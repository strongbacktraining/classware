000010******************************************************************00001099
000020*   PROGRAM NAME:  ETNI RECONCILIATION PROGRAM                    00002099
000030*                                                                 00003099
000040*   PROGRAM ID  :  ETNBC16                                        00004099
000050*                                                                 00005099
000060*   PURPOSE: THE PURPOSE OF THIS PROGRAM IS TO PRODUCE THE        00006099
000070*            RECONCILIATION REPORT AND UPDATE THE TELEPHONE       00007099
000080*            INVENTORY FOR BILLING AND ETNI SYSTEMS.              00008099
000090******************************************************************00009099
000100*   MODIFICATION LOG:                                             00010099
000110*                                                                 00011099
000120*   CHANGE   PROGRAMMER                                           00012099
000130*   CODE     NAME             DATE       DESCRIPTION              00013099
000140*   ------   ----------     --------     -----------------------  00014099
000150*            J. CELEMEN      03-2002     INITIAL VERSION          00015099
000160*            M. AUSLANDER    07-14-02    COMMENT OUT DISPLAY      00016099
000170*                                        FOR COMMITT PROCESSING   00017099
000180*            B. TARN         07-2002     SET DIFFERENT COMMIT     00018099
000190*                                        POINTS FOR REPORT VS     00019099
000200*                                        UPDATE MODE.             00020099
000210*            A.G.BOLOGOVSKY  08-09-02    Removed 7200- routine to 00021099
000220*                                        verify NPA/NXX against   00022099
000230*                                        LERG-6 table.            00023099
000240*            A.G.BOLOGOVSKY  08-16-02    1) For ALL billing systms00024099
000250*                                           if trans-code = 'SPL' 00025099
000260*                                           remove DELETE, instead00026099
000270*                                           write to Error file.  00027099
000280*                                        2) For Vision only:      00028099
000290*                                           if Billing Status = AI00029099
000300*                                           and ETNI Status = AR  00030099
000310*                                           remove UPDATE, instead00031099
000320*                                           write to Error file.  00032099
000330*    EMERG   S.BONENFANT     08/17/02    CHK FOR SPL BEFORE CHK   00033099
000340*                                       FOR UPDATE MODE           00034099
000350*    EMERG   KC LOUIE        08/27/02   ALIGN ERROR PROCESS AS    00035099
000360*IR8953-082702 <PUT OUT ERROR REPORT BEFORE RECON IS PROCESS      00036099
000370*      SEE BEFORE THE "REPORT LOCAL BILLING FIELDS" COMMENTS IN   00037099
000380*      PARAGRAPH 2100-MDN-MATCH.                                  00038099
000390*            AC PINLAC       08-29-02   CORRECT UPDATE QTY ON     00039099
000400*                                       NGP COUNTERS              00040099
000410*    EMERG   KC LOUIE        08/30/02   INSTEAD OF DELETE PROCESS 00041099
000420*       REPLACE WITH ERROR REPORTING AND DO NOT REPORT TO RECON   00042099
000430*       SEE (*KC) FOR STATEMENTS THAT ARE                         00043099
000440*       CONSIDERED DEACTIVATED BASE ON REPLACING DELETE PROCESS   00044099
000450*       WITH ERROR REPORTING PROCESS AND NOT REPORTING TO THE     00045099
000460*       RECONCILIATION REPORT PROCESS. (SEE *KC)                  00046099
000470*                                                                 00047099
000480*            A.G.BOLOGOVSKY  09/06/02  Added a new parm "UPDDEL"  00048099
000490*                                      which allows both update   00049099
000500*                                      and delete functionality.  00050099
000510*                                                                 00051099
000520*            A.G.BOLOGOVSKY  09/09/02  If 2nd byte of eTNI Number 00052099
000530*                                      Location = "H", bypass     00053099
000540*                                      tests. These are pre-paid  00054099
000550*                                      numbers on Hold.           00055099
000560*                                                                 00056099
000570*            A.G.BOLOGOVSKY  09/12/02  Added a test on the value  00057099
000580*                                      of input parm. If incorrect00058099
000590*                                           display msg & abend.  00059099
000600*                                                                 00060099
000610*            A.G.BOLOGOVSKY  09/17/02  Changed Control Report to  00061099
000620*                                      print a formatted copy of  00062099
000630*                                      input MDNIN Header (Rec    00063099
000640*                                      Type 1) data fields.       00064099
000650*                                                                 00065099
000660*            A.G.BOLOGOVSKY  09/17/02  Added 3 new parms: REPORX, 00066099
000670*                                      UPDATX and UPDDEX. Use of  00067099
000680*                                      these will NOT compare date00068099
000690*                                      on MDNIN Header to current.00069099
000700*                                      Use of REPORT/UPDATE/UPDDEL00070099
000710*                                      causes comparison and if   00071099
000720*                                      Header date < current date,00072099
000730*                                      program abends with message00073099
000740*                                                                 00074099
000750*            AC PINLAC       09/25/02  ADDED PARMs: UPDDNA, UPDDNX00075099
000760*                                      TO UPDATE MDN STATUS TO NA.00076099
000770*                                      SET MIN-NUM TO NULLS       00077099
000780*                                      INSTEAD OF SPACES.         00078099
000790*                                                                 00079099
000800*   FIX0928  S.BONENFANT     09/28/02  MIN STATUS UPDATE TO AA NOT00080099
000810*                                      AP; ADD 1 MICROSECOND TO   00081099
000820*                                      LAST TRX TIME BEFORE INSERT00082099
000830*                                      TO HISTORY; NO UNLOAD HIST 00083099
000840*                                      CREATED FOR UPDDNA; ADD    00084099
000850*                                      TNICOB01, TNICOB06 INCLS   00085099
000860*                                                                 00086099
000870*            J.CELEMEN       10/01/02  -ON THE VALIDATION OF THE  00087099
000880*                                       MDNIN FILE HEADER DATE,   00088099
000890*                                       PROCESS THE FILE IF IT WAS00089099
000900*                                       CREATED WITHIN 24 HOURS   00090099
000910*                                      -VALIDATE TRANSACTION DATE 00091099
000920*                                       AGAINST HEADER DATE, NOT  00092099
000930*                                       CURRENT DATE              00093099
000940*                                      -PREVENT OVERLAYING 'NH'   00094099
000950*                                       MDNs in eTNI              00095099
000960*                                      -DISPLAY ACTUAL PGM MODE   00096099
000970*                                      -ON THE UPDDNA OPTION,     00097099
000980*                                       SPACE OUT NL FIELD        00098099
000990*                                      -DISPLAY AN ERROR LINE IN  00099099
001000*                                       RECON RPT IF AN ATTEMPT   00100099
001010*                                       TO UPDATE eTNI FAILS      00101099
001020*                                      -FIX PREPAID BYPASS LOGIC  00102099
001030*                                       CHANGE THAT AFFECTED      00103099
001040*                                       MATCHING LOGIC            00104099
001050*                                                                 00105099
001060*            AC PINLAC       10/21/02  ADD CHECK TO MIN IN CTN-INV00106099
001070*                                      NOT PAIRED WITH ANOTHER MDN00107099
001080*                                                                 00108099
001090*            J BOLTON        11/08/02  ADD LOGIC TO UPDATE        00109099
001100*                                      AA-STS-CNT IN NEW          00110099
001110*                                      NPANXX-AVAIL TABLE         00111099
001120*                                                                 00112099
001130*            A.G.Bologovsky  11/12/02  Made 2 changes: Bypass     00113099
001140*                                      Transaction Date check for 00114099
001150*                                      Prism - updates eTNI re-   00115099
001160*                                      gardless of TRX Date.      00116099
001170*                                      And except 'AR' status,    00117099
001180*                                      do not update Transaction  00118099
001190*                                      Date for Prism.            00119099
001200*                                      (see 2100-MDN-MATCH  and   00120099
001210*                                       7010-UPDATE-CTN-INV)      00121099
001220*            A.YEYKELIS      12/02/02  FIXED RECON REPORT TO NOT  00122099
001230*                                      WRITE BLANK LINES WHEN ERRO00123099
001240*                                      MESSAGE IS WRITTEN TO THE  00124099
001250*                                      ERROR REPORT.              00125099
001260*                                                                 00126099
001270*            A.G.Bologovsky  12/04/02  Commented out changes made 00127099
001280*                                      11/23/02 in 2100-MDN-MATCH.00128099
001290*                                      No longer bypass TRX date  00129099
001300*                                      check for Prism - they will00130099
001310*                                      send a real Transaction dt.00131099
001320*                                      ("AGB" on changed lines).  00132099
001330*                                                                 00133099
001340*            A.G.Bologovsky  12/04/02  Commented out changes made 00134099
001350*                                      11/23/02 in 7010-UPDATE.   00135099
001360*                                      Back to updating Prism     00136099
001370*                                      Transaction Date.          00137099
001380*                                      ("AGX" on changed lines).  00138099
001390*                                                                 00139099
001400*            A.G.Bologovsky  12/04/02  Commented out call to pgm  00140099
001410*                                      ETNSC50: updates AA-STS-CNT00141099
001420*                                      in NPANXX-AVAIL table.     00142099
001430*                                      Table not in Prod yet!     00143099
001440*                                      ("POSX" on changed line).  00144099
001450*                                                                 00145099
001460*            A.G.Bologovsky  12/04/02  For any of the parms that  00146099
001470*                                      update, save CTN status for00147099
001480*                                      determining if MIN-INV     00148099
001490*                                      needs to be updated.       00149099
001500*                                      ("STAX" on new lines).     00150099
001510*                                                                 00151099
001520*            A.G.Bologovsky  02/10/03  Added the write of a new   00152099
001530*                                      Date Control output file   00153099
001540*                                      (DTCTLOUT-FILE) which      00154099
001550*                                      drives Logical delete      00155099
001560*                                      process in pgm ETNBC46.    00156099
001570*                                                                 00157099
001580*            A.G.Bologovsky  03/13/03  Added SUB-MARKET Null Ind  00158099
001590*                                      to fetch of MIN-INV in rtn 00159099
001600*                                      7810-. This was causing    00160099
001610*                                      an occasional error msg    00161099
001620*                                      rather than a MIN-INV      00162099
001630*                                      Status update to "AA".     00163099
001640*                                      Also, added NULL indicator 00164099
001650*                                      logic to every SQL opera-  00165099
001660*                                      tion for every table.      00166099
001670*                                                                 00167099
001680*            A.G.Bologovsky  03/18/03  Biller can no longer make  00168099
001690*                                      PORT-IND changes to eTNI.  00169099
001700*                                      If different, its an error!00170099
001710*                                      (see references to fields: 00171099
001720*                                           WS-NEW-PORT-IND,      00172099
001730*                                           WS-OLD-PORT-IND)      00173099
001740*                                      Valid eTNI PORT-INDS are...00174099
001750*                                      IO, PI, PO, RE, SB.        00175099
001760*                                                                 00176099
001770*  #870803   A.G.BOLOGOVSKY  04/10/03  REMOVED SENSITITY TO       00177099
001780*                                      PROD-TYPE when matching    00178099
001790*                                      eTNI and Biller MDNs.      00179099
001800*                                      Also, no longer Include    00180099
001810*                                      PROD-TYPE on CTN-INV updts.00181099
001820*                                                                 00182099
001830*  #830803   A.G.Bologovsky  04/11/03  Added logic to try up to   00183099
001840*                                      10 inserts in CTN-INV-HIST 00184099
001850*                                      if a dupe key (-803) sqlcd 00185099
001860*                                      occurs in 1st insert try.  00186099
001870*                                                                 00187099
001880*  #880803   s.lesser        04/14/03  MOVED LOCATION OF 3/18/03  00188099
001890*                                      FIX SO PORT-IND EDIT       00189099
001900*                                      TO DIALLOW PORT-IND CHANGE 00190099
001910*                                      IS NOT DONE WHEN MDN IS IN 00191099
001920*                                      BILLING SYS, BUT NOT ENTI  00192099
001930*                                      (I.E. IT WILL ONLY BE DONE 00193099
001940*                                      WHEN MDN IS IN BOTH SYSTEMS00194099
001950*  #850803-1 L.STRAUSS       04/24/03  Commented out business rule00195099
001960*                                      preventing Vision MDNs from00196099
001970*                                      being modified from AR to  00197099
001980*                                      AI status.                 00198099
001990*  #850803-2 L.STRAUSS       04/24/03  INSERTED CODE SO THAT WHEN 00199099
002000*                                      MDN is in eTNI but not in  00200099
002010*                                      billing system, status not 00201099
002020*                                      to be updated to NA if the 00202099
002030*                                      Port Indicator is PO or PI 00203099
002040*                                      if the Run Mode is UPDDNA. 00204099
002050*  #850803-2 L.STRAUSS       04/24/03  INSERTED CODE SO THAT WHEN 00205099
002060*                                      MDN is in eTNI but not in  00206099
002070*                                      billing system, do not     00207099
002080*                                      delete the MDN from eTNI   00208099
002090*                                      if the Port Indicator is   00209099
002100*                                      PO or PI if the Run Mode is00210099
002110*                                      UPDDEL.                    00211099
002120*  #140804   L.STRAUSS       05/21/03  Modified code to include   00212099
002130*                                      new hold reason codes.     00213099
002140*            L.STRAUSS       06/16/03  Don't flag for hist update 00214099
002150*                                      if min blank and mdn status00215099
002160*                                      na or nh                   00216099
002170*  IR#071503 KIN.LOUIE       07/15/03  RSS - THIS PROGRAM SHOULD  00217099
002180*                            CHECK THAT THE NL FIRST CHARACTER IS 00218099
002190*                            ALWAYS EQUAL TO THE BILLER ID FROM   00219099
002200*                            HEADER.  UPDATES ARE NOT ALLOWED TO  00220099
002210*                            THE BILLER-ID IN THIS PROCESS.       00221099
002220*            MNOTE:  SEE     7020-INSERT-CTN-INV WHERE ONLY       00222099
002230*                            THE BILLER-ID OF CTN-INV IS UPDATED  00223099
002240*                            here only: see flow                  00224099
002250*                            (1) 2200-MDN-NOT-IN-ETNI             00225099
002260*                            (2) 2200-POPULATE-CTN                00226099
002270*                            (3) 7020-insert-ctn-inv              00227099
002280*                            ALSO, REPLACED IASCC67 WITH ENTCC27. 00228099
002290*                            ALSO, INCLUDED PREPAID-IND FOR       00229099
002300*                            CTN-INV AND CTN-INV-HISTORY FOR EACH 00230099
002310*                            INSERT PROCESS.                      00231099
002320*                            NOTE: PREPAID-IND DEFAULT IS 'N'     00232099
002330*                            NOTE: BILLING WILL PASS TO ETNI END  00233099
002340*                            NOTE: OF AUGUST 2003 OR LATER, BUT   00234099
002350*                            NOTE: UNTIL THAT TIME OK TO USE 'N'. 00235099
002360*                            SEE 220-POPULATE-CTN                 00236099
002370*                            SEE 2320-POPULATE-CTN-HIST           00237099
002380*                            ADD 7125-REINSERT-CTN-INV-HIST FOR   00238099
002390*                            THE RETRY 1 TO 10 TIMES ROUTINE      00239099
002400*                            MNOTE:  COMMENTS ADDED as required   00240099
002410*                            MNOTE:  iascc67 in etnbc08 replaced  00241099
002420*                            MNOTE:  by etncc27.                  00242099
002430*                            MNOTE:  etnrc41 will still use       00243099
002440*                            MNOTE:  iascc67 ?                    00244099
002450*                                                                 00245099
002460* LMS        l. strauss      10/17/03  ADDED CODE SO THAT WHEN    00246099
002470*                                      MDN is in eTNI but not in  00247099
002480*                                      billing system, status not 00248099
002490*                                      to be updated to NA if the 00249099
002500*                                      Port Indicator is IO       00250099
002510*                                      if the Run Mode is UPDDNA. 00251099
002520*                            10/17/03  ADDED CODE SO THAT WHEN    00252099
002530*                                      MDN is in eTNI but not in  00253099
002540*                                      billing system, do not     00254099
002550*                                      delete the MDN from eTNI   00255099
002560*                                      if the Port Indicator is   00256099
002570*                                      IO if the Run Mode is      00257099
002580*                                      UPDDEL.                    00258099
002590*                                                                 00259099
002600*            A.G.Bologovsky  12/11/03  No longer move nulls to    00260099
002610*                                      MIN-NUM when PORT-IND is   00261099
002620*                                      "PO", "PI" or "IO" in      00262099
002630*                                      "UPDDNA" parm-activated rtn00263099
002640*                                      7015-UPDATE-CTN-INV-STATUS.00264099
002650*                                      Now, only do it for PO, IO 00265099
002660*                                      (Ported Out) CTNs.         00266099
002670*                                                                 00267099
002680*            A.G.Bologovsky  01/23/04  Port-Outs have spaces in NL00268099
002690*                                      so only compare NLs 1st    00269099
002700*                                      byte to Biller from Header 00270099
002710*                                      if the NL is populated.    00271099
002720*                                      Prevents lots of false msgs00272099
002730*                                     "RSS NO UPDATE TO BILL.ID". 00273099
002740*                                      Search phrase:             00274099
002750*                                     "port-outs have spaces in NL00275099
002760*                                                                 00276099
002770*            A.G.BOLOGOVSKY  01/23/04  Due to the high volume of  00277099
002780*                                      "PREPAID ON HOLD:BYPASSED" 00278099
002790*                                      messages, write them to a  00279099
002800*                                      seperate output report file00280099
002810*                                      Search phrase:             00281099
002820*                                      "8875-WRITE-PREPAID-ON-HOLD00282099
002830*                                                                 00283099
002840*            A.G.BOLOGOVSKY  01/26/04  Remove the change of 3/18/300284099
002850*                                      which prevented Biller from00285099
002860*                                      modifying Port Indicator   00286099
002870*                                      in eTNI.(in 2100-MDN-MATCH)00287099
002880*                                      Search phrase:             00288099
002890*                                      "PREVENT PORT IND CHANGE"  00289099
002900*                                                                 00290099
002910*            A.G.BOLOGOVSKY  01/30/04  In 7830-UPDATE-MIN-INV-STAT00291099
002920*                                      added logic to check on    00292099
002930*                                      CTN's status to determine  00293099
002940*                                      which status to update the 00294099
002950*                                      MIN-INV with.              00295099
002960*                                      Search phrase:             00296099
002970*                                      "7830-UPDATE-MIN-INV-STATUS00297099
002980*                                                                 00298099
002990*            A.G.BOLOGOVSKY  01/30/04  Same as above, but added to00299099
003000*                                      2185-UPD-OLD-MIN-NUM-STAT. 00300099
003010*                                                                 00301099
003020*            A.G.BOLOGOVSKY  01/30/04  Same as above, but added to00302099
003030*                                      2190-UPD-NEW-MIN-NUM-STAT. 00303099
003040*                                                                 00304099
003050*            A.G.BOLOGOVSKY  02/03/04  To prevent Ported-Out eTNI 00305099
003060*                                      CTNs from being compared   00306099
003070*                                      to Biller (won't be there, 00307099
003080*                                      anyway), check on Status & 00308099
003090*                                      Port-Ind of "PO".          00309099
003100*                                      Search phrase:             00310099
003110*                                     "records with a "PO" in Stat00311099
003120*                                                                 00312099
003130*            A.G.BOLOGOVSKY  02/10/04  To prevent eTNI Snapbacks  00313099
003140*                                      CTNs from being compared   00314099
003150*                                      to Biller (won't be there, 00315099
003160*                                      anyway), check on Status & 00316099
003170*                                      Port-Ind of "SB".          00317099
003180*                                      Search phrase:             00318099
003190*                                     "and a "SB" in Port-Indicat"00319099
003200*                                                                 00320099
003210*            A.G.BOLOGOVSKY  02/10/04  Revert back to not letting 00321099
003220*                                      Biller change eTNI Port-Ind00322099
003230*                                      Search phrase:             00323099
003240*                                     "PORT-INDS-DONT-MATCH"      00324099
003250*                                      and                        00325099
003260*                                     "NEVER UPDATE PORT-IND FROM"00326099
003270*                                                                 00327099
003280*            A.G.BOLOGOVSKY  02/16/04  If Biller sends Status of  00328099
003290*                                      AT and blank NL, don't     00329099
003300*                                      report this as an error.   00330099
003310*                                      Search phrase:             00331099
003320*                                      "will never be found in NGP00332099
003330*                                                                 00333099
003340*            A.G.BOLOGOVSKY  02/16/04  Since Biller can't change  00334099
003350*                                      eTNI Port-Ind anymore,     00335099
003360*                                      remove logic which compares00336099
003370*                                      Port-Ind from the 2 inputs.00337099
003380*                                      Search phrase:             00338099
003390*                                      "DO NOT include the compari00339099
003400*                                                                 00340099
003410*            A.G.BOLOGOVSKY  02/20/04  No longer change the SYS-  00341099
003420*                                      UPDATE-DATE & OPERATOR-ID  00342099
003430*                                      when writing to HISTORY.   00343099
003440*                                      Just move from CTN-INV.    00344099
003450*                                      Search phrase:             00345099
003460*                                      "longer change the SYS UPDA00346099
003470*                                                                 00347099
003480*            A.G.BOLOGOVSKY  02/25/04  2100-MDN-MATCH: If Biller's00348099
003490*                                      Status is "AG" and both    00349099
003500*                                      eTNI's Status and Port-Ind 00350099
003510*                                      are "PO", write a msg to   00351099
003520*                                      error file & exit routine. 00352099
003530*                                      (no updates performed).    00353099
003540*                                      "ETNI PORTED OUT WITH PO"  00354099
003550*                                      This supercedes the change 00355099
003560*                                      made on 02/03/04.          00356099
003570*                                      Search phrase:             00357099
003580*                                      "If Biller Port Ind differe00358099
003590*                                                                 00359099
003600*            A.G.BOLOGOVSKY  02/26/04  2100-MDN-MATCH: If Biller's00360099
003610*                                      Status is "AG" and eTNI's  00361099
003620*                                      Status is "PO" and Port-Ind00362099
003630*                                      is "IO", write a msg to    00363099
003640*                                      error file & exit routine. 00364099
003650*                                      (no updates performed).    00365099
003660*                                      "ETNI PORTED OUT WITH IO"  00366099
003670*                                      This supercedes the change 00367099
003680*                                      made on 02/03/04.          00368099
003690*                                      Search phrase:             00369099
003700*                                      "If Biller Port Ind differe00370099
003710*                                                                 00371099
003720*            A.G.BOLOGOVSKY  02/27/04  For each Biller MDN not in 00372099
003730*                                      eTNI input file, check     00373099
003740*                                      CTN-INV to make sure that  00374099
003750*                                      the Biller there is same as00375099
003760*                                      what's in Biller's input   00376099
003770*                                      file. If not,      below   00377099
003780*                                      error message is written & 00378099
003790*                                      routine is exited with no  00379099
003800*                                      updates taking place.      00380099
003810*                                      "MDN BELONGS TO DIFF BILR" 00381099
003820*                                      Search phrase:             00382099
003830*                                      "because of a transfer fail00383099
003840*                                                                 00384099
003850*            A.G.BOLOGOVSKY  02/27/04  Correct an intermittent    00385099
003860*                                      error where already proces-00386099
003870*                                      sed MINS are reapplied to  00387099
003880*                                      subsequent CTNs.           00388099
003890*                                      Initialized DCLGENS for    00389099
003900*                                      CTN-INV, HISTORY between   00390099
003910*                                      input file compare cycles. 00391099
003920*                                                                 00392099
003930*            A.G.BOLOGOVSKY  03/2/04   If eTNI CTN not in Biller  00393099
003940*                                      file and it's in "AG"      00394099
003950*                                      status with a Port-Ind of  00395099
003960*                                      "PI", copy this CTN-INV row00396099
003970*                                      to History "as is", create 00397099
003980*                                      a new History row with     00398099
003990*                                      "UNLD" Trx-Cde, "PO" status00399099
004000*                                      and "IO" Port-Ind. Then,   00400099
004010*                                      delete original CTN-INV row00401099
004020*                                      & write "deleted" message: 00402099
004030*                                      "DELETED, NOT IN BILLING". 00403099
004040*                                      See 2300-MDN-NOT-IN-BILL.  00404099
004050*                                                                 00405099
004060*            A.G.BOLOGOVSKY  03/3/04   7125-REINSERT-CTN-INV-HIST.00406099
004070*                                      routine corrected to NOT   00407099
004080*                                      refetch a fresh copy of    00408099
004090*                                      CTN-INV data, but rather to00409099
004100*                                      write the already-updated  00410099
004110*                                      data resident in HISTORY   00411099
004120*                                      Dclgen. Otherwise, when    00412099
004130*                                      attempting a re-insert of  00413099
004140*                                      HISTORY row, all changes   00414099
004150*                                      made in program are lost!  00415099
004160*                                                                 00416099
004170*            A.G.BOLOGOVSKY  03/16/04  If this is a Port-Out in   00417099
004180*                                      eTNI (and thus not found in00418099
004190*                                      Biller file), don't display00419099
004200*                                      "UPDATED: MDN NOT IN BILL" 00420099
004210*                                      message on Recon report.   00421099
004220*                                      Just keep a count.         00422099
004230*                                                                 00423099
004240*            A.G.BOLOGOVSKY  03/19/04  Enhanced above mod by NOT  00424099
004250*                                      printing a blank line where00425099
004260*                                      "UPDATED: MDN NOT IN BILL" 00426099
004270*                                      used to print for          00427099
004280*                                      Ported Out eTNI CTNs.      00428099
004290*                                                                 00429099
004300*            A.G.BOLOGOVSKY  03/24/04  Corrected a problem in     00430099
004310*                                      2300-MDN-NOT-IN-BILL where 00431099
004320*                                      CTN was not being passed to00432099
004330*                                      7000-SELECT-CTN-INV and a  00433099
004340*                                      previously processed CTN   00434099
004350*                                      was being updated.         00435099
004360*                                                                 00436099
004370*            A.G.BOLOGOVSKY  03/27/04  Corrected a problem in     00437099
004380*                                      2100-MDN-MATCH where       00438099
004390*                                      CTN was not being passed to00439099
004400*                                      7010-UPDATE-CTN-INV        00440099
004410*                                      and a previously processed 00441099
004420*                                      CTN was being updated.     00442099
004430*                                                                 00443099
004440*            A.G.BOLOGOVSKY  03/30/04  If eTNI CTN not in Biller  00444099
004450*                                      file & in eTNI the status/ 00445099
004460*                                      Port-Ind combo is:         00446099
004470*                                      AG/PI, AG/IO, PO/IO/ NA/IO 00447099
004480*                                      copy this CTN-INV row      00448099
004490*                                      to History "as is", create 00449099
004500*                                      a new History row with     00450099
004510*                                      "ULD" Trx-Cde, "PO" status 00451099
004520*                                      and "IO" Port-Ind. Then,   00452099
004530*                                      delete original CTN-INV row00453099
004540*                                      & write "deleted" message: 00454099
004550*                                      "DELETED, NOT IN BILLING". 00455099
004560*                                      See 2300-MDN-NOT-IN-BILL.  00456099
004570*                                                                 00457099
004580*            A.G.BOLOGOVSKY  03/31/04  If Biller MDN matches eTNI 00458099
004590*                                      CTN in 2100-MDN-MATCH and  00459099
004600*                                      Biller's STATUS is AI and  00460099
004610*                                      Biller's Port-Ind is RE and00461099
004620*                                      eTNI's Status and Port-Ind 00462099
004630*                                      for the same CTN are PO,   00463099
004640*                                      check LSMS table to see if 00464099
004650*                                      this is a VZW SPID. If so, 00465099
004660*                                      allow Port-Ind update.     00466099
004670*                                      If not, allow only Status  00467099
004680*                                      update, but NOT Port-Ind.  00468099
004690*                                      See 7200-CHECK-SPID-IN-LSMS00469099
004700*                                                                 00470099
004710*            A.G.BOLOGOVSKY  04/16/04  If CTN is on eTNI file but 00471099
004720*                                      not on Biller's AND it's   00472099
004730*                                      Ported-out, that's a normal00473099
004740*                                      condition. Do not write    00474099
004750*                                      "WARNING: MDN NOT IN BILL" 00475099
004760*                                      message to Error file.     00476099
004770*                                                                 00477099
004780*            A.G.BOLOGOVSKY  04/16/04  Added sensitivity to       00478099
004790*                                      NOT-DELETED-SW in routine  00479099
004800*                                      7030-DELETE-CTN-INV to pre-00480099
004810*                                      vent deletion when needed. 00481099
004820*                                                                 00482099
004830*            A.G.BOLOGOVSKY  04/20/04  When updating "old" eTNI   00483099
004840*                                      MIN status in 2180-UPDATE, 00484099
004850*                                      allow PI Port-Ind records  00485099
004860*                                      to be updated. If "old"    00486099
004870*                                      eTNI Status = 'AI' and old 00487099
004880*                                      eTNI PortInd = 'PI', set   00488099
004890*                                      MIN-INV Min Status to 'AP'.00489099
004900*                                      (see 2185- routine).       00490099
004910*                                                                 00491099
004920*            A.G.BOLOGOVSKY  04/21/04  In 2300-MDN-NOT-IN-BILL,   00492099
004930*                                      changed the criteria for   00493099
004940*                                      unloading CTN-INV row to   00494099
004950*                                      History from "PI/IO" and   00495099
004960*                                      Status "AG" to "PI/IO" and 00496099
004970*                                      Status not = 'NH'.         00497099
004980*                                                                 00498099
004990*            A.G.BOLOGOVSKY  04/23/04  In 2300-MDN-NOT-IN-BILL,   00499099
005000*                                      if eTNI CTN is ported out  00500099
005010*                                      (Status PO, Port-IND PO)   00501099
005020*                                      perform no updates and no  00502099
005030*                                      writes to recon output.    00503099
005040*                                      Search phrase:             00504099
005050*                                      "updates or reporting"     00505099
005060*                                                                 00506099
005070*            A.G.BOLOGOVSKY  04/27/04  Added a version of 2180-   00507099
005080*                                      UPDATE-MIN-INV-STATUS rtn  00508099
005090*                                      which updates MIN-INV      00509099
005100*                                      status ONLY in those cases 00510099
005110*                                      where the CTN is found in  00511099
005120*                                      Biller file and not eTNI's 00512099
005130*                                      file. This routine assumes 00513099
005140*                                      eTNI "old" fields are empty00514099
005150*                                      New routine names:         00515099
005160*                                      2183-UPDATE-MIN-INV-STATUS,00516099
005170*                                      7007-SELECT-CTN-INV-MIN.   00517099
005180*                                                                 00518099
005190*            A.G.BOLOGOVSKY  05/05/04  Added the UPDDNA parm to   00519099
005200*                                      list of parms in routine   00520099
005210*                                      2300-MDN-NOT-IN-BILL which 00521099
005220*                                      moves eTNI Status to field 00522099
005230*                                      WS-OLD-STATUS, which the   00523099
005240*                                      MIN-INV update relies on.  00524099
005250*                                                                 00525099
005260*            A.G.BOLOGOVSKY  05/05/04  In 2300-MDN-NOT-IN-BILL,   00526099
005270*                                      added update of MIN-INV    00527099
005280*                                      Status to "AP" when a Port 00528099
005290*                                      Out is being unloaded from 00529099
005300*                                      CTN-INV to History.        00530099
005310*                                      (2184-UPDATE-MIN-STATUS)   00531099
005320*                                                                 00532099
005330*            A.G.BOLOGOVSKY  05/06/04  In 2300-MDN-NOT-IN-BILL,   00533099
005340*                                      added logic to handle      00534099
005350*                                      Transitional CTNs. (status 00535099
005360*                                      not PO, Port-Ind is PO).   00536099
005370*                                      CTN-INV row saved in Hist, 00537099
005380*                                           updated,      MIN-INV 00538099
005390*                                      Status updated to "AP".    00539099
005400*                                                                 00540099
005410*            A.G.BOLOGOVSKY  05/14/04  In 2110-VALIDATE-BILL-MDN, 00541099
005420*                                      no longer write error msg  00542099
005430*                                     "PORT-IND UPDT DISALLOWED   00543099
005440*                                      KEPT: " "                  00544099
005450*                                      if eTNI CTN was not found &00545099
005460*                                      only Biller's MDN exists.  00546099
005470*                                                                 00547099
005480*            A.G.BOLOGOVSKY  05/17/04  In 2300-MDN-NOT-IN-BIL rtn 00548099
005490*                                      added logic to write a     00549099
005500*                                      Disconnect message to the  00550099
005510*                                      VZW Gateway when deleting/ 00551099
005520*                                      unloading "PI" or "IO"     00552099
005530*                                      Port-Ind CTN-INV rows.     00553099
005540*                                                                 00554099
005550*            A.G.BOLOGOVSKY  05/21/04  In 2300-MDN-NOT-IN-BIL rtn 00555099
005560*                                      added to write to recon rpt00556099
005570*                                      the actual Status updated  00557099
005580*                                      to rather than a generic   00558099
005590*                                      "UPDATED: MDN NOT IN BILL".00559099
005600*                                                                 00560099
005610*            A.G.BOLOGOVSKY  05/24/04  In 2300-MDN-NOT-IN-BIL rtn 00561099
005620*                                      now check LSMS table before00562099
005630*                                      updating Regular CTNs to   00563099
005640*                                      check if they've Ported Out00564099
005650*                                                                 00565099
005660*            A.G.BOLOGOVSKY  06/08/04  Allow a Biller-ID of "R".  00566099
005670*                                      (2010-VALIDATE-BILL-HEADER)00567099
005680*                                                                 00568099
005690*            A.G.BOLOGOVSKY  06/11/04  Changed location of Bypass 00569099
005700*                                      of New Transactions to very00570099
005710*                                      top of 2300-MDN-NOT-IN-BILL00571099
005720*                                      so it applies to PO and PIs00572099
005730*                                      as well as regular CTNs.   00573099
005740*                                                                 00574099
005750*            A.G.BOLOGOVSKY  06/14/04  Placed all Exclusionary    00575099
005760*                                      logic at the start of      00576099
005770*                                      2300-MDN-NOT-IN-BILL to    00577099
005780*                                      prevent unnecessary        00578099
005790*                                      processing. Was scattered  00579099
005800*                                      throughout the routine.    00580099
005810*                                                                 00581099
005820*            A.G.BOLOGOVSKY  06/16/04  Disallowed I2K east & west 00582099
005830*                                      from updating eTNI MINs    00583099
005840*                                      based on setting of flag   00584099
005850*                                      IS-THIS-I2K-INPUT.         00585099
005860*                                      (except in cases where     00586099
005870*                                       Biller Status is NA/NH:   00587099
005880*                                       eTNI MIN is nulled out).  00588099
005890*                                                                 00589099
005900*            A.G.BOLOGOVSKY  06/29/04  Change MQ initialization to00590099
005910*                                      occur at start of pgm      00591099
005920*                                      rather than at first use of00592099
005930*                                      MQ. This prevents LOTS of  00593099
005940*                                      records from processing OK 00594099
005950*                                      before potential MQ failure00595099
005960*                                      causes an abend.           00596099
005970*                                                                 00597099
005980*            A.G.BOLOGOVSKY  06/29/04  Added the Disconnect count 00598099
005990*                                      to job run-total displays. 00599099
006000*                                                                 00600099
006010*            A.G.BOLOGOVSKY  06/30/04  Allow the processing of the00601099
006020*                                      following: eTNI status of  00602099
006030*                                      "NH" & hold-reason "DONATE"00603099
006040*                                      and the Biller has status  00604099
006050*                                      "AR/AI" and Port-Ind "PI". 00605099
006060*                                      Previously bypassed all    00606099
006070*                                      eTNI "NH" status rows.     00607099
006080*                                      Search For: "AGB 6/30/04". 00608099
006090*                                                                 00609099
006100*            A.G.BOLOGOVSKY  06/30/04  Dynamically determine which00610099
006110*                                      Logical Partition (LPAR)   00611099
006120*                                      this job is running in so  00612099
006130*                                      that the correct MQ manager00613099
006140*                                      name can be used in routine00614099
006150*                                      "Q1030-SELECT-QUEUE-MGR".  00615099
006160*                                      The LPAR is found in rtn   00616099
006170*                                      "0900-GET-ENVIRONMENT-INFO"00617099
006180*                                      (Logic from IASBCF8)       00618099
006190*                                                                 00619099
006200*CAY070804   A.YEYKELIS      07/08/04  Allow updates to Holding   00620099
006210*                                    Number Location when the MDN 00621099
006220*                                    is in 'AI' status in billing 00622099
006230*                                                                 00623099
006240*            A.G.BOLOGOVSKY  07/19/04  Simplify the rules determi-00624099
006250*                                      ning when I2K can and can't00625099
006260*                                      update eTNI MIN-NUM in rtn 00626099
006270*                                      2400-CHECK-FOR-I2K.        00627099
006280*                                                                 00628099
006290*            A.G.BOLOGOVSKY  07/30/04  Modified routines 2185-UPD 00629099
006300*                                      and 7006-SELECT to update  00630099
006310*                                      the MIN-INV status of the  00631099
006320*                                      old MIN on any CTN-INV row 00632099
006330*                                      where Biller's MIN is      00633099
006340*                                      updated to eTNI. This chg  00634099
006350*                                      will update the original   00635099
006360*                                      eTNI MIN's status. (the one00636099
006370*                                      no longer on CTN-INV).     00637099
006380*                                                                 00638099
006390*            A.G.BOLOGOVSKY  08/25/04  Added new logic to test    00639099
006400*                                      against the PORTIN-MDN-TDS 00640099
006410*                                      table as a condition to    00641099
006420*                                      determine if pgm should    00642099
006430*                                      issue a Disconnect to      00643099
006440*                                      the Gateway. See routines  00644099
006450*                                      2300-MDN-NOT-IN-BILL,      00645099
006460*                                      9170-READ-PORTIN-MDN-TDS,  00646099
006470*                                      7005-SPLIT-CTN-INV-UPD.    00647099
006480*                                                                 00648099
006490*            A.G.BOLOGOVSKY  08/27/04  Enhanced above search to   00649099
006500*                                      find row in PORTIN-MDN-TDS 00650099
006510*                                      with the most recent       00651099
006520*                                      Effective-Date.            00652099
006530*                                                                 00653099
006540*            A.G.BOLOGOVSKY  08/27/04  Create a History record    00654099
006550*                                      before updating CTN-INV to 00655099
006560*                                      "NH" / "SPLIT" in routine  00656099
006570*                                      2300- just before          00657099
006580*                                      7005-SPLIT-CTN-INV-UPD is  00658099
006590*                                      executed.                  00659099
006600*                                                                 00660099
006610*            A.G.BOLOGOVSKY  08/27/04  When updating MIN-INV in   00661099
006620*                                      2184- routine, check to see00662099
006630*                                      if any other CTN-INV rows  00663099
006640*                                      have same MIN as the one   00664099
006650*                                      being processed. Is so, its00665099
006660*                                      an error.                  00666099
006670*                                                                 00667099
006680*            A.G.BOLOGOVSKY  09/02/04  In 2180-UPDATE-MIN-INV-STAT00668099
006690*                                      added 'PO' as a valid value00669099
006700*                                      for WS-OLD-PORT-IND...     00670099
006710*                                      ('RE' OR 'PI' OR 'PO') so  00671099
006720*                                      that MIN-INV status will be00672099
006730*                                      updated and not bypassed.  00673099
006740*                                                                 00674099
006750*            A.G.BOLOGOVSKY  09/08/04  In 2110-VALIDATE-PORT-IND  00675099
006760*                                      added the following combo  00676099
006770*                                      as allowing update of eTNI 00677099
006780*                                      Port-Indicator....         00678099
006790*                                        eTNI has "NH/Donate/RE"  00679099
006800*                                        Bilr has "AI/      /PI"  00680099
006810*                                                                 00681099
006820*            A.G.BOLOGOVSKY  09/24/04  Added "pre-read" logic to  00682099
006830*                                      disallow run if there are  00683099
006840*                                      more missing Biller records00684099
006850*                                      than allowed by Parm count.00685099
006860*                                      Prevents major problems of 00686099
006870*                                      freeing up MDNs/MINs when  00687099
006880*                                      they should remain active. 00688099
006890*                                      See P100-PRE-READ-OF-FILES.00689099
006900*                                                                 00690099
006910*            A.G.BOLOGOVSKY  09/30/04  Added logic to reconcile   00691099
006920*                                      the Prepaid Indicator      00692099
006930*                                      between Billing and eTNI.  00693099
006940*                                      These routines affected:   00694099
006950*                                                                 00695099
006960*                                  1) 2100-CONTINUE.              00696099
006970*                                  2) MDN Match....               00697099
006980*                                     2140-MOVE-BILL-TO-ETNI-CTN  00698099
006990*                                     2145-SET-CTNINV-NULL-INDS   00699099
007000*                                                                 00700099
007010*                                  3) In Biller/not in eTNI...    00701099
007020*                                     2220-POPULATE-CTN           00702099
007030*                                                                 00703099
007040*                                  4) Not in Biller/in eTNI...    00704099
007050*                                     7004-RE-PORTED-CTN-INV-UPD  00705099
007060*                                     7015-UPDATE-CTN-INV-STATUS  00706099
007070*                                     7003-TRANSITIONAL-CTN-INV-UP00707099
007080*                                                                 00708099
007090*            A.G.BOLOGOVSKY  10/07/04 When CTN in eTNI with RE    00709099
007100*                                     Port-IND and NOT in Biller  00710099
007110*                                     and has a non-VZW Spid, the 00711099
007120*                                     Status changed to PO.       00712099
007130*                                     Added logic to also change  00713099
007140*                                     Port-Ind to PO in routine   00714099
007150*                                     7004-RE-PORTED-CTN-INV-UPD  00715099
007160*                                     so that eTNI gets PO/PO.    00716099
007170*                                                                 00717099
007180*            A.G.BOLOGOVSKY  10/08/04 An MDN in NA Status should  00718099
007190*                                     never have a RSS Biller (R).00719099
007200*                                     When deassign is done,      00720099
007210*                                     return Biller R to original 00721099
007220*                                     Biller stored in NGP(1:1).  00722099
007230*                                     7003-TRANSITIONAL-CTN-INV-UP00723099
007240*                                     7010-UPDATE-CTN-INV         00724099
007250*                                                                 00725099
007260*            A.G.BOLOGOVSKY  10/15/04 RSS Biller doesn't supply a 00726099
007270*                                     Product Type, so in 2100-   00727099
007280*                                     MDN-MATCH, copy the Product 00728099
007290*                                     Type from eTNI to Biller so 00729099
007300*                                     that they always match.     00730099
007310*                                                                 00731099
007320*                                     When MDN in Biller and not  00732099
007330*                                     in eTNI, the program will   00733099
007340*                                     insert it into eTNI. Check  00734099
007350*                                     the MARKET-NPA-NXX-LR table 00735099
007360*                                     to get Product-Type in      00736099
007370*                                     7008-GET-PRODTYPE-FROM-MARKE00737099
007380*                                                                 00738099
007390*            A.G.BOLOGOVSKY  10/15/04 IN 2100-CONTINUE routine,   00739099
007400*                                     added a check on PREPAID-IND00740099
007410*                                     and PORT-IND when deciding  00741099
007420*                                     if Biller data same as eTNI.00742099
007430*                                                                 00743099
007440*            A.G.BOLOGOVSKY  10/26/04 To prevent invalid Biller   00744099
007450*                                     Prepaid-Ind values from     00745099
007460*                                     corrupting eTNI, flip to    00746099
007470*                                     spaces all invalid PP-Inds..00747099
007480*                                     8100-READ-NEXT-BILL-RECORD  00748099
007490*                                     8110-READ-NEXT-ETNI-RECORD  00749099
007500*                                                                 00750099
007510*            A.G.BOLOGOVSKY  10/27/04 To prevent unnecessary (but 00751099
007520*                                     harmless) updates to CTN-INV00752099
007530*                                     and HISTORY), check on blank00753099
007540*                                     PrePaid-Ind from Biller and 00754099
007550*                                     all other Biller/eTNI fields00755099
007560*                                     matching. If so, do NOT     00756099
007570*                                     reconcile Bill/eTNI record. 00757099
007580*                                     2100-CONTINUE routine.      00758099
007590*                                                                 00759099
007600*            A.G.BOLOGOVSKY  10/28/04 When only the Prepaid-IND is00760099
007610*                                     different between Biller and00761099
007620*                                     eTNI, report it in recon rpt00762099
007630*                                     "UPDATED: PREPAID-IND"      00763099
007640*                                     "FROM "Y" TO "N"            00764099
007650*                                     (2105-REPORT-UPDATE-STATUS) 00765099
007660*                                                                 00766099
007670*            A.G.BOLOGOVSKY  11/19/04 Made a number of changes:   00767099
007680*                            1) Allow change to PI Port-Ind if    00768099
007690*                               MDN in LSMS with 6006 SPID.       00769099
007700*                                                                 00770099
007710*                            2) Allow change to PO Port-Ind if    00771099
007720*                               MDN in LSMS with non-6006 SPID.   00772099
007730*                                                                 00773099
007740*                            3) Allow change to PO Port-Ind if    00774099
007750*                               MDN not in LSMS, but is an Intra- 00775099
007760*                               Service Port.                     00776099
007770*                                                                 00777099
007780*                            4) Allow change to RE Port-Ind if    00778099
007790*                               MDN not in LSMS, but is VZW-owned 00779099
007800*                               in LERG13.                        00780099
007810*                                                                 00781099
007820*                            5) Prevent CTN-INV-HISTORY dupe LAST 00782099
007830*                               TRX DATES by checking if Biller's 00783099
007840*                               TRX DATE is already in History. If00784099
007850*                               so, loop up to 20 times and incre-00785099
007860*                               ment Biller's LAST TRX DATE until 00786099
007870*                               it is no longer found in History. 00787099
007880*                               (7550-CHECK-HIST-FOR-TRX-DATE)    00788099
007890*                                                                 00789099
007900*                            6) If the Port-Ind is the only field 00790099
007910*                               different and its found to be a   00791099
007920*                               disallowed change, no unnecessary 00792099
007930*                               updates to ANY tables will occur. 00793099
007940*                                                                 00794099
007950*                            7) Prevent adding back a Biller recd 00795099
007960*                               which was just offloaded by the   00796099
007970*                               Override Aging pgm ETNSC21. New   00797099
007980*                               logic in 2200-MDN-NOT-IN-ETNI.    00798099
007990*                                                                 00799099
008000*            A.G.BOLOGOVSKY  01/26/05 In 2100-MDN-MATCH,          00800099
008010*                                     execute new routine called  00801099
008020*                                     8600-CHECK-FOR-DIFF-BILLER  00802099
008030*                                     which confirms that RSS MDN 00803099
008040*                                     is not currently associated 00804099
008050*                                     with another Biller in the  00805099
008060*                                     CTN-INV.                    00806099
008070*                                                                 00807099
008080*            A.G.BOLOGOVSKY  03/14/05 To reduce the number of     00808099
008090*                                    "PORT-IND UPDT DISALLOWED"   00809099
008100*                                     messages, do not print if   00810099
008110*                                     the CTN-INV Last-TRX-Date is00811099
008120*                                     within 5 days of curr date. 00812099
008130*                                   2101-HOW-CURR-IS-LAST-TRX-DATE00813099
008140*                                                                 00814099
008150*            A.G.BOLOGOVSKY  03/17/05 For regular History inserts 00815099
008160*                                     (not "unloads"), execute    00816099
008170*                                     a new routine which issues  00817099
008180*                                     call to subprogram ETNDC15. 00818099
008190*                                    2103-CALL-ETNDC15-HIST-INSERT00819099
008200*                                                                 00820099
008210*            A.G.BOLOGOVSKY  04/01/05 New Logic to perform cross- 00821099
008220*                                     Biller "forced matches"     00822099
008230*                                     between CTN/MDN of RSS and  00823099
008240*                                     Core Billers. See...        00824099
008250*                                     7001-SELECT-CTN-INV,        00825099
008260*                                     2000-CONTINUE,              00826099
008270*                                     7010-UPDATE-CTN-INV.        00827099
008280*                                                                 00828099
008290*    The above modifications will cause these changes....         00829099
008300*                                                                 00830099
008310*C1) RSS recon can update an MDN in PO status regardless of what  00831099
008320*    the Biller ID is in CTN-INV.                                 00832099
008330*                                                                 00833099
008340*C2) A Core Biller recon can update an MDN in PO status if it is  00834099
008350*    the Core Biller for the MDN (i.e. MDNIN Biller ID same as 1st00835099
008360*    char of NGP on CTN-INV fro MDN)                              00836099
008370*                                                                 00837099
008380*C3) All other cases, the MDNIN Biller ID must match the Biller ID00838099
008390*    on CTN-INV or it should get a MDN Belongs to Different Biller00839099
008400*    Error.                                                       00840099
008410*                                                                 00841099
008420*C4) note that the Biller ID for the file sent from the billing   00842099
008430*    system (MDNIN) is taken from the file header record.         00843099
008440*                                                                 00844099
008450*          A.G.BOLOGOVSKY  06/20/05 New Logic to go against       00845099
008460*                                   PARAM-VALUES table in rtn     00846099
008470*                                   1100-GET-PARAM-VALUES-PARMS   00847099
008480*                                   to get number of days to      00848099
008490*                                   wait before issuing message   00849099
008500*                                   "PORT-IND UPDT DISALLOWED"    00850099
008510*                                   in routine                    00851099
008520*                                   2101-HOW-CURR-IS-LAST-TRX-DAY 00852099
008530*                                                                 00853099
008540*          A.G.BOLOGOVSKY  05/20/05 Changed comparison to be      00854099
008550*                                   against "new" (Biller) Last   00855099
008560*                                   TRX Date rather than "old"    00856099
008570*                                   eTNI Last TRX Date when cal-  00857099
008580*                                   culating how current the      00858099
008590*                                   date is in routine            00859099
008600*                                   2101-HOW-CURR-IS-LAST-TRX-DAY 00860099
008610*                                                                 00861099
008620*          A.G.BOLOGOVSKY  05/31/05 Various changes to conform    00862099
008630*                                   with TNI Assignment Synchro-  00863099
008640*                                   nicity v1.0.                  00864099
008650*                                   Search:                       00865099
008660*                                   VALID-PENDING-HOLD-REASON-CODE00866099
008670*                                   AGB 5/31/05                   00867099
008680*                                                                 00868099
008690*          L. STRAUSS      06/23/05 If Biller Status is Assigned  00869099
008700*                                   Available (AA) and both eTNI  00870099
008710*                                   Status and Port-Ind are "PO"  00871099
008720*                                   (Ported out),      write an   00872099
008730*                                   error message to the output   00873099
008740*                                   error file & exit routine.    00874099
008750*                                   This disallows updates to     00875099
008760*                                   ported-out eTNI CTNs.         00876099
008770*                                   (no update is performed in    00877099
008780*                                   this case: both Biller and    00878099
008790*                                   eTNI files are read after     00879099
008800*                                   2100-ADDITIONAL-CHECKS)       00880099
008810*                                                                 00881099
008820*          A.G.BOLOGOVSKY  08/17/05 In 2100-MDN-MATCH, no longer  00882099
008830*                                   compare RSS NGP with eTNI's by00883099
008840*                                   always moving eTNI's NGP to   00884099
008850*                                   the RSS Biller file NGP field.00885099
008860*                                   Search: 2100-TEST-ON-RSS      00886099
008870*                                                                 00887099
008880*          A.G.BOLOGOVSKY  10/11/05 In 2100-CONTINUE, prevent the 00888099
008890*                                   pgm from considering a space  00889099
008900*                                   and an "N" in Biller & eTNI to00890099
008910*                                   be different values in Prepaid00891099
008920*                                   Ind. This will prevent lots of00892099
008930*                                   needless CTN-INV updates and  00893099
008940*                                   History inserts.              00894099
008950*                                   Search: AGB 10/11/05          00895099
008960*                                                                 00896099
008970*          A.G.BOLOGOVSKY  10/14/05 To identify why a small number00897099
008980*                                   of Not-In Biller/in-ETNI MDNs 00898099
008990*                                   stay in NH status with PENDxxx00899099
009000*                                   Hold-Reason, added logic to   00900099
009010*                                   write to Recon error file upon00901099
009020*                                   coming out of routine         00902099
009030*                                   2102-CREATE-CTN-HIST within   00903099
009040*                                   2300-MDN-NOT-IN-BILL if any   00904099
009050*                                   errors took place.            00905099
009060*                                   Previously, it just went to   00906099
009070*                                   2300-EXIT so cause of no updat00907099
009080*                                   of CTN-INV row was not known. 00908099
009090*                                   Search: AGB 10/14/05          00909099
009100*                                                                 00910099
009110*          A.G.BOLOGOVSKY  10/17/05 When performing LOCAL inserts 00911099
009120*                                   to History (for Unload rows), 00912099
009130*                                   use a dynamic CURRENT TIMESTMP00913099
009140*                                   when populating the           00914099
009150*                                   SYS-UPDATE-DATE field.        00915099
009160*                                   This mimics how called program00916099
009170*                                   ETNDC15 handles HISTORY writes00917099
009180*                                                                 00918099
009190*                                   Also, use a dynamic           00919099
009200*                                   CURRENT TIMESTAMP             00920099
009210*                                   for SYS-UPDATE-DATE field     00921099
009220*                                   instead of static curr date   00922099
009230*                                   when updating/inserting into  00923099
009240*                                   CTN-INV.                      00924099
009250*                                   Search: AGB 10/17/05          00925099
009260*                                                                 00926099
009270*          A.G.BOLOGOVSKY  11/21/05 Make use of new standardized  00927099
009280*                                   Biller-ID copybook, ETNCC67.  00928099
009290*                                   Search: AGB 11/21/05          00929099
009300*                                                                 00930099
009310*          A.G.BOLOGOVSKY  01/30/06 If prepaid-ind is the only    00931099
009320*                                   change and the MDN's new      00932099
009330*                                   status (from Biller) is either00933099
009340*                                   AI and AG,      perform       00934099
009350*                                   insert into HISTORY and update00935099
009360*                                   CTN-INV, else bypass.         00936099
009370*                                   Search: AGB 1/30/06           00937099
009380*                                                                 00938099
009390*          A.G.BOLOGOVSKY  02/01/06 To prevent the Biller from    00939099
009400*                                   updating eTNI with an illegal 00940099
009410*                                   combination of Status and     00941099
009420*                                   Port-Ind, perform a check to  00942099
009430*                                   disallow update.              00943099
009440*                                   Search: AGB 2/01/06           00944099
009450*                                                                 00945099
009460*          A.G.BOLOGOVSKY  03/07/06 Due to the high volume of     00946099
009470*                                   "PORT-IND UPDT DISALLOWED"    00947099
009480*                                   messages, write them to a     00948099
009490*                                   seperate output report file.  00949099
009500*                                   (ERROROUT3).                  00950099
009510*                                   Search phrase: 'AGB 3/7/06'   00951099
009520*                                                                 00952099
009530*          A.G.BOLOGOVSKY  03/21/06 Corrected an intermittant bug 00953099
009540*                                   when validating MIN NUM       00954099
009550*                                   between etni & biller file.   00955099
009560*                                   The value in WS-OLD-MIN-NUM   00956099
009570*                                   would sometimes be SPACE.     00957099
009580*                                   (in 2110-Validate routine).   00958099
009590*                                   Search phrase: 'AGB 3/21/06'  00959099
009600*                                                                 00960099
009610*          A.G.Bologovsky  04/18/06 When performing               00961099
009620*                                   Q1000-ISSUE-DISCON-TO-GATEWAY 00962099
009630*                                   if the CTN-INV row not found, 00963099
009640*                                   don't write to MQ to prevent  00964099
009650*                                   writing blank MQ records.     00965099
009660*                                   Keep counter for display @ end00966099
009670*                                   Search phrase: 'AGB 4/18/06'  00967099
009680*                                                                 00968099
009690*  AXY042706 A.YEYKELIS    04/27/06                               00969099
009700*                          1).ADDED MQCMIT QUEUE (MQ COMMIT)      00970099
009710*                          2).DO NOT CHECK THE NGP-NL-ASSIGNMENT  00971099
009720*                             TABLE FOR AN ENTRY FOR 'PI' NUMBERS 00972099
009730*                                                                 00973099
009740*          A.G.Bologovsky  05/05/06 Any time Biller and/or eTNI   00974099
009750*                                   record not processed, write   00975099
009760*                                   record to new file ERROROU4,  00976099
009770*                                   along with an error code      00977099
009780*                                   showing why record was bypassd00978099
009790*                                   Search phrase: 'AGB 5/08/06'  00979099
009800*                                                                 00980099
009810*          A.G.Bologovsky  09/07/06  NGP Extension project:       00981099
009820*                                    fetch Biller-ID from Number  00982099
009830*                                    Group table instead of using 00983099
009840*                                    the first position of NGP.   00984099
009850*                                    Search phrase:               00985099
009860*                                   'NGP Extension Project'       00986099
009870*                                                                 00987099
009880*================================================================*00988099
009890*   5/21/2007    J.Aversano   Modifications  for VISION Trans.    00989099
009900*   (JA0507)                  -Handle New CTN-INV STATUS"PA"      00990099
009910*                              PENDING ASSIGNMENT                 00991099
009920*                             -MIN Updates if "PA" Status         00992099
009930*                             -Removed 2400-CHECK-FOR-I2K  para   00993099
009940*                             -Removed Specific Queue Mgr name    00994099
009950*                               From PARAM-VALUES & now using     00995099
009960*                               Default queue Mgr                 00996099
009970*                             -Added  Edits  to  Prevent VISION & 00997099
009980*                               RSS from providing Invalid        00998099
009990*                               CTN-STATUS  codes                 00999099
010000*                             -Removed existing bug, in handling  01000099
010010*                               "AG" / "SB" CTN-INV               01001099
010020*                                                                 01002099
010030*================================================================*01003099
010040*                                                                 01004099
010050*   9/14/2007    J.Aversano   Modifications  for Removal of       01005099
010060*                             CTN-INV,  PORT-IND = 'IO'           01006099
010070*                                                                 01007099
010080*                             - Avoid "NA" Un-Loads in the case   01008099
010090*                               where MDN is NOT in BILLING &     01009099
010100*                               Is in a Status that PARAM-VALUES  01010099
010110*                              ('ETNBC16-CTN-STATUS')             01011099
010120*                               is flagged as to omit Unloading   01012099
010130*   (JA0907)                   VISION Transparency                01013099
010140*                                                                 01014099
010150*================================================================*01015099
010160*                                                                 01016099
010170*  10/19/2007    J.Aversano   Modifications  for Bypass of  'NA'  01017099
010180*                             Status  in  Billing  Feed           01018099
010190*   (JA1007)                                                      01019099
010200*                                                                 01020099
010210*================================================================*01021099
010220*                                                                 01022099
010230*  12/07/2007    J.Aversano   Bypass for VISION, "NGP NL Not   '  01023099
010240*                             "NGP NL Not Found" Error            01024099
010250*   (JA1207)                  VISION Transparency                 01025099
010260*                                                                 01026099
010270*================================================================*01027099
010280*                                                                 01028099
010290*  12/11/2007    J.Aversano   - VISION-to-VISION  Biller-ID  Chg  01029099
010300*                               now Allowed,  but Not for RSS     01030099
010310*                             - MDN's  NOT Updated, if ONLY       01031099
010320*                               PREPAID Changes & MDN in "AG"     01032099
010330*                             - Sequential Numbering Call,  if    01033099
010340*                               taking  an  MDN  out  of  "AA"    01034099
010350*                             - Seq. Numbering                    01035099
010360*                               Added  Array  to  Call ETNSC58    01036099
010370*                                                                 01037099
010380*   (JA1207A)                 VISION Transparency                 01038099
010390*                                                                 01039099
010400*================================================================*01040099
010410*                                                                 01041099
010420*  12/26/2007    J.Aversano   - General -                         01042099
010430*                                                                 01043099
010440*                           A0.- Special NOTES listed in:         01044099
010450*                                1100-GET-PARAM-VALUES-PARMS      01045099
010460*                                                                 01046099
010470*                              - Added  'ETNBC16-SET-TO-AA ' PARAM01047099
010480*                                Will Control which CTN-STATUS's  01048099
010490*                                to be set to "AA", Is            01049099
010500**                               Over-riden by ETNBC16-CTN-STATUS 01050099
010510**                               If a CTN-INV entry matches a     01051099
010520**                               status in "ETNBC16-CTN-STATUS"   01052099
010530**                               BYPASS of that Entry Will OCCUR  01053099
010540*                                                                 01054099
010550*                              - The Update function "UPDDNA"     01055099
010560*                                will no longer function as       01056099
010570*                                an Update to CTN-INV & update    01057099
010580*                                the MDN  as  "NA"  status.       01058099
010590*                                As eTNI controls all Inventory   01059099
010600*                                "NA" will be updated to "AA"     01060099
010610*                                When eTNI has the MDN & Billing  01061099
010620*                                 does NOT.                       01062099
010630*                                2300-MDN-NOT-IN-BILL             01063099
010640*                                                                 01064099
010650*                             - FOR  RSS -                        01065099
010660*                           A1.- NA Unload chg'd to Return MDN    01066099
010670*                                to "AA", if NGP-NL-ASSGN entry   01067099
010680*                                not in table:                    01068099
010690*                                  Lookup Biller-ID  per NGP      01069099
010700*                                 Update NGP, NL &                01070099
010710*                                         CTN-STATUS  = 'AA'      01071099
010720*                                  Bump Counts NGP-COUNTERS       01072099
010730*                                                                 01073099
010740*                             - FOR  RSS -                        01074099
010750*                           B..  if NGP-NL-ASSGN entry Found:     01075099
010760*                                   process as current            01076099
010770*                                                                 01077099
010780*                             - FOR  RSS -                        01078099
010790*                           C..  RSS  will  have 'PA' 'AR' & 'AI' 01079099
010800*                                Billing  Input  data  & will be  01080099
010810*                                Handeled  all the same           01081099
010820*                                                                 01082099
010830*                             - FOR  VISION -                     01083099
010840*                           D..- NA Unload chg'd to Return MDN    01084099
010850*                                to "AA"                          01085099
010860*                                  Access  Number-Group  table    01086099
010870*                                  Update NL  to  Biller-Id, per  01087099
010880*                                          Number-Group  table    01088099
010890*                                  Update NGP, NL & CTN-STATUS    01089099
010900*                                  Bump Counts NGP-COUNTERS       01090099
010910*                                                                 01091099
010920*   (JA1207B)                                                     01092099
010930*                           E..- Allow  'X'  to be Valid for      01093099
010940*                                Prepaid-IND                      01094099
010950*                                                                 01095099
010960*   (JA1207C)                                                     01096099
010970*                           F..- Edit to prohibit VISION data     01097099
010980*                                from violating intergrity        01098099
010990*                                between NGP & Biller-ID          01099099
011000*                                                                 01100099
011010*   (JA1207D)                                                     01101099
011020*                           - RSS -                               01102099
011030*                           G..- Force 'PA' from Billing to error 01103099
011040*                                out, If eTNI has it as either    01104099
011050*                                'AG', 'AR', 'AI', 'AT' or 'PO'   01105099
011060*                                                                 01106099
011070*   (JA1207E)                                                     01107099
011080*                                                                 01108099
011090*   (JA1207F)               - Fix Error Report -                  01109099
011100*                           For Error Message:                    01110099
011110*                           LIT-DUPE-BILLER-ID                    01111099
011120*                           "MDN Belongs to DIFF BILR"            01112099
011130*                           Now Both Billing & eTNI Data          01113099
011140*                           Will be Displayed                     01114099
011150*                                                                 01115099
011160*  03/08/2008    J.Aversano                                       01116099
011170*  (JA0308)                 Will Now Handle  RSS Recon            01117099
011180*                           Cond - "Not-In-eTNI' as a Biller Swap 01118099
011190*                           RSS has MDN as 'PA' Status, eTNI      01119099
011200*                           has MDN as 'AA' or 'PA' Status  &     01120099
011210*                           MDN erroneoursly  belongs to VISION   01121099
011220*                                                                 01122099
011230*  03/20/2008    J.Aversano                                       01123099
011240*  (JA0320)                 Modified to fix NGP-Counter Code,     01124099
011250*                           due to a latent bug                   01125099
011260*                                                                 01126099
011270*                           Modified to fix issue for             01127099
011280*                           Vision Trans. with  "NA"  Unload      01128099
011290*                           and  MDN  "Not on Billing File"       01129099
011300*                           Now  BOTH  BILLING  &  eTNI  Drive    01130099
011310*                           the  Process.                         01131099
011320*                                                                 01132099
011330*                           Modified to fix issue with MIN's      01133099
011340*                           due to a latent bug                   01134099
011350*                                                                 01135099
011360*  04/02/2008    J.Aversano                                       01136099
011370*  (JA0402)                 Modified to add OPC processing        01137099
011380*                           Added  WS-LEGIT-BILLER-ID-RESELLER    01138099
011390*                           instead of WS-RSS wherever possible   01139099
011400*                                                                 01140099
011410*  Removed * * * * * * *    F..- Edit to prohibit VISION data     01141099
011420*                                from violating intergrity        01142099
011430*                                between NGP & Biller-ID          01143099
011440*                                                                 01144099
011450*   (JA1207D)                                                     01145099
011460*  Removed * * * * * * *    F..- Edit to prohibit VISION data     01146099
011470*                                from changing NGP  this change   01147099
011480*                                was requested after the initial  01148099
011490*                                launch of VISION Trans.          01149099
011500*  05/02/2008    J.Aversano                                       01150099
011510*  (JA0502)                 Modified to prohibit Billing data     01151099
011520*                           from changing NGP, without condition. 01152099
011530*                                                                 01153099
011540*  06/02/2008    J.Aversano                                       01154099
011550*  (JA0602)                 Modified to handle HUB Billing data,  01155099
011560*                           A new processing path was created.    01156099
011570*                                                                 01157099
011580*                           Added new PARAM  to  Process          01158099
011590*                           "ETNBC16-NOT-IN-ETNI"  w/ HUB &       01159099
011600*                           Ctn_Status =  Listed  Status's.       01160099
011610*                                                                 01161099
011620*                           Added new PARAM  to  Process          01162099
011630*                           "ETNBC16-NOT-IN-BILLING"  w/ HUB &    01163099
011640*                           Ctn_Status =  Listed  Status's.       01164099
011650*                                                                 01165099
011660*                           Modified to Properly Handle Split     01166099
011670*                           Transactions, for "Not-In-Billing"    01167099
011680*                           case  using  Market-NPA-NXX-LR        01168099
011690*                                                                 01169099
011700*                           Modified to Properly Check eTNI       01170099
011710*                           CTN-INV  Table  for  MDN's  that  were01171099
011720*                           Updated  within  the  last  24  hours 01172099
011730*                           Checked  for  Not-in-eTNI  &          01173099
011740*                                         Not-in-Billing  cases   01174099
011750*                                                                 01175099
011760*                           Modified to add OPC processing,       01176099
011770*   JA0402E                 Extended  RSS / OPC  Changes          01177099
011780*                                                                 01178099
011790*                           Modified 2100- Para  for  HUB / VISION01179099
011800*                           Processing                            01180099
011810*                                                                 01181099
011820*  08/15/2008    J.Aversano                                       01182099
011830*  (JA0815)                 Modified to Table Market-Min-Lr data  01183099
011840*                           &  lookup  in  array  to  determine   01184099
011850*                           HUB  transaction                      01185099
011860*                                                                 01186099
011870*                           Modified 2200-Not-in-Etni to NOT -    01187099
011880*                           allow  OPC to VISION  Biller Converts 01188099
011890*                                                                 01189099
011900*  10/16/2008    J.King     Modified 7020-INSERT-CTN-INV:         01190099
011910*  (JK1008A)                For non-VZHUB MDNs, set PORT_IND=PI   01191099
011920*                           instead of RE. Will allow APIs to     01192099
011930*                           work correctly: DACM/P & POUT. Update 01193099
011940*                           prior to 2145-SET-CTNINV-NULL-INDS.   01194099
011950*                                                                 01195099
011960*  (JK1008B)                Modified 2110-VALIDATE-BILL-MDN-FIELDS01196099
011970*                           OPC Does not have NGP-NL-ASSIGNMENT   01197099
011980*                           - Do not check or create err msg      01198099
011990*                                                                 01199099
012000*  (JK1008C)                NL should be NULL not Spaces.         01200099
012010*                           - Per Sue B. 10/14/2008.              01201099
012020*                                                                 01202099
012030*  11/18/2008    J.Aversano                                       01203099
012040*  (JA1108)                 Modified  2300- Para  (not in Billing)01204099
012050*                           to  process  Split  Logic  properly   01205099
012060*                           MDN's  will be  set  to  'NH'  with   01206099
012070*                           Reason code  =  'SPLIT'  via  7015-   01207099
012080*                                                         Para    01208099
012090*                           (based upon Market_Npa_Nxx_Lr table)  01209099
012100*                                                                 01210099
012110*                           Prior  Logic  was  putting  them  in  01211099
012120*                           'NA'  Unload  Status,  which  allowed 01212099
012130*                           Real_Time_Assignments  (RTA)  to      01213099
012140*                           Assign  them,  in  Error              01214099
012150*                                                                 01215099
012160*  12/15/2008    J.Aversano                                       01216099
012170*  (JA1208)                 Modified  2300-,8878- Para to supress 01217099
012180*                           reason code '005' from printing       01218099
012190*                           on the 'NORECON' Report               01219099
012200*                                                                 01220099
012210*  12/31/2008    J.Aversano                                       01221099
012220*  (JA1208A)                Added  new  Params  to  Generalize    01222099
012230*                           program processes for "Not_In_Billing"01223099
012240*                           Processes  will  now  support:        01224099
012250*                           "HUB",  "Retail"  &  "Resell".        01225099
012260*                                                                 01226099
012270*                           Added  new  Params  to  Generalize    01227099
012280*                           process  for  "Vision  Screen         01228099
012290*                           Retirement, Phase I"                  01229099
012300*                                                                 01230099
012310*                           Removed  All  TNICOB*  Includes       01231099
012320*                                                                 01232099
012330*                                                                 01233099
012340*  02/13/2009    Andy Bologovsky                                  01234099
012350*  (AGB021309)              Timestamp Timezone.                   01235099
012360*                           Replace 7600-GET-TIMESTAMP with       01236099
012370*                                   8000-GET-TIMEZONE.            01237099
012380*                           (also find by ':WS-HRS')              01238099
012390*                                                                 01239099
012400*   7/21/2009    J.Aversano                                       01240099
012410*  (JA0709)                 Modified  1100- Para  to  account     01241099
012420*                           for a Re-Start Process.               01242099
012430*                                                                 01243099
012440*                           Cleaned  up  some  I2k  Code "**K"    01244099
012450*                                                                 01245099
012460*                           Added  DSNTIAR  for  DB2  Fatal Errors01246099
012470*                                                                 01247099
012480*   8/18/2009    J.Aversano                                       01248099
012490*  (JA0809)                 Added  new  PARAM-VALUES:             01249099
012500*                           "ETNBC16-INTRA-VISION"   which will   01250099
012510*                           restrict update between instances     01251099
012520*                           based upon the specified Ctn-Status   01252099
012530*                           combinations.                         01253099
012540*                                                                 01254099
012550*   8.28.2009    J.Aversano                                       01255099
012560*  (JA0809A)                Fixed  Error  in  Error Out  Report,  01256099
012570*                           was reporting on prior record's       01257099
012580*                           TimeStamp.                            01258099
012590*                                                                 01259099
012600*                           Permanent  Reserves,  will  NOT       01260099
012610*                           Change  NL,  from  Billing            01261099
012620*                                                                 01262099
012630*                           Clean-up  Commented  Out  Code,  as   01263099
012640*                           well  as  obsolete  code              01264099
012650*                                                                 01265099
012660*   9.25.2009    J.Aversano                                       01266099
012670*  (JA0909)                 2110-Validate  will no longer edit    01267099
012680*                           data   for  valid  Access  of         01268099
012690*                           NGP-NL-ASSIGNMENT.                    01269099
012700*                                                                 01270099
012710*                           Update of NGP-NL-ASS  will  NOT       01271099
012720*                           fail  transactions  for  SQL  +100    01272099
012730*                                                                 01273099
012740*================================================================*01274099
012750*  11.20.2009    J.Aversano                                       01275099
012760*  (JA1109)                 4G  Project Addition  of:             01276099
012770*                               SIM-INV                           01277099
012780*                               VORA-IMSI-INV                     01278099
012790*                               Via  "Data Layers"  - per Amdocs  01279099
012800*                                                                 01280099
012810*                           4G  Project  will  -NOT-  Update      01281099
012820*                               the above entities                01282099
012830*                                                                 01283099
012840*                           4G  Project Additional  Report  Info: 01284099
012850*                               RECON                             01285099
012860*                               NORECON                           01286099
012870*                               ERROR OUT  Reports                01287099
012880*================================================================*01288099
012890*                                                                 01289099
012900*   1.29.2010    J.Aversano                                       01290099
012910*  (JA0110)                 10110-CREATE-HISTORY-DUP              01291099
012920*                           Where  Clause was  in   Error         01292099
012930*================================================================*01293099
012940*   3.15.2010    J.Aversano                                       01294099
012950*  (JA0310)                 4G  Project Addition  of  Version II: 01295099
012960*                               Allow for Update to:              01296099
012970*                                 SIM-INV                         01297099
012980*                                 SIM-INV-HISTORY                 01298099
012990*                                 VORA-IMSI-INV                   01299099
013000*                                 VORA-IMSI-INV-HISTORY           01300099
013010*                                                                 01301099
013020*                               Generate  CDVC,  if  required     01302099
013030*                                                                 01303099
013040*                               MQ  Commit  &  DB2  Commit Aligned01304099
013050*                                                                 01305099
013060*                               MQ  Commit  &  DB2  Commit Added  01306099
013070*                               to  300X-  Routine                01307099
013080*                                                                 01308099
013090*                               7805-  Detect  MIN's  of  CTNINV  01309099
013100*                               Code changed to look for > 0      01310099
013110*                                                                 01311099
013120*                               7806-  Detect  MIN's  of  CTNINV  01312099
013130*                                                                 01313099
013140*                               Added  TNI-MDN-MIN  Table         01314099
013150******************************************************************01315099
013160*   8.05.2010    J.Aversano                                       01316099
013170*  (JA0810)                 Fixes  &  Modifications:              01317099
013180*                           -Fixed Comments - for MIN process     01318099
013190*                           -Removed NGP VISION Edit Filter       01319099
013200*                           -Comment  Out  Below  Report  Lines   01320099
013210*                           -Adjust alignment of  Report  Headers 01321099
013220******************************************************************01322099
013230*   8.25.2010    J.Aversano                                       01323099
013240*  (JA0810)                 Fixes  &  Modifications:              01324099
013250*                           -Removed NGP Reseller Edit Filter     01325099
013260******************************************************************01326099
013270*   9.14.2010    J.Aversano                                       01327099
013280*  (JA0910)                 Fix:                                  01328099
013290*                           -Use  MDNIN & CTNIN IoArea's instead  01329099
013300*                           of Ws-New-Status & Ws-Old-Status      01330099
013310******************************************************************01331099
013320*  10.07.2010    J.Aversano                                       01332099
013330*  (JA1010)                 Fix:                                  01333099
013340*                            7007- Para -  Use  CTN  IoArea       01334099
013350*                           instead  of  MDNIN  IoArea            01335099
013360******************************************************************01336099
013370*  12.02.2010    J.Aversano                                       01337099
013380*  (JA1210)                 Fixes  &  Modifications:              01338099
013390*                           -Fixed Ctn-Inv-History Updates        01339099
013400*                            do -Not- effect System-Update-Date or01340099
013410*                            Last-Trx_Date - unless duplicates    01341099
013420*                                                                 01342099
013430*                           -2300-MDN-NOT-IN-Billing              01343099
013440*                            When Updating CTN-INV to 'NA' or 'AA'01344099
013450*                            check for ICC-ID  &  Clear CTN-INV   01345099
013460*                            of IMSI /  ICC-ID-4G                 01346099
013470*                            - Update Sim-INV & Sim-INV-Hist      01347099
013480*                                         -or-                    01348099
013490*                            - Update Vora-Imsi & Vora-Imsi-Hist  01349099
013500*                                                                 01350099
013510*                           -Retain  Port-Ind  for  DONATE        01351099
013520*                                                                 01352099
013530*                           -Added  VISION Edit in 2100-          01353099
013540*                                                                 01354099
013550*                           -Added code to only Update Sim or Vora01355099
013560*                            IF sys-update-date > 24 hours        01356099
013570*                                                                 01357099
013580*                           -2100- & 2300- Exit Upon <24 Hours    01358099
013590*                                                                 01359099
013600*                           -2100- Error Out  VISION  'BackWard'  01360099
013610*                            Errors                               01361099
013620*                                                                 01362099
013630*                           -2100- Exit 4G Processing, If         01363099
013640*                            Errors Exist                         01364099
013650*                                                                 01365099
013660*                           -Removed old non-readable comments    01366099
013670*                            "Legacy Comments"                    01367099
013680*                                                                 01368099
013690*  01.14.2011    J.Aversano                                       01369099
013700*  (JA0111)                 Fix:                                  01370099
013710*                            2300-Not-In-Billing  - 4G Updates    01371099
013720*                            WS-NEW-STATUS is to be AVOIDED       01372099
013730*                            as a viable repository of valid data 01373099
013740*                                                                 01374099
013750*  02.01.2011    J.Aversano                                       01375099
013760*  (JA0211)                 Upgrade:                              01376099
013770*                            NGP Project - Add LRN-UPDT-REQT      01377099
013780*                            Table for VISION only NGP mismatch   01378099
013790*                                                                 01379099
013800*                            Resolved  Bug  Issue  in 2300-       01380099
013810*                                                                 01381099
013820*  03.22.2011    J.Aversano                                       01382099
013830*  (JA0322)                 Enhance:                              01383099
013840*                            2100-Mdn-Match                       01384099
013850*                            Create Edit to omit from 'AR' to     01385099
013860*                            'AI' processing with SIM's           01386099
013870*                                                                 01387099
013880*               -  Manage  Inserts / Updates  Based  Upon  Actual 01388099
013890*                  Inserts / Updates & Deletes                    01389099
013900*                                                                 01390099
013910*  04.20.2011    J.Aversano                                       01391099
013920*  (JA0411)                 Enhance:                              01392099
013930*                           Modify  7051- para                    01393099
013940*                                                                 01394099
013950*                                                                 01395099
013960*  05.17.2011    J.Aversano                                       01396099
013970*  (JA0511)                 Enhance:                              01397099
013980*                           Modify  MQ  Commit  consideration     01398099
013990*                           process,  by  adding  to  DB2  Commit 01399099
014000*                           counters                              01400099
014010*                                                                 01401099
014020*                           Changed  'Commit  Display'            01402099
014030*                                                                 01403099
014040*                           Changed  'Commit  Display'            01404099
014050*                                                                 01405099
014060*                                                                 01406099
014070*AGB052511   Andy Bologovsky 05/25/2011 Removed logic to update   01407099
014080*                            SYS_UPDATE_DATE upon insert to       01408099
014090*                            CTN_INV_HISTORY. Should be just a    01409099
014100*                            copy of the date in CTN_INV.         01410099
014110*                                                                 01411099
014120*                                                                 01412099
014130******************************************************************01413099
014140*  07.11.2011    J.Aversano                                       01414099
014150*  (JA0711)                 Enhance:                              01415099
014160*                           Modify  "Out of NH" Processing, so    01416099
014170*                           as to Null ICC_ID in CTN_INV upon     01417099
014180*                           updating from (etni) 'NH' to 'Ax'     01418099
014190*                           based upon Billing                    01419099
014200*                                                                 01420099
014210*                           2145-  para                           01421099
014220*                                                                 01422099
014230******************************************************************01423099
014240*  10.28.2011    J.Aversano                                       01424099
014250*  (JA1011)                 Add:                                  01425099
014260*                           4 New Param Entries for VTS processing01426099
014270*                           Handle  VTS  processing in Matched,   01427099
014280*                           not in Billing & not in eTNI          01428099
014290*                           a/k/a "Non-Geo-NL"                    01429099
014300*                                                                 01430099
014310*                           CTN  Last-Trx-Date updated only if    01431099
014320*                            CTN-Status Change or Add to CTN      01432099
014330*                                                                 01433099
014340*                           Modified  Error  Message              01434099
014350*                            2110-                                01435099
014360*                            2200-                                01436099
014370*                                                                 01437099
014380*                           Modified  7035-,  7036-  Hub process  01438099
014390*                            will NO Longer  Execute              01439099
014400*                            HUB  processing Logic kept intact    01440099
014410*                            in-case of a future requirement.     01441099
014420*                                                                 01442099
014430*                           Fixed  Bug  in  Reconout  Report      01443099
014440******************************************************************01444099
014450*  12.27.2011    J.Aversano                                       01445099
014460*  (JA1211)                 Modified  2200-Not-In-eTNI so that    01446099
014470*                           Message in  the  Error  Report is     01447099
014480*                           displayed 'Not in eTNI'               01448099
014490*                                                                 01449099
014500*                           2185-  Old  'AI' MDN's  will Upd Mins 01450099
014510*                           to 'AP' Status                        01451099
014520*                                                                 01452099
014530*                           Removed  RSS Edit for:                01453099
014540*                           'PORT-IND UPDT DISALLOWED'            01454099
014550*                            PORT-IND forced to match             01455099
014560*                                                                 01456099
014570*                           Added  'Non Exist. eTNI'  message,    01457099
014580*                           indicated not in CTN  or  eTNI Flat   01458099
014590*                                                                 01459099
014600******************************************************************01460099
014610*   1.23.2012    J.Aversano                                       01461099
014620*  (JA0112)                 Modified  2300-Not-In-Billing         01462099
014630*                           to  NOT  Issue  DSCP's                01463099
014640*                                                                 01464099
014650*                           Old  Min  2185-                       01465099
014660*                                                                 01466099
014670*                           Conditional  Update  of  Old-MIN      01467099
014680******************************************************************01468099
014690*   2.06.2012    J.Aversano                                       01469099
014700*  (JA0212)                                                       01470099
014710*                           Old  Min  2185-                       01471099
014720*                                                                 01472099
014730*                           Removed:                              01473099
014740*                           Conditional  Update  of  Old-MIN      01474099
014750*                                                                 01475099
014760*                           Aligned  ALL -  If  &  End-if's       01476099
014770******************************************************************01477099
014780*   3.12.2012    J.Aversano                                       01478099
014790*   (JA0312)                                                      01479099
014800*                         Add  VTS  Option:                       01480099
014810*                              Not in Billing & eTNI in 'AG'      01481099
014820*                              Force  to  Parameter Value         01482099
014830*                                                                 01483099
014840*                         Add  OPC  Change:                       01484099
014850*                             Do -NOT- Allow, a regression From   01485099
014860*                           'AI'  status  to  another 'A*' status 01486099
014870*                                                                 01487099
014880*                         Add  eTNI  Line  to  2100-VTS-Match     01488099
014890*                                                                 01489099
014900*                         Add  "VTS"  to  OPC/VTS Reports         01490099
014910******************************************************************01491099
014920*   3.23.2012    J.Aversano                                       01492099
014930*   (JA0312A)             Alarm.com  Changes:                     01493099
014940*                         Change Error NL='VRTEL' for VISION      01494099
014950*                           to  VISION  Biller Attempted  Updates 01495099
014960*                                                                 01496099
014970*                         NUMBER-LOCATION  Table                  01497099
014980*                         For  CTN-STATUS  Release  To: 'AA'      01498099
014990*                                                                 01499099
015000*                         2200-  VRTEL or Contractual Reserves    01500099
015010*                             a/k/a:  Permanent  Reserves         01501099
015020*                         Will -NOT-  be allowed, if "V to V' Upd 01502099
015030******************************************************************01503099
015040*                                                                 01504099
015050*   4.05.2012    J.Aversano                                       01505099
015060*   (JA0412)              5XX / 5YY  Changes  -   RSS:            01506099
015070*                         Change  Will  Allow for  Specialized    01507099
015080*                         processing  &  recognition              01508099
015090*                                                                 01509099
015100******************************************************************01510099
015101*   6.05.2012    J.Aversano                                       01511099
015102*   (JA0612)              4G  Oriented  Generic  Update  Process  01512099
015103*                         for  when  an  MDN  is  Set to AA       01513099
015104*                         Will  lookup  SIM-INV-HIST  for  AD,    01514099
015105*                         if  exists,  then will  set  SIM-INV    01515099
015106*                         to  AD.  Otherwise  will  become  AA.   01516099
015107*                                                                 01517099
      *                         Vision B_to_B  -  Coded                 01518099
015108******************************************************************01519099
015101*   6.28.2012    J.Aversano                                       01520099
015102*   (JA0612A)             WS-VISION-B2B-C                         01521099
      *                         Vision B_to_B  -  Coded                 01522099
      *                         Added  Below  to  "SET-TO-AA"  RESELLER 01523099
      *                         parameter  Option:                      01524099
134490*                         WS-CTNIN-ICC-ID-4G  NOT  >  SPACES      01525099
      ******************************************************************01526099
      *   9.18.2012    J.Aversano                                       01527099
      *   (JA0912)                                                      01528099
      *                                                                 01529099
      *    Created  Generic Version of 'VRTEL'  now  '*RTEL'            01530099
      *    << Above  Change  Commented  Out,  Pending  Next  Release >> 01531099
      *                                                                 01532099
      *    RSS request  for  Prepaid ONLY - Update of CTN-HIST          01533099
      *    CDVC Application-ID - first character becomes the Biller ID  01534099
      *    Prevent Backward Updates  from  "AI"  to  "AR"               01535099
      *    Fix  Data  Bugs  in  L'  Indicator  of  MIN  for  Reports    01536099
      *    Fix  Not-In-Billing For  'NA'  CTN & SIM Update              01537099
      *    Fix  PrePaid-IND  latent  bug, in handling "Prepaid Only"    01538099
      *    Add  "Pre Paid" Only  Comment on Reconout  Report            01539099
      *    Mod.  for  Error Report - SIM-INV line                       01540099
      *    New  SIM-Update  Counter                                     01541099
      *                                                                 01542099
      ******************************************************************01543099
      *   9.28.2012    J.Aversano                                       01544099
      *   (JA0912A)                                                     01545099
      *                                                                 01546099
      *    OPC /  VTS  Bug  Resolved  @  2300-NIB  Para                 01547099
      *================================================================*01548099
      *  10.03.2012    J.Aversano                                       01549099
      *   (JA1012)                                                      01550099
      *                                                                 01551099
      *    Created  Generic Version of 'VRTEL'  now  '*RTEL'            01552099
      *    UN-Commented  Out 'VRTEL'  now  '*RTEL'                      01553099
      *    Extended  2300-NIB  for  '*RTEL'  processing                 01554099
      *                                                                 01555099
      *    Program  will  no  longer  set  C/C  = 2, for > 1 Number-Loc 01556099
      *      with  Type  = 'T',  Originally  this  was  considered a    01557099
      *      possible  issue                                            01558099
      *                                                                 01559099
      *    Added  WS-NL-SAVED  to  Reduce  Number-Location  I/O's       01560099
      *                                                                 01561099
      *    Removed  Vestigial  Comments  &  Blank  lines                01562099
      *                                                                 01563099
      *    Removed  CCE3  copybook                                      01564099
      *                                                                 01565099
096260**   Future  Release:  WS-NGP // WS-NGP-SAVED                     01566099
096270**   PERFORM 7300-SELECT-NUMBER-GROUP       THRU 7300-EXIT        01567099
      *                                                                 01568099
      *================================================================*01569099
      *  11.29.2012    J.Aversano                                       01570099
      *   (JA1112)                                                      01571099
      *                                                                 01572099
      *    Created  Emergency  Fix  For  VISION  to  Allow              01573099
      *    3G / 4G  issue  to  be  fixed  Via  this  module.            01574099
      *    This  process  is  like  a  hybrid  "CDVC"                   01575099
      *================================================================*01576099
015120 IDENTIFICATION DIVISION.                                         01577099
015130*================================================================*01578099
015140 PROGRAM-ID.    ETNBC16.                                          01579099
015150                                                                  01580099
015160 ENVIRONMENT DIVISION.                                            01581099
015170 CONFIGURATION SECTION.                                           01582099
015180 SOURCE-COMPUTER. IBM-3090.                                       01583099
015190 OBJECT-COMPUTER. IBM-3090.                                       01584099
015200                                                                  01585099
015210 INPUT-OUTPUT SECTION.                                            01586099
015220                                                                  01587099
015230 FILE-CONTROL.                                                    01588099
015240     SELECT NMMDNINP-FILE  ASSIGN TO NMMDNINP.                    01589099
015250     SELECT NMCTNINP-FILE  ASSIGN TO NMCTNINP.                    01590099
015260     SELECT RECONOUT-FILE  ASSIGN TO RECONOUT.                    01591099
015270     SELECT ERROROUT-FILE  ASSIGN TO ERROROUT.                    01592099
015280     SELECT ERROROUT2-FILE ASSIGN TO ERROROU2                     01593099
015290            FILE STATUS IS ERROROUT2-STATUS.                      01594099
015300     SELECT ERROROUT3-FILE ASSIGN TO ERROROU3                     01595099
015310            FILE STATUS IS ERROROUT3-STATUS.                      01596099
015320     SELECT ERROROUT4-FILE ASSIGN TO ERROROU4                     01597099
015330            FILE STATUS IS ERROROUT4-STATUS.                      01598099
015340     SELECT NMMDNINP-FILE-TRAILER  ASSIGN TO NMMDNINT             01599099
015350            FILE STATUS IS TRAILER-STATUS.                        01600099
015360     SELECT DTCTLOUT-FILE  ASSIGN TO DTCTLOUT.                    01601099
015370     SELECT CNTRLRPT-FILE  ASSIGN TO CNTRLRPT.                    01602099
015380     SELECT SEQPARMI-FILE  ASSIGN TO SEQPARMI.                    01603099
015390     SELECT ERRORHUB-FILE  ASSIGN TO ERRORHUB.                    01604099
015400     SELECT RECONHUB-FILE  ASSIGN TO RECONHUB.                    01605099
015410                                                                  01606099
015420 DATA DIVISION.                                                   01607099
015430 FILE SECTION.                                                    01608099
015440                                                                  01609099
015450 FD  NMMDNINP-FILE                                                01610099
015460     LABEL RECORDS ARE OMITTED                                    01611099
015470     RECORDING MODE F                                             01612099
015480     BLOCK CONTAINS 0 RECORDS                                     01613099
015490     DATA RECORD IS NMMDNINP-RECORD.                              01614099
015500 01  NMMDNINP-RECORD                  PIC X(200).                 01615099
015510                                                                  01616099
015520                                                                  01617099
015530 FD  NMMDNINP-FILE-TRAILER                                        01618099
015540     LABEL RECORDS ARE OMITTED                                    01619099
015550     RECORDING MODE F                                             01620099
015560     BLOCK CONTAINS 0 RECORDS                                     01621099
015570     DATA RECORD IS NMMDNINP-RECORD-TRAILER.                      01622099
015580 01  NMMDNINP-RECORD-TRAILER          PIC X(200).                 01623099
015590                                                                  01624099
015600                                                                  01625099
015610 FD  NMCTNINP-FILE                                                01626099
015620     LABEL RECORDS ARE OMITTED                                    01627099
015630     RECORDING MODE F                                             01628099
015640     BLOCK CONTAINS 0 RECORDS                                     01629099
015650     DATA RECORD IS NMCTNINP-RECORD.                              01630099
015660 01  NMCTNINP-RECORD                  PIC X(319).                 01631099
015670                                                                  01632099
015680 FD  RECONOUT-FILE                                                01633099
015690     RECORDING MODE F                                             01634099
015700     LABEL RECORDS STANDARD                                       01635099
015710     RECORD CONTAINS 133 CHARACTERS                               01636099
015720     DATA RECORD IS RECON-RECORD.                                 01637099
015730 01  RECON-RECORD                     PIC X(133).                 01638099
015740                                                                  01639099
015750                                                                  01640099
015760 FD  ERROROUT-FILE                                                01641099
015770     RECORDING MODE F                                             01642099
015780     LABEL RECORDS STANDARD                                       01643099
015790     RECORD CONTAINS 133 CHARACTERS                               01644099
015800     DATA RECORD IS ERROR-RECORD.                                 01645099
015810 01  ERROR-RECORD                     PIC X(133).                 01646099
015820                                                                  01647099
015830 FD  ERROROUT2-FILE                                               01648099
015840     RECORDING MODE F                                             01649099
015850     LABEL RECORDS STANDARD                                       01650099
015860     RECORD CONTAINS 133 CHARACTERS                               01651099
015870     DATA RECORD IS ERROR2-RECORD.                                01652099
015880 01  ERROR2-RECORD                    PIC X(133).                 01653099
015890                                                                  01654099
015900 FD  ERROROUT3-FILE                                               01655099
015910     RECORDING MODE F                                             01656099
015920     LABEL RECORDS STANDARD                                       01657099
015930     RECORD CONTAINS 133 CHARACTERS                               01658099
015940     DATA RECORD IS ERROR3-RECORD.                                01659099
015950 01  ERROR3-RECORD                    PIC X(133).                 01660099
015960                                                                  01661099
015970 FD  ERROROUT4-FILE                                               01662099
015980     RECORDING MODE F                                             01663099
015990     LABEL RECORDS STANDARD                                       01664099
016000     RECORD CONTAINS 300 CHARACTERS                               01665099
016010     DATA RECORD IS ERROR4-RECORD.                                01666099
016020 01  ERROR4-RECORD.                                               01667099
016030     05 ERROR4-REASON                 PIC X(4).                   01668099
016040     05 ERROR4-ETNI-OR-BILLER         PIC X(11).                  01669099
016050     05 ERROR4-CTN-BILLER-DATA        PIC X(285).                 01670099
016060                                                                  01671099
016070 FD  DTCTLOUT-FILE                                                01672099
016080     RECORDING MODE F                                             01673099
016090     LABEL RECORDS STANDARD                                       01674099
016100     RECORD CONTAINS 80 CHARACTERS                                01675099
016110     DATA RECORD IS DTCTLOUT-RECORD.                              01676099
016120 01  DTCTLOUT-RECORD                  PIC X(80).                  01677099
016130                                                                  01678099
016140 FD  CNTRLRPT-FILE                                                01679099
016150     RECORDING MODE F                                             01680099
016160     LABEL RECORDS STANDARD                                       01681099
016170     RECORD CONTAINS 133 CHARACTERS                               01682099
016180     DATA RECORD IS CNTRLRPT-RECORD.                              01683099
016190 01  CNTRLRPT-RECORD                  PIC X(133).                 01684099
016200                                                                  01685099
016210 FD  SEQPARMI-FILE                                                01686099
016220     RECORDING MODE F                                             01687099
016230     LABEL RECORDS STANDARD                                       01688099
016240     RECORD CONTAINS 80 CHARACTERS                                01689099
016250     DATA RECORD IS SEQPARM-PARM1.                                01690099
016260 01  SEQPARM-PARM1                    PIC X(80).                  01691099
016270                                                                  01692099
016280 FD  ERRORHUB-FILE                                                01693099
016290     RECORDING MODE F                                             01694099
016300     LABEL RECORDS OMITTED                                        01695099
016310     RECORD CONTAINS 133 CHARACTERS                               01696099
016320     DATA RECORD IS ERRORHUB-RECORD.                              01697099
016330 01  ERRORHUB-RECORD                  PIC X(133).                 01698099
016340                                                                  01699099
016350 FD  RECONHUB-FILE                                                01700099
016360     RECORDING MODE F                                             01701099
016370     LABEL RECORDS OMITTED                                        01702099
016380     RECORD CONTAINS 133 CHARACTERS                               01703099
016390     DATA RECORD IS RECONHUB-RECORD.                              01704099
016400 01  RECONHUB-RECORD                  PIC X(133).                 01705099
016410                                                                  01706099
016420*================================================================*01707099
016430 WORKING-STORAGE SECTION.                                         01708099
016440*================================================================*01709099
016450                                                                  01710099
016460 01  WS-START-LITERAL                PIC X(40) VALUE              01711099
016470     'WORKING-STORAGE STARTS HERE - *ETNBC16*'.                   01712099
016480                                                                  01713099
016490 01  WS-RETURN-CODE                  PIC S9(08)  VALUE  +0.       01714099
016500 01  WS-SPACES-10                    PIC  X(10)  VALUE  SPACES.   01715099
016501 01  WS-SPACES-20                    PIC  X(20)  VALUE  SPACES.   01716099
016502 01  WS-CTNIN-CTN-STATUS-PREV        PIC  XX  VALUE  SPACES.      01717099
016503 01  WS-SIM-INV-STATUS               PIC  XX  VALUE  SPACES.      01718099
016504                                                                  01719099
016505                                                                  01720099
016506 01  WS-TOTL-SIM-UPD                                              01721099
016507                                     PIC  S9(10)  COMP-3 VALUE +0.01722099
016506 01  WS-TOTL-UPD-INS-DEL-MQ                                       01723099
016507                                     PIC  S9(10)  COMP-3 VALUE +0.01724099
016508 01  WS-SAVE-UPD-INS-DEL-MQ                                       01725099
016509                                     PIC  S9(10)  COMP-3 VALUE +0.01726099
016510 01  WS-DISP-UPD-INS-DEL-MQ                                       01727099
016511                                     PIC   9(09)  VALUE  0.       01728099
016512                                                                  01729099
016513 01  WS-TOTL-UPDATES-INSERTS-CHKPT                                01730099
016514                                     PIC  S9(10)  COMP-3 VALUE +0.01731099
016515 01  WS-SAVE-UPDATES-INSERTS-CHKPT                                01732099
016516                                     PIC  S9(10)  COMP-3 VALUE +0.01733099
016517 01  WS-DISP-UPDATES-INSERTS-CHKPT                                01734099
016518                                     PIC   9(09)  VALUE 0.        01735099
016519                                                                  01736099
016520 01  WS-MDN-CLEAR                    PIC  X(10)   VALUE  SPACES.  01737099
016530                                                                  01738099
016540 01  WS-CDVC-QUEUENAME               PIC  X(48)  VALUE  SPACES.   01739099
016550                                                                  01740099
016560 01  WS-CTNIN-CTN-STATUS-SAVED       PIC  X(02)  VALUE  SPACES.   01741099
016570                                                                  01742099
016580 01  FILLER.                                                      01743099
016590  10 WS-MDNIN-MDNX                   PIC   X(10).                 01744099
016600  10 WS-MDNIN-MDN9 REDEFINES WS-MDNIN-MDNX  PIC   9(10).          01745099
016610                                                                  01746099
016620 01  WS-MDN-COMP-3                   PIC  S9(10)  COMP-3 VALUE +0.01747099
016630 01  WS-MIN-COMP-3                   PIC  S9(10)  COMP-3 VALUE +0.01748099
016640                                                                  01749099
016650 01  WS-STATUS-PC                    PIC  XX  VALUE  'PC'.        01750099
016660 01  WS-VORA-STATUS                  PIC  XX  VALUE  SPACES.      01751099
016670 01  WS-SIM-STATUS                   PIC  XX  VALUE  SPACES.      01752099
016680                                                                  01753099
016690 01  W03-OPTIONS                     PIC S9(9) BINARY  VALUE  +0. 01754099
016700 01  PUT-HCONN                       PIC S9(9) BINARY  VALUE  +0. 01755099
016710 01  BUFFER-LENGTH                   PIC S9(9) BINARY  VALUE +1.  01756099
016720 01  COMPLETION-CODE                 PIC S9(9) BINARY  VALUE +1.  01757099
016730 01  REASON                          PIC S9(9) BINARY  VALUE +1.  01758099
016740 01  WS-REASON                       PIC  9(9)         VALUE  0.  01759099
016750 01  WS-SELECT-SIM-VORA              PIC  X  VALUE  SPACES.       01760099
016760                                                                  01761099
016770 01 WS-SIM-INV-HIST-ETLSC08          PIC  X(08) VALUE 'ETLSC08'.  01762099
016780 01 WS-VORA-INV-HIST-ETLSC09         PIC  X(08) VALUE 'ETLSC09'.  01763099
016790*                                                                 01764099
016800 01  WS-SIM-INV-ETLSC10              PIC  X(08)  VALUE 'ETLSC10 '.01765099
016810 01  WS-VORA-INV-ETLSC11             PIC  X(08)  VALUE 'ETLSC11 '.01766099
016820*                                                                 01767099
016830 01  WS-4G-DETAIL-LINE               PIC  X(133)  VALUE  SPACES.  01768099
016840                                                                  01769099
016850 01  WS-4G-ERROR-SW                  PIC  X  VALUE  SPACES.       01770099
016860     88  WS-4G-ERROR-YES             VALUE  'Y'.                  01771099
016870     88  WS-4G-ERROR-NO              VALUE  'N'.                  01772099
016880                                                                  01773099
016890 01  WS-4G-CDVC-SW                  PIC  X  VALUE  SPACES.        01774099
016900     88  WS-4G-CDVC-YES             VALUE  'Y'.                   01775099
016910     88  WS-4G-CDVC-NO              VALUE  ' '.                   01776099
016920                                                                  01777099
016930 01  WS-SIM-UPD-SW                  PIC  X  VALUE  SPACES.        01778099
016940     88  WS-4G-SIM-YES              VALUE  'Y'.                   01779099
016950     88  WS-4G-SIM-NO               VALUE  ' '.                   01780099
016960                                                                  01781099
016970 01  WS-VORA-UPD-SW                 PIC  X  VALUE  SPACES.        01782099
016980     88  WS-4G-VORA-YES             VALUE  'Y'.                   01783099
016990     88  WS-4G-VORA-NO              VALUE  ' '.                   01784099
017000                                                                  01785099
017010 01  ERROR-MSG.                                                   01786099
017020     05  ERROR-LEN      PIC  S9(04)  COMP VALUE +720.             01787099
017030     05  ERROR-TEXT     PIC  X(72)   OCCURS 10 TIMES.             01788099
017040     05  ERROR-TEXT-LEN PIC  S9(09)  COMP VALUE +72.              01789099
017050                                                                  01790099
017060 01  WS-ETNI-WK-LOG     PIC  X(132).                              01791099
017070                                                                  01792099
017080 01 WS-ADD-TEN                    PIC  S9(4)V USAGE COMP-3.       01793099
017090 01 WS-TRAILER-COUNTER            PIC  S9(4)V USAGE COMP-3        01794099
017100                                              Value +0.           01795099
017110 01  FILLER.                                                      01796099
017120     10  WS-RESELLER-FLAG         PIC  X.                         01797099
017130     88  WS-RESELLER-TRUE         VALUES  'O' 'R'.                01798099
017140                                                                  01799099
017150 01 IX01-IDX                      PIC  9(03).                     01800099
017160 01 WS-CTNIN-CTN-TEXT-SAVED       PIC  X(06)  VALUE  SPACES.      01801099
017170                                                                  01802099
017180 01  WS-MDNIN-BILLER-ID-HUB       PIC  X(01)  VALUE  SPACES.      01803099
017190 01  WS-MDNIN-MIN-NUM-HUB         PIC  X(10)  VALUE  SPACES.      01804099
017200 01  WS-MDNIN-MDN-STATUS-HUB      PIC  X(02)  VALUE  SPACES.      01805099
017210 01  WS-MDNIN-NL-HUB              PIC  X(05)  VALUE  SPACES.      01806099
017220 01  WS-HUB-UPDATE-SWITCH         PIC  X(01)  VALUE  SPACES.      01807099
017230                                                                  01808099
017240 01 ZERO1                       PIC  S9(1)V USAGE COMP-3 VALUE +0.01809099
017250 01 ZERO2                       PIC  S9(1)V USAGE COMP-3 VALUE +0.01810099
017260 01 CORE-DUMP                   PIC  S9(1)V USAGE COMP-3 VALUE +0.01811099
017270 01  WS-CTN-INV-MIN-COUNT       PIC S9(09) COMP VALUE +0.         01812099
017280 01  WS-CTN-INV-NEW-COUNT       PIC S9(09) COMP VALUE +0.         01813099
017290 01  WS-MKT-MIN-LR-COUNT        PIC S9(09) COMP VALUE +0.         01814099
017300 01  WS-SIM-HIST-COUNT          PIC S9(09) COMP VALUE +0.         01815099
017310 01  WS-CTN-CHECK               PIC  X(10)  VALUE  SPACES.        01816099
017320 01  WS-RETAINED-DETAIL-1-MDN   PIC  X(20)  VALUE  SPACES.        01817099
017330 01  WS-CTNIN-4TH-G             PIC  X(20)  VALUE  SPACES.        01818099
017340                                                                  01819099
017350 01 FILLER.                                                       01820099
017360    10  WS-CTN-STATUS-TO-AA-STATUE  PIC  X  VALUE  '0'.           01821099
017370        88  WS-CTN-STATUS-TO-AA-NOTFOUND    VALUE  '0'.           01822099
017380        88  WS-CTN-STATUS-TO-AA             VALUE  '1'.           01823099
017390                                                                  01824099
017400 01 FILLER.                                                       01825099
017410    10  WS-VTS-PROCESS-FLAG         PIC  X  VALUE  '0'.           01826099
017420        88  WS-VTS-PROCESSED-NOT            VALUE  '0'.           01827099
017430        88  WS-VTS-PROCESSED                VALUE  '1'.           01828099
017440                                                                  01829099
017450    10  WS-5XX-PROCESS-FLAG         PIC  X  VALUE  '0'.           01830099
017460        88  WS-5XX-PROCESSED-NOT            VALUE  '0'.           01831099
017470        88  WS-5XX-PROCESSED                VALUE  '1'.           01832099
017480                                                                  01833099
017490 01  FILLER.                                                      01834099
017500     10  WS-CTN-STATUS-BYPASS-ARRAY  PIC  X(30)  VALUE SPACES.    01835099
017510     10  WS-CTN-STATUS-BYPASS-ARRAY-LST  REDEFINES                01836099
017520         WS-CTN-STATUS-BYPASS-ARRAY  PIC  X(03)                   01837099
017530                                     OCCURS  10  TIMES.           01838099
017540     10  FILLER                      PIC  X(03)  VALUE SPACES.    01839099
017550     10  FILLER                      PIC  X(30)  VALUE SPACES.    01840099
017560                                                                  01841099
017570     10  WS-CTN-STATUS-TO-AA-ARRAY   PIC  X(30)  VALUE SPACES.    01842099
017580     10  WS-CTN-STATUS-TO-AA-ARRAY-LST  REDEFINES                 01843099
017590         WS-CTN-STATUS-TO-AA-ARRAY   PIC  X(03)                   01844099
017600                                     OCCURS  10  TIMES.           01845099
017610     10  FILLER                      PIC  X(03)  VALUE SPACES.    01846099
017620     10  FILLER                      PIC  X(30)  VALUE SPACES.    01847099
017630                                                                  01848099
017640     10  WS-ETNBC16-NOT-IN-ETNI-ARAY-H PIC X(30) VALUE SPACES.    01849099
017650     10  WS-ETNBC16-NOT-IN-ETNI-ARRAY-L    REDEFINES              01850099
017660         WS-ETNBC16-NOT-IN-ETNI-ARAY-H      PIC  X(03)            01851099
017670                                     OCCURS  10  TIMES.           01852099
017680     10  FILLER                      PIC  X(03)  VALUE SPACES.    01853099
017690     10  FILLER                      PIC  X(30)  VALUE SPACES.    01854099
017700                                                                  01855099
017710     10  WS-ETNBC16-N-I-BILLING-ARAY PIC X(30)      VALUE SPACES. 01856099
017720     10  WS-ETNBC16-N-I-BILL-ARAY-L REDEFINES                     01857099
017730         WS-ETNBC16-N-I-BILLING-ARAY PIC X(03)                    01858099
017740                                     OCCURS  10  TIMES.           01859099
017750     10  FILLER                      PIC  X(03)  VALUE SPACES.    01860099
017760     10  FILLER                      PIC  X(30)  VALUE SPACES.    01861099
017770                                                                  01862099
017780**       WS-CTN-STATUS-V-A1-IDX                                   01863099
017790                                                                  01864099
017800     10  WS-BC16-VTS-MATCH-PROCESS-AREA PIC X(100)  VALUE SPACES. 01865099
017810     10  WS-BC16-VTS-MATCH-PROCESS-AR-L    REDEFINES              01866099
017820         WS-BC16-VTS-MATCH-PROCESS-AREA PIC X(05)                 01867099
017830                                     OCCURS  20  TIMES.           01868099
017840     10  FILLER                      PIC  X(05)  VALUE SPACES.    01869099
017850     10  FILLER                      PIC  X(30)  VALUE SPACES.    01870099
017860                                                                  01871099
017870 10  WS-BC16-VTS-NIB-DEFAULT         PIC X(005)  VALUE SPACE.     01872099
017880                                                                  01873099
017890                                                                  01874099
017900**       WS-CTN-STATUS-V-B-IDX                                    01875099
017910                                                                  01876099
017920     10  WS-BC16-VTS-NIB-PROCESS-ARAY PIC X(100)  VALUE SPACES.   01877099
017930     10  WS-BC16-VTS-NIB-PROCESS-ARAY-L    REDEFINES              01878099
017940         WS-BC16-VTS-NIB-PROCESS-ARAY PIC X(05)                   01879099
017950                                     OCCURS  20  TIMES.           01880099
017960     10  FILLER                      PIC  X(05)  VALUE SPACES.    01881099
017970     10  FILLER                      PIC  X(30)  VALUE SPACES.    01882099
017980                                                                  01883099
017990**       WS-CTN-STATUS-V-C-IDX                                    01884099
018000                                                                  01885099
018010     10  WS-BC16-VTS-NIE-PROCESS-ARAY PIC X(100)  VALUE SPACES.   01886099
018020     10  WS-BC16-VTS-NIE-PROCESS-ARAY-L    REDEFINES              01887099
018030         WS-BC16-VTS-NIE-PROCESS-ARAY PIC X(05)                   01888099
018040                                     OCCURS  20  TIMES.           01889099
018050     10  FILLER                      PIC  X(05)  VALUE SPACES.    01890099
018060     10  FILLER                      PIC  X(30)  VALUE SPACES.    01891099
018070                                                                  01892099
018080                                                                  01893099
018090     10  WS-BC16-5XX-MATCH-PROCESS-AREA PIC X(100)  VALUE SPACES. 01894099
018100     10  WS-BC16-5XX-MATCH-PROCESS-AR-L    REDEFINES              01895099
018110         WS-BC16-5XX-MATCH-PROCESS-AREA PIC X(05)                 01896099
018120                                     OCCURS  20  TIMES.           01897099
018130     10  FILLER                      PIC  X(05)  VALUE SPACES.    01898099
018140     10  FILLER                      PIC  X(30)  VALUE SPACES.    01899099
018150                                                                  01900099
018160**       WS-CTN-STATUS-5-B-IDX                                    01901099
018170     10  WS-BC16-5XX-NIB-DEFAULT      PIC X(005)  VALUE SPACES.   01902099
018180     10  WS-BC16-5XX-NIB-PROCESS-ARAY PIC X(100)  VALUE SPACES.   01903099
018190     10  WS-BC16-5XX-NIB-PROCESS-ARAY-L    REDEFINES              01904099
018200         WS-BC16-5XX-NIB-PROCESS-ARAY PIC X(05)                   01905099
018210                                     OCCURS  20  TIMES.           01906099
018220     10  FILLER                      PIC  X(05)  VALUE SPACES.    01907099
018230     10  FILLER                      PIC  X(30)  VALUE SPACES.    01908099
018240                                                                  01909099
018250**       WS-CTN-STATUS-5-C-IDX                                    01910099
018260                                                                  01911099
018270     10  WS-BC16-5XX-NIE-PROCESS-ARAY PIC X(100)  VALUE SPACES.   01912099
018280     10  WS-BC16-5XX-NIE-PROCESS-ARAY-L    REDEFINES              01913099
018290         WS-BC16-5XX-NIE-PROCESS-ARAY PIC X(05)                   01914099
018300                                     OCCURS  20  TIMES.           01915099
018310     10  FILLER                      PIC  X(05)  VALUE SPACES.    01916099
018320     10  FILLER                      PIC  X(30)  VALUE SPACES.    01917099
018330                                                                  01918099
018340                                                                  01919099
018350                                                                  01920099
018360**       WS-CTN-STATUS-D-A-IDX                                    01921099
018370                                                                  01922099
018380     10  WS-ETNBC16-4G-PROCESS-ARAY PIC X(080)     VALUE SPACES.  01923099
018390     10  WS-ETNBC16-4G-PROCESS-ARAY-L REDEFINES                   01924099
018400         WS-ETNBC16-4G-PROCESS-ARAY  PIC X(05)                    01925099
018410                                     OCCURS  16  TIMES.           01926099
018420     10  FILLER                      PIC  X(03)  VALUE SPACES.    01927099
018430     10  FILLER                      PIC  X(30)  VALUE SPACES.    01928099
018440                                                                  01929099
018450                                                                  01930099
018460**  Retail  or  Reseller  Not  In  Billing                        01931099
018470**  Bypass                                                        01932099
018480                                                                  01933099
018490     10  WS-ETNBC16-N-I-BILLING-RE   PIC X(30)      VALUE SPACES. 01934099
018500     10  WS-ETNBC16-N-I-BILL-ARAY-R REDEFINES                     01935099
018510         WS-ETNBC16-N-I-BILLING-RE   PIC X(03)                    01936099
018520                                     OCCURS  10  TIMES.           01937099
018530     10  FILLER                      PIC  X(03)  VALUE SPACES.    01938099
018540     10  FILLER                      PIC  X(30)  VALUE SPACES.    01939099
018550                                                                  01940099
018560**  Retail  In  Billing  - For  Billing-Profile-MDN  Update       01941099
018570                                                                  01942099
018580     10  WS-ETNBC16-I-BILLING      PIC X(35)      VALUE SPACES.   01943099
018590**   10  WS-ETNBC16-I-BILL-ARAY-FROM  PIC  X(2)                   01944099
018600**   10  WS-ETNBC16-I-BILL-ARAY-TO    PIC  X(2)                   01945099
018610     10  WS-ETNBC16-I-BILL-ARAY-F-T REDEFINES                     01946099
018620         WS-ETNBC16-I-BILLING      PIC X(05)                      01947099
018630                                     OCCURS   7  TIMES.           01948099
018640     10  FILLER                      PIC  X(05)  VALUE SPACES.    01949099
018650     10  FILLER                      PIC  X(30)  VALUE SPACES.    01950099
018660                                                                  01951099
018670**  VISION  In  Billing  -                                        01952099
018680                                                                  01953099
018690     10  WS-ETNBC16-V-BILLING      PIC X(30)      VALUE SPACES.   01954099
018700**   10  WS-ETNBC16-V-BILL-ARAY-FROM-STAT  PIC  X(2)              01955099
018710**   10  WS-ETNBC16-V-BILL-ARAY-TO-STAT    PIC  X(2)              01956099
018720**   10  FILLER                            PIC  X(1)              01957099
018730     10  WS-ETNBC16-V-BILL-ARAY-F-T REDEFINES                     01958099
018740         WS-ETNBC16-V-BILLING      PIC X(05)                      01959099
018750                                     OCCURS   6  TIMES.           01960099
018760     10  FILLER                      PIC  X(05)  VALUE SPACES.    01961099
018770     10  FILLER                      PIC  X(30)  VALUE SPACES.    01962099
018780                                                                  01963099
018790     10  WS-CTN-STATUS-C-A-IDX       PIC  S9(4)  COMP  VALUE +0.  01964099
018800     10  WS-CTN-STATUS-C-A-IDX-MAX   PIC  S9(4)  COMP  VALUE +07. 01965099
018810                                                                  01966099
018820     10  WS-CTN-STATUS-B-A-IDX       PIC  S9(4)  COMP  VALUE +0.  01967099
018830     10  WS-CTN-STATUS-B-A-IDX-MAX   PIC  S9(4)  COMP  VALUE +10. 01968099
018840                                                                  01969099
018850     10  WS-CTN-STATUS-V-A-IDX       PIC  S9(4)  COMP  VALUE +0.  01970099
018860     10  WS-CTN-STATUS-V-A-IDX-MAX   PIC  S9(4)  COMP  VALUE +06. 01971099
018870                                                                  01972099
018880     10  WS-CTN-STATUS-V-A1-IDX      PIC  S9(4)  COMP  VALUE +0.  01973099
018890     10  WS-CTN-STATUS-V-A1-IDX-MAX  PIC  S9(4)  COMP  VALUE +20. 01974099
018900                                                                  01975099
018910     10  WS-CTN-STATUS-V-B-IDX      PIC  S9(4)  COMP  VALUE +0.   01976099
018920     10  WS-CTN-STATUS-V-B-IDX-MAX  PIC  S9(4)  COMP  VALUE +20.  01977099
018930                                                                  01978099
018940     10  WS-CTN-STATUS-V-C-IDX      PIC  S9(4)  COMP  VALUE +0.   01979099
018950     10  WS-CTN-STATUS-V-C-IDX-MAX  PIC  S9(4)  COMP  VALUE +20.  01980099
018960                                                                  01981099
018970     10  WS-CTN-STATUS-D-A-IDX       PIC  S9(4)  COMP  VALUE +0.  01982099
018980     10  WS-CTN-STATUS-D-A-IDX-MAX   PIC  S9(4)  COMP  VALUE +16. 01983099
018990                                                                  01984099
019000     10  WS-CTN-STATUS-5-A1-IDX      PIC  S9(4)  COMP  VALUE +0.  01985099
019010     10  WS-CTN-STATUS-5-A1-IDX-MAX  PIC  S9(4)  COMP  VALUE +20. 01986099
019020                                                                  01987099
019030     10  WS-CTN-STATUS-5-B-IDX      PIC  S9(4)  COMP  VALUE +0.   01988099
019040     10  WS-CTN-STATUS-5-B-IDX-MAX  PIC  S9(4)  COMP  VALUE +20.  01989099
019050                                                                  01990099
019060     10  WS-CTN-STATUS-5-C-IDX      PIC  S9(4)  COMP  VALUE +0.   01991099
019070     10  WS-CTN-STATUS-5-C-IDX-MAX  PIC  S9(4)  COMP  VALUE +20.  01992099
019080                                                                  01993099
019090 01  VTS-MDN-SW                   PIC  X(01)  VALUE  'N'.         01994099
019100     88  VTS-MDN                  VALUE 'Y'.                      01995099
019110     88  NOT-VTS-MDN              VALUE 'N'.                      01996099
019120                                                                  01997099
019130 01  5XX-MDN-SW                   PIC  X(01)  VALUE  'N'.         01998099
019140     88  5XX-MDN                  VALUE 'Y'.                      01999099
019150     88  NOT-5XX-MDN              VALUE 'N'.                      02000099
019160                                                                  02001099
019170 01  WS-SUB-VTS-NL      PIC  S9(04)  COMP  VALUE  +0.             02002099
019180 01  WS-SUB-VTS-NL-MAX  PIC  S9(04)  COMP  VALUE  +200.           02003099
019190                                                                  02004099
019200 01  WS-SUB-5XX-NL      PIC  S9(04)  COMP  VALUE  +0.             02005099
019210 01  WS-SUB-5XX-NL-MAX  PIC  S9(04)  COMP  VALUE  +200.           02006099
019220                                                                  02007099
019230 01  VTS-ROWS           PIC  X(01)  VALUE  'Y'.                   02008099
019240     88  MORE-VTS-ROWS      VALUE  'Y'.                           02009099
019250     88  NO-MORE-VTS-ROWS   VALUE  'N'.                           02010099
019260                                                                  02011099
019270 01  5XX-ROWS           PIC  X(01)  VALUE  'Y'.                   02012099
019280     88  MORE-5XX-ROWS      VALUE  'Y'.                           02013099
019290     88  NO-MORE-5XX-ROWS   VALUE  'N'.                           02014099
019300                                                                  02015099
019310 01 WS-VTS-NL-TABLE.                                              02016099
019320   03 WS-VTS-TBL OCCURS 200  TIMES.                               02017099
019330    05  WS-VTS-ENTRY.                                             02018099
019340        10 WS-VTS-NL                 PIC X(05).                   02019099
019350                                                                  02020099
019360 01 WS-5XX-NL-TABLE.                                              02021099
019370   03 WS-5XX-TBL OCCURS 200  TIMES.                               02022099
019380    05  WS-5XX-ENTRY.                                             02023099
019390        10 WS-5XX-NL                 PIC X(05).                   02024099
019400        10 WS-5XX-RELATED-NL         PIC X(05).                   02025099
019410                                                                  02026099
019420 01  WS-PRIOR-CTN-STATUS             PIC X(02) VALUE '  '.        02027099
019430                                                                  02028099
019440 01  WS-ETNSC58                      PIC X(08) VALUE 'ETNSC58 '.  02029099
019450                                                                  02030099
019460 01  FILLER.                                                      02031099
019470     05  WS-NGP-NL-AREA               PIC  X(45000)               02032099
019480                                      VALUE  SPACES.              02033099
019490                                                                  02034099
019500     05  WS-NGP-NL-ARRAY  REDEFINES  WS-NGP-NL-AREA               02035099
019510                              OCCURS 5000  TIMES.                 02036099
019520                                                                  02037099
019530        10  WS-NGP-ENTRY              PIC  X(03).                 02038099
019540        10  WS-NL-ENTRY               PIC  X(05).                 02039099
019550        10  WS-PRODUCT-ENTRY          PIC  X(01).                 02040099
019560                                                                  02041099
019570     05  WS-NGP-NL-ARRAY-END.                                     02042099
019580                                                                  02043099
019590     10  FILLER                      PIC  X(09)  VALUE SPACES.    02044099
019600                                                                  02045099
019610     10  WS-NGP-NL-A-IDX             PIC  S9(4) COMP VALUE +0.    02046099
019620     10  WS-NGP-NL-A-IDX-MAX         PIC  S9(4) COMP VALUE +5000. 02047099
019630                                                                  02048099
019640                                                                  02049099
019650 01  FILLER.                                                      02050099
019660**  This  Array  is  Used  ONLY  for  "HUB"  data                 02051099
019670     05  WS-MKT-MIN-LR-AREA           PIC  X(1200)                02052099
019680                                      VALUE  SPACES.              02053099
019690                                                                  02054099
019700     05  WS-MKT-MIN-LR-ARRAY REDEFINES WS-MKT-MIN-LR-AREA         02055099
019710                              OCCURS  200  TIMES.                 02056099
019720                                                                  02057099
019730        10  WS-MARKET-MIN-LR          PIC  X(06).                 02058099
019740                                                                  02059099
019750     05  WS-MKT-MIN-LR-ARRAY-END.                                 02060099
019760                                                                  02061099
019770     10  FILLER                      PIC  X(06)  VALUE SPACES.    02062099
019780                                                                  02063099
019790     10  WS-MKT-MIN-LR-IDX           PIC  S9(4)  COMP VALUE +0.   02064099
019800     10  WS-MKT-MIN-LR-IDX-MAX       PIC  S9(4)  COMP VALUE +200. 02065099
019810     10  WS-MKT-MIN-LR-IDX-MAX-LIT   PIC  S9(4)  COMP VALUE +200. 02066099
019820                                                                  02067099
019830     10  WS-BILL-MIN-BLK-SAVED       PIC  X(06)  VALUE SPACES.    02068099
019840     10  WS-ETNI-MIN-BLK-SAVED       PIC  X(06)  VALUE SPACES.    02069099
019850     10  WS-SEARCH-MIN-BLK           PIC  X(06)  VALUE SPACES.    02070099
019860                                                                  02071099
019870     10  WS-NGP-CURRENT              PIC  X(03)  VALUE SPACES.    02072099
019880     10  WS-NL-CURRENT               PIC  X(05)  VALUE SPACES.    02073099
019890     10  WS-PRODUCT-CURRENT          PIC  X(01)  VALUE SPACES.    02074099
019900                                                                  02075099
019910                                                                  02076099
019920*-----------------------------------------------------------------02077099
019930*-----work areas and variables for local MQ processing------------02078099
019940*-----------------------------------------------------------------02079099
019950                                                                  02080099
019960 01  MQ-ERRORS.                                                   02081099
019970     COPY ETNCCE1.                                                02082099
019980 01  MQ-CONSTANTS.                                                02083099
019990     COPY CMQV.                                                   02084099
020000 01  OBJECT-GET-DESCRIPTOR.                                       02085099
020010     COPY CMQODV.                                                 02086099
020020 01  OBJECT-PUT-DESCRIPTOR.                                       02087099
020030     COPY CMQODV.                                                 02088099
020040 01  MESSAGE-GET-DESCRIPTOR.                                      02089099
020050     COPY CMQMDV.                                                 02090099
020060 01  MESSAGE-PUT-DESCRIPTOR.                                      02091099
020070     COPY CMQMDV.                                                 02092099
020080 01  GMOPTIONS.                                                   02093099
020090     COPY CMQGMOV.                                                02094099
020100 01  PMOPTIONS.                                                   02095099
020110     COPY CMQPMOV.                                                02096099
020120*----copybook below holds MQ commands (OPEN, CLOSE, GET, etc)-----02097099
020130 01  LS-Q-LNKG.                                                   02098099
020140     COPY ETNCC04.                                                02099099
020150*---copybook below holds ACTP/DSCP common VZW gateway layout------02100099
020160 01  WS-ACTP-DSCP-MESSAGE.                                        02101099
020170     COPY ETNCC23.                                                02102099
020180                                                                  02103099
020190 01  WS-SEQ-NUMBERING-AREA.                                       02104099
020200     COPY ETNCC116.                                               02105099
020210                                                                  02106099
020220 01  FILLER.                                                      02107099
020230     COPY ETNCCE2.                                                02108099
020240                                                                  02109099
020250**1  FILLER.                                                      02110099
020260**   COPY ETNCCE3.                                                02111099
020270                                                                  02112099
020280 01  WS-LTE-DATA-LAYER.                                           02113099
020290     COPY ETLCC01.                                                02114099
020300                                                                  02115099
020310 01  FILLER.                                                      02116099
020320     COPY ETLCC12.                                                02117099
020330                                                                  02118099
020340                                                                  02119099
020350 01  WS-MQ-VARIOUS-AND-SUNDRY.                                    02120099
020360     05 WS-NOTI-QUE-NAME                  PIC X(48)  VALUE SPACE. 02121099
020370     05 WS-TRIG-QUE-NAME                  PIC X(48)  VALUE SPACE. 02122099
020380     05 WS-CDVC-QUE-LNKG                  PIC X(185) VALUE SPACE. 02123099
020390     05 WS-NOTI-QUE-LNKG                  PIC X(185) VALUE SPACE. 02124099
020400     05 WS-TRIG-QUE-LNKG                  PIC X(185) VALUE SPACE. 02125099
020410     05 WS-GATEWAY-QUE-LNKG               PIC X(185) VALUE SPACE. 02126099
020420     05 WS-Q-MGR-ID                       PIC X(48)  VALUE SPACE. 02127099
020430     05 MQ-NOTIFY-RECORD                  PIC X(2505) VALUE SPACE.02128099
020440                                                                  02129099
020450 01  MQ-TRIGGER-RECORD.                                           02130099
020460     05 WS-TRIG-EOT                       PIC X(04) VALUE 'EOT '. 02131099
020470     05 WS-TRIG-OPER-ID                   PIC X(51) VALUE SPACES. 02132099
020480                                                                  02133099
020490*----below is a random number that ties the Trigger MQ record-----02134099
020500*----with its Notification records. Both get the same Correlation.02135099
020510 01  WS-CORRELATION-ID                    PIC X(26) VALUE SPACE.  02136099
020520                                                                  02137099
020530*---copybook below holds commarea to HISTORY update program-------02138099
020540 01  WS-HISTORY-COMMAREA.                                         02139099
020550     COPY ETNCC361.                                               02140099
020560                                                                  02141099
020570*-----------------------------------------------------------------02142099
020580*---work areas and variables for MQ processing via      to ETWSC8102143099
020590*-----------------------------------------------------------------02144099
020600                                                                  02145099
020610 01 WS-NOTIFY-RECORD.                                             02146099
020620*** COPY ETNCC380.  ***  InLine  due  to  Duplicate Output Area   02147099
020630                                                                  02148099
020640    05  CA3-INPUT-AREA.                                           02149099
020650     10  API-ID                          PIC X(04).               02150099
020660     10  CA3-IN-ARGS.                                             02151099
020670       15  BILLER-ID                   PIC X(01).                 02152099
020680       15  PRODUCT-TYPE                PIC X(01).                 02153099
020690       15  NL                          PIC X(05).                 02154099
020700       15  OLD-NL                      PIC X(05).                 02155099
020710       15  OPERATOR-ID                 PIC X(16).                 02156099
020720       15  ORIGINATION-DT-TM           PIC X(26).                 02157099
020730       15  RETRY-CTR                   PIC 9(03).                 02158099
020740       15  BACKOUT-IND                 PIC X(01).                 02159099
020750       15  INTERNAL-PORT               PIC X(01).                 02160099
020760       15  ACCT-TYP-IND                PIC X(01).                 02161099
020770       15  FILLER                      PIC X(27).                 02162099
020780       15  MDN-CNT                     PIC 9(03).                 02163099
020790       15  MDN-TABLE.                                             02164099
020800           20  MDN-ROW OCCURS 100.                                02165099
020810               25  MDN                 PIC X(10).                 02166099
020820               25  NGP                 PIC X(03).                 02167099
020830               25  MIN-OR-LRN          PIC X(10).                 02168099
020840       05  CA3-OUTPUT-AREA.                                       02169099
020850           10  API-STATUS-CD-NOT               PIC X(05).         02170099
020860           10  API-STATUS-DESCR-NOT            PIC X(80).         02171099
020870           10  ERROR-DT-TM-NOT                 PIC X(26).         02172099
020880                                                                  02173099
020890 01 WS-MQ-PARM.                                                   02174099
020900    COPY ETNCC381.                                                02175099
020910                                                                  02176099
020920*01 WS-PARAM-VALUE-REC.                                           02177099
020930**  COPY ETNCC353.                                                02178099
020940                                                                  02179099
020950 01 WS-COMMIT-ROLLBACK.                                           02180099
020960    COPY ETNCC364.                                                02181099
020970                                                                  02182099
020980 01 MQ-VARIOUS-FIELDS.                                            02183099
020990    05 WS-CALL-PGM                   PIC X(8)   VALUE SPACE.      02184099
021000    05 WS-MQ-RETURN-CODE-NUM         PIC 9(8)   VALUE ZERO.       02185099
021010    05 WS-MQ-RETURN-CODE-ALPHA REDEFINES                          02186099
021020       WS-MQ-RETURN-CODE-NUM         PIC X(8).                    02187099
021030    05 WS-ETWSC81                    PIC X(7)   VALUE 'ETWSC81'.  02188099
021040                                                                  02189099
021050*-----------------------------------------------------------------02190099
021060                                                                  02191099
021070*AXY042706 - BEG                                                  02192099
021080*01  WS-COMMAREA                     PIC X(97) VALUE SPACE.       02193099
021090 01  WS-COMMAREA                     PIC X(100) VALUE SPACE.      02194099
021100*AXY042706 - END                                                  02195099
021110                                                                  02196099
021120 01  WS-GATEWAY-VARIABLES.                                        02197099
021130     05 WS-GATEWAY-BILLER-ID         PIC X(01) VALUE SPACES.      02198099
021140     05 WS-GATEWAY-QUEUENAME         PIC X(48) VALUE SPACES.      02199099
021150     05 WS-GATEWAY-PGM-ID            PIC X(08) VALUE SPACES.      02200099
021160     05 WS-GATEWAY-API-ID            PIC X(04) VALUE SPACES.      02201099
021170     05 WS-GATEWAY-ERR-LOCATION      PIC X(06) VALUE SPACES.      02202099
021180     05 WS-GATEWAY-ERR-REASON        PIC X(40) VALUE SPACES.      02203099
021190     05 WS-GATEWAY-ERR-CODE          PIC X(06) VALUE SPACES.      02204099
021200     05 WS-GATEWAY-ERR-ACTION        PIC X(01) VALUE SPACES.      02205099
021210                                                                  02206099
021220 01  WS-QUEUE-STATUS          PIC X(03) VALUE 'NO'.               02207099
021230     88 QUEUE-AVAILABLE                 VALUE 'YES'.              02208099
021240     88 QUEUE-NOT-AVAILABLE             VALUE 'NO '.              02209099
021250 01  WS-MESSAGE-LENGTH        PIC X(01) VALUE '1'.                02210099
021260     88 SHORT                           VALUE '1'.                02211099
021270     88 LONG                            VALUE '2'.                02212099
021280 01  WS-ERR-IND               PIC X(01) VALUE 'N'.                02213099
021290     88 APPL-ERROR                      VALUE 'Y'.                02214099
021300     88 NO-ERROR                        VALUE 'N'.                02215099
021310                                                                  02216099
021320*AXY042706 - BEG                                                  02217099
021330 01  WS-COMMIT-DSCP           PIC X(01) VALUE 'N'.                02218099
021340     88 COMMIT-DSCP                     VALUE 'Y'.                02219099
021350     88 NO-COMMIT-DSCP                  VALUE 'N'.                02220099
021360*AXY042706 - END                                                  02221099
021370                                                                  02222099
021380*-----------------------------------------------------------      02223099
021390* Q U E U E  I N F O R M A T I O N                                02224099
021400*-----------------------------------------------------------      02225099
021410 01  WS-QUEUE-RECORD                  PIC X(16).                  02226099
021420 01  WS-QUEUE-INFO.                                               02227099
021430     10 WS-QUEUE-KEY                  PIC X(05).                  02228099
021440     10 WS-QUEUE-NAME                 PIC X(49).                  02229099
021450     10 FILLER                        PIC X(1) VALUE SPACES.      02230099
021460                                                                  02231099
021470 01  DISCONNECT-MSG-COUNTER           PIC 9(9)  VALUE ZERO.       02232099
021480 01  NOTIFICATION-MSG-COUNTER         PIC 9(9)  VALUE ZERO.       02233099
021490 01  WS-BACKOUT-QUEUE-NAME.                                       02234099
021500     10 WS-BACKOUT-Q-NAME             PIC X(05).                  02235099
021510     10 FILLER                        PIC X(10) VALUE '.BACKOUT'. 02236099
021520                                                                  02237099
021530 01  WS-FLAGS.                                                    02238099
021540     10 DEBUG-SW                         PIC X(01) VALUE 'N'.     02239099
021550        88 DEBUG-ON                                VALUE 'Y'.     02240099
021560     10 RECORD-VALID-SW                  PIC X(01) VALUE 'N'.     02241099
021570        88 RECORD-VALID                            VALUE 'Y'.     02242099
021580     10 INSERT-NEW-CTN-SW                PIC X(01) VALUE 'N'.     02243099
021590        88 INSERT-NEW-CTN                          VALUE 'Y'.     02244099
021600                                                                  02245099
021610 01  Q-FORMAT-CTN.                                                02246099
021620     05 Q-FORMAT-NPA                PIC X(3).                     02247099
021630     05 F                           PIC X          VALUE '-'.     02248099
021640     05 Q-FORMAT-NXX                PIC X(3).                     02249099
021650     05 F                           PIC X          VALUE '-'.     02250099
021660     05 Q-FORMAT-LINE               PIC X(4).                     02251099
021670                                                                  02252099
021680 01  WS-MQ-SUB                      PIC X(08)     VALUE 'ETNSC03'.02253099
021690 01  WS-POOLR-MSGQU-CTR             PIC 9(14)     VALUE ZERO.     02254099
021700                                                                  02255099
021710 01 WS-VARIABLES.                                                 02256099
021720    10 WS-ERR-LOCATION              PIC X(06)     VALUE SPACES.   02257099
021730    10 WS-ERR-REASON                PIC X(40)     VALUE SPACES.   02258099
021740    10 WS-ERR-CODE                  PIC X(06)     VALUE SPACES.   02259099
021750    10 WS-ERR-ACTION                PIC X(01)     VALUE SPACES.   02260099
021760                                                                  02261099
021770*-----------------------------------------------------------------02262099
021780*----------------end of MQ areas and variables--------------------02263099
021790*-----------------------------------------------------------------02264099
021800                                                                  02265099
021810 01  WS-BILLER-COUNTS.                                            02266099
021820     05 ETNI-HAS-MIN-COUNT            PIC 9(9) VALUE ZERO.        02267099
021830     05 I2K-MIN-NULL-COUNT            PIC 9(9) VALUE ZERO.        02268099
021840     05 ETNI-HAS-NO-MIN-COUNT         PIC 9(9) VALUE ZERO.        02269099
021850     05 NON-I2K-BILLER                PIC 9(9) VALUE ZERO.        02270099
021860                                                                  02271099
021870 01  WS-SWITCHES.                                                 02272099
021880     05  WS-SEQPARM-EOF-SW            PIC X(01) VALUE 'N'.        02273099
021890         88  WS-SEQPARM-EOF                     VALUE 'Y'.        02274099
021900     05  WS-END-OF-FILE-BILL          PIC X(01) VALUE 'N'.        02275099
021910         88  WS-NO-MORE-RECORD-BILL             VALUE 'Y'.        02276099
021920     05  WS-END-OF-FILE-ETNI          PIC X(01) VALUE 'N'.        02277099
021930         88  WS-NO-MORE-RECORD-ETNI             VALUE 'Y'.        02278099
021940     05  WS-ERROR-FIELDS-SW           PIC X(01) VALUE SPACES.     02279099
021950         88  WS-ERROR-FIELDS-FOUND              VALUE 'E'.        02280099
021960*--* #850803-2 LMS 4/21/2003 BEGIN                                02281099
021970     05  NOT-DELETED-SW               PIC X(01) VALUE 'N'.        02282099
021980     05  NOT-UPDATED-SW               PIC X(01) VALUE 'N'.        02283099
021990*--* #850803-2 LMS 4/21/2003 END                                  02284099
022000     05  WS-DATE-SW                   PIC X(01) VALUE SPACES.     02285099
022010         88  WS-DATE-VALID                      VALUE 'V'.        02286099
022020         88  WS-DATE-INVALID                    VALUE 'I'.        02287099
022030     05  WS-LEAP-YEAR-SW              PIC X(01).                  02288099
022040         88 LEAP-YEAR                 VALUE 'Y'.                  02289099
022050         88 NOT-LEAP-YEAR             VALUE 'N'.                  02290099
022060     05  WS-REC-SW                    PIC X(01) VALUE SPACES.     02291099
022070         88  WS-REC-MATCH                       VALUE '1'.        02292099
022080         88  WS-REC-BILL-NOT-IN-ETNI            VALUE '2'.        02293099
022090         88  WS-REC-ETNI-NOT-IN-BILL            VALUE '3'.        02294099
022100     05  WS-VALID-PRODUCT-TYPE        PIC X(01).                  02295099
022110         88  VALID-PRODUCT-TYPE                                   02296099
022120             VALUES 'C', 'L', 'M', 'N', 'P', 'Q'.                 02297099
022130     05  WS-VALID-MDN-STATUS          PIC X(02).                  02298099
022140         88  VALID-MDN-STATUS                                     02299099
022150             VALUES 'NA', 'NH', 'AT', 'AA', 'AR',                 02300099
022160                    'AI', 'AG', 'PO', 'PA'.                       02301099
022170     05  WS-VALID-PORT-IND           PIC X(02).                   02302099
022180         88  VALID-PORT-IND                                       02303099
022190             VALUES 'IO', 'PI', 'PO', 'RE', 'SB'.                 02304099
022200*** #140804 LMS 05/21/2003 BEGIN                                  02305099
022210*----COPYBOOK FOR HOLD REASONS------------------------------------02306099
022220     COPY ETNCC20.                                                02307099
022230*** #140804 LMS 05/21/2003 END                                    02308099
022240                                                                  02309099
022250*** #870803 SDL BEGIN                                             02310099
022260     05  WS-COMINGLED-IND            PIC X(01) VALUE SPACE.       02311099
022270*** #870803 SDL END                                               02312099
022280                                                                  02313099
022290 01  WS-LITERALS.                                                 02314099
022300     05  LIT-PGM-ID                   PIC X(8) VALUE 'ETNBC16'.   02315099
022310* START JBOLTON 11-08-02 NEW LIT FOR CALL TO ETNSC50. NEW         02316099
022320* SUBROUTINE FOR UPDATING AA-STS-CNT IN NPANXX-AVAIL TABLE        02317099
022330     05  WS-PGM-ID-ETNSC50            PIC X(8) VALUE 'ETNSC50'.   02318099
022340     05  WS-INCREMENT-LIT             PIC X(1) VALUE 'I'.         02319099
022350     05  WS-DECREMENT-LIT             PIC X(1) VALUE 'D'.         02320099
022360* END   JBOLTON                                                   02321099
022370     05  LIT-RPT-ID-RECON             PIC X(8)  VALUE 'RTNBC16R'. 02322099
022380     05  LIT-RPT-ID-ERROR             PIC X(8)  VALUE 'RTNBC16E'. 02323099
022390     05  LIT-RPT-ID-RECON-HUB         PIC X(8)  VALUE 'HTNBC16R'. 02324099
022400     05  LIT-RPT-ID-ERROR-HUB         PIC X(8)  VALUE 'HTNBC16E'. 02325099
022410     05  LIT-RPT-ID-CNTRLRPT          PIC X(8)  VALUE 'RTNBC16C'. 02326099
022420     05  LIT-RPT-ID-PO-ERROR-I2KE     PIC X(11) VALUE             02327099
022430         'RTNBC16PORI'.                                           02328099
022440     05  LIT-RPT-ID-PO-ERROR-I2KW     PIC X(11) VALUE             02329099
022450         'RTNBC16PORK'.                                           02330099
022460     05  LIT-RPT-ID-PO-ERROR-VISE     PIC X(11) VALUE             02331099
022470         'RTNBC16PORV'.                                           02332099
022480     05  LIT-RPT-ID-PO-ERROR-VISW     PIC X(11) VALUE             02333099
022490         'RTNBC16PORN'.                                           02334099
022500     05  LIT-RPT-ID-PO-ERROR-VISA     PIC X(11) VALUE             02335099
022510         'RTNBC16PORA'.                                           02336099
022520     05  LIT-RPT-ID-PO-ERROR-RSS      PIC X(11) VALUE             02337099
022530         'RTNBC16PORR'.                                           02338099
022540     05  LIT-RPT-ID-PO-ERROR-OPC      PIC X(11) VALUE             02339099
022550         'RTNBC16PORO'.                                           02340099
022560     05  LIT-RPT-ID-PO-ERROR-VTS      PIC X(11) VALUE             02341099
022570         'RTNBC16PORG'.                                           02342099
022580     05  LIT-RPT-TITLE-RECON          PIC X(34)                   02343099
022590         VALUE 'TNI RECONCILIATION UPDATE REPORT '.               02344099
022600     05  LIT-RPT-TITLE-ERROR          PIC X(34)                   02345099
022610         VALUE 'TNI RECONCILIATION ERROR REPORT  '.               02346099
022620     05  LIT-RPT-TITLE-ERROR-HUB      PIC X(34)                   02347099
022630         VALUE 'TNI RECONCILIATION HUB ERROR RPT '.               02348099
022640     05  LIT-RPT-TITLE-CNTRLRPT       PIC X(34)                   02349099
022650         VALUE 'TNI RECONCILIATION CONTROL REPORT'.               02350099
022660     05  LIT-RPT-TYPE-REPORT          PIC X(16)                   02351099
022670         VALUE '(REPORT ONLY)   '.                                02352099
022680     05  LIT-RPT-TYPE-UPDATE          PIC X(16)                   02353099
022690         VALUE '(UPDATE MODE)   '.                                02354099
022700     05  LIT-RPT-TYPE-UPDDEL          PIC X(16)                   02355099
022710         VALUE '(UPD/DEL MODE)  '.                                02356099
022720     05  LIT-RPT-TYPE-UPDDNA          PIC X(16)                   02357099
022730         VALUE '(UPD/DNA MODE)  '.                                02358099
022740     05  LIT-RECON-ID                 PIC X(7) VALUE 'RECON  '.   02359099
022750     05  LIT-DL-SERVICE-CD            PIC X(8) VALUE 'NMCST   '.  02360099
022760     05  LIT-OPERATOR-ID              PIC X(16)                   02361099
022770                                      VALUE 'ETNBC16         '.   02362099
022780     05  LIT-UNKNOWN                  PIC X(08)                   02363099
022790                                      VALUE 'UNKNOWN '.           02364099
022800     05  LIT-UPDATED-COMMENT          PIC X(25)                   02365099
022810         VALUE 'UPDATED: NOT MATCHING   '.                        02366099
022820     05  LIT-PREPAID-IND-UPDATED      PIC X(25)                   02367099
022830         VALUE 'UPDATED: PREPAID-IND    '.                        02368099
022840     05  LIT-INSERTED-COMMENT-ETNI    PIC X(25)                   02369099
022850         VALUE 'INSERTED:MDN NOT IN ETNI'.                        02370099
022860     05  LIT-UPDATED-COMMENT-BILL     PIC X(25)                   02371099
022870         VALUE 'UPDATED: MDN NOT IN BILL'.                        02372099
022880     05  LIT-DELETED-COMMENT          PIC X(25)                   02373099
022890         VALUE 'DELETED: NOT IN BILLING '.                        02374099
022900     05  LIT-UNLOADED-COMMENT         PIC X(25)                   02375099
022910         VALUE 'UNLOADED: NOT IN BILLING '.                       02376099
022920     05  LIT-SPLIT-COMMENT            PIC X(25)                   02377099
022930         VALUE 'UPDATED TO NH/SPLIT.     '.                       02378099
022940     05  LIT-UPD-NA-NOT-IN-BILL-COMMENT  PIC X(25)                02379099
022950         VALUE 'UPDATED TO NA:NOT IN BILL'.                       02380099
022960     05  LIT-UPD-PO-NOT-IN-BILL-COMMENT  PIC X(25)                02381099
022970         VALUE 'UPDATED TO PO:NOT IN BILL'.                       02382099
022980     05  LIT-DEL-BL-MDN-PROFILE          PIC X(25)                02383099
022990         VALUE 'Deleted From BL-MDN-PROF.'.                       02384099
023000     05  LIT-BYP-NOT-IN-BILLING          PIC X(25)                02385099
023010         VALUE 'Bypassed Not in Billing  '.                       02386099
023020     05  LIT-UPD-PENDDASG-R-NOT-IN-BILL.                          02387099
023030         10 F                            PIC X(21) VALUE          02388099
023040         'SENT ASGN TO BILLER: '.                                 02389099
023050         10 LIT-UPD-PENDDASG-R-BILLER    PIC X.                   02390099
023060                                                                  02391099
023070     05  LIT-DYNAMIC-STATUS-COMMENT.                              02392099
023080         10 F                            PIC X(11)  VALUE         02393099
023090               'UPDATED TO '.                                     02394099
023100         10 COMMENT-STATUS               PIC X(2)   VALUE SPACE.  02395099
023110         10 F                            PIC X(12)  VALUE         02396099
023120               ':NOT IN BILL'.                                    02397099
023130*--* #850803-2 LMS 4/21/2003 BEGIN                                02398099
023140     05  LIT-NGP-NOMATCH              PIC X(25)                   02399099
023150         VALUE 'NGPs Do Not Match       '.                        02400099
023160     05  LIT-MIN-UPDATE-ERROR         PIC X(25)                   02401099
023170         VALUE 'MIN UPDATE FAILED       '.                        02402099
023180     05  LIT-MKT-MIN-LR-ERROR         PIC X(25)                   02403099
023190         VALUE 'Market-Min-Lr Access Err'.                        02404099
023200     05  LIT-MKT-NPA-NXX-LR-ERROR     PIC X(25)                   02405099
023210         VALUE 'Market-Npa-Nxx-Lr    Err'.                        02406099
023220     05  WS-MULTIPLE-HUB-ERRORS-EXIST PIC X(25)                   02407099
023230         VALUE 'Multiple HUB Errors     '.                        02408099
023240     05  LIT-NOT-DELETED-COMMENT      PIC X(25)                   02409099
023250         VALUE 'NOT DELT: PORT IND PO/PI'.                        02410099
023260     05  LIT-NOT-UPDATED-COMMENT      PIC X(25)                   02411099
023270         VALUE 'NOT UPDT: PORT IND PO/PI'.                        02412099
023280*--* #850803-2 LMS 4/21/2003 end                                  02413099
023290     05  LIT-UPDATED-STATUS-COMMENT   PIC X(25)                   02414099
023300         VALUE 'UPDATED STATUS: NO BILL '.                        02415099
023310     05  LIT-UPDATE-ERROR             PIC X(25)                   02416099
023320         VALUE 'UPDATE ERR:SEE ERROR RPT'.                        02417099
023330     05  LIT-CTN-INV-ERROR            PIC X(25)                   02418099
023340         VALUE 'CTN-INV RECORD NOT FOUND'.                        02419099
023350     05  LIT-CTN-INV-INSERT-ERROR     PIC X(25)                   02420099
023360         VALUE 'CTN-INV DUP INSERT ERROR'.                        02421099
023370     05  LIT-CTN-INV-INSERT-ERROR-NIE PIC X(25)                   02422099
023380         VALUE 'CTNINV DUP INS ERR-N I E'.                        02423099
023390     05  LIT-CTN-HIST-INSERT-ERROR    PIC X(25)                   02424099
023400         VALUE 'CTN-HIST DUP INS:NOT DLTD'.                       02425099
023410     05  LIT-CTN-HIST-ETNDC15-ERROR   PIC X(25)                   02426099
023420         VALUE 'ETNDC15 FAIL: HIST INSERT'.                       02427099
023430     05  LIT-CTN-HIST-ETNDC38-ERROR   PIC X(25)                   02428099
023440         VALUE 'ETNDC38 FAIL: GET BILLER '.                       02429099
023450     05  LIT-BILLER-ERROR             PIC X(25)                   02430099
023460         VALUE 'BILLER IDS DO NOT MATCH '.                        02431099
023470     05  LIT-LERG6-ERROR              PIC X(25)                   02432099
023480         VALUE 'ERROR: NOT IN LERG6     '.                        02433099
023490     05  LIT-NL-ERROR                 PIC X(25)                   02434099
023500         VALUE 'NUMBER LOCTN NOT FOUND  '.                        02435099
023510     05  LIT-NGP-ERROR                PIC X(25)                   02436099
023520         VALUE 'NGP NOT FOUND           '.                        02437099
023530     05  LIT-NGP-NL-ERROR             PIC X(25)                   02438099
023540         VALUE 'NGP NL ASSGN NOT FOUND  '.                        02439099
023550     05  LIT-STATUS-NGP-COUNTER-ERROR PIC X(25)                   02440099
023560         VALUE 'NGP COUNTERS NOT FOUND  '.                        02441099
023570**   05  LIT-STATUS-NGP-NL-PTYP-ERROR PIC X(25)                   02442099
023580**       VALUE 'NGP NL ASSGN PTYP NOTFND'.                        02443099
023590     05  LIT-TRANS-DATE-ERROR         PIC X(25)                   02444099
023600         VALUE 'INVALID LAST TRANS DATE '.                        02445099
023610     05  LIT-TRANS-CODE-ERROR         PIC X(25)                   02446099
023620         VALUE 'INVALID LAST TRANS CODE '.                        02447099
023630     05  LIT-TRANS-STAT-ERROR         PIC X(25)                   02448099
023640         VALUE 'INVALID LAST TRX CD/STAT'.                        02449099
023650     05  LIT-STATUS-ERROR             PIC X(25)                   02450099
023660         VALUE 'Invalid Status          '.                        02451099
023670     05  LIT-STATUS-ERROR-ETNI        PIC X(25)                   02452099
023680         VALUE 'Inv Status & Not in eTNI'.                        02453099
023690     05  LIT-HOLD-REASON-ERROR        PIC X(25)                   02454099
023700         VALUE 'INVALID HOLD REASON     '.                        02455099
023710     05  LIT-MIN-NUM-NOTFND           PIC X(25)                   02456099
023720         VALUE 'MIN-INV MIN NOT FOUND   '.                        02457099
023730     05  LIT-MIN-NUM-IN-CTN           PIC X(25)                   02458099
023740         VALUE 'MIN ALREADY IN CTN-INV  '.                        02459099
023750     05  LIT-MIN-NUM-NOTFND-S         PIC X(25)                   02460099
023760         VALUE 'MIN-INV NOTFND - STS UPD'.                        02461099
023770     05  LIT-PORT-IND-ERROR           PIC X(25)                   02462099
023780         VALUE 'INVALID PORT IND        '.                        02463099
023790     05  LIT-PORT-IND-CHANGE-ERROR    PIC X(25)                   02464099
023800         VALUE 'PORT-IND UPDT DISALLOWED '.                       02465099
023810     05  LIT-OLD-PORT-KEPT.                                       02466099
023820         10 F                         PIC X(8) VALUE ' KEPT: "'.  02467099
023830         10 OLD-PORT-IND-KEPT-PORT    PIC X(2).                   02468099
023840         10 F                         PIC X    VALUE '"'.         02469099
023850     05  LIT-PORT-IND-CHANGE-ALLOW    PIC X(25)                   02470099
023860         VALUE 'PORT-IND UPDT ALLOWED    '.                       02471099
023870     05  LIT-PORT-IND-NGP-NOMATCH     PIC X(25)                   02472099
023880         VALUE 'PORT-IND NOMATCH         '.                       02473099
023890     05  LIT-OLD-PORT-CHANGED.                                    02474099
023900         10 F                         PIC X(1) VALUE ' '.         02475099
023910         10 NEW-PORT-IND-CHANGED      PIC X(2).                   02476099
023920         10 F                         PIC X(3) VALUE ' > '.       02477099
023930         10 OLD-PORT-IND-CHANGED      PIC X(2).                   02478099
023940         10 F                         PIC X(1) VALUE ' '.         02479099
023950     05  LIT-ETNI-PORTED-PO-ERROR     PIC X(25)                   02480099
023960         VALUE 'ETNI PORTED OUT WITH PO: '.                       02481099
023970     05  LIT-ETNI-PORTED-IO-ERROR     PIC X(25)                   02482099
023980         VALUE 'ETNI PORTED OUT WITH IO: '.                       02483099
023990     05  LIT-PA-ERROR             PIC X(25)                       02484099
024000         VALUE 'BILLING Status ERROR PA: '.                       02485099
024010     05  LIT-NGP-BILLER-ERROR     PIC X(25)                       02486099
024020         VALUE 'Billing-Id NGP Error     '.                       02487099
024030     05  LIT-NGP-BILLER-ERROR1    PIC X(25)                       02488099
024040         VALUE 'Billing NGP Err-TNI =    '.                       02489099
024050     05  LIT-AA-ERROR             PIC X(25)                       02490099
024060         VALUE 'BILLING Status ERROR AA: '.                       02491099
024070     05  LIT-V-TO-V-BILLER-ID-UPD PIC X(25)                       02492099
024080         VALUE 'Vision -to- Vision Upds: '.                       02493099
024090     05  LIT-V-TO-V-STATUS-ERROR  PIC X(25)                       02494099
024100         VALUE 'Vision Status Err XXXX : '.                       02495099
024110     05  LIT-V-TO-R-BILLER-ID-UPD PIC X(25)                       02496099
024120         VALUE 'Vision -to- RSS Upds:    '.                       02497099
024130     05  LIT-V-TO-O-BILLER-ID-UPD PIC X(25)                       02498099
024140         VALUE 'Vision -to- OPC Upds:    '.                       02499099
024150     05  LIT-ETNI-PO-PO               PIC X(8) VALUE ' PO/PO'.    02500099
024160     05  LIT-ETNI-PO-IO               PIC X(8) VALUE ' PO/IO'.    02501099
024170     05  LIT-BILLER-AA-PI             PIC X(8) VALUE ' AA/PI'.    02502099
024180                                                                  02503099
024190     05  LIT-ETNI-TO-FROM-PP-IND.                                 02504099
024200         10 F                         PIC X(6) VALUE 'FROM "'.    02505099
024210         10 LIT-ETNI-FROM-PP-IND      PIC X.                      02506099
024220         10 F                         PIC X(6) VALUE '" TO "'.    02507099
024230         10 LIT-ETNI-TO-PP-IND        PIC X.                      02508099
024240         10 F                         PIC X    VALUE '"'.         02509099
024250                                                                  02510099
024260     05  LIT-NOT-NUMERIC-ERROR        PIC X(25)                   02511099
024270         VALUE 'INVALID/NOT NUMERIC     '.                        02512099
024280     05  LIT-NOT-IN-BILLING-FEED      PIC X(25)                   02513099
024290         VALUE 'WARNING NOT IN BILLING  '.                        02514099
024300     05  LIT-HELD-CONTRACT-RSV        PIC X(25)                   02515099
024310         VALUE 'BYPASS:HELD OR CNTRACT R'.                        02516099
024320     05  LIT-ADDED-FROM-BILLING       PIC X(25)                   02517099
024330         VALUE 'CTN Row Added Per Billing'.                       02518099
024340     05  LIT-BILL-ETNINH-ERROR        PIC X(25)                   02519099
024350         VALUE 'BILL TO ETNI-NH:BYPSD'.                           02520099
024360     05  LIT-PRODUCT-TYPE-MISMATCH    PIC X(25)                   02521099
024370         VALUE 'PRODUCT TYPE MISMATCH   '.                        02522099
024380     05  LIT-NGP-NOT-FOUND            PIC X(25)                   02523099
024390         VALUE 'NGP NOT FOUND IN TABLE  '.                        02524099
024400     05  LIT-NGP-IS-EMPTY             PIC X(25)                   02525099
024410         VALUE 'NGP WAS EMPTY/BLANK     '.                        02526099
024420                                                                  02527099
024430**   JA1109  - 4G                                                 02528099
024440                                                                  02529099
024450     05  LIT-SIM-MDN-MISMATCH         PIC X(25)                   02530099
024460         VALUE 'eTNI / SIM MDN MISMATCH '.                        02531099
024470     05  LIT-SIM-STATUS-MISMATCH      PIC X(25)                   02532099
024480         VALUE 'eTNI/SIM STATUS MISMATCH'.                        02533099
024490     05  LIT-SIM-ICCID-MISMATCH       PIC X(25)                   02534099
024500         VALUE 'eTNI/SIM ICC-ID MISMATCH'.                        02535099
024510     05  LIT-4G-NL-MISMATCH-RESELLER  PIC X(25)                   02536099
024520         VALUE 'NL MISMATCH For Reseller'.                        02537099
024530     05  LIT-VORA-STATUS-MISMATCH     PIC X(25)                   02538099
024540         VALUE 'VORA STATUS MISMATCH    '.                        02539099
024550     05  LIT-VORA-IMSI-MISMATCH       PIC X(25)                   02540099
024560         VALUE 'VORA IMSI MISMATCH      '.                        02541099
024570     05  LIT-BILL-ETNI-IMSI-MISMATCH  PIC X(25)                   02542099
024580         VALUE 'Bill / eTNI IMSI Error  '.                        02543099
024590     05  LIT-BILL-ETNI-SIM-MISMATCH   PIC X(25)                   02544099
024600         VALUE 'Bill/eTNI SIM Err - Bill'.                        02545099
024610     05  LIT-ETNI-BILL-SIM-MISMATCH   PIC X(25)                   02546099
024620         VALUE 'eTNI/Bill SIM Err - eTNI'.                        02547099
024630     05  LIT-UNKNOWN-SIM-MISMATCH     PIC X(25)                   02548099
024640         VALUE 'UnKnown Bill/eTNI SIM Er'.                        02549099
024650     05  LIT-SIM-VORA-ERROR           PIC X(25)                   02550099
024660         VALUE 'SIM-or-VORA not in eTNI '.                        02551099
024670     05  LIT-TOTL-CDVC-GENERATED      PIC X(25)                   02552099
024680         VALUE 'Total  CDVCs  Generated '.                        02553099
024690                                                                  02554099
024700     05  LIT-TOTL-IUD-MQ              PIC X(25)                   02555099
024710         VALUE 'Total  Insert.Upd.Del.Mq'.                        02556099
024720                                                                  02557099
024730     05  LIT-TOTL-CHKPT               PIC X(25)                   02558099
024740         VALUE 'Total  Insert.Update-Ckp'.                        02559099
024750                                                                  02560099
024760     05  LIT-CDVC-GENERATED           PIC X(25)                   02561099
024770         VALUE 'CDVC  Generated         '.                        02562099
024780                                                                  02563099
024790     05  LIT-TN-MINS-NOT-BOTH-HUB     PIC X(25)                   02564099
024800         VALUE 'BOTH TNs  NOT HUB MIN"s '.                        02565099
024810     05  LIT-TN-MINS-ARE-HUB          PIC X(25)                   02566099
024820         VALUE 'Reseller HUB Min Error   '.                       02567099
024830     05  LIT-TN-MINS-BILL-NOT-HUB     PIC X(25)                   02568099
024840         VALUE 'Billing MIN is Not HUB"s '.                       02569099
024850                                                                  02570099
024860     05  LIT-TN-MINS-ETNI-NOT-HUB     PIC X(25)                   02571099
024870         VALUE 'ETNI  MIN is Not HUB"s   '.                       02572099
024880                                                                  02573099
024890     05  LIT-TN-NH-NOT-UPDATED-HUB     PIC X(25)                  02574099
024900         VALUE 'NH Update Not Allowed    '.                       02575099
024910                                                                  02576099
024920     05  LIT-NOT-IN-ETNI              PIC X(25)                   02577099
024930         VALUE 'NOT In  ETNI & Not  PI   '.                       02578099
024940                                                                  02579099
024950     05  LIT-UPDATED-TO-AA            PIC X(25)                   02580099
024960         VALUE 'Updated HUB To AA Status'.                        02581099
024970                                                                  02582099
024980     05  LIT-ERROR-AI                 PIC X(25)                   02583099
024990         VALUE 'No Billing data, AI eTNI'.                        02584099
025000                                                                  02585099
025010     05  LIT-RSS-NL-1ST-TO-BILL-ID.                               02586099
025020         10 F                         PIC X(3) VALUE 'NL '.       02587099
025030         10 LIT-RSS-NL                PIC X(5).                   02588099
025040         10 F                         PIC X(16) VALUE             02589099
025050         ' Wrong for Bilr '.                                      02590099
025060         10 LIT-RSS-BILLER            PIC X.                      02591099
025070                                                                  02592099
025080     05  LIT-SIM-UPD                  PIC X(25)                   02593099
025090         VALUE 'SIM UPDATED              '.                       02594099
025080     05  LIT-DUPE-BILLER-ID           PIC X(25)                   02595099
025090         VALUE 'MDN BELONGS TO DIFF BILR '.                       02596099
025100                                                                  02597099
025110     05  LIT-BYPASS-SPLIT            PIC X(25)                    02598099
025120         VALUE 'BYPASSED Due to Split    '.                       02599099
025130                                                                  02600099
025140     05  LIT-ETNI                     PIC X(11) VALUE             02601099
025150                                     'ETNI ====> '.               02602099
025160                                                                  02603099
025170     05  LIT-BILLER                   PIC X(11) VALUE             02604099
025180                                     'BILLER ==> '.               02605099
025190                                                                  02606099
025200     05  WS-CC-VALUES.                                            02607099
025210         10  WS-CC-PAGE               PIC X(01)  VALUE '1'.       02608099
025220         10  WS-CC-1-LINE             PIC X(01)  VALUE ' '.       02609099
025230         10  WS-CC-2-LINES            PIC X(01)  VALUE '0'.       02610099
025240         10  WS-CC-3-LINES            PIC X(01)  VALUE '-'.       02611099
025250     05  YES-VALUE                    PIC X(01)  VALUE 'Y'.       02612099
025260     05  NO-VALUE                     PIC X(01)  VALUE 'N'.       02613099
025270     05  SEQIO-LITS.                                              02614099
025280         10  SEQCHKPT                 PIC S9(04) COMP VALUE +00.  02615099
025290         10  SEQCLOSE                 PIC S9(04) COMP VALUE +01.  02616099
025300         10  SEQOPENI                 PIC S9(04) COMP VALUE +02.  02617099
025310         10  SEQOPENO                 PIC S9(04) COMP VALUE +03.  02618099
025320         10  SEQREAD                  PIC S9(04) COMP VALUE +04.  02619099
025330         10  SEQINIT                  PIC S9(04) COMP VALUE +05.  02620099
025340         10  SEQRESTRT                PIC S9(04) COMP VALUE +06.  02621099
025350         10  SEQWRITE                 PIC S9(04) COMP VALUE +07.  02622099
025360     05  SEQ-RETURN-CODE-DATA.                                    02623099
025370         10  SEQ-RET-CODE             PIC S9(08) COMP.            02624099
025380             88  SEQ-SUCCESS          VALUE ZERO.                 02625099
025390             88  SEQ-END-OF-FILE                                  02626099
025400                 VALUES +004, +104, +204, +304, +404,             02627099
025410                        +504, +604, +704, +804, +904.             02628099
025420             88  SEQ-READ-PAST-EOF    VALUE +410.                 02629099
025430             88  SEQ-REPOS-CLOSED     VALUE +608.                 02630099
025440             88  SEQ-BUFF-SIZE-DIFF   VALUE +610.                 02631099
025450             88  SEQ-SYSOUT-START     VALUE +612.                 02632099
025460             88  SEQ-RSTRT-FILE-NOT-READ VALUE +614.              02633099
025470             88  SEQ-ERROR                                        02634099
025480                 VALUE +001 THRU +003                             02635099
025490                       +005 THRU +103                             02636099
025500                       +105 THRU +203                             02637099
025510                       +205 THRU +303                             02638099
025520                       +305 THRU +403                             02639099
025530                       +405 THRU +503                             02640099
025540                       +505 THRU +603                             02641099
025550                       +605 THRU +703                             02642099
025560                       +705 THRU +803                             02643099
025570                       +805 THRU +903                             02644099
025580                       +906 THRU +99999999.                       02645099
025590         10  SEQ-SUBR-RET-CODE        PIC S9(08) COMP.            02646099
025600         10  SEQ-CNTL-MAX-FILES       PIC S9(08) COMP             02647099
025610                                      VALUE +128.                 02648099
025620         10  SEQ-FUNCTION             PIC S9(04) COMP.            02649099
025630                                                                  02650099
025640 01  WS-ACCUM-LITERAL                 PIC X(40) VALUE             02651099
025650     'ACCUMULATOR VARIABLES STARTS HERE ====>'.                   02652099
025660                                                                  02653099
025670 01  FILE-STATUSES.                                               02654099
025680     05 ERROROUT2-STATUS                PIC X(2)   VALUE SPACE.   02655099
025690     05 ERROROUT3-STATUS                PIC X(2)   VALUE SPACE.   02656099
025700     05 ERROROUT4-STATUS                PIC X(2)   VALUE SPACE.   02657099
025710     05 TRAILER-STATUS                  PIC X(2)   VALUE SPACE.   02658099
025720                                                                  02659099
025730 01  WS-ACCUMULATORS.                                             02660099
025740     05  WS-TOTL-BILL-RECS-READ         PIC S9(09) COMP           02661099
025750                                                   VALUE +0.      02662099
025760     05  WS-TOTL-BILL-HUB-DETECTED      PIC S9(09) COMP           02663099
025770                                                   VALUE +0.      02664099
025780     05  WS-TOTL-ETNI-HUB-DETECTED      PIC S9(09) COMP           02665099
025790                                                   VALUE +0.      02666099
025800     05  WS-TOTL-MKT-NPANXX-ERR         PIC S9(09) COMP           02667099
025810                                                   VALUE +0.      02668099
025820     05  WS-TOTL-BYPASS-SPLIT           PIC S9(09) COMP           02669099
025830                                                   VALUE +0.      02670099
025840     05  WS-TOTL-BL-MDN-PROFILE-DEL     PIC S9(09) COMP           02671099
025850                                                   VALUE +0.      02672099
025860     05  WS-TOTL-BYPASS-NOT-IN-BILLING  PIC S9(09) COMP           02673099
025870                                                   VALUE +0.      02674099
025880     05  WS-TOTL-HUB-ERRORS-THIS-TRANS  PIC S9(09) COMP           02675099
025890                                                   VALUE +0.      02676099
025900     05  WS-TOTL-HUB-ERRORS             PIC S9(09) COMP           02677099
025910                                                   VALUE +0.      02678099
025920     05  WS-TOTL-HUB-MATCHES            PIC S9(09) COMP           02679099
025930                                                   VALUE +0.      02680099
025940     05  WS-TOTL-HUB-MULTI-ERRORS       PIC S9(09) COMP           02681099
025950                                                   VALUE +0.      02682099
025960     05  WS-TOTL-HUB-MIN-ERRORS        PIC S9(09) COMP            02683099
025970                                                   VALUE +0.      02684099
025980     05  WS-TOTL-HUB-MIN-ERRORS-ETNI   PIC S9(09) COMP            02685099
025990                                                   VALUE +0.      02686099
026000     05  WS-TOTL-NH-HUB-ERRORS         PIC S9(09) COMP            02687099
026010                                                   VALUE +0.      02688099
026020     05  WS-TOTL-HUB-MIN-ERRORS-BILL   PIC S9(09) COMP            02689099
026030                                                   VALUE +0.      02690099
026040     05  WS-TOTL-HUB-ADD-ETNI-PER-BILL PIC S9(09) COMP            02691099
026050                                                   VALUE +0.      02692099
026060     05  WS-TOTL-HUB-UPDATED-TO-AA     PIC S9(09) COMP            02693099
026070                                                   VALUE +0.      02694099
026080     05  WS-TOTL-HUB-ERROR-AI          PIC S9(09) COMP            02695099
026090                                                   VALUE +0.      02696099
026100     05  WS-TOTL-HUB-STATUS-ERROR      PIC S9(09) COMP            02697099
026110                                                   VALUE +0.      02698099
026120     05  WS-TOTL-NOT-IN-ETNI            PIC S9(09) COMP           02699099
026130                                                   VALUE +0.      02700099
026140     05  WS-TOTL-RESELLER-HUB-ERROR     PIC S9(09) COMP           02701099
026150                                                   VALUE +0.      02702099
026160     05  WS-TOTL-ETNI-MININV-ERRS       PIC S9(09) COMP           02703099
026170                                                   VALUE +0.      02704099
026180     05  WS-TOTL-MKT-MIN-LR-ERR         PIC S9(09) COMP           02705099
026190                                                   VALUE +0.      02706099
026200     05  WS-TOTL-ETNI-RECS-READ         PIC S9(09) COMP           02707099
026210                                                   VALUE +0.      02708099
026220     05  WS-TOTL-BILL-ETNI-MATCH-CNT    PIC S9(09) COMP           02709099
026230                                                   VALUE +0.      02710099
026240     05  WS-TOTL-BILL-ETNI-MATCH-NEW    PIC S9(09) COMP           02711099
026250                                                   VALUE +0.      02712099
026260     05  WS-TOTL-BILL-ETNI-MATCH-PP     PIC S9(09) COMP           02713099
026270                                                   VALUE +0.      02714099
026280     05  WS-TOTL-BILL-ETNI-MATCH-NH     PIC S9(09) COMP           02715099
026290                                                   VALUE +0.      02716099
026300     05  WS-TOTL-BILL-ETNI-MATCH-OK     PIC S9(09) COMP           02717099
026310                                                   VALUE +0.      02718099
026320     05  WS-TOTL-PP-BLANK-MATCH-ALL     PIC S9(09) COMP           02719099
026330                                                   VALUE +0.      02720099
026340     05  WS-TOTL-BILL-ETNI-DIFF-CNT     PIC S9(09) COMP           02721099
026350                                                   VALUE +0.      02722099
026360     05  WS-TOTL-BILL-NOT-IN-ETNI-CNT   PIC S9(09) COMP           02723099
026370                                                   VALUE +0.      02724099
026380     05  WS-TOTL-BILL-NOT-IN-ETNI-NEW   PIC S9(09) COMP           02725099
026390                                                   VALUE +0.      02726099
026400     05  WS-TOTL-BILL-NOT-IN-ETNI-PROC  PIC S9(09) COMP           02727099
026410                                                   VALUE +0.      02728099
026420     05  WS-TOTL-ETNI-NOT-IN-BILL-CNT   PIC S9(09) COMP           02729099
026430                                                   VALUE +0.      02730099
026440     05  WS-PO-IN-ETNI-NOT-IN-BILL      PIC S9(09) COMP           02731099
026450                                                   VALUE +0.      02732099
026460     05  WS-TOTL-ETNI-NOT-IN-BILL-NEW   PIC S9(09) COMP           02733099
026470                                                   VALUE +0.      02734099
026480     05  WS-TOTL-ETNI-NOT-IN-BILL-PROC  PIC S9(09) COMP           02735099
026490                                                   VALUE +0.      02736099
026500     05  WS-TOTL-ETNI-NA-NH-CNT         PIC S9(09) COMP           02737099
026510                                                   VALUE +0.      02738099
026520     05  WS-TOTL-ETNI-MININV-UPD-CNT    PIC S9(09) COMP           02739099
026530                                                   VALUE +0.      02740099
026540     05  WS-TOTL-ETNI-MININV-UPD-ST-CNT PIC S9(09) COMP           02741099
026550                                                   VALUE +0.      02742099
026560     05  WS-TOTL-ETNI-CTNINV-UPD-CNT    PIC S9(09) COMP           02743099
026570                                                   VALUE +0.      02744099
026580     05  WS-TOTL-ETNI-CTNINV-UPD-ST-CNT     PIC S9(09) COMP       02745099
026590                                                   VALUE +0.      02746099
026600     05  WS-TOTL-ETNI-CTNINV-INS-CNT    PIC S9(09) COMP           02747099
026610                                                   VALUE +0.      02748099
026620     05  WS-TOTL-ETNI-CTNINV-DUPINS     PIC S9(09) COMP           02749099
026630                                                   VALUE +0.      02750099
026640     05  WS-TOTL-ETNI-CTNINV-DLT-CNT    PIC S9(09) COMP           02751099
026650                                                   VALUE +0.      02752099
026660     05  WS-TOTL-ETNI-CTNHIST-INS-CNT   PIC S9(09) COMP           02753099
026670                                                   VALUE +0.      02754099
026680     05  WS-TOTL-ETNI-CTNHIST-DUPINS    PIC S9(09) COMP           02755099
026690                                                   VALUE +0.      02756099
026700     05  WS-TOTL-BAD-CALLS-TO-ETNDC15   PIC S9(09) COMP           02757099
026710                                                   VALUE +0.      02758099
026720     05  WS-TOTL-ETNI-NGPCNTS-UPD-CNT   PIC S9(09) COMP           02759099
026730                                                   VALUE +0.      02760099
026740     05  WS-TOTL-ETNI-NGPNLAS-UPD-CNT   PIC S9(09) COMP           02761099
026750                                                   VALUE +0.      02762099
026760     05  WS-TOTL-ERROR-CNT              PIC S9(09) COMP           02763099
026770                                                   VALUE +0.      02764099
026780     05  WS-TOTL-ERROR-CNT-HUB          PIC S9(09) COMP           02765099
026790                                                   VALUE +0.      02766099
026800     05  WS-TOTL-ERROR-CTNINV-NOTFND    PIC S9(09) COMP           02767099
026810                                                   VALUE +0.      02768099
026820     05  WS-TOTL-ERROR-CTNINV-DUPINS    PIC S9(09) COMP           02769099
026830                                                   VALUE +0.      02770099
026840     05  WS-TOTL-ERROR-CTNHIST-DUPINS   PIC S9(09) COMP           02771099
026850                                                   VALUE +0.      02772099
026860     05  WS-TOTL-ERROR-BILLER-NOTMTCH   PIC S9(09) COMP           02773099
026870                                                   VALUE +0.      02774099
026880     05  WS-TOTL-ERROR-LERG6-NOTFND     PIC S9(09) COMP           02775099
026890                                                   VALUE +0.      02776099
026900     05  WS-TOTL-ERROR-NUMLOC-NOTFND    PIC S9(09) COMP           02777099
026910                                                   VALUE +0.      02778099
026920     05  WS-TOTL-ERROR-NUMGRP-NOTFND    PIC S9(09) COMP           02779099
026930                                                   VALUE +0.      02780099
026940     05  WS-TOTL-ERROR-GRPLOC-NOTFND    PIC S9(09) COMP           02781099
026950                                                   VALUE +0.      02782099
026960     05  WS-TOTL-ERROR-NGPCNT-NOTFND    PIC S9(09) COMP           02783099
026970                                                   VALUE +0.      02784099
026980     05  WS-TOTL-ERROR-NGPNL-NOTFND     PIC S9(09) COMP           02785099
026990                                                   VALUE +0.      02786099
027000     05  WS-TOTL-ERROR-DATE-INVALID     PIC S9(09) COMP           02787099
027010                                                   VALUE +0.      02788099
027020     05  WS-TOTL-ERROR-TRX-CODE-NOTFND  PIC S9(09) COMP           02789099
027030                                                   VALUE +0.      02790099
027040     05  WS-TOTL-ERROR-TRX-STAT-NOTFND  PIC S9(09) COMP           02791099
027050                                                   VALUE +0.      02792099
027060     05  WS-TOTL-ERROR-STATUS-INVALID   PIC S9(09) COMP           02793099
027070                                                   VALUE +0.      02794099
027080     05  WS-TOTL-ERROR-HOLD-REASON      PIC S9(09) COMP           02795099
027090                                                   VALUE +0.      02796099
027100     05  WS-TOTL-ERROR-MIN-NUM-NOTFND   PIC S9(09) COMP           02797099
027110                                                   VALUE +0.      02798099
027120     05  WS-TOTL-ERROR-MIN-NUM-IN-CTN   PIC S9(09) COMP           02799099
027130                                                   VALUE +0.      02800099
027140     05  WS-TOTL-ERROR-MIN-NUM-NOTFND-S PIC S9(09) COMP           02801099
027150                                                   VALUE +0.      02802099
027160     05  WS-TOTL-ERROR-PORT-IND-CHANGED PIC S9(09) COMP           02803099
027170                                                   VALUE +0.      02804099
027180     05  WS-TOTL-ERROR-PORT-IND-NOT-CHG PIC S9(09) COMP           02805099
027190                                                   VALUE +0.      02806099
027200*** #870803 SDL BEGIN                                             02807099
027210     05  WS-TOTL-ERROR-PRDTYP-MISMATCH  PIC S9(09) COMP           02808099
027220                                                   VALUE +0.      02809099
027230*** #870803 SDL END                                               02810099
027240*** #071503 KIN BEGIN                                             02811099
027250     05  WS-TOTL-ERROR-RSS-BILL-NL-BYP  PIC S9(09) COMP           02812099
027260                                                   VALUE +0.      02813099
027270*** #071503 KIN END                                               02814099
027280                                                                  02815099
027290     05  WS-TOTL-ERROR-NOT-NUMERIC      PIC S9(09) COMP           02816099
027300                                                   VALUE +0.      02817099
027310     05  WS-TOTL-CNTRLRPT-CNT           PIC S9(09) COMP           02818099
027320                                                   VALUE +0.      02819099
027330     05  WS-TOTL-ERROR-POPO-MISMATCH    PIC S9(09) COMP           02820099
027340                                                   VALUE +0.      02821099
027350     05  WS-TOTL-ERROR-POIO-MISMATCH    PIC S9(09) COMP           02822099
027360                                                   VALUE +0.      02823099
027370     05  WS-TOTL-ERROR-DUPE-BILLER      PIC S9(09) COMP           02824099
027380                                                   VALUE +0.      02825099
027390     05  WS-TOTL-V-TO-V-BILLER-UPD      PIC S9(09) COMP           02826099
027400                                                   VALUE +0.      02827099
027410     05  WS-TOTL-V-TO-R-BILLER-UPD      PIC S9(09) COMP           02828099
027420                                                   VALUE +0.      02829099
027430     05  WS-TOTL-ERROR-NGP-NOT-FOUND    PIC S9(09) COMP           02830099
027440                                                   VALUE +0.      02831099
027450     05  WS-TOTL-ERROR-NGP-ARE-EMPTY    PIC S9(09) COMP           02832099
027460                                                   VALUE +0.      02833099
027470     05  WS-TOTL-ERROR-PA-ERROR         PIC S9(09) COMP           02834099
027480                                                   VALUE +0.      02835099
027490     05  WS-SAVE-V-TO-V-BILLER-UPD      PIC S9(09) COMP           02836099
027500                                                   VALUE +0.      02837099
027510                                                                  02838099
027520     05  WS-SAVE-V-TO-R-BILLER-UPD      PIC S9(09) COMP           02839099
027530                                                   VALUE +0.      02840099
027540                                                                  02841099
027550     05  WS-SAVE-NGP-BILLER-ERROR       PIC S9(09) COMP           02842099
027560                                                   VALUE +0.      02843099
027570                                                                  02844099
027580     05  WS-TOTL-NGP-BILLER-ERROR       PIC S9(09) COMP           02845099
027590                                                   VALUE +0.      02846099
027600                                                                  02847099
027610     05  WS-TOTL-ERROR-AA               PIC S9(09) COMP           02848099
027620                                                   VALUE +0.      02849099
027630                                                                  02850099
027640*    05  WS-TOTL-ETNI-H-NL              PIC 9(9)   VALUE 0.       02851099
027650                                                                  02852099
027660**  JA1109  -  4G                                                 02853099
027670                                                                  02854099
027680     05  WS-TOTL-CDVC-GENERATED         PIC 9(9)   VALUE 0.       02855099
027690                                                                  02856099
027700     05  WS-TOTL-SIM-MDN-ERR            PIC 9(9)   VALUE 0.       02857099
027710     05  WS-TOTL-SIM-ICCID-ERR          PIC 9(9)   VALUE 0.       02858099
027720     05  WS-TOTL-SIM-STATUS-ERR         PIC 9(9)   VALUE 0.       02859099
027730     05  WS-TOTL-SIM-VORA-ERR           PIC 9(9)   VALUE 0.       02860099
027740     05  WS-TOTL-VORA-IMSI-ERR          PIC 9(9)   VALUE 0.       02861099
027750     05  WS-TOTL-VORA-STATUS-ERR        PIC 9(9)   VALUE 0.       02862099
027760     05  WS-TOTL-NL-MISMATCH-RESELLER   PIC 9(9)   VALUE 0.       02863099
027770     05  WS-T-BILL-ETNI-IMSI-MISMATCH   PIC 9(9)   VALUE 0.       02864099
027780     05  WS-T-BILL-ETNI-SIM-MISMATCH    PIC 9(9)   VALUE 0.       02865099
027790                                                                  02866099
027800     05  WS-LINE-CTR-RECON              PIC 9(2)   VALUE 56.      02867099
027810     05  WS-LINE-CTR-ERROR              PIC 9(2)   VALUE 56.      02868099
027820     05  WS-LINE-CTR-RECON-HUB          PIC 9(2)   VALUE 56.      02869099
027830     05  WS-LINE-CTR-ERROR-HUB          PIC 9(2)   VALUE 56.      02870099
027840     05  WS-LINE-CTR-ERROR-PREPAID      PIC 9(2)   VALUE 56.      02871099
027850     05  WS-LINE-CTR-ERROR-PO           PIC 9(2)   VALUE 56.      02872099
027860     05  WS-LINE-CTR-CNTRLRPT           PIC 9(2)   VALUE 56.      02873099
027870     05  WS-PAGE-CTR-RECON              PIC 9(3)   VALUE 0.       02874099
027880     05  WS-PAGE-CTR-ERROR              PIC 9(3)   VALUE 0.       02875099
027890     05  WS-PAGE-CTR-RECON-HUB          PIC 9(3)   VALUE 0.       02876099
027900     05  WS-PAGE-CTR-ERROR-HUB          PIC 9(3)   VALUE 0.       02877099
027910     05  WS-PAGE-CTR-ERROR-PREPAID      PIC 9(3)   VALUE 0.       02878099
027920     05  WS-PAGE-CTR-ERROR-PO           PIC 9(3)   VALUE 0.       02879099
027930     05  WS-PAGE-CTR-CNTRLRPT           PIC 9(3)   VALUE 0.       02880099
027940                                                                  02881099
027950 01  WS-MISC-LITERAL                  PIC X(40) VALUE             02882099
027960     'MISCELLANEOUS VARIABLES START HERE====>'.                   02883099
027970 01  FILLER.                                                      02884099
027980     10  WS-MDN-MATCH-CTN.                                        02885099
027990         15  WS-MDN-LENGTH-IND    PIC  S9(04) COMP  VALUE +10.    02886099
028000         15  WS-MDN               PIC  X(20)        VALUE SPACES. 02887099
027980     10  WS-MDN-LENGTH-10.                                        02888099
028000         15  WS-MDN-10            PIC  X(10)        VALUE SPACES. 02889099
028010                                                                  02890099
028020 01  WS-MISC-FIELDS.                                              02891099
028030     05  IS-THIS-I2K-INPUT              PIC X      VALUE SPACES.  02892099
028040     05  SAVE-IS-THIS-I2K-INPUT         PIC X      VALUE SPACES.  02893099
028050     05  WS-SAVE-BILLER-ID              PIC X(3)   VALUE SPACES.  02894099
028060     05  WS-SAVED-NL                    PIC X(5)   VALUE SPACES.  02895099
028070     05  WS-PGM-VERSION                 PIC X(20)  VALUE SPACES.  02896099
028080     05  WS-BILLER-ID                   PIC X(01)  VALUE SPACES.  02897099
028090     05  WS-SYSTEM                      PIC X(04)  VALUE SPACES.  02898099
028100     05  WS-CURR-PARA                   PIC X(40)  VALUE SPACES.  02899099
028110     05  SQL-STATUS-CODE                PIC S9(09) COMP-3.        02900099
028120         88  SQL-SUCCESS                VALUE +0.                 02901099
028130         88  SQL-ROW-NOT-FOUND          VALUE +100.               02902099
028140         88  SQL-NULL-IND-MISSING       VALUE -305.               02903099
028150         88  SQL-DUP-INSERT             VALUE -803.               02904099
028160         88  SQL-DUP-SELECT             VALUE -811.               02905099
028170*IR071503 - RSS BEG                                               02906099
028180     05  WS-SQLCODE                     PIC S9(09)  VALUE ZERO.   02907099
028190     05  WS-SQLCODE-DS                  PIC -----9.               02908099
028200*IR071503 - RSS END                                               02909099
028210     05  WS-RPT-MAX-LINES               PIC  9(2)   VALUE 55.     02910099
028220     05  WS-ABEND-TEXT                  PIC  X(80)  VALUE SPACES. 02911099
028230     05  WS-ABEND-TEXT-2                PIC  X(80)  VALUE SPACES. 02912099
028240     05  WS-ABEND-CODE                  PIC ---------9.           02913099
028250     05  WS-SUB                         PIC S9(06)  COMP-3.       02914099
028260     05  WS-QUO                         PIC  9(10)  VALUE 0.      02915099
028270     05  WS-REM                         PIC  9(10)  VALUE 0.      02916099
028280     05  WS-ZERO                        PIC S9(01)  COMP-3        02917099
028290                                                    VALUE +0.     02918099
028300     05  WS-EXIST-FLAG                  PIC S9(04) COMP VALUE 0.  02919099
028310     05  DIFF-BILLER-FLAG               PIC X      VALUE SPACE.   02920099
028320     05  WS-SKIPPED-FLAG                PIC X      VALUE SPACE.   02921099
028330     05  WS-CHECK-OLD-CTN-STATUS        PIC X(2)   VALUE SPACE.   02922099
028340     05  WS-CHECK-OLD-PORT-IND          PIC X(2)   VALUE SPACE.   02923099
028350     05  SHOULD-MIN-STATUS-BE-UPDATED   PIC X      VALUE SPACE.   02924099
028360     05  MODIFIED-MIN-STATUS            PIC X(2)   VALUE SPACE.   02925099
028370     05  FIRST-TIME-THRU                PIC X      VALUE 'Y'.     02926099
028380     05  WS-MDNIN-RECORD-TYPE           PIC X(01).                02927099
028390         88  WS-MDNIN-HEADER            VALUE '1'.                02928099
028400         88  WS-MDNIN-DETAIL            VALUE '5'.                02929099
028410         88  WS-MDNIN-TRAILER           VALUE '9'.                02930099
028420     05  WS-PHONE-NUM                   PIC X(10).                02931099
028430     05  FILLER REDEFINES WS-PHONE-NUM.                           02932099
028440         10  WS-NPA-NUM                 PIC  9(03).               02933099
028450         10  WS-NXX-NUM                 PIC  9(03).               02934099
028460         10  WS-LINE-NUM                PIC  X(04).               02935099
028470     05  WS-NPA-CMP                     PIC S9(3)V COMP-3.        02936099
028480     05  WS-NXX-CMP                     PIC S9(3)V COMP-3.        02937099
028490     05  WS-COMMENT                     PIC X(25).                02938099
028500*** #140804 LMS 05/21/2003 BEGIN                                  02939099
028510     05  WS-ADDTL-INFO                  PIC X(15).                02940099
028520*** #140804 LMS 05/21/2003 END                                    02941099
028530     05  WS-QTY                         PIC S9(9)V COMP-3         02942099
028540                                                   VALUE ZEROES.  02943099
028550     05  WS-QTY1                        PIC S9(9)V COMP-3         02944099
028560                                                   VALUE ZEROES.  02945099
028570     05  WS-MDN-HISTORY                 PIC  X(20) VALUE SPACES.  02946099
028580     05  WS-CTN-FOR-SYS-DATE            PIC  X(20) VALUE SPACES.  02947099
028590     05  SEARCH-MDN                     PIC  X(20) VALUE SPACES.  02948099
028600     05  SEARCH-BILLER-ID               PIC  X     VALUE SPACES.  02949099
028610     05  SEARCH-NL                      PIC  X(05) VALUE SPACES.  02950099
028620     05  SEARCH-CTN-STATUS              PIC  XX    VALUE SPACES.  02951099
028630     05  SEARCH-NGP                     PIC  XXX   VALUE SPACES.  02952099
028640     05  WS-NL                          PIC  X(05) VALUE SPACES.  02953099
028640     05  WS-NL-SAVED                    PIC  X(05) VALUE SPACES.  02954099
028650     05  WS-NGP                         PIC  X(03) VALUE SPACES.  02955099
028660     05  WS-PRODUCT-TYPE                PIC  X(01) VALUE SPACES.  02956099
028670     05  WS-TRANS-CODE                  PIC  X(03) VALUE SPACES.  02957099
028680                                                                  02958099
028690     05  WS-OLD-MIN-NUM                 PIC  X(10) VALUE SPACES.  02959099
028700     05  WS-OLD-STATUS                  PIC  X(02) VALUE SPACES.  02960099
028710     05  WS-OLD-NL                      PIC  X(05) VALUE SPACES.  02961099
028720     05  WS-OLD-NGP                     PIC  X(03) VALUE SPACES.  02962099
028730     05  WS-OLD-PRODUCT-TYPE            PIC  X(01) VALUE SPACES.  02963099
028740     05  WS-OLD-PORT-IND                PIC  X(02) VALUE SPACES.  02964099
028750                                                                  02965099
028760     05  WS-NEW-MIN-NUM                 PIC  X(10) VALUE SPACES.  02966099
028770     05  WS-NEW-STATUS                  PIC  X(02) VALUE SPACES.  02967099
028780     05  WS-NEW-NL                      PIC  X(05) VALUE SPACES.  02968099
028790     05  WS-NEW-NGP                     PIC  X(03) VALUE SPACES.  02969099
028800     05  WS-NEW-PRODUCT-TYPE            PIC  X(01) VALUE SPACES.  02970099
028810     05  WS-NEW-PORT-IND                PIC  X(02) VALUE SPACES.  02971099
028820                                                                  02972099
028830     05  WS-DELIMITER                   PIC  X(01) VALUE SPACES.  02973099
028840     05  WS-DELIMITER-VALUE             PIC  X(01) VALUE SPACES.  02974099
028850     05  WS-TEMP-MIN-NUM                PIC  9(10) VALUE ZEROES.  02975099
028860     05  WS-TEMP-MIN-NUM-TEXT           REDEFINES                 02976099
028870         WS-TEMP-MIN-NUM                PIC  X(10).               02977099
028880*--------#870803------------------------------------              02978099
028890     05  WS-MATCH-KEY-BILL.                                       02979099
028900         10  WS-MATCH-KEY-BILL-MDN      PIC  X(20).               02980099
028910     05  WS-MATCH-KEY-ETNI.                                       02981099
028920         10  WS-MATCH-KEY-ETNI-MDN      PIC  X(20).               02982099
028930                                                                  02983099
028940     05  WS-MATCH-KEY-BILL-MDN-SAVE     PIC  X(20).               02984099
028950     05  WS-MATCH-KEY-ETNI-MDN-SAVE     PIC  X(20).               02985099
028960                                                                  02986099
028970*--------#870803------------------------------------              02987099
028980     05  WS-LEAP-YEAR                   PIC 9(04) VALUE ZEROES.   02988099
028990     05  WS-REMAINDER                   PIC 9(04) VALUE ZEROES.   02989099
029000* START JBOLTON 11-08-02 NEW LIT FOR CALL TO ETNSC50. NEW         02990099
029010* SUBROUTINE FOR UPDATING AA-STS-CNT IN NPANXX-AVAIL TABLE        02991099
029020     05  WS-CTN-NUMERIC.                                          02992099
029030         10  WS-CTN-NUM-NPA           PIC 9(03).                  02993099
029040         10  WS-CTN-NUM-NXX           PIC 9(03).                  02994099
029050         10  WS-CTN-NUM-REST          PIC 9(14).                  02995099
029060                                                                  02996099
029070*** #870803 SDL BEGIN  FIELDS TO CONVERT NPANXX TO NUMERIC        02997099
029080                                                                  02998099
029090     05  WS-NPANXX                      PIC X(06).                02999099
029100     05  WS-NPANXX-NUMERIC REDEFINES WS-NPANXX                    03000099
029110                                        PIC 9(06).                03001099
029120                                                                  03002099
029130***    WHEN MDNIN PRODUCT TYPE DOESN'T MATCH CTNIN PRODUCT TYPE   03003099
029140***    AND THE NPANXX IS COMINGLED, MDNIN PRODUCT TYPE WILL BE    03004099
029150***    OVERLAID WITH CTNIN PRODUCT TYPE AND THE ORIGINAL MDNIN    03005099
029160***    PRODUCT TYPE WILL BE SAVED IN THIS FIELD                   03006099
029170                                                                  03007099
029180     05  WS-MDNIN-PRODUCT-TYPE-SAVE   PIC  X(01) VALUE SPACES.    03008099
029190*** #870803 SDL END                                               03009099
029200                                                                  03010099
029210     05  WS-MIN-SAME-AS-CTN-FLAG      PIC X.                      03011099
029220     05  HOLD-WS-COMMENT              PIC X(25).                  03012099
029230     05  HOLD-WS-ADDTL-INFO           PIC X(15).                  03013099
029240                                                                  03014099
029250 01  WS-ORIG-TRX-DATE.                                            03015099
029260     05 WS-ORIG-TRX-MM              PIC X(02).                    03016099
029270     05 WS-ORIG-TRX-DD              PIC X(02).                    03017099
029280     05 WS-ORIG-TRX-YYYY            PIC X(04).                    03018099
029290                                                                  03019099
029300 01  NUMERIC-CTNIN-CTN                PIC 9(10) VALUE ZERO.       03020099
029310                                                                  03021099
029320 01  HOST-ETNI-CTN.                                               03022099
029330     49 HOST-ETNI-CTN-LENGTH          PIC S9(4) USAGE COMP.       03023099
029340     49 HOST-ETNI-CTN-TEXT            PIC X(20).                  03024099
029350                                                                  03025099
029360 01  WS-CTN-W-DUPE-MIN.                                           03026099
029370     49 WS-CTN-W-DUPE-MIN-LENGTH      PIC S9(4) USAGE COMP.       03027099
029380     49 WS-CTN-W-DUPE-MIN-TEXT        PIC X(20).                  03028099
029390 01  FILLER.                                                      03029099
029400     10  WS-HUB-TEXT                  PIC  X(04)  VALUE  'HUB '.  03030099
029410                                                                  03031099
029420 01  FILLER.                                                      03032099
029430     10  WS-HUB-FLAG                  PIC  X(01)  VALUE  SPACES.  03033099
029440     88  WS-HUB                       VALUE  'Y'.                 03034099
029450     10  WS-HUB-BILL-FLAG             PIC  X(01)  VALUE  SPACES.  03035099
029460     88  WS-HUB-BILL                  VALUE  'Y'.                 03036099
029470     10  WS-HUB-ETNI-FLAG             PIC  X(01)  VALUE  SPACES.  03037099
029480     88  WS-HUB-ETNI                  VALUE  'Y'.                 03038099
029490     10  WS-SPLIT-FLAG                PIC  X(01)  VALUE  SPACES.  03039099
029500     88  WS-SPLIT-BYPASS              VALUE  'B'.                 03040099
029510     88  WS-SPLIT                     VALUE  'S'.                 03041099
029520                                                                  03042099
029530 01 WS-MKT-MIN-LR-DATA.                                           03043099
029540     05 WS-MIN-BLK                    PIC X(6)  VALUE  SPACES.    03044099
029550     05 WS-LN-RANGE                   PIC X(4)  VALUE  SPACES.    03045099
029560                                                                  03046099
029570                                                                  03047099
029580 01  EXISTANCE-VARIABLES.                                         03048099
029590     05 MDN-MATCH-FLAG                  PIC X.                    03049099
029600     05 MDN-NOT-IN-ETNI-FLAG            PIC X.                    03050099
029610     05 MDN-NOT-IN-BILL-FLAG            PIC X.                    03051099
029620                                                                  03052099
029630 01  EXISTANCE-COUNTS.                                            03053099
029640     05 CTNINV-ROWS-FOR-MIN             PIC S9(04) COMP.          03054099
029650     05 INSTANCE-COUNT                  PIC 9(9) COMP.            03055099
029660     05 EXISTANCE-FLAG                  PIC S9(4) COMP VALUE ZERO.03056099
029670                                                                  03057099
029680 01  PENDING-HOLD-REASON-CODES          PIC X(10).                03058099
029690     88 VALID-PENDING-HOLD-REASON-CODE                            03059099
029700        VALUES 'PENDDASG  ', 'PENDASGN  ', 'PENDRASG  ',          03060099
029710               'PENDDASG-R', 'PENDASGN-R'.                        03061099
029720                                                                  03062099
029730                                                                  03063099
029740 01  PENDING-HOLD-REASON-CODES-II       PIC X(10).                03064099
029750     88 VALID-PENDING-HOLD-REASON-II                              03065099
029760        VALUES 'PENDDASG  ', 'PENDASGN  ', 'PENDRASG  ',          03066099
029770               'PENDASGN-R'.                                      03067099
029780                                                                  03068099
029790                                                                  03069099
029800 01 WS-DATE-FILEDS.                                               03070099
029810     05  WS-TEMP-DATE.                                            03071099
029820         10  WS-TEMP-DATE-CCYY          PIC X(04).                03072099
029830         10  WS-TEMP-DATE-MM            PIC X(02).                03073099
029840         10  WS-TEMP-DATE-DD            PIC X(02).                03074099
029850         10  WS-TEMP-DATE-HH            PIC X(02).                03075099
029860         10  WS-TEMP-DATE-MI            PIC X(02).                03076099
029870         10  WS-TEMP-DATE-SS            PIC X(02).                03077099
029880     05  WS-TEMP-DATE-NUM REDEFINES                               03078099
029890         WS-TEMP-DATE                   PIC 9(14).                03079099
029900     05  WS-TEMP-CCYY                   PIC 9(04).                03080099
029910     05  WS-INP-DATE                    PIC S9(07) COMP-3.        03081099
029920     05  WS-RUN-DATE                    PIC 9(06).                03082099
029930     05  WS-RUN-TIME                    PIC 9(06).                03083099
029940                                                                  03084099
029950     05  WS-HDR-DATE-TIME.                                        03085099
029960         10 WS-HDR-DATE.                                          03086099
029970            15 WS-HDR-DATE-CCYY          PIC X(04) VALUE SPACES.  03087099
029980            15 WS-HDR-DATE-MM            PIC X(02) VALUE SPACES.  03088099
029990            15 WS-HDR-DATE-DD            PIC X(02) VALUE SPACES.  03089099
030000         10 WS-HDR-DATE-NUM              REDEFINES                03090099
030010            WS-HDR-DATE                  PIC 9(08).               03091099
030020         10 WS-HDR-TIME.                                          03092099
030030            15 WS-HDR-TIME-HH            PIC X(02) VALUE SPACES.  03093099
030040            15 WS-HDR-TIME-MI            PIC X(02) VALUE SPACES.  03094099
030050            15 WS-HDR-TIME-SS            PIC X(02) VALUE SPACES.  03095099
030060                                                                  03096099
030070     05  WS-HDR-DATE-TIME-MINUS-1.                                03097099
030080         10 WS-HDR-DATE-MINUS-1.                                  03098099
030090           15 WS-HDR-DATE-TIME-MINUS-1-CCYY                       03099099
030100                                          PIC X(04) VALUE SPACES. 03100099
030110           15 WS-HDR-DATE-TIME-MINUS-1-MM PIC X(02) VALUE SPACES. 03101099
030120           15 WS-HDR-DATE-TIME-MINUS-1-DD PIC X(02) VALUE SPACES. 03102099
030130         10 WS-HDR-DATE-MINUS-1-NUM       REDEFINES               03103099
030140            WS-HDR-DATE-MINUS-1           PIC 9(08).              03104099
030150         10 WS-HDR-TIME-MINUS-1.                                  03105099
030160           15 WS-HDR-DATE-TIME-MINUS-1-HH PIC X(02) VALUE SPACES. 03106099
030170           15 WS-HDR-DATE-TIME-MINUS-1-MI PIC X(02) VALUE SPACES. 03107099
030180           15 WS-HDR-DATE-TIME-MINUS-1-SS PIC X(02) VALUE SPACES. 03108099
030190     05  WS-HDR-DATE-TIME-MINUS-1DAY       REDEFINES              03109099
030200         WS-HDR-DATE-TIME-MINUS-1          PIC 9(14).             03110099
030210                                                                  03111099
030220     05  WS-HIST-LAST-TRX-DATE.                                   03112099
030230         10 WS-HIST-LAST-TRX-DATE-CCYY     PIC X(04) VALUE SPACES.03113099
030240         10 WS-HIST-LAST-TRX-DATE-MM       PIC X(02) VALUE SPACES.03114099
030250         10 WS-HIST-LAST-TRX-DATE-DD       PIC X(02) VALUE SPACES.03115099
030260         10 WS-HIST-LAST-TRX-DATE-HH       PIC X(02) VALUE SPACES.03116099
030270         10 WS-HIST-LAST-TRX-DATE-MI       PIC X(02) VALUE SPACES.03117099
030280         10 WS-HIST-LAST-TRX-DATE-SS       PIC X(02) VALUE SPACES.03118099
030290     05  WS-HIST-LAST-TRX-DATE-NUM         REDEFINES              03119099
030300         WS-HIST-LAST-TRX-DATE             PIC 9(14).             03120099
030310                                                                  03121099
030320     05  WS-CURR-DATE-TIME-X.                                     03122099
030330         10 WS-CURR-DATE-TIME-CCYY         PIC X(04) VALUE SPACES.03123099
030340         10 WS-CURR-DATE-TIME-MM           PIC X(02) VALUE SPACES.03124099
030350         10 WS-CURR-DATE-TIME-DD           PIC X(02) VALUE SPACES.03125099
030360         10 WS-CURR-DATE-TIME-HH           PIC X(02) VALUE SPACES.03126099
030370         10 WS-CURR-DATE-TIME-MI           PIC X(02) VALUE SPACES.03127099
030380         10 WS-CURR-DATE-TIME-SS           PIC X(02) VALUE SPACES.03128099
030390     05  WS-CURR-DATE-TIME                 REDEFINES              03129099
030400         WS-CURR-DATE-TIME-X               PIC 9(14).             03130099
030410                                                                  03131099
030420     05  WS-TIMESTAMP                      PIC X(26) VALUE SPACES.03132099
030430     05  WS-TIMESTAMP-JUST-DATE            PIC X(10) VALUE SPACES.03133099
030440                                                                  03134099
030450     05  WS-TIMESTAMP-NUM.                                        03135099
030460         10 WS-TIMESTAMP-YYYY-NUM          PIC 9(4).              03136099
030470         10 WS-TIMESTAMP-MM-NUM            PIC 9(2).              03137099
030480         10 WS-TIMESTAMP-DD-NUM            PIC 9(2).              03138099
030490     05  WS-TIMESTAMP-NUMERIC REDEFINES                           03139099
030500         WS-TIMESTAMP-NUM                  PIC 9(8).              03140099
030510                                                                  03141099
030520     05  WS-TIMESTAMP-MINUS-1              PIC X(26) VALUE SPACES.03142099
030530     05  WS-CURR-DATE-TIME-MINUS-1.                               03143099
030540         10 WS-CURR-DATE-TIME-MINUS-1-CCYY PIC X(04) VALUE SPACES.03144099
030550         10 WS-CURR-DATE-TIME-MINUS-1-MM   PIC X(02) VALUE SPACES.03145099
030560         10 WS-CURR-DATE-TIME-MINUS-1-DD   PIC X(02) VALUE SPACES.03146099
030570         10 WS-CURR-DATE-TIME-MINUS-1-HH   PIC X(02) VALUE SPACES.03147099
030580         10 WS-CURR-DATE-TIME-MINUS-1-MI   PIC X(02) VALUE SPACES.03148099
030590         10 WS-CURR-DATE-TIME-MINUS-1-SS   PIC X(02) VALUE SPACES.03149099
030600     05  WS-CURR-DATE-TIME-MINUS-1DAY      REDEFINES              03150099
030610         WS-CURR-DATE-TIME-MINUS-1         PIC 9(14).             03151099
030620                                                                  03152099
030630     05  WS-TIMESTAMP-MINUS-5              PIC X(26) VALUE SPACE. 03153099
030640                                                                  03154099
030650                                                                  03155099
030660     05  WS-BILL-LAST-TRX-DATE-1.                                 03156099
030670         10 WS-BILL-LAST-TRX-1-CCYY     PIC X(4).                 03157099
030680         10 FILLER                      PIC X     VALUE '-'.      03158099
030690         10 WS-BILL-LAST-TRX-1-MM       PIC X(2).                 03159099
030700         10 FILLER                      PIC X     VALUE '-'.      03160099
030710         10 WS-BILL-LAST-TRX-1-DD       PIC X(2).                 03161099
030720         10 FILLER                      PIC X     VALUE '-'.      03162099
030730         10 WS-BILL-LAST-TRX-1-HH       PIC X(2).                 03163099
030740         10 FILLER                      PIC X     VALUE '.'.      03164099
030750         10 WS-BILL-LAST-TRX-1-MI       PIC X(2).                 03165099
030760         10 FILLER                      PIC X     VALUE '.'.      03166099
030770         10 WS-BILL-LAST-TRX-1-SS       PIC X(2).                 03167099
030780         10 FILLER                      PIC X     VALUE '.'.      03168099
030790         10 WS-BILL-LAST-TRX-1-MS       PIC X(6).                 03169099
030800         10 WS-BILL-LAST-TRX-1-MS9  REDEFINES                     03170099
030810            WS-BILL-LAST-TRX-1-MS       PIC 9(6).                 03171099
030820     05  WS-BILL-LAST-TRX-DATE-2.                                 03172099
030830         10  WS-BILL-LAST-TRX-2-CCYY.                             03173099
030840             15  WS-BILL-LAST-TRX-2-CC  PIC X(2).                 03174099
030850             15  WS-BILL-LAST-TRX-2-YY  PIC X(2).                 03175099
030860         10  WS-BILL-LAST-TRX-2-MM      PIC X(2).                 03176099
030870         10  WS-BILL-LAST-TRX-2-DD      PIC X(2).                 03177099
030880         10  WS-BILL-LAST-TRX-2-HH      PIC X(2).                 03178099
030890         10  WS-BILL-LAST-TRX-2-MI      PIC X(2).                 03179099
030900         10  WS-BILL-LAST-TRX-2-SS      PIC X(2).                 03180099
030910     05  WS-BILL-LAST-TRX-DATE-2-NUM REDEFINES                    03181099
030920         WS-BILL-LAST-TRX-DATE-2        PIC 9(14).                03182099
030930                                                                  03183099
030940     05  WS-MDNIN-LAST-TRX-DATE-NUM.                              03184099
030950         10 WS-LAST-TRX-YYYY-NUM        PIC 9(4).                 03185099
030960         10 WS-LAST-TRX-MM-NUM          PIC 9(2).                 03186099
030970         10 WS-LAST-TRX-DD-NUM          PIC 9(2).                 03187099
030980     05  WS-MDNIN-LAST-TRX-DATE-NUMERIC REDEFINES                 03188099
030990         WS-MDNIN-LAST-TRX-DATE-NUM     PIC 9(8).                 03189099
031000                                                                  03190099
031010     05  WS-ETNI-LAST-TRX-DATE-1.                                 03191099
031020         10  WS-ETNI-LAST-TRX-1-CCYY    PIC X(4).                 03192099
031030         10  FILLER                     PIC X     VALUE '-'.      03193099
031040         10  WS-ETNI-LAST-TRX-1-MM      PIC X(2).                 03194099
031050         10  FILLER                     PIC X     VALUE '-'.      03195099
031060         10  WS-ETNI-LAST-TRX-1-DD      PIC X(2).                 03196099
031070         10  FILLER                     PIC X     VALUE '-'.      03197099
031080         10  WS-ETNI-LAST-TRX-1-HH      PIC X(2).                 03198099
031090         10  FILLER                     PIC X     VALUE '.'.      03199099
031100         10  WS-ETNI-LAST-TRX-1-MI      PIC X(2).                 03200099
031110         10  FILLER                     PIC X     VALUE '.'.      03201099
031120         10  WS-ETNI-LAST-TRX-1-SS      PIC X(2).                 03202099
031130         10  FILLER                     PIC X     VALUE '.'.      03203099
031140         10  WS-ETNI-LAST-TRX-1-MS      PIC X(6).                 03204099
031150                                                                  03205099
031160     05  WS-ETNI-LAST-TRX-DATE-2.                                 03206099
031170         10 WS-ETNI-LAST-TRX-2-CCYY.                              03207099
031180             15  WS-ETNI-LAST-TRX-2-CC  PIC X(2).                 03208099
031190             15  WS-ETNI-LAST-TRX-2-YY  PIC X(2).                 03209099
031200         10  WS-ETNI-LAST-TRX-2-MM      PIC X(2).                 03210099
031210         10  WS-ETNI-LAST-TRX-2-DD      PIC X(2).                 03211099
031220         10  WS-ETNI-LAST-TRX-2-HH      PIC X(2).                 03212099
031230         10  WS-ETNI-LAST-TRX-2-MI      PIC X(2).                 03213099
031240         10  WS-ETNI-LAST-TRX-2-SS      PIC X(2).                 03214099
031250     05  WS-ETNI-LAST-TRX-DATE-2-NUM REDEFINES                    03215099
031260         WS-ETNI-LAST-TRX-DATE-2        PIC 9(14).                03216099
031270                                                                  03217099
031280     05  WS-VORA-SYS-UPDATE-DATE1.                                03218099
031290         10  WS-VORA-SYS-UPDATE-1-CCYY  PIC X(4).                 03219099
031300         10  FILLER                     PIC X     VALUE '-'.      03220099
031310         10  WS-VORA-SYS-UPDATE-1-MM    PIC X(2).                 03221099
031320         10  FILLER                     PIC X     VALUE '-'.      03222099
031330         10  WS-VORA-SYS-UPDATE-1-DD    PIC X(2).                 03223099
031340         10  FILLER                     PIC X     VALUE '-'.      03224099
031350         10  WS-VORA-SYS-UPDATE-1-HH    PIC X(2).                 03225099
031360         10  FILLER                     PIC X     VALUE '.'.      03226099
031370         10  WS-VORA-SYS-UPDATE-1-MI    PIC X(2).                 03227099
031380         10  FILLER                     PIC X     VALUE '.'.      03228099
031390         10  WS-VORA-SYS-UPDATE-1-SS    PIC X(2).                 03229099
031400         10  FILLER                     PIC X     VALUE '.'.      03230099
031410         10  WS-VORA-SYS-UPDATE-1-MS    PIC X(6).                 03231099
031420                                                                  03232099
031430     05  WS-VORA-SYS-UPDATE-DATE2.                                03233099
031440         10 WS-VORA-SYS-UPDATE-2-CCYY.                            03234099
031450             15  WS-VORA-SYS-UPDATE-2-CC PIC X(2).                03235099
031460             15  WS-VORA-SYS-UPDATE-2-YY PIC X(2).                03236099
031470         10  WS-VORA-SYS-UPDATE-2-MM    PIC X(2).                 03237099
031480         10  WS-VORA-SYS-UPDATE-2-DD    PIC X(2).                 03238099
031490         10  WS-VORA-SYS-UPDATE-2-HH    PIC X(2).                 03239099
031500         10  WS-VORA-SYS-UPDATE-2-MI    PIC X(2).                 03240099
031510         10  WS-VORA-SYS-UPDATE-2-SS    PIC X(2).                 03241099
031520     05  WS-VORA-SYS-UPDATE-2-NUM REDEFINES                       03242099
031530         WS-VORA-SYS-UPDATE-DATE2      PIC 9(14).                 03243099
031540                                                                  03244099
031550                                                                  03245099
031560     05  WS-SIM-SYS-UPDATE-DATE1.                                 03246099
031570         10  WS-SIM-SYS-UPDATE-1-CCYY   PIC X(4).                 03247099
031580         10  FILLER                     PIC X     VALUE '-'.      03248099
031590         10  WS-SIM-SYS-UPDATE-1-MM     PIC X(2).                 03249099
031600         10  FILLER                     PIC X     VALUE '-'.      03250099
031610         10  WS-SIM-SYS-UPDATE-1-DD     PIC X(2).                 03251099
031620         10  FILLER                     PIC X     VALUE '-'.      03252099
031630         10  WS-SIM-SYS-UPDATE-1-HH     PIC X(2).                 03253099
031640         10  FILLER                     PIC X     VALUE '.'.      03254099
031650         10  WS-SIM-SYS-UPDATE-1-MI     PIC X(2).                 03255099
031660         10  FILLER                     PIC X     VALUE '.'.      03256099
031670         10  WS-SIM-SYS-UPDATE-1-SS     PIC X(2).                 03257099
031680         10  FILLER                     PIC X     VALUE '.'.      03258099
031690         10  WS-SIM-SYS-UPDATE-1-MS     PIC X(6).                 03259099
031700                                                                  03260099
031710     05  WS-SIM-SYS-UPDATE-DATE2.                                 03261099
031720         10 WS-SIM-SYS-UPDATE-2-CCYY.                             03262099
031730             15  WS-SIM-SYS-UPDATE-2-CC PIC X(2).                 03263099
031740             15  WS-SIM-SYS-UPDATE-2-YY PIC X(2).                 03264099
031750         10  WS-SIM-SYS-UPDATE-2-MM     PIC X(2).                 03265099
031760         10  WS-SIM-SYS-UPDATE-2-DD     PIC X(2).                 03266099
031770         10  WS-SIM-SYS-UPDATE-2-HH     PIC X(2).                 03267099
031780         10  WS-SIM-SYS-UPDATE-2-MI     PIC X(2).                 03268099
031790         10  WS-SIM-SYS-UPDATE-2-SS     PIC X(2).                 03269099
031800     05  WS-SIM-SYS-UPDATE-DATE-2-NUM REDEFINES                   03270099
031810         WS-SIM-SYS-UPDATE-DATE2        PIC 9(14).                03271099
031820                                                                  03272099
031830 01  WS-RELEASE-DT-TM.                                            03273099
031840     05 WS-RELEASE-MM                   PIC X(2).                 03274099
031850     05 WS-RELEASE-DD                   PIC X(2).                 03275099
031860     05 WS-RELEASE-YYYY                 PIC X(4).                 03276099
031870     05 WS-RELEASE-HH                   PIC X(2).                 03277099
031880     05 WS-RELEASE-MI                   PIC X(2).                 03278099
031890                                                                  03279099
031900******************************************************************03280099
031910*   REPORT LAYOUT                                                 03281099
031920******************************************************************03282099
031930 01  WS-HEADING-1.                                                03283099
031940     05 FILLER                  PIC X(16)                         03284099
031950        VALUE 'REPORT ID     : '.                                 03285099
031960     05 HEADING-1-RPT-ID        PIC X(11)   VALUE SPACES.         03286099
031970     05 FILLER                  PIC X(26)   VALUE SPACE.          03287099
031980     05 HEADING-1-COMPANY       PIC X(33)   VALUE                 03288099
031990       '        VERIZON WIRELESS        '.                        03289099
032000     05 FILLER                  PIC X(31)   VALUE SPACE.          03290099
032010     05 FILLER                  PIC X(06)   VALUE 'DATE: '.       03291099
032020     05 HEADING-1-DATE.                                           03292099
032030        10 HEADING-MM           PIC X(2).                         03293099
032040        10 FILLER               PIC X       VALUE '/'.            03294099
032050        10 HEADING-DD           PIC X(2).                         03295099
032060        10 FILLER               PIC X       VALUE '/'.            03296099
032070        10 HEADING-YY           PIC X(2).                         03297099
032080     05 FILLER                  PIC X(01)   VALUE SPACE.          03298099
032090                                                                  03299099
032100 01  WS-HEADING-2.                                                03300099
032110     05 FILLER                  PIC X(16)                         03301099
032120        VALUE 'BILLING SYSTEM: '.                                 03302099
032130     05 HEADING-2-BILL          PIC X(18)   VALUE SPACES.         03303099
032140     05 FILLER                  PIC X(19)   VALUE SPACES.         03304099
032150     05 HEADING-2-RPT-TITLE     PIC X(34)   VALUE SPACES.         03305099
032160     05 FILLER                  PIC X(30)   VALUE SPACES.         03306099
032170     05 FILLER                  PIC X(6)    VALUE 'TIME: '.       03307099
032180     05 HEADING-HH              PIC X(2).                         03308099
032190     05 FILLER                  PIC X       VALUE ':'.            03309099
032200     05 HEADING-MI              PIC X(2).                         03310099
032210     05 FILLER                  PIC X       VALUE ':'.            03311099
032220     05 HEADING-SS              PIC X(2).                         03312099
032230     05 FILLER                  PIC X(01)   VALUE SPACE.          03313099
032240                                                                  03314099
032250 01  WS-HEADING-3.                                                03315099
032260     05 FILLER                  PIC X(63)   VALUE SPACES.         03316099
032270     05 HEADING-3-RPT-TYPE      PIC X(16)   VALUE SPACES.         03317099
032280     05 FILLER                  PIC X(38)   VALUE SPACES.         03318099
032290     05 FILLER                  PIC X(6)    VALUE 'PAGE: '.       03319099
032300     05 HEADING-3-PAGE          PIC Z,ZZ9.                        03320099
032310     05 FILLER                  PIC X(04)   VALUE SPACE.          03321099
032320                                                                  03322099
032330*                                                                 03323099
032340 01  WS-HEADING-4.                                                03324099
032350     05 FILLER                  PIC X(48)   VALUE                 03325099
032360     'SYS     MDN        MIN     ...ICC  or  IMSI.... '.          03326099
032370     05 FILLER                  PIC X(52)   VALUE                 03327099
032380**   'LAST TRX   4g/CTN   NL   NGP BLR  PORT TRX COMMENTs '.      03328099
032390     'LAST TRX 4g/CTN  NL   NGP BLR PORT TRX COMMENTs     '.      03329099
032400                                                                  03330099
032410 01  WS-HEADING-5.                                                03331099
032420     05 FILLER                  PIC X(48)   VALUE                 03332099
032430     '                                                '.          03333099
032440     05 FILLER                  PIC X(52)   VALUE                 03334099
032450     '  DATE   STATUS           ID  IND  CDE              '.      03335099
032460                                                                  03336099
032470 01  WS-HEADING-6.                                                03337099
032480     05 FILLER                  PIC X(48)   VALUE                 03338099
032490     '---     ---        ---     -------------------- '.          03339099
032500     05 FILLER                  PIC X(52)   VALUE                 03340099
032510     '-------- ------ ----  --- --- ---- --- --------     '.      03341099
032520                                                                  03342099
032530                                                                  03343099
032540 01  WS-BLANK-LINE.                                               03344099
032550     05 FILLER                  PIC X(132)  VALUE SPACES.         03345099
032560                                                                  03346099
032570 01  UNSTRING-SYS-UPDATE-DATE.                                    03347099
032580     05 F                       PIC X(20).                        03348099
032590     05 LAST-BYTES-SYS-DATE     PIC 9(6).                         03349099
032600                                                                  03350099
032610 01  UNSTRING-LAST-TRX-DATE.                                      03351099
032620     05 F                       PIC X(20).                        03352099
032630     05 LAST-BYTES-TRX-DATE     PIC 9(6).                         03353099
032640                                                                  03354099
032650 01  RETRY-SUB                  PIC 9(2)    VALUE ZERO.           03355099
032660                                                                  03356099
032670 01  DETAIL-LINE-1.                                               03357099
032680     05 DETAIL-1-SYSTEM         PIC X(4)    VALUE SPACE.          03358099
032690     05 FILLER                  PIC X(1)    VALUE SPACE.          03359099
032700     05 DETAIL-1-MDN            PIC X(10)   VALUE SPACE.          03360099
032710     05 FILLER                  PIC X(1)    VALUE SPACE.          03361099
032720     05 DETAIL-1-MIN            PIC X(10)   VALUE SPACE.          03362099
032730     05 FILLER                  PIC X(1)    VALUE SPACE.          03363099
032740     05 DETAIL-1-ICC-IMSI       PIC X(20)   VALUE SPACE.          03364099
032750     05 FILLER                  PIC X(1)    VALUE SPACE.          03365099
032760     05 DETAIL-1-LAST-TRX-DT    PIC Z(08)   VALUE ZERO.           03366099
032770     05 FILLER                  PIC X(01)   VALUE SPACE.          03367099
032780     05 DETAIL-1-4G-STATUS      PIC X(02)   VALUE SPACE.          03368099
032790     05 FILLER                  PIC X(01)   VALUE SPACE.          03369099
032800     05 DETAIL-1-CTN-STATUS     PIC X(02)   VALUE SPACE.          03370099
032810     05 FILLER                  PIC X(2)    VALUE SPACE.          03371099
032820     05 DETAIL-1-NL             PIC X(5)    VALUE SPACE.          03372099
032830     05 FILLER                  PIC X       VALUE SPACE.          03373099
032840     05 DETAIL-1-NGP            PIC X(03)   VALUE SPACE.          03374099
032850     05 FILLER                  PIC X(2)    VALUE SPACE.          03375099
032860     05 DETAIL-1-BILLER-ID      PIC X       VALUE SPACE.          03376099
032870     05 FILLER                  PIC X(3)    VALUE SPACE.          03377099
032880     05 DETAIL-1-PORT-IND       PIC X(2)    VALUE SPACE.          03378099
032890     05 FILLER                  PIC X(2)    VALUE SPACE.          03379099
032900     05 DETAIL-1-LAST-TRX-CD    PIC X(3)    VALUE SPACE.          03380099
032910     05 FILLER                  PIC X(1)    VALUE SPACE.          03381099
032920     05 DETAIL-1-COMMENT        PIC X(25)   VALUE SPACE.          03382099
032930     05 FILLER                  PIC X(1)    VALUE SPACE.          03383099
032940     05 DETAIL-1-ADDTL-INFO     PIC X(15)   VALUE SPACE.          03384099
032950     05 FILLER                  PIC X(5)    VALUE SPACE.          03385099
032960                                                                  03386099
032970                                                                  03387099
032980**----------------------------------------------------------------03388099
032990*   REPORT LAYOUT  - HUB  AREA                                    03389099
033000**----------------------------------------------------------------03390099
033010 01  WS-HEADING-1-HUB.                                            03391099
033020     05 FILLER                  PIC X(16)                         03392099
033030        VALUE 'REPORT ID     : '.                                 03393099
033040     05 HEADING-1-RPT-ID-HUB    PIC X(11)   VALUE SPACES.         03394099
033050     05 FILLER                  PIC X(26)   VALUE SPACE.          03395099
033060     05 HEADING-1-COMPANY-HUB   PIC X(33)   VALUE                 03396099
033070       '        VERIZON BUSINESS:  HUB  '.                        03397099
033080     05 FILLER                  PIC X(31)   VALUE SPACE.          03398099
033090     05 FILLER                  PIC X(06)   VALUE 'DATE: '.       03399099
033100     05 HEADING-1-DATE-HUB.                                       03400099
033110        10 HEADING-MM-HUB       PIC X(2).                         03401099
033120        10 FILLER               PIC X       VALUE '/'.            03402099
033130        10 HEADING-DD-HUB       PIC X(2).                         03403099
033140        10 FILLER               PIC X       VALUE '/'.            03404099
033150        10 HEADING-YY-HUB       PIC X(2).                         03405099
033160     05 FILLER                  PIC X(01)   VALUE SPACE.          03406099
033170                                                                  03407099
033180 01  WS-HEADING-2-HUB.                                            03408099
033190     05 FILLER                  PIC X(16)                         03409099
033200        VALUE 'BILLING SYSTEM: '.                                 03410099
033210     05 HEADING-2-BIL-HUB       PIC X(18)   VALUE SPACES.         03411099
033220     05 FILLER                  PIC X(19)   VALUE SPACES.         03412099
033230     05 HEADING-2-RPT-TITLE-HUB PIC X(34)   VALUE SPACES.         03413099
033240     05 FILLER                  PIC X(30)   VALUE SPACES.         03414099
033250     05 FILLER                  PIC X(6)    VALUE 'TIME: '.       03415099
033260     05 HEADING-HH-HUB          PIC X(2).                         03416099
033270     05 FILLER                  PIC X       VALUE ':'.            03417099
033280     05 HEADING-M-HUB           PIC X(2).                         03418099
033290     05 FILLER                  PIC X       VALUE ':'.            03419099
033300     05 HEADING-SS-HUB          PIC X(2).                         03420099
033310     05 FILLER                  PIC X(01)   VALUE SPACE.          03421099
033320                                                                  03422099
033330 01  WS-HEADING-3-HUB.                                            03423099
033340     05 FILLER                  PIC X(63)   VALUE SPACES.         03424099
033350     05 HEADING-3-RPT-TYPE-HUB  PIC X(16)   VALUE SPACES.         03425099
033360     05 FILLER                  PIC X(38)   VALUE SPACES.         03426099
033370     05 FILLER                  PIC X(6)    VALUE 'PAGE: '.       03427099
033380     05 HEADING-3-PAGE-HUB      PIC Z,ZZ9.                        03428099
033390     05 FILLER                  PIC X(04)   VALUE SPACE.          03429099
033400                                                                  03430099
033410 01  WS-HEADING-4-HUB.                                            03431099
033420     05 FILLER                  PIC X(48)   VALUE                 03432099
033430     'SYSTEM     MDN       MIN     PROD   LAST TRANS  '.          03433099
033440     05 FILLER                  PIC X(51)   VALUE                 03434099
033450     '  CTN    NL   NGP BILLER  PORT TRX  COMMENTS       '.       03435099
033460                                                                  03436099
033470 01  WS-HEADING-5-HUB.                                            03437099
033480     05 FILLER                  PIC X(48)   VALUE                 03438099
033490     '                             TYPE      DATE     '.          03439099
033500     05 FILLER                  PIC X(45)   VALUE                 03440099
033510     ' STATUS             ID     ID  CODE          '.             03441099
033520                                                                  03442099
033530 01  WS-HEADING-6-HUB.                                            03443099
033540     05 FILLER                  PIC X(48)   VALUE                 03444099
033550     '------ ---------- ---------- ---- --------------'.          03445099
033560     05 FILLER                  PIC X(35)   VALUE                 03446099
033570     ' ------ ----- --- ------  ---- ----'.                       03447099
033580     05 FILLER                  PIC X(25)   VALUE                 03448099
033590     ' ------------------------'.                                 03449099
033600     05 FILLER                  PIC X(15)   VALUE                 03450099
033610     '---------------'.                                           03451099
033620                                                                  03452099
033630 01  DETAIL-LINE-1-HUB.                                           03453099
033640     05 FILLER                  PIC X       VALUE SPACE.          03454099
033650     05 DETAIL-1-SYSTEM-HUB     PIC X(4)    VALUE SPACE.          03455099
033660     05 FILLER                  PIC X(2)    VALUE SPACE.          03456099
033670     05 DETAIL-1-MDN-HUB        PIC X(10)   VALUE SPACE.          03457099
033680     05 FILLER                  PIC X(1)    VALUE SPACE.          03458099
033690     05 DETAIL-1-MIN-HUB        PIC X(10)   VALUE SPACE.          03459099
033700     05 FILLER                  PIC X(2)    VALUE SPACE.          03460099
033710     05 DETAIL-1-P-TYPE-HUB     PIC X       VALUE SPACE.          03461099
033720     05 FILLER                  PIC X(3)    VALUE SPACE.          03462099
033730     05 DETAIL-1-LAST-TRX-D-HUB PIC Z(14)   VALUE ZERO.           03463099
033740     05 FILLER                  PIC X(03)   VALUE SPACE.          03464099
033750     05 DETAIL-1-CTN-STATUS-HUB PIC X(02)   VALUE SPACE.          03465099
033760     05 FILLER                  PIC X(3)    VALUE SPACE.          03466099
033770     05 DETAIL-1-NL-HUB         PIC X(5)    VALUE SPACE.          03467099
033780     05 FILLER                  PIC X       VALUE SPACE.          03468099
033790     05 DETAIL-1-NGP-HUB        PIC X(03)   VALUE SPACE.          03469099
033800     05 FILLER                  PIC X(3)    VALUE SPACE.          03470099
033810     05 DETAIL-1-BILLER-ID-HUB  PIC X       VALUE SPACE.          03471099
033820     05 FILLER                  PIC X(6)    VALUE SPACE.          03472099
033830     05 DETAIL-1-PORT-IND-HUB   PIC X(2)    VALUE SPACE.          03473099
033840     05 FILLER                  PIC X(2)    VALUE SPACE.          03474099
033850     05 DETAIL-1-LAST-TRX-CD-HUB PIC X(3)    VALUE SPACE.         03475099
033860     05 FILLER                  PIC X(2)    VALUE SPACE.          03476099
033870     05 DETAIL-1-COMMENT-HUB    PIC X(25)   VALUE SPACE.          03477099
033880     05 FILLER                  PIC X(1)    VALUE SPACE.          03478099
033890     05 DETAIL-1-ADDTL-INFO-HUB PIC X(15)   VALUE SPACE.          03479099
033900                                                                  03480099
033910 01  FILE-HEADER-LINE.                                            03481099
033920     05 F                       PIC X(10) VALUE 'HDR DATE: '.     03482099
033930     05 HDR-LINE-DATE-TIME      PIC X(14).                        03483099
033940     05 F                       PIC X(3)  VALUE SPACE.            03484099
033950     05 F                       PIC X(15) VALUE 'HDR REF TABLE: '.03485099
033960     05 HDR-LINE-REF-TABLE-ID   PIC X(5).                         03486099
033970     05 F                       PIC X(3)  VALUE SPACE.            03487099
033980     05 F                       PIC X(12) VALUE 'HDR BILLER: '.   03488099
033990     05 HDR-LINE-BILLER-ID      PIC X.                            03489099
034000     05 F                       PIC X(3)  VALUE SPACE.            03490099
034010     05 F                       PIC X(12) VALUE 'HDR USERID: '.   03491099
034020     05 HDR-LINE-USER-ID        PIC X(16).                        03492099
034030     05 F                       PIC X(3)  VALUE SPACE.            03493099
034040     05 F                       PIC X(12) VALUE 'HDR APPLID: '.   03494099
034050     05 HDR-LINE-APPL-ID        PIC X(4).                         03495099
034060     05 F                       PIC X(3)  VALUE SPACE.            03496099
034070     05 F                       PIC X(12) VALUE 'HDR RUN NO: '.   03497099
034080     05 HDR-LINE-RUN-NO         PIC X(3).                         03498099
034090                                                                  03499099
034100 01  SUMMARY-LINE.                                                03500099
034110     05 FILLER                  PIC X(01)   VALUE SPACE.          03501099
034120     05 SUMMARY-DESC            PIC X(50)   VALUE SPACES.         03502099
034130     05 FILLER                  PIC X(02)   VALUE SPACES.         03503099
034140     05 SUMMARY-COUNT           PIC ZZZ,ZZZ,ZZ9.                  03504099
034150     05 FILLER                  PIC X(30)   VALUE SPACES.         03505099
034160                                                                  03506099
034170******************************************************************03507099
034180*   INPUT PARAMETERS                                              03508099
034190****************************************************************  03509099
034200 01  WS-INPUT-PARM-RECORD.                                        03510099
034210     05  WS-RUNPARMS.                                             03511099
034220         10 WS-PARM-PROCESS-REQ       PIC X(06).                  03512099
034230*--------these 4 parms abend if MDNIN date < CURRENT date---------03513099
034240            88  WS-PARM-UPDATE        VALUE 'UPDATE'.             03514099
034250            88  WS-PARM-REPORT        VALUE 'REPORT'.             03515099
034260            88  WS-PARM-UPDDEL        VALUE 'UPDDEL'.             03516099
034270            88  WS-PARM-UPDDNA        VALUE 'UPDDNA'.             03517099
034280*--------these 4 parms don't care about the dates-----------------03518099
034290            88  WS-PARM-UPDATX        VALUE 'UPDATX'.             03519099
034300            88  WS-PARM-REPORX        VALUE 'REPORX'.             03520099
034310            88  WS-PARM-UPDDEX        VALUE 'UPDDEX'.             03521099
034320            88  WS-PARM-UPDDNX        VALUE 'UPDDNX'.             03522099
034330         10 FILLER                    PIC X.                      03523099
034340*--------how many missing Biller recs will be tolerated-----------03524099
034350         10 WS-PARM-THRESHOLD-RECS    PIC X(10).                  03525099
034360         10 FILLER                    PIC X(63).                  03526099
034370                                                                  03527099
034380 01  WS-INPUT-LITERAL                 PIC X(40) VALUE             03528099
034390     'INPUT MDNIN RECORD STARTS HERE =======>'.                   03529099
034400                                                                  03530099
034410******************************************************************03531099
034420*   LOCAL BILLING SYSTEM MDN FILE LAYOUT                          03532099
034430****************************************************************  03533099
034440 01  WS-MDNIN-RECORD.                                             03534099
034450     COPY ETNCC27.                                                03535099
034460                                                                  03536099
034470 01  WS-INPUT-LITERAL                 PIC X(40) VALUE             03537099
034480     'INPUT CTNIN RECORD STARTS HERE =======>'.                   03538099
034490                                                                  03539099
034500 01  WS-CTNIN-LAST-TRX-DATE-SAVED     PIC X(26) VALUE  SPACES.    03540099
034510                                                                  03541099
034520******************************************************************03542099
034530*   ETNI CTN-INV INPUT FILE LAYOUT...                             03543099
034540****************************************************************  03544099
034550 01  WS-CTNIN-RECORD.                                             03545099
034560     05 WS-CTNIN-CTN.                                             03546099
034570        49 WS-CTNIN-CTN-LEN            PIC S9(4) USAGE COMP.      03547099
034580        49 WS-CTNIN-CTN-TEXT           PIC X(20).                 03548099
034590     05 WS-CTNIN-SYS-CREATION-DATE     PIC X(26).                 03549099
034600     05 WS-CTNIN-SYS-UPDATE-DATE       PIC X(26).                 03550099
034610     05 FILLER                         PIC X(01).                 03551099
034620     05 WS-CTNIN-OPERATOR-ID           PIC X(16).                 03552099
034630     05 FILLER                         PIC X(01).                 03553099
034640     05 WS-CTNIN-APPLICATION-ID        PIC X(6).                  03554099
034650     05 FILLER                         PIC X(01).                 03555099
034660     05 WS-CTNIN-DL-SERVICE-CODE       PIC X(5).                  03556099
034670     05 WS-CTNIN-DL-UPDATE-STAMP       PIC S9(4)V USAGE COMP-3.   03557099
034680     05 FILLER                         PIC X(01).                 03558099
034690     05 WS-CTNIN-LAST-TRX-DATE         PIC X(26).                 03559099
034700     05 WS-CTNIN-LAST-TRX-CODE         PIC X(3).                  03560099
034710     05 WS-CTNIN-CTN-STATUS            PIC X(2).                  03561099
034720     05 WS-CTNIN-LAST-TRX-UID          PIC X(16).                 03562099
034730     05 WS-CTNIN-NL                    PIC X(5).                  03563099
034740     05 FILLER                         PIC X(01).                 03564099
034750     05 WS-CTNIN-NGP                   PIC X(3).                  03565099
034760     05 WS-CTNIN-CONV-RUN-NO           PIC S9(3)V USAGE COMP-3.   03566099
034770     05 FILLER                         PIC X(01).                 03567099
034780     05 WS-CTNIN-SPECIAL-TRX-DATE      PIC X(26).                 03568099
034790     05 FILLER                         PIC X(01).                 03569099
034800     05 WS-CTNIN-RUN-ID                PIC S9(9)V USAGE COMP-3.   03570099
034810     05 FILLER                         PIC X(01).                 03571099
034820     05 WS-CTNIN-HOLD-REASON           PIC X(30).                 03572099
034830     05 FILLER                         PIC X(01).                 03573099
034840     05 WS-CTNIN-PRODUCT-TYPE          PIC X(1).                  03574099
034850     05 WS-CTNIN-ICC-ID.                                          03575099
034860        49 WS-CTNIN-ICC-ID-LEN         PIC S9(4) USAGE COMP.      03576099
034870        49 WS-CTNIN-ICC-ID-TEXT        PIC X(20).                 03577099
034880     05 FILLER                         PIC X(01).                 03578099
034890     05 WS-CTNIN-PORT-IND              PIC X(2).                  03579099
034900     05 WS-CTNIN-MIN-NUM.                                         03580099
034910        49 WS-CTNIN-MIN-NUM-LEN        PIC S9(4) USAGE COMP.      03581099
034920        49 WS-CTNIN-MIN-NUM-TEXT       PIC X(10).                 03582099
034930     05 FILLER                         PIC X(01).                 03583099
034940     05 WS-CTNIN-BILLER-ID             PIC X(1).                  03584099
034950     05 FILLER                         PIC X(01).                 03585099
034960     05 WS-CTNIN-STATUS-REASON-CD      PIC X(10).                 03586099
034970     05 WS-CTNIN-PREPAID-IND           PIC X.                     03587099
034980     05 FILLER                         PIC X.                     03588099
034990     05 WS-CTNIN-IMSI                  PIC X(15).                 03589099
035000     05 WS-CTNIN-ICC-ID-4G             PIC X(20).                 03590099
035000     05 WS-CTNIN-I-I-4G   REDEFINES                               03591099
035000        WS-CTNIN-ICC-ID-4G             PIC X(20).                 03592099
035010                                                                  03593099
035020 01  WS-CTNIN-RECORD-SAVED             PIC X(400) VALUE SPACE.    03594099
035030                                                                  03595099
035040*----COPYBOOK FOR OUTPUT DATE CONTROL FILE------------------------03596099
035050 01  DATE-CTL-RECORD.                                             03597099
035060     COPY ETNCC24.                                                03598099
035070                                                                  03599099
035080*01  WS-COMMON-BILLER-COPYBOOK                                    03600099
035090     COPY ETNCC67.                                                03601099
035100                                                                  03602099
035110*    passarea for calling ETNDC38 to select from NUMBER-GROUP     03603099
035120 01  WS-ETNDC38-INTERFACE.                                        03604099
035130     COPY ETNCC378.                                               03605099
035140                                                                  03606099
035150******************************************************************03607099
035160*   RECONCILIATION REPORT                                         03608099
035170******************************************************************03609099
035180 01  WS-RECON-REC.                                                03610099
035190     05 WS-RECON-REC-CC               PIC X.                      03611099
035200     05 WS-RECON-REC-DATA             PIC X(132).                 03612099
035210                                                                  03613099
035220******************************************************************03614099
035230*   ERROR REPORT                                                  03615099
035240******************************************************************03616099
035250 01  WS-ERROR-REC.                                                03617099
035260     05 WS-ERROR-REC-CC               PIC X.                      03618099
035270     05 WS-ERROR-REC-DATA             PIC X(132).                 03619099
035280                                                                  03620099
035290******************************************************************03621099
035300*   RECONCILIATION REPORT - HUB                                   03622099
035310******************************************************************03623099
035320 01  WS-RECON-REC-HUB.                                            03624099
035330     05 WS-RECON-REC-CC-HUB           PIC X.                      03625099
035340     05 WS-RECON-REC-DATA-HUB         PIC X(132).                 03626099
035350                                                                  03627099
035360******************************************************************03628099
035370*   ERROR REPORT - HUB                                            03629099
035380******************************************************************03630099
035390 01  WS-ERROR-REC-HUB.                                            03631099
035400     05 WS-ERROR-REC-CC-HUB           PIC X.                      03632099
035410     05 WS-ERROR-REC-DATA-HUB         PIC X(132).                 03633099
035420                                                                  03634099
035430******************************************************************03635099
035440*   CONTROL REPORT                                                03636099
035450******************************************************************03637099
035460 01  WS-CNTRLRPT-REC.                                             03638099
035470     05 WS-CNTRLRPT-REC-CC            PIC X.                      03639099
035480     05 WS-CNTRLRPT-REC-DATA          PIC X(132).                 03640099
035490                                                                  03641099
035500******************************************************************03642099
035510*   SQL ERROR MESSAGE                                             03643099
035520******************************************************************03644099
035530 01  WS05-INTF-MESSAGE.                                           03645099
035540     05  WS05-INTF-LENGTH             PIC S9(4) COMP VALUE 960.   03646099
035550     05  WS05-INTF-MSG                                            03647099
035560         OCCURS 12 TIMES INDEXED BY WS05-ERROR-INDEX.             03648099
035570         10  WS05-INTF-MSG-LINE       PIC X(80).                  03649099
035580                                                                  03650099
035590 01  CO01-SQL-ERROR-LINE-LENGTH       PIC S9(8) COMP VALUE 80.    03651099
035600                                                                  03652099
035610******************************************************************03653099
035620*   SQL COMMUNICATION AREA                                        03654099
035630******************************************************************03655099
035640     EXEC SQL                                                     03656099
035650          INCLUDE SQLCA                                           03657099
035660     END-EXEC.                                                    03658099
035670                                                                  03659099
035680******************************************************************03660099
035690*   NUMBER-LOCATION TABLE                                         03661099
035700******************************************************************03662099
035710     EXEC SQL                                                     03663099
035720          INCLUDE TSNUMLOC                                        03664099
035730     END-EXEC.                                                    03665099
035740                                                                  03666099
035750******************************************************************03667099
035760*   NUMBER-GROUP TABLE                                            03668099
035770******************************************************************03669099
035780     EXEC SQL                                                     03670099
035790          INCLUDE TSNUMBGR                                        03671099
035800     END-EXEC.                                                    03672099
035810                                                                  03673099
035820******************************************************************03674099
035830*   NM-TRX-CODES                                                  03675099
035840******************************************************************03676099
035850     EXEC SQL                                                     03677099
035860          INCLUDE TSNMTRXC                                        03678099
035870     END-EXEC.                                                    03679099
035880                                                                  03680099
035890******************************************************************03681099
035900*   NM-TRX-VALID-STS                                              03682099
035910******************************************************************03683099
035920     EXEC SQL                                                     03684099
035930          INCLUDE TSNMTRXV                                        03685099
035940     END-EXEC.                                                    03686099
035950                                                                  03687099
035960******************************************************************03688099
035970*   CTN-INV TABLE                                                 03689099
035980******************************************************************03690099
035990     EXEC SQL                                                     03691099
036000          INCLUDE TSCTNINV                                        03692099
036010     END-EXEC.                                                    03693099
036020                                                                  03694099
036060 01  DCLNL-NULL-INDS.                                             03695099
036070     10 RELATED-NL-NI                PIC S9(4) USAGE COMP.        03696099
                                                                        03697099
036030******************************************************************03698099
036040*   CTN-INV TABLE INDICATORS                                      03699099
036050******************************************************************03700099
036060 01  DCLCTN-INV-NULL-INDS.                                        03701099
036070     10 SYS-UPDATE-DATE-NI           PIC S9(4) USAGE COMP.        03702099
036080     10 OPERATOR-ID-NI               PIC S9(4) USAGE COMP.        03703099
036090     10 APPLICATION-ID-NI            PIC S9(4) USAGE COMP.        03704099
036100     10 DL-UPDATE-STAMP-NI           PIC S9(4) USAGE COMP.        03705099
036110     10 NL-NI                        PIC S9(4) USAGE COMP.        03706099
036120     10 CONV-RUN-NO-NI               PIC S9(4) USAGE COMP.        03707099
036130     10 SPECIAL-TRX-DATE-NI          PIC S9(4) USAGE COMP.        03708099
036140     10 RUN-ID-NI                    PIC S9(4) USAGE COMP.        03709099
036150     10 HOLD-REASON-NI               PIC S9(4) USAGE COMP.        03710099
036160     10 ICC-ID-NI                    PIC S9(4) USAGE COMP.        03711099
036170     10 PORT-IND-NI                  PIC S9(4) USAGE COMP.        03712099
036180     10 MIN-NUM-NI                   PIC S9(4) USAGE COMP.        03713099
036190     10 BILLER-ID-NI                 PIC S9(4) USAGE COMP.        03714099
036200*IR071503 - RSS - INCLUDED PREPAID                                03715099
036210     10 PREPAID-IND-NI               PIC S9(4) USAGE COMP.        03716099
036220     10 SEARCH-BILLER-ID-NI          PIC S9(4) USAGE COMP.        03717099
036230     10 SEARCH-NL-ID-NI              PIC S9(4) USAGE COMP.        03718099
036240                                                                  03719099
036250******************************************************************03720099
036260*   MIN-INV TABLE                                                 03721099
036270******************************************************************03722099
036280     EXEC SQL                                                     03723099
036290          INCLUDE TSMININV                                        03724099
036300     END-EXEC.                                                    03725099
036310                                                                  03726099
036320******************************************************************03727099
036330*   MIN-INV TABLE INDICATORS                                      03728099
036340******************************************************************03729099
036350 01  DCLMIN-INV-NULL-INDS.                                        03730099
036360     10 SYS-UPDATE-DATE-NI           PIC S9(4) USAGE COMP.        03731099
036370     10 OPERATOR-ID-NI               PIC S9(4) USAGE COMP.        03732099
036380     10 APPLICATION-ID-NI            PIC S9(4) USAGE COMP.        03733099
036390     10 DL-UPDATE-STAMP-NI           PIC S9(4) USAGE COMP.        03734099
036400     10 LRN-NI                       PIC S9(4) USAGE COMP.        03735099
036410     10 SUB-MARKET-NI                PIC S9(4) USAGE COMP.        03736099
036420     10 SID-NI                       PIC S9(4) USAGE COMP.        03737099
036430                                                                  03738099
036440******************************************************************03739099
036450*   NGP-NL-ASSIGNMENT TABLE                                       03740099
036460******************************************************************03741099
036470     EXEC SQL                                                     03742099
036480          INCLUDE TSNGNLAS                                        03743099
036490     END-EXEC.                                                    03744099
036500                                                                  03745099
036510******************************************************************03746099
036520*   NGP-NL-ASSIGNMENT INDICATORS                                  03747099
036530******************************************************************03748099
036540 01  DCLNGP-NL-ASSIGNMENT-NULL-INDS.                              03749099
036550     10 SYS-UPDATE-DATE-NI           PIC S9(4) USAGE COMP.        03750099
036560     10 OPERATOR-ID-NI               PIC S9(4) USAGE COMP.        03751099
036570     10 APPLICATION-ID-NI            PIC S9(4) USAGE COMP.        03752099
036580     10 DL-UPDATE-STAMP-NI           PIC S9(4) USAGE COMP.        03753099
036590     10 AA-STS-CNT-NI                PIC S9(4) USAGE COMP.        03754099
036600     10 MAX-INV-LVL-NI               PIC S9(4) USAGE COMP.        03755099
036610     10 MIN-INV-LVL-NI               PIC S9(4) USAGE COMP.        03756099
036620     10 CONV-RUN-NO-NI               PIC S9(4) USAGE COMP.        03757099
036630***************************************************************** 03758099
036640* NULL INDICATORS FOR NULLABLE COLUMNS IN MARKET_NPA_NXX_LR       03759099
036650***************************************************************** 03760099
036660 01  DCLMARKET-NPA-NXX-LR-NULL-INDS.                              03761099
036670     10 SYS-UPDATE-DATE-NI           PIC S9(4) USAGE COMP.        03762099
036680     10 OPERATOR-ID-NI               PIC S9(4) USAGE COMP.        03763099
036690     10 APPLICATION-ID-NI            PIC S9(4) USAGE COMP.        03764099
036700     10 DL-UPDATE-STAMP-NI           PIC S9(4) USAGE COMP.        03765099
036710     10 LOGICAL-SWITCH-NI            PIC S9(4) USAGE COMP.        03766099
036720     10 LOGICAL-VM-MACHINE-NI        PIC S9(4) USAGE COMP.        03767099
036730     10 EXPIRATION-DATE-NI           PIC S9(4) USAGE COMP.        03768099
036740     10 NPA-AREA-DSC-NI              PIC S9(4) USAGE COMP.        03769099
036750     10 NEW-NPA-NI                   PIC S9(4) USAGE COMP.        03770099
036760     10 NEW-NXX-NI                   PIC S9(4) USAGE COMP.        03771099
036770     10 END-OF-SPLIT-NI              PIC S9(4) USAGE COMP.        03772099
036780     10 OLD-NPA-NI                   PIC S9(4) USAGE COMP.        03773099
036790     10 OLD-NXX-NI                   PIC S9(4) USAGE COMP.        03774099
036800     10 NUMBER-POOLING-IND-NI        PIC S9(4) USAGE COMP.        03775099
036810                                                                  03776099
036820******************************************************************03777099
036830*   NGP-COUNTERS TABLE                                            03778099
036840******************************************************************03779099
036850     EXEC SQL                                                     03780099
036860          INCLUDE TSNGPCNT                                        03781099
036870     END-EXEC.                                                    03782099
036880                                                                  03783099
036890******************************************************************03784099
036900*   NGP-COUNTERS INDICATORS                                       03785099
036910******************************************************************03786099
036920 01  DCLNGP-COUNTERS-NULL-INDS.                                   03787099
036930     10 UNASG-HOLD-QTY-NI            PIC S9(4) USAGE COMP.        03788099
036940     10 UNASG-PROD-QTY-NI            PIC S9(4) USAGE COMP.        03789099
036950     10 SYS-UPDATE-DATE-NI           PIC S9(4) USAGE COMP.        03790099
036960                                                                  03791099
036970******************************************************************03792099
036980*   CTN-INV-HISTORY TABLE                                         03793099
036990******************************************************************03794099
037000     EXEC SQL                                                     03795099
037010          INCLUDE TSCTNINH                                        03796099
037020     END-EXEC.                                                    03797099
037030                                                                  03798099
037040******************************************************************03799099
037050*   TNI-LERG-13 TABLE                                             03800099
037060******************************************************************03801099
037070     EXEC SQL                                                     03802099
037080          INCLUDE TSTNIL13                                        03803099
037090     END-EXEC.                                                    03804099
037100                                                                  03805099
037110*                                                                 03806099
037120* NULL INDICATORS FOR NULLABLE COLUMNS IN TNI-LERG-13.            03807099
037130*                                                                 03808099
037140 01  TNI-LERG-13-NULL-INDS.                                       03809099
037150     05 STATUS-CD-NI                 PIC S9(4) USAGE COMP.        03810099
037160     05 EFFECTIVE-DATE-NI            PIC S9(4) USAGE COMP.        03811099
037170     05 ADMIN-OCN-NI                 PIC S9(4) USAGE COMP.        03812099
037180     05 OCN-NI                       PIC S9(4) USAGE COMP.        03813099
037190     05 LOCALITY-STATE-NI            PIC S9(4) USAGE COMP.        03814099
037200     05 RATE-CENTER-NAME-NI          PIC S9(4) USAGE COMP.        03815099
037210                                                                  03816099
037220******************************************************************03817099
037230*   TNI-NPANXX-MDN TABLE                                          03818099
037240******************************************************************03819099
037250     EXEC SQL                                                     03820099
037260        INCLUDE TSNPAMDN                                          03821099
037270     END-EXEC.                                                    03822099
037280                                                                  03823099
037290******************************************************************03824099
037300*   TCHKPT-CNTRL TABLE                                            03825099
037310******************************************************************03826099
037320     EXEC SQL                                                     03827099
037330          INCLUDE TSCHKPTC                                        03828099
037340     END-EXEC.                                                    03829099
037350                                                                  03830099
037360******************************************************************03831099
037370*   CHKPT-FREQ TABLE                                              03832099
037380******************************************************************03833099
037390     EXEC SQL                                                     03834099
037400          INCLUDE TSCKPTFQ                                        03835099
037410     END-EXEC.                                                    03836099
037420                                                                  03837099
037430******************************************************************03838099
037440*   TVZW-LSMS TABLE                                               03839099
037450******************************************************************03840099
037460     EXEC SQL                                                     03841099
037470          INCLUDE TSVWLSMS                                        03842099
037480     END-EXEC.                                                    03843099
037490                                                                  03844099
037500******************************************************************03845099
037510*   PARAM-VALUES TABLE                                            03846099
037520******************************************************************03847099
037530     EXEC SQL                                                     03848099
037540          INCLUDE TSPRMVAL                                        03849099
037550     END-EXEC.                                                    03850099
037560                                                                  03851099
037570******************************************************************03852099
037580*   TNI-CLIENT-NAMES TABLE                                        03853099
037590******************************************************************03854099
037600     EXEC SQL                                                     03855099
037610          INCLUDE TSTNICNM                                        03856099
037620     END-EXEC.                                                    03857099
037630                                                                  03858099
037640******************************************************************03859099
037650*   PORTIN-MDN-TDS TABLE                                          03860099
037660******************************************************************03861099
037670     EXEC SQL                                                     03862099
037680          INCLUDE TSPORTIN                                        03863099
037690     END-EXEC.                                                    03864099
037700                                                                  03865099
037710******************************************************************03866099
037720*   MARKET-NPA-NXX-LR TABLE                                       03867099
037730******************************************************************03868099
037740     EXEC SQL                                                     03869099
037750          INCLUDE TSMKTNXL                                        03870099
037760     END-EXEC.                                                    03871099
037770                                                                  03872099
037780******************************************************************03873099
037790*   GATEWAY-MSG-DET                                               03874099
037800******************************************************************03875099
037810     EXEC SQL                                                     03876099
037820          INCLUDE TSGTMDET                                        03877099
037830     END-EXEC.                                                    03878099
037840******************************************************************03879099
037850*   GATEWAY-MSG-HDR                                               03880099
037860******************************************************************03881099
037870     EXEC SQL                                                     03882099
037880          INCLUDE TSGTMHDR                                        03883099
037890     END-EXEC.                                                    03884099
037900                                                                  03885099
037910*************************************************************     03886099
037920* INCLUDE  DLCGEN FOR MARKET_MIN_LR TABLE                         03887099
037930*************************************************************     03888099
037940     EXEC SQL                                                     03889099
037950          INCLUDE TSMKTMLR                                        03890099
037960     END-EXEC.                                                    03891099
037970                                                                  03892099
037980* ANDY: comment for dev4 timezone test. only in sts3.             03893099
037990*************************************************************     03894099
038000* INCLUDE  DLCGEN FOR BL-MDN-PROFILE                              03895099
038010*************************************************************     03896099
038020*    EXEC SQL                                                     03897099
038030*         INCLUDE TSBLMNDP                                        03898099
038040*    END-EXEC.                                                    03899099
038050                                                                  03900099
038060*************************************************************     03901099
038070* INCLUDE  DLCGEN FOR  VORA-IMSI-INV                              03902099
038080*************************************************************     03903099
038090     EXEC SQL                                                     03904099
038100          INCLUDE TSVORIMI                                        03905099
038110     END-EXEC.                                                    03906099
038120                                                                  03907099
038130*************************************************************     03908099
038140* INCLUDE  DLCGEN FOR  SIM-INV                                    03909099
038150*************************************************************     03910099
038160     EXEC SQL                                                     03911099
038170          INCLUDE TSSIMINV                                        03912099
038180     END-EXEC.                                                    03913099
038190                                                                  03914099
038200***************************************************************** 03915099
038210* INCLUDE TNI_MDN_MIN TABLE DECLARATION                           03916099
038220***************************************************************** 03917099
038230     EXEC SQL                                                     03918099
038240        INCLUDE TSMDNMIN                                          03919099
038250     END-EXEC.                                                    03920099
038260                                                                  03921099
038270***************************************************************** 03922099
038280*------* LRN_UPD_REQT            *------*                         03923099
038290***************************************************************** 03924099
038300      EXEC SQL                                                    03925099
038310           INCLUDE TSLRNUPR                                       03926099
038320      END-EXEC.                                                   03927099
038330                                                                  03928099
038340                                                                  03929099
038350                                                                  03930099
038360******************************************************************03931099
038370*   RESTART LOGIC VARIABLES                                       03932099
038380******************************************************************03933099
038390                                                                  03934099
038400 01 SEQ-DDNAMES-SUBSCRIPTS.                                       03935099
038410    05 NMMDNINP-SUB                     PIC S9(4) COMP            03936099
038420                                        VALUE ZERO.               03937099
038430    05 NMCTNINP-SUB                     PIC S9(4) COMP            03938099
038440                                        VALUE ZERO.               03939099
038450    05 RECONOUT-SUB                     PIC S9(4) COMP            03940099
038460                                        VALUE ZERO.               03941099
038470    05 ERROROUT-SUB                     PIC S9(4) COMP            03942099
038480                                        VALUE ZERO.               03943099
038490    05 CNTRLRPT-SUB                     PIC S9(4) COMP            03944099
038500                                        VALUE ZERO.               03945099
038510 01 DFHCOMMAREA.                                                  03946099
038520    05  SYS-USER-INFO-AREA.                                       03947099
038530        10 FILLER                       PIC X(27).                03948099
038540        10 SYS-CALL-PGM-ID              PIC X(08).                03949099
038550    05  SYS-DATE-TIME-STAMP.                                      03950099
038560        10 SYS-DATE                     PIC S9(07)                03951099
038570                                        USAGE COMP-3.             03952099
038580        10 SYS-TIME                     PIC S9(07)                03953099
038590                                        USAGE COMP-3.             03954099
038600        10 SYS-DATE-DIS                 PIC X(08).                03955099
038610        10 SYS-TIME-DIS                 PIC X(08).                03956099
038620    05  SYS-CURRENT-DATE-TIME-STAMP.                              03957099
038630        10 SYS-CURRENT-DATE             PIC S9(07)                03958099
038640                                        USAGE COMP-3.             03959099
038650        10 SYS-CURRENT-TIME             PIC S9(07)                03960099
038660                                        USAGE COMP-3.             03961099
038670        10 SYS-CURRENT-DATE-DIS         PIC X(08).                03962099
038680        10 SYS-CURRENT-TIME-DIS         PIC X(08).                03963099
038690    05  FILLER                          PIC X(07).                03964099
038700    05  SYS-RESTART-IND                 PIC X(01).                03965099
038710    05  FILLER                          PIC X(49).                03966099
038720    05  SEQ-CNTL-AREA.                                            03967099
038730        10 SEQ-CNTL-ARRAY-GP.                                     03968099
038740           15 SEQ-CNTL-ARRAY             OCCURS 128 TIMES.        03969099
038750              20 SEQ-INFO-AREA.                                   03970099
038760                 25 SEQ-DDNAME-TXT.                               03971099
038770                    30 SEQ-CNTL-DDNAME      PIC X(08) SYNC.       03972099
038780                    30 SEQ-CNTL-FILE-NAME   PIC X(44).            03973099
038790                    30 SEQ-FD-AREA          PIC X(76).            03974099
038800                 25 SEQ-CNTL-REC-COUNT      PIC S9(08) COMP.      03975099
038810                 25 SEQ-CNTL-ACCESS-METHOD-IND PIC X.             03976099
038820                 25 SEQ-OPEN-IND            PIC X.                03977099
038830                 25 SEQ-RESTART-IND         PIC X(01).            03978099
038840                 25 FILLER                  PIC X(01).            03979099
038850        10 SEQ-CNTL-ARRAY-SUB               PIC S9(04) COMP.      03980099
038860        10 SEQ-CNTL-ARRAY-ALLOCATED         PIC S9(04) COMP.      03981099
038870        10 SEQ-RET-CODE-DISPLAY             PIC 9(8).             03982099
038880        10 SEQ-REC-COUNT-DISPLAY            PIC Z(9)9(1).         03983099
038890        10 SEQ-RPT-TEXT                     PIC X(132).           03984099
038900     05 FILLER                              PIC X(171).           03985099
038910                                                                  03986099
038920 01  WS-CHKPT-INFO-AREA.                                          03987099
038930     05  WS-JOB-INFO.                                             03988099
038940         10  WS-JOB-ID             PIC X(8).                      03989099
038950         10  WS-JOB-STEP           PIC X(7).                      03990099
038960         10  WS-PROC-STEP          PIC X(7).                      03991099
038970     05  WS-CHKPT-SAVE-DATA.                                      03992099
038980         10  WS-CHKPT-SAVE-1        PIC X(250).                   03993099
038990         10  WS-CHKPT-SAVE-2        PIC X(250).                   03994099
039000         10  WS-CHKPT-SAVE-3        PIC X(250).                   03995099
039010         10  WS-CHKPT-SAVE-4        PIC X(250).                   03996099
039020         10  WS-CHKPT-SAVE-5        PIC X(250).                   03997099
039030         10  WS-CHKPT-SAVE-6        PIC X(250).                   03998099
039040         10  WS-CHKPT-SAVE-7        PIC X(250).                   03999099
039050         10  WS-CHKPT-SAVE-8        PIC X(250).                   04000099
039060         10  WS-CHKPT-SAVE-9        PIC X(250).                   04001099
039070         10  WS-CHKPT-SAVE-10       PIC X(250).                   04002099
039080         10  WS-CHKPT-SAVE-11       PIC X(250).                   04003099
039090         10  WS-CHKPT-SAVE-12       PIC X(250).                   04004099
039100         10  WS-CHKPT-SAVE-13       PIC X(250).                   04005099
039110         10  WS-CHKPT-SAVE-14       PIC X(250).                   04006099
039120         10  WS-CHKPT-SAVE-15       PIC X(250).                   04007099
039130         10  WS-CHKPT-SAVE-16       PIC X(250).                   04008099
039140     05  WS-CHKPT-SAVE-APPL-DATA.                                 04009099
039150         10  SAVE-APPL-DATA-1                                     04010099
039160                                    PIC X(4000).                  04011099
039170     05  WS-CHKPT-IO-DATA.                                        04012099
039180         10  WS-SAVE-SEQ-DATA OCCURS 5 TIMES.                     04013099
039190             15  SAVE-SEQ-DATA      PIC X(136).                   04014099
039200         10  WS-SAVE-CURSOR-DATA.                                 04015099
039210             15  CUST-CRSR-FETCH-CNT PIC S9(4) COMP.              04016099
039220                                                                  04017099
039230     05  WS-CHKPT-VARIABLES.                                      04018099
039240         10  WS-COMMIT-CNT          PIC 9(7)    VALUE 0.          04019099
039250         10  WS-COMMIT-FREQ         PIC 9(7)    VALUE 0.          04020099
039260         10  WS-COMMIT-INIT         PIC 9(7)    VALUE 0.          04021099
039270         10  WS-COMMIT-TIME         PIC 9(7)    VALUE 0.          04022099
039280         10  WS-COMMIT-STRT         PIC S9(7)   COMP-3            04023099
039290                                                VALUE +0.         04024099
039300         10  WS-COMMIT-END          PIC S9(7)   COMP-3            04025099
039310                                                VALUE +0.         04026099
039320         10  WS-COMMIT-SECS         PIC S9(5)V9 COMP-3            04027099
039330                                                VALUE +0.         04028099
039340         10  WS-COMMIT-ON-IND       PIC X(1)    VALUE SPACE.      04029099
039350         10  WS-LUW-CNT             PIC S9(7)   COMP-3            04030099
039360                                                VALUE +0.         04031099
039370         10  WS-TOT-LUW-CNT         PIC S9(7)   COMP-3            04032099
039380                                                VALUE +0.         04033099
039390         10  WS-ABEND-CNT           PIC 9(7)    VALUE  0.         04034099
039400         10  WS-CHKPT-SEQ-SUB       PIC S9(4) COMP.               04035099
039410         10  WS-CHKPT-FETCH-CNT     PIC S9(4) COMP.               04036099
039420         10  CUST-CRSR-FETCH-IND    PIC X(01).                    04037099
039430         10  WS-CHKPT-INSERT-IND    PIC X(01).                    04038099
039440*                                                                 04039099
039450 01  WS-RESTART-VARIABLES.                                        04040099
039460     05  WS-SAVE-HDR-BILLER-ID            PIC X(01)  VALUE SPACE. 04041099
039470     05  WS-SAVE-BILL-RECS-READ           PIC S9(10) COMP-3       04042099
039480                                                     VALUE +0.    04043099
039490     05  WS-SAVE-ETNI-RECS-READ           PIC S9(10) COMP-3       04044099
039500                                                     VALUE +0.    04045099
039510     05  WS-SAVE-BILL-ETNI-MATCH-CNT      PIC S9(10) COMP-3       04046099
039520                                                     VALUE +0.    04047099
039530     05  WS-SAVE-BILL-ETNI-MATCH-NEW      PIC S9(10) COMP-3       04048099
039540                                                     VALUE +0.    04049099
039550     05  WS-SAVE-BILL-ETNI-MATCH-PP       PIC S9(10) COMP-3       04050099
039560                                                     VALUE +0.    04051099
039570     05  WS-SAVE-BILL-ETNI-MATCH-NH       PIC S9(10) COMP-3       04052099
039580                                                     VALUE +0.    04053099
039590     05  WS-SAVE-BILL-ETNI-MATCH-OK       PIC S9(10) COMP-3       04054099
039600                                                     VALUE +0.    04055099
039610     05  WS-SAVE-PP-BLANK-MATCH-ALL       PIC S9(10) COMP-3       04056099
039620                                                     VALUE +0.    04057099
039630     05  WS-SAVE-BILL-ETNI-DIFF-CNT       PIC S9(10) COMP-3       04058099
039640                                                     VALUE +0.    04059099
039650     05  WS-SAVE-BILL-NOT-IN-ETNI-CNT     PIC S9(10) COMP-3       04060099
039660                                                     VALUE +0.    04061099
039670     05  WS-SAVE-BILL-NOT-IN-ETNI-NEW     PIC S9(10) COMP-3       04062099
039680                                                     VALUE +0.    04063099
039690     05  WS-SAVE-BILL-NOT-IN-ETNI-PROC    PIC S9(10) COMP-3       04064099
039700                                                     VALUE +0.    04065099
039710     05  WS-SAVE-ETNI-NOT-IN-BILL-CNT     PIC S9(10) COMP-3       04066099
039720                                                     VALUE +0.    04067099
039730     05  WS-SAVE-PO-IN-ETNI-NOT-IN-BILL   PIC S9(10) COMP-3       04068099
039740                                                     VALUE +0.    04069099
039750     05  WS-SAVE-ETNI-NOT-IN-BILL-NEW     PIC S9(10) COMP-3       04070099
039760                                                     VALUE +0.    04071099
039770     05  WS-SAVE-ETNI-NOT-IN-BILL-PROC    PIC S9(10) COMP-3       04072099
039780                                                     VALUE +0.    04073099
039790     05  WS-SAVE-ETNI-NA-NH-CNT           PIC S9(10) COMP-3       04074099
039800                                                     VALUE +0.    04075099
039810     05  WS-SAVE-ETNI-MININV-UPD-CNT      PIC S9(10) COMP-3       04076099
039820                                                     VALUE +0.    04077099
039830     05  WS-SAVE-ETNI-MININV-UPD-ST-CNT   PIC S9(10) COMP-3       04078099
039840                                                     VALUE +0.    04079099
039850     05  WS-SAVE-ETNI-CTNINV-UPD-CNT      PIC S9(10) COMP-3       04080099
039860                                                     VALUE +0.    04081099
039870     05  WS-SAVE-ETNI-CTNINV-UPD-ST-CNT PIC S9(10) COMP-3         04082099
039880                                                     VALUE +0.    04083099
039890     05  WS-SAVE-ETNI-CTNINV-INS-CNT      PIC S9(10) COMP-3       04084099
039900                                                     VALUE +0.    04085099
039910     05  WS-SAVE-ETNI-CTNINV-DUPINS       PIC S9(10) COMP-3       04086099
039920                                                     VALUE +0.    04087099
039930     05  WS-SAVE-ETNI-CTNINV-DLT-CNT      PIC S9(10) COMP-3       04088099
039940                                                     VALUE +0.    04089099
039950     05  WS-SAVE-ETNI-CTNHIST-INS-CNT     PIC S9(10) COMP-3       04090099
039960                                                     VALUE +0.    04091099
039970     05  WS-SAVE-ETNI-CTNHIST-DUPINS      PIC S9(10) COMP-3       04092099
039980                                                     VALUE +0.    04093099
039990     05  WS-SAVE-ETNI-NGPCNTS-UPD-CNT     PIC S9(10) COMP-3       04094099
040000                                                    VALUE +0.     04095099
040010     05  WS-SAVE-ETNI-NGPNLAS-UPD-CNT     PIC S9(10) COMP-3       04096099
040020                                                     VALUE +0.    04097099
040030     05  WS-SAVE-ERROR-CNT                PIC S9(10) COMP-3       04098099
040040                                                     VALUE +0.    04099099
040050     05  WS-SAVE-ERROR-CTNINV-NOTFND      PIC S9(09) COMP         04100099
040060                                                     VALUE +0.    04101099
040070     05  WS-SAVE-ERROR-CTNINV-DUPINS      PIC S9(09) COMP         04102099
040080                                                     VALUE +0.    04103099
040090     05  WS-SAVE-ERROR-CTNHIST-DUPINS     PIC S9(09) COMP         04104099
040100                                                     VALUE +0.    04105099
040110     05  WS-SAVE-ERROR-BILLER-NOTMTCH     PIC S9(09) COMP         04106099
040120                                                     VALUE +0.    04107099
040130     05  WS-SAVE-ERROR-LERG6-NOTFND       PIC S9(09) COMP         04108099
040140                                                     VALUE +0.    04109099
040150     05  WS-SAVE-ERROR-NUMLOC-NOTFND      PIC S9(09) COMP         04110099
040160                                                     VALUE +0.    04111099
040170     05  WS-SAVE-ERROR-NUMGRP-NOTFND      PIC S9(09) COMP         04112099
040180                                                     VALUE +0.    04113099
040190     05  WS-SAVE-ERROR-GRPLOC-NOTFND      PIC S9(09) COMP         04114099
040200                                                     VALUE +0.    04115099
040210     05  WS-SAVE-ERROR-NGPCNT-NOTFND      PIC S9(09) COMP         04116099
040220                                                     VALUE +0.    04117099
040230     05  WS-SAVE-ERROR-NGPNL-NOTFND       PIC S9(09) COMP         04118099
040240                                                     VALUE +0.    04119099
040250     05  WS-SAVE-ERROR-DATE-INVALID       PIC S9(09) COMP         04120099
040260                                                     VALUE +0.    04121099
040270     05  WS-SAVE-ERROR-TRX-CODE-NOTFND    PIC S9(09) COMP         04122099
040280                                                     VALUE +0.    04123099
040290     05  WS-SAVE-ERROR-TRX-STAT-NOTFND    PIC S9(09) COMP         04124099
040300                                                     VALUE +0.    04125099
040310     05  WS-SAVE-ERROR-STATUS-INVALID     PIC S9(09) COMP         04126099
040320                                                     VALUE +0.    04127099
040330     05  WS-SAVE-ERROR-HOLD-REASON        PIC S9(09) COMP         04128099
040340                                                     VALUE +0.    04129099
040350     05  WS-SAVE-ERROR-MIN-NUM-NOTFND     PIC S9(09) COMP         04130099
040360                                                     VALUE +0.    04131099
040370     05  WS-SAVE-ERROR-MIN-NUM-IN-CTN     PIC S9(09) COMP         04132099
040380                                                     VALUE +0.    04133099
040390     05  WS-SAVE-ERROR-MIN-NUM-NOTFND-S   PIC S9(09) COMP         04134099
040400                                                     VALUE +0.    04135099
040410     05  WS-SAVE-ERROR-PORT-IND-CHANGED   PIC S9(09) COMP         04136099
040420                                                     VALUE +0.    04137099
040430                                                                  04138099
040440     05  WS-SAVE-ERROR-PORT-IND-NOT-CHG   PIC S9(09) COMP         04139099
040450                                                     VALUE +0.    04140099
040460*** #870803 SDL BEGIN                                             04141099
040470     05  WS-SAVE-ERROR-PRDTYP-MISMATCH    PIC S9(09) COMP         04142099
040480                                                     VALUE +0.    04143099
040490*** #870803 SDL END                                               04144099
040500*** #071503 KIN BEGIN                                             04145099
040510     05  WS-SAVE-ERROR-RSS-BILL-NL-BYP    PIC S9(09) COMP         04146099
040520                                                     VALUE +0.    04147099
040530*** #071503 KIN END                                               04148099
040540                                                                  04149099
040550     05  WS-SAVE-ERROR-POPO-MISMATCH    PIC S9(09) COMP           04150099
040560                                                   VALUE +0.      04151099
040570     05  WS-SAVE-ERROR-POIO-MISMATCH    PIC S9(09) COMP           04152099
040580                                                   VALUE +0.      04153099
040590     05  WS-TOTL-NOT-IN-BILLING-FEED    PIC S9(09) COMP           04154099
040600                                                   VALUE +0.      04155099
040610     05  WS-SAVE-ERROR-DUPE-BILLER      PIC S9(09) COMP           04156099
040620                                                   VALUE +0.      04157099
040630                                                                  04158099
040640     05  WS-SAVE-ERROR-NGP-NOT-FOUND    PIC S9(09) COMP           04159099
040650                                                   VALUE +0.      04160099
040660     05  WS-SAVE-ERROR-NGP-ARE-EMPTY    PIC S9(09) COMP           04161099
040670                                                   VALUE +0.      04162099
040680     05  WS-SAVE-ERROR-NOT-NUMERIC        PIC S9(09) COMP         04163099
040690                                                     VALUE +0.    04164099
040700     05  WS-SAVE-CNTRLRPT-CNT             PIC S9(10) COMP-3       04165099
040710                                                     VALUE +0.    04166099
040720     05  WS-SAVE-PAGE-CTR-RECON           PIC 9(3)   VALUE 0.     04167099
040730     05  WS-SAVE-PAGE-CTR-ERROR           PIC 9(3)   VALUE 0.     04168099
040740     05  WS-SAVE-PAGE-CTR-ERROR-PREPAID   PIC 9(3)   VALUE 0.     04169099
040750     05  WS-SAVE-PAGE-CTR-ERROR-PO        PIC 9(3)   VALUE 0.     04170099
040760     05  WS-SAVE-PAGE-CTR-CNTRLRPT        PIC 9(3)   VALUE 0.     04171099
040770                                                                  04172099
040780  01 VARIOUS-AND-SUNDRY.                                          04173099
040790     05 SUB                               PIC 9(5)   VALUE ZERO.  04174099
040800     05 WS-BILLER-ETNI-MATCH              PIC 9(10)  VALUE ZERO.  04175099
040810     05 WS-BILLER-NOT-IN-ETNI             PIC 9(10)  VALUE ZERO.  04176099
040820     05 WS-ETNI-NOT-IN-BILLER             PIC 9(10)  VALUE ZERO.  04177099
040830     05 WS-PARM-THRESHOLD-RECS-NUMERIC    PIC 9(10)  VALUE ZERO.  04178099
040840     05 WS-HOLD-LINE                      PIC X(4)   VALUE SPACE. 04179099
040850     05 WS-HOLD-LINE-CTN                  PIC X(4)   VALUE SPACE. 04180099
040860     05 WS-HOLD-NGP                       PIC X(3)   VALUE '???'. 04181099
040870     05 FORCED-MDN-MATCH-FLAG             PIC X      VALUE SPACE. 04182099
040880     05 EOF-ETNI                          PIC X      VALUE SPACE. 04183099
040890     05 EOF-BILL                          PIC X      VALUE SPACE. 04184099
040900     05 PORT-INDS-DONT-MATCH              PIC X      VALUE SPACE. 04185099
040910     05 SAVE-TRANS-MIN                    PIC X(10)  VALUE SPACE. 04186099
040920     05 CTN-HAS-VZW-SPID                  PIC X      VALUE SPACE. 04187099
040930     05 NULL-ICC-ID-FLAG                  PIC X      VALUE SPACE. 04188099
040940     05 ALLOW-PORT-IND-CHG                PIC X      VALUE SPACE. 04189099
040950     05 WS-SAVE-MDNIN-BILLER-ID           PIC X      VALUE SPACE. 04190099
040960     05 USE-CTN-FIELDS-FOR-KEY            PIC X      VALUE SPACE. 04191099
040970     05 CREATE-UNLOAD-HISTORY-FLAG        PIC X      VALUE SPACE. 04192099
040980     05 NH-AND-PENDDASG-R-FLAG            PIC X      VALUE SPACE. 04193099
040990     05 NH-AND-OTHER-PENDING-FLAG         PIC X      VALUE SPACE. 04194099
041000     05 JUST-FOR-TEST                     PIC 9      VALUE ZERO.  04195099
041010     05 DUMMY-COUNTER                     PIC 9(5)   VALUE ZERO.  04196099
041020     05 FILTERED-SNAPBACKS                PIC 9(9)   VALUE ZERO.  04197099
041030     05 WS-ALPHA-NPA-NXX                  PIC X(6).               04198099
041040     05 WS-ALPHA-NPA-NXX-NUM REDEFINES WS-ALPHA-NPA-NXX PIC 9(6). 04199099
041050     05 WS-ALPHA-NPA-NXX-SIGN-COMP3       PIC S9(6)V COMP-3.      04200099
041060     05 WS-ALPHA-LINE                     PIC X(4).               04201099
041070     05 SHOULD-WE-DISCONNECT-FLAG         PIC X.                  04202099
041080     05 WS-THREE-BYTES-OF-SPACE           PIC X(3)   VALUE SPACE. 04203099
041090     05 WS-KEEP-THIS-RECORD               PIC X.                  04204099
041100     05 WS-DISPLAY-HDR-DATE               PIC X.                  04205099
041110     05 PORT-INDS-DIFFERENT               PIC 9(9)   VALUE ZERO.  04206099
041120     05 PORT-INDS-DIFF-BUT-DISALLOW       PIC 9(9)   VALUE ZERO.  04207099
041130     05 HAD-TO-INCREMENT-COUNT            PIC 9(9)   VALUE ZERO.  04208099
041140     05 HISTORY-TOO-RECENT-COUNT          PIC 9(9)   VALUE ZERO.  04209099
041150     05 RPT-MDNIN-PREPAID-IND             PIC X      VALUE SPACE. 04210099
041160     05 RPT-CTNIN-PREPAID-IND             PIC X      VALUE SPACE. 04211099
041170     05 ONLY-PREPAID-IND-CHANGED          PIC X      VALUE SPACE. 04212099
041180     05 PORT-IND-IS-THE-ONLY-CHANGE       PIC X      VALUE SPACE. 04213099
041190     05 GATEWAY-INTRASERV-PORT            PIC X      VALUE SPACE. 04214099
041200     05 IS-THIS-RECENT-HISTORY            PIC X      VALUE SPACE. 04215099
041210     05 TRX-DATE-TOO-RECENT               PIC X      VALUE SPACE. 04216099
041220     05 WS-ERROR-ALREADY-REPORTED         PIC X      VALUE 'N'.   04217099
041230     05 WS-ERROR-ALREADY-REPORTED-HUB     PIC X      VALUE 'N'.   04218099
041240     05 WS-CALLED-PGM                     PIC X(7)   VALUE SPACE. 04219099
041250     05 WS-PORT-IND-DAYS                  PIC X(2)   VALUE SPACE. 04220099
041260     05 WS-PORT-IND-DAYS-NUMERIC REDEFINES WS-PORT-IND-DAYS       04221099
041270                                          PIC 9(2).               04222099
041280     05 WS-PORT-IND-DAYS-NUM              PIC 9(9)   VALUE ZERO.  04223099
041290     05 WS-MDNIN-TRX-DAYS                 PIC 9(9)   VALUE ZERO.  04224099
041300     05 WS-TIMESTAMP-DAYS                 PIC 9(9)   VALUE ZERO.  04225099
041310     05 WS-CANT-FIND-CTN-IN-Q1000         PIC 9(9)   VALUE ZERO.  04226099
041320     05 WS-8878-FIRST-PASS                PIC X      VALUE 'Y'.   04227099
041330     05 WS-ERROR4-REASON                  PIC X(4)   VALUE SPACE. 04228099
041340     05 WS-ETNDC38-BILLER                 PIC X      VALUE SPACE. 04229099
041350     05 WS-MDNIN-DETAIL-NL             PIC  X(05)  VALUE  SPACES. 04230099
041360                                                                  04231099
041370*----AGB 5/08/06                                                  04232099
041380  01 WS-LIT-ERROR4-REASONS.                                       04233099
041390     05 WS-LIT-ERROR4-REASON-1            PIC X(100)  VALUE       04234099
041400     'Error 001: MDN Match.              Biller Last Trx Dt > Bill04235099
041410-    'er Header Dt - 1 day.'.                                     04236099
041420                                                                  04237099
041430     05 WS-LIT-ERROR4-REASON-2            PIC X(100)  VALUE       04238099
041440     'Error 002: MDN Match.              ETNI Last Trx Dt > Biller04239099
041450-    ' Header Dt - 1 day.'.                                       04240099
041460                                                                  04241099
041470     05 WS-LIT-ERROR4-REASON-3            PIC X(100)  VALUE       04242099
041480     'Error 003: In Biller, Not in eTNI. Biller Last Trx Dt > Bill04243099
041490-    'er Header Dt - 1 day.'.                                     04244099
041500                                                                  04245099
041510     05 WS-LIT-ERROR4-REASON-4            PIC X(100)  VALUE       04246099
041520     'Error 004: Not in Biller, in eTNI. ETNI Last Trx Dt > Biller04247099
041530-    ' Header Dt - 1 day.'.                                       04248099
041540                                                                  04249099
041550     05 WS-LIT-ERROR4-REASON-5            PIC X(100)  VALUE       04250099
041560     'Error 005: Not in Biller, in eTNI. Both Status and Port Ind 04251099
041570-    'are PO.'.                                                   04252099
041580                                                                  04253099
041590     05 WS-LIT-ERROR4-DASHES              PIC X(100)  VALUE       04254099
041600     '============================================================04255099
041610-    '======================'.                                    04256099
041620                                                                  04257099
041630  01 WS-OWNERSHIP-VARIABLES.                                      04258099
041640     05 WS-FOUND-AS-CODE-HOLDER           PIC X      VALUE SPACE. 04259099
041650     05 WS-FOUND-AS-BLOCK-HOLDER          PIC X      VALUE SPACE. 04260099
041660     05 WS-VZW-OWNED-AS-CODE-HOLDER       PIC X      VALUE SPACE. 04261099
041670     05 WS-VZW-OWNED-AS-CODE-HOLDER-EX    PIC X      VALUE SPACE. 04262099
041680     05 WS-VZW-OWNED-AS-BLOCK-HOLDER      PIC X      VALUE SPACE. 04263099
041690                                                                  04264099
041700  01 WS-WORK-MDN-WITH-DASHES.                                     04265099
041710     05 WS-WORK-MDN-NPA                   PIC X(3).               04266099
041720     05 F                                 PIC X      VALUE '-'.   04267099
041730     05 WS-WORK-MDN-NXX                   PIC X(3).               04268099
041740     05 F                                 PIC X      VALUE '-'.   04269099
041750     05 WS-WORK-MDN-LINE                  PIC X(4).               04270099
041760                                                                  04271099
041770  01 LINE-HANDLING.                                               04272099
041780     05 WS-LINE                           PIC X(4)   VALUE SPACE. 04273099
041790     05 WS-LINE-NUMERIC REDEFINES WS-LINE PIC 9(4).               04274099
041800     05 WS-LINE-RANGE             PIC S9(4)V COMP-3 VALUE ZERO.   04275099
041810                                                                  04276099
041820  01 LERG13-EFFECTIVE-DATE.                                       04277099
041830     05 WS-EFF-DT                 PIC X(10)  VALUE SPACES.        04278099
041840     05 WS-EDIT-EFF-DT.                                           04279099
041850        10 WS-EDIT-EFF-YYYY       PIC X(4)   VALUE SPACE.         04280099
041860        10 WS-EDIT-EFF-FILLER1    PIC X      VALUE SPACE.         04281099
041870        10 WS-EDIT-EFF-MM         PIC X(2)   VALUE SPACE.         04282099
041880        10 WS-EDIT-EFF-FILLER2    PIC X      VALUE SPACE.         04283099
041890        10 WS-EDIT-EFF-DD         PIC X(2)   VALUE SPACE.         04284099
041900                                                                  04285099
041910*----working storage fields for Sysplex information-------------- 04286099
041920  01 SYSPLEX-INFO.                                                04287099
041930     05 SYS-NAME                          PIC X(8).               04288099
041940     05 REAL-STORAGE-M                    PIC S9(6) COMP.         04289099
041950     05 PRODI                             PIC X(8).               04290099
041960     05 PRODN                             PIC X(8).               04291099
041970     05 MDL                               PIC 9999.               04292099
041980     05 SMF-NAME                          PIC X(4).               04293099
041990     05 IPL-JDATE                         PIC 9(7) COMP-3.        04294099
042000     05 SU-SEC                            PIC S9(6) COMP.         04295099
042010     05 CPU-TYPE                          PIC X(6).               04296099
042020     05 CPU-MODEL                         PIC X(3).               04297099
042030     05 SYSPLEX-NAME                      PIC X(8).               04298099
042040     05 OS390-RELEASE                     PIC 9(6).               04299099
042050     05 HARDWARE-NAME                     PIC X(8).               04300099
042060     05 LPAR-NAME                         PIC X(8).               04301099
042070     05 VM-USERID                         PIC X(8).               04302099
042080  01 FOUR-BYTES.                                                  04303099
042090     05 FULL-WORD                         PIC S9(8) COMP.         04304099
042100     05 PTR4 REDEFINES FULL-WORD POINTER.                         04305099
042110     05 PL4  REDEFINES FULL-WORD          PIC 9(7) COMP-3.        04306099
042120                                                                  04307099
042130*AGB021309                                                        04308099
042140 01  WS-ETNDC43                 PIC X(7)  VALUE 'ETNDC43'.        04309099
042150 01  WS-ETNDC43-CALL-RECORD.                                      04310099
042160     COPY ETNCC901.                                               04311099
042170                                                                  04312099
042180 01  WS-API-COMMAREA.                                             04313099
042190     COPY ETNCC01.                                                04314099
042200                                                                  04315099
042210 01  WS-HRS                     PIC S9(4) COMP VALUE 0.           04316099
042220 01  WS-TIME-ZONE               PIC X(1).                         04317099
042230 01  WS-UNCOMP-PLUS-HRS         PIC 9(1).                         04318099
042240 01  WS-DB2-TIMESTAMP           PIC X(26).                        04319099
042250 01  WS-1ST-PASS                PIC X          VALUE 'Y'.         04320099
042260*AGB021309                                                        04321099
042270                                                                  04322099
042280 01  WS-DFHCOMMAREA                       PIC X(08).              04323099
042290                                                                  04324099
042300*================================================================*04325099
042310 LINKAGE SECTION.                                                 04326099
042320*================================================================*04327099
042330*-----Pointers to Sysplex Information------                       04328099
042340  01 CB1.                                                         04329099
042350     05 PTR1      POINTER OCCURS 512.                             04330099
042360  01 CVT.                                                         04331099
042370     05 CVT1      POINTER OCCURS 512.                             04332099
042380                                                                  04333099
042390*================================================================*04334099
042400 PROCEDURE DIVISION.                                              04335099
042410*================================================================*04336099
042420                                                                  04337099
042430 0000-MAIN-LINE.                                                  04338099
042440******************************************************************04339099
042450*                                                                 04340099
042460*   PARAGRAPH NAME:  0000-MAIN-LINE                               04341099
042470*                                                                 04342099
042480*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   04343099
042490*             DO MAIN FLOW                                        04344099
042500*                                                                 04345099
042510*   PRIMARY PARAGRAPH FUNCTIONS:                                  04346099
042520*     - 2000-PROGRAM-MAIN                                         04347099
042530*     - 2100-MDN-MATCH                                            04348099
042540*     - 2200-MDN-NOT-IN-ETNI                                      04349099
042550*     - 2300-MDN-NOT-IN-BILL                                      04350099
042560*                                                                 04351099
042570******************************************************************04352099
042580     MOVE '0000-MAIN-LINE   '  TO WS-CURR-PARA                    04353099
042590     PERFORM 0100-PRE-INITIALIZE THRU                             04354099
042600             0100-EXIT                                            04355099
042610                                                                  04356099
042620     PERFORM 0900-GET-ENVIRONMENT-INFO THRU                       04357099
042630             0900-EXIT                                            04358099
042640                                                                  04359099
042650     PERFORM 1000-INITIALIZE THRU                                 04360099
042660             1000-EXIT                                            04361099
042670                                                                  04362099
042680     PERFORM 1001-MQ-INITIALIZATION THRU 1001-EXIT                04363099
042690                                                                  04364099
042700     PERFORM 2000-PROGRAM-MAIN THRU                               04365099
042710             2000-EXIT                                            04366099
042720       UNTIL WS-NO-MORE-RECORD-BILL                               04367099
042730         AND WS-NO-MORE-RECORD-ETNI                               04368099
042740                                                                  04369099
042750     PERFORM 3000-TERMINATE THRU 3000-EXIT                        04370099
042760     GOBACK                                                       04371099
042770     .                                                            04372099
042780 0000-EXIT.                                                       04373099
042790     EXIT.                                                        04374099
042800                                                                  04375099
042810                                                                  04376099
042820 0100-PRE-INITIALIZE.                                             04377099
042830******************************************************************04378099
042840*                                                                 04379099
042850*   PARAGRAPH NAME : 0100-PRE-INITIALIZE                          04380099
042860*                                                                 04381099
042870*   DESCRIPTION :                                                 04382099
042880*     PERFORM PRE-PROCESSING FOR BATCH                            04383099
042890*     PROGRAM EXECUTION                                           04384099
042900*                                                                 04385099
042910*   PARAGRAPH MAJOR FUNCTIONS :                                   04386099
042920*       - PERFORM CHCKPT/RESTART INIT PROCESS                     04387099
042930*       - INITIALIZE SEQIO BY CALLING C100- PARAGRAPH             04388099
042940******************************************************************04389099
042950     MOVE '0100-PRE-INITIALIZE'  TO WS-CURR-PARA                  04390099
042960                                                                  04391099
042970* DISPLAY PROGRAM INFORMATION                                     04392099
042980     MOVE WHEN-COMPILED TO WS-PGM-VERSION                         04393099
042990     DISPLAY 'ETNI RECONCILIATION PROCESS '                       04394099
043000             'VERSION: '                                          04395099
043010              WS-PGM-VERSION                                      04396099
043020                                                                  04397099
043030     PERFORM 0110-GET-PROGRAM-DATE-TIME THRU 0110-EXIT            04398099
043040                                                                  04399099
043050**  JA0322  - Trailer File Processing -                           04400099
043060                                                                  04401099
043070                                                                  04402099
043080     OPEN  INPUT  NMMDNINP-FILE-TRAILER                           04403099
043090                                                                  04404099
043100     IF  TRAILER-STATUS  =  '00'                                  04405099
043110         INITIALIZE  NMMDNINP-RECORD-TRAILER(1:1)                 04406099
043120         READ  NMMDNINP-FILE-TRAILER  AT  END                     04407099
043130           DISPLAY '*  Billing File Error - Read Failed *'        04408099
043140           DISPLAY '*  Trailer Record Missing *'                  04409099
043150           DISPLAY '*  Job  Will Abend  *'                        04410099
043160           PERFORM  9000-ABORT  THRU  9000-EXIT                   04411099
043170           CLOSE  NMMDNINP-FILE-TRAILER                           04412099
043180           GOBACK                                                 04413099
043190         END-READ                                                 04414099
043200         CONTINUE                                                 04415099
043210       ELSE                                                       04416099
043220         DISPLAY '*  Billing File Error - Open Failed *'          04417099
043230         DISPLAY '*  Trailer Record Missing *'                    04418099
043240         DISPLAY '*  Job  Will Abend  *'                          04419099
043250         PERFORM  9000-ABORT  THRU  9000-EXIT                     04420099
043260         GOBACK                                                   04421099
043270     END-IF                                                       04422099
043280                                                                  04423099
043290     IF  NMMDNINP-RECORD-TRAILER(1:1)  NOT  =  '9'                04424099
043300         DISPLAY '*  Billing File Error - Trailer Missing *'      04425099
043310         DISPLAY '*  Trailer Record Missing *'                    04426099
043320         DISPLAY '*  Job  Will Abend  *'                          04427099
043330         PERFORM  9000-ABORT  THRU  9000-EXIT                     04428099
043340         CLOSE  NMMDNINP-FILE-TRAILER                             04429099
043350         GOBACK                                                   04430099
043360     END-IF                                                       04431099
043370                                                                  04432099
043380     CLOSE  NMMDNINP-FILE-TRAILER                                 04433099
043390                                                                  04434099
043400* READ INPUT PARAMETER FILE                                       04435099
043410     PERFORM 0120-READ-PARMS THRU 0120-EXIT                       04436099
043420                                                                  04437099
043430*----if no updates to be performed, skip check on missing MDNs----04438099
043440     IF WS-PARM-REPORT OR WS-PARM-REPORX                          04439099
043450        GO TO 0100-PRE-INITIALIZE-CONTINUE-2                      04440099
043460     END-IF                                                       04441099
043470                                                                  04442099
043480*----if user specified all "9s" for missing Biller records--------04443099
043490*----tolerance in Parm,      do not perform PRE-READ routines-----04444099
043500     IF WS-PARM-THRESHOLD-RECS = '9999999999' OR                  04445099
043510        WS-PARM-THRESHOLD-RECS = '0000000000'                     04446099
043520        DISPLAY ' '  DISPLAY                                      04447099
043530       '  _______________________________________________'        04448099
043540        DISPLAY                                                   04449099
043550       '__|  Since Parm threshold value was all "9s" or |'        04450099
043560        DISPLAY                                                   04451099
043570       '| |  Spaces, the pre-read logic for checking    |'        04452099
043580        DISPLAY                                                   04453099
043590       '| |  missing Biller data will NOT execute...    |'        04454099
043600        DISPLAY                                                   04455099
043610       '| |_____________________________________________|'        04456099
043620        DISPLAY                                                   04457099
043630       '|___________________________________________|'            04458099
043640        DISPLAY ' '                                               04459099
043650        GO TO 0100-PRE-INITIALIZE-CONTINUE-2                      04460099
043660     END-IF                                                       04461099
043670                                                                  04462099
043680*----updates will be performed: look for missing Biller MDNs------04463099
043690     PERFORM P100-PRE-READ-OF-FILES THRU P100-EXIT                04464099
043700                                                                  04465099
043710*----the BIG Decision: too many missing MDNs in Biller: Shut Down-04466099
043720     IF WS-ETNI-NOT-IN-BILLER > WS-PARM-THRESHOLD-RECS-NUMERIC    04467099
043730        DISPLAY ' '                                               04468099
043740        DISPLAY                                                   04469099
043750       '      IMPORTANT MESSAGE FROM ETNBC16...'                  04470099
043760        DISPLAY                                                   04471099
043770       '_____________________________________________'            04472099
043780       DISPLAY                                                    04473099
043790       '|  An input file pre-check routine has      |'            04474099
043800       DISPLAY                                                    04475099
043810       '|  found > ' WS-PARM-THRESHOLD-RECS-NUMERIC               04476099
043820       ' CTNs which exist in   |'                                 04477099
043830       DISPLAY                                                    04478099
043840       '|  eTNI, but NOT in the input Biller file.  |'            04479099
043850       DISPLAY                                                    04480099
043860       '|  ' WS-ETNI-NOT-IN-BILLER                                04481099
043870       ' were missing from Biller file.|'                         04482099
043880       DISPLAY                                                    04483099
043890       '|                                           |'            04484099
043900       DISPLAY                                                    04485099
043910       '|  Biller/eTNI match:   ' WS-BILLER-ETNI-MATCH            04486099
043920       '          |'                                              04487099
043930       DISPLAY                                                    04488099
043940       '|  In Bill/not in eTNI: ' WS-BILLER-NOT-IN-ETNI           04489099
043950       '          |'                                              04490099
043960       DISPLAY                                                    04491099
043970       '|  In eTNI/not in Bill: ' WS-ETNI-NOT-IN-BILLER           04492099
043980       '          |'                                              04493099
043990       DISPLAY                                                    04494099
044000       '|                                           |'            04495099
044010       DISPLAY                                                    04496099
044020       '|  To protect the integrity of eTNI data,   |'            04497099
044030       DISPLAY                                                    04498099
044040       '|  the Reconciliaton will NOT EXECUTE.      |'            04499099
044050       DISPLAY                                                    04500099
044060       '|  No updates have taken place.             |'            04501099
044070       DISPLAY                                                    04502099
044080       '|                                           |'            04503099
044090       DISPLAY                                                    04504099
044100       '|  ETNBC16 will deliberately abend with     |'            04505099
044110       DISPLAY                                                    04506099
044120       '|  an illegal zero division.                |'            04507099
044130       DISPLAY                                                    04508099
044140       '|___________________________________________|'            04509099
044150       DISPLAY ' ' DISPLAY ' '                                    04510099
044160       COMPUTE WS-SUB = 1 / WS-ZERO                               04511099
044170       GOBACK                                                     04512099
044180     END-IF.                                                      04513099
044190                                                                  04514099
044200*=================================================================04515099
044210*        otherwise, we're ok - continue the Recon!                04516099
044220*=================================================================04517099
044230                                                                  04518099
044240 0100-PRE-INITIALIZE-CONTINUE-1.                                  04519099
044250      DISPLAY ' ' DISPLAY                                         04520099
044260     'Pre-check for missing Biller data is now finished.'         04521099
044270      DISPLAY                                                     04522099
044280     'Parm specified no more than ' WS-PARM-THRESHOLD-RECS-NUMERIC04523099
044290     ' missing Biller recs.'                                      04524099
044300      DISPLAY                                                     04525099
044310     'In actuality, ' WS-ETNI-NOT-IN-BILLER                       04526099
044320     ' Biller recs were missing.'                                 04527099
044330      DISPLAY                                                     04528099
044340     'There are fewer missing than the threshold: Recon will run!'04529099
044350       DISPLAY                                                    04530099
044360       '_____________________________________________'            04531099
044370       DISPLAY                                                    04532099
044380       '|                                           |'            04533099
044390       DISPLAY                                                    04534099
044400       '|  Biller/eTNI match:   ' WS-BILLER-ETNI-MATCH            04535099
044410       '          |'                                              04536099
044420       DISPLAY                                                    04537099
044430       '|  In Bill/not in eTNI: ' WS-BILLER-NOT-IN-ETNI           04538099
044440       '          |'                                              04539099
044450       DISPLAY                                                    04540099
044460       '|  In eTNI/not in Bill: ' WS-ETNI-NOT-IN-BILLER           04541099
044470       '          |'                                              04542099
044480       DISPLAY                                                    04543099
044490       '|___________________________________________|'            04544099
044500      DISPLAY ' ' DISPLAY                                         04545099
044510     '==========================================================='04546099
044520      DISPLAY ' ' DISPLAY ' '.                                    04547099
044530                                                                  04548099
044540                                                                  04549099
044550 0100-PRE-INITIALIZE-CONTINUE-2.                                  04550099
044560* RESTART LOGIC                                                   04551099
044570     INITIALIZE SEQ-CNTL-ARRAY-GP                                 04552099
044580                SEQ-CNTL-ARRAY-SUB                                04553099
044590                SEQ-CNTL-ARRAY-ALLOCATED                          04554099
044600     MOVE SEQINIT TO SEQ-FUNCTION                                 04555099
044610     MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                            04556099
044620     CALL SYS-CALL-PGM-ID  USING                                  04557099
044630          DFHCOMMAREA                                             04558099
044640          SEQ-RETURN-CODE-DATA                                    04559099
044650          SEQ-CNTL-MAX-FILES                                      04560099
044660                                                                  04561099
044670     PERFORM C100-INIT-CHKPT-RSTRT                                04562099
044680        THRU C100-EXIT                                            04563099
044690     .                                                            04564099
044700 0100-EXIT.                                                       04565099
044710      EXIT.                                                       04566099
044720                                                                  04567099
044730                                                                  04568099
044740 0110-GET-PROGRAM-DATE-TIME.                                      04569099
044750******************************************************************04570099
044760*                                                                 04571099
044770*   PARAGRAPH NAME : 0110-GET-PROGRAM-DATE-TIME                   04572099
044780*                                                                 04573099
044790*   DESCRIPTION :                                                 04574099
044800*     GET CURRENT PREVIOUS DATE/TIME                              04575099
044810*   PARAGRAPH MAJOR FUNCTIONS :                                   04576099
044820*                                                                 04577099
044830******************************************************************04578099
044840     MOVE '0110-GET-PROGRAM-DATE-TIME'  TO WS-CURR-PARA           04579099
044850                                                                  04580099
044860     PERFORM 8000-GET-TIMEZONE THRU 8000-EXIT                     04581099
044870                                                                  04582099
044880                                                                  04583099
044890* REFORMAT CURRENT DATE TO NUMERIC FIELD                          04584099
044900     MOVE    WS-TIMESTAMP (01:04) TO                              04585099
044910             WS-CURR-DATE-TIME-CCYY  WS-EDIT-EFF-YYYY             04586099
044920     MOVE    WS-TIMESTAMP (06:02) TO                              04587099
044930             WS-CURR-DATE-TIME-MM    WS-EDIT-EFF-MM               04588099
044940     MOVE    WS-TIMESTAMP (09:02) TO                              04589099
044950             WS-CURR-DATE-TIME-DD    WS-EDIT-EFF-DD               04590099
044960     MOVE    WS-TIMESTAMP (12:02) TO                              04591099
044970             WS-CURR-DATE-TIME-HH                                 04592099
044980     MOVE    WS-TIMESTAMP (15:02) TO                              04593099
044990             WS-CURR-DATE-TIME-MI                                 04594099
045000     MOVE    WS-TIMESTAMP (18:02) TO                              04595099
045010             WS-CURR-DATE-TIME-SS                                 04596099
045020                                                                  04597099
045030     MOVE '-' TO WS-EDIT-EFF-FILLER1  WS-EDIT-EFF-FILLER2         04598099
045040     MOVE WS-EDIT-EFF-DT TO WS-EFF-DT                             04599099
045050                                                                  04600099
045060* REFORMAT PREVIOUS DATE TO NUMERIC FIELD                         04601099
045070     MOVE    WS-TIMESTAMP-MINUS-1 (01:04) TO                      04602099
045080             WS-CURR-DATE-TIME-MINUS-1-CCYY                       04603099
045090     MOVE    WS-TIMESTAMP-MINUS-1 (06:02) TO                      04604099
045100             WS-CURR-DATE-TIME-MINUS-1-MM                         04605099
045110     MOVE    WS-TIMESTAMP-MINUS-1 (09:02) TO                      04606099
045120             WS-CURR-DATE-TIME-MINUS-1-DD                         04607099
045130     MOVE    WS-TIMESTAMP-MINUS-1 (12:02) TO                      04608099
045140             WS-CURR-DATE-TIME-MINUS-1-HH                         04609099
045150     MOVE    WS-TIMESTAMP-MINUS-1 (15:02) TO                      04610099
045160             WS-CURR-DATE-TIME-MINUS-1-MI                         04611099
045170     MOVE    WS-TIMESTAMP-MINUS-1 (18:02) TO                      04612099
045180             WS-CURR-DATE-TIME-MINUS-1-SS                         04613099
045190                                                                  04614099
045200* DISPLAY CURRENT DATE                                            04615099
045210     DISPLAY 'EXECUTION STARTED ON         : '                    04616099
045220             WS-TIMESTAMP                                         04617099
045230     DISPLAY ' '                                                  04618099
045240                                                                  04619099
045250* DISPLAY CURRENT DATE MINUS 1 DAY                                04620099
045260     DISPLAY 'CURRENT DATE/TIME MINUS 1 DAY: '                    04621099
045270             WS-TIMESTAMP-MINUS-1                                 04622099
045280     DISPLAY ' '                                                  04623099
045290     .                                                            04624099
045300 0110-EXIT.                                                       04625099
045310     EXIT.                                                        04626099
045320                                                                  04627099
045330                                                                  04628099
045340 0120-READ-PARMS.                                                 04629099
045350******************************************************************04630099
045360*                                                                 04631099
045370*   PARAGRAPH NAME : 0120-READ-PARMS                              04632099
045380*                                                                 04633099
045390*   DESCRIPTION :                                                 04634099
045400*     READ IN THE PARAMETERS PASSED.                              04635099
045410*   PARAGRAPH MAJOR FUNCTIONS :                                   04636099
045420*   - OPEN THE SEQPARMI-FILE                                      04637099
045430*   - READ IN EACH RECORD FROM THE PARAMETER FILE                 04638099
045440*   - CLOSE THE SEQPARMI-FILE                                     04639099
045450******************************************************************04640099
045460     MOVE '0120-READ-PARMS'  TO WS-CURR-PARA                      04641099
045470                                                                  04642099
045480     OPEN INPUT SEQPARMI-FILE                                     04643099
045490                                                                  04644099
045500     READ SEQPARMI-FILE                                           04645099
045510       AT END MOVE YES-VALUE TO WS-SEQPARM-EOF-SW                 04646099
045520     END-READ                                                     04647099
045530                                                                  04648099
045540     IF WS-SEQPARM-EOF                                            04649099
045550        MOVE 'SEQPARMI FILE IS EMPTY'                             04650099
045560          TO WS-ABEND-TEXT                                        04651099
045570        PERFORM 9000-ABORT                                        04652099
045580           THRU 9000-EXIT                                         04653099
045590     ELSE                                                         04654099
045600        IF SEQPARM-PARM1 > SPACES OR LOW-VALUES                   04655099
045610           MOVE SEQPARM-PARM1 TO WS-RUNPARMS                      04656099
045620           INSPECT WS-PARM-THRESHOLD-RECS                         04657099
045630                   REPLACING ALL SPACES BY ZERO                   04658099
045640           INSPECT WS-PARM-THRESHOLD-RECS                         04659099
045650                   REPLACING ALL LOW-VALUES BY ZERO               04660099
045660           MOVE WS-PARM-THRESHOLD-RECS TO                         04661099
045670                WS-PARM-THRESHOLD-RECS-NUMERIC                    04662099
045680                                                                  04663099
045690           IF WS-PARM-REPORT OR WS-PARM-REPORX                    04664099
045700              MOVE LIT-RPT-TYPE-REPORT TO HEADING-3-RPT-TYPE      04665099
045710                                          HEADING-3-RPT-TYPE-HUB  04666099
045720           END-IF                                                 04667099
045730           IF WS-PARM-UPDATE OR WS-PARM-UPDATX                    04668099
045740              MOVE LIT-RPT-TYPE-UPDATE TO HEADING-3-RPT-TYPE      04669099
045750                                          HEADING-3-RPT-TYPE-HUB  04670099
045760           END-IF                                                 04671099
045770           IF WS-PARM-UPDDEL OR WS-PARM-UPDDEX                    04672099
045780              MOVE LIT-RPT-TYPE-UPDDEL TO HEADING-3-RPT-TYPE      04673099
045790                                          HEADING-3-RPT-TYPE-HUB  04674099
045800           END-IF                                                 04675099
045810           IF WS-PARM-UPDDNA OR WS-PARM-UPDDNX                    04676099
045820              MOVE LIT-RPT-TYPE-UPDDNA TO HEADING-3-RPT-TYPE      04677099
045830                                          HEADING-3-RPT-TYPE-HUB  04678099
045840           END-IF                                                 04679099
045850                                                                  04680099
045860*---------if its not one of the correct parms, abend right now!---04681099
045870          IF NOT WS-PARM-REPORT AND NOT WS-PARM-UPDATE AND        04682099
045880             NOT WS-PARM-UPDDEL AND NOT WS-PARM-UPDDNA AND        04683099
045890             NOT WS-PARM-REPORX AND NOT WS-PARM-UPDATX AND        04684099
045900             NOT WS-PARM-UPDDEX AND NOT WS-PARM-UPDDNX            04685099
045910             DISPLAY ' ' DISPLAY ' ' DISPLAY                      04686099
045920            '____________________________________'                04687099
045930             DISPLAY                                              04688099
045940            '| E R R O R   i n   E T N B C 1 6  |'                04689099
045950             DISPLAY                                              04690099
045960            '|                                  |'                04691099
045970             DISPLAY                                              04692099
045980            '| The parm passed to ETNBC16 was   |'                04693099
045990             DISPLAY                                              04694099
046000            '| not "REPORT" or "UPDATE" or      |'                04695099
046010             DISPLAY                                              04696099
046020            '| "UPDDEL" or "UPDDNA" or          |'                04697099
046030             DISPLAY                                              04698099
046040            '| "REPORX" or "UPDATX" or          |'                04699099
046050             DISPLAY                                              04700099
046060            '| "UPDDEX" or "UPDDNX".            |'                04701099
046070             DISPLAY                                              04702099
046080            '| The program performed no         |'                04703099
046090             DISPLAY                                              04704099
046100            '| Processing and will ABEND.       |'                04705099
046110             DISPLAY                                              04706099
046120            '|__________________________________|'                04707099
046130             DISPLAY ' '                                          04708099
046140             DISPLAY 'PARAMETER PASSED: ' SEQPARM-PARM1           04709099
046150             DISPLAY ' ' DISPLAY ' '                              04710099
046160             MOVE 'WRONG PARM PASSED. PLEASE CHK SEQPARMI.'       04711099
046170                   TO WS-ABEND-TEXT                               04712099
046180             PERFORM 9000-ABORT THRU 9000-EXIT                    04713099
046190          END-IF                                                  04714099
046200          DISPLAY ' '                                             04715099
046210          DISPLAY '||||||||||||||||||||||||||||||||||||||||'      04716099
046220          DISPLAY 'Parameter Passed: ' SEQPARM-PARM1              04717099
046230          DISPLAY 'Missing Biller Rec Tolerance: '                04718099
046240                   WS-PARM-THRESHOLD-RECS-NUMERIC                 04719099
046250          DISPLAY '||||||||||||||||||||||||||||||||||||||||'      04720099
046260          DISPLAY ' '                                             04721099
046270        ELSE                                                      04722099
046280           MOVE 'NO PARAMETER PASSED. PLEASE CHK SEQPARMI'        04723099
046290             TO WS-ABEND-TEXT                                     04724099
046300           PERFORM 9000-ABORT THRU 9000-EXIT                      04725099
046310        END-IF                                                    04726099
046320     CLOSE SEQPARMI-FILE                                          04727099
046330     .                                                            04728099
046340 0120-EXIT.                                                       04729099
046350     EXIT.                                                        04730099
046360                                                                  04731099
046370                                                                  04732099
046380 0900-GET-ENVIRONMENT-INFO.                                       04733099
046390* PSA                                                             04734099
046400      SET ADDRESS OF CB1     TO NULL                              04735099
046410                                                                  04736099
046420* CVT                                                             04737099
046430      SET ADDRESS OF CVT     TO PTR1(5)                           04738099
046440      MOVE CVT(341:8)        TO SYS-NAME                          04739099
046450      MOVE CVT(857:4)        TO FOUR-BYTES                        04740099
046460      COMPUTE REAL-STORAGE-M = (FULL-WORD + 1023) / 1024          04741099
046470                                                                  04742099
046480* ECVT                                                            04743099
046490      SET ADDRESS OF CB1     TO CVT1(36)                          04744099
046500      MOVE CB1(9:8)          TO SYSPLEX-NAME                      04745099
046510      MOVE CB1(337:8)        TO HARDWARE-NAME                     04746099
046520      MOVE CB1(345:8)        TO LPAR-NAME                         04747099
046530      MOVE CB1(353:8)        TO VM-USERID                         04748099
046540      MOVE CB1(513:6)        TO OS390-RELEASE                     04749099
046550                                                                  04750099
046560      DISPLAY ' '                                                 04751099
046570      DISPLAY '-----Runtime Environment-----'                     04752099
046580      DISPLAY 'LPAR-NAME    : ' LPAR-NAME                         04753099
046590      DISPLAY 'SYSPLEX-NAME : ' SYSPLEX-NAME                      04754099
046600      DISPLAY 'HARDWARE-NAME: ' HARDWARE-NAME                     04755099
046610      DISPLAY 'OS390-RELEASE: ' OS390-RELEASE                     04756099
046620      DISPLAY '-----------------------------'                     04757099
046630      DISPLAY ' ' DISPLAY ' '                                     04758099
046640      .                                                           04759099
046650 0900-EXIT.                                                       04760099
046660      EXIT.                                                       04761099
046670                                                                  04762099
046680                                                                  04763099
046690 1000-INITIALIZE.                                                 04764099
046700******************************************************************04765099
046710*   PARAGRAPH NAME:   1000-INITIALIZE                             04766099
046720*                                                                 04767099
046730*   PURPOSE:                                                      04768099
046740*     THIS PARAGRAPH PERFORMS THE INITIALIZATION FUNCTIONS.       04769099
046750*                                                                 04770099
046760*   PRIMARY PARAGRAPH FUNCTIONS:                                  04771099
046770*   - INITIALIZES THE NEEDED VARIABLES                            04772099
046780*   - CALLS PARAGRAPH TO READ THE PARAMETERS PASSED.              04773099
046790*   - OPENS THE SEQUENTIAL FILES                                  04774099
046800*   - CALLS A PARAGRAPH TO CHECK IF PROGRAM WAS RESTARTED.        04775099
046810*   - READS IN THE FIRST RECORD IN THE FILE.                      04776099
046820******************************************************************04777099
046830     MOVE '1000-INITIALIZE'  TO WS-CURR-PARA                      04778099
046840                                                                  04779099
046850* RESTORE COUNTS                                                  04780099
046860     MOVE WS-SAVE-BILL-RECS-READ                                  04781099
046870       TO WS-TOTL-BILL-RECS-READ                                  04782099
046880     MOVE WS-SAVE-ETNI-RECS-READ                                  04783099
046890       TO WS-TOTL-ETNI-RECS-READ                                  04784099
046900     MOVE WS-SAVE-BILL-ETNI-MATCH-CNT                             04785099
046910       TO WS-TOTL-BILL-ETNI-MATCH-CNT                             04786099
046920     MOVE WS-SAVE-BILL-ETNI-MATCH-NEW                             04787099
046930       TO WS-TOTL-BILL-ETNI-MATCH-NEW                             04788099
046940     MOVE WS-SAVE-BILL-ETNI-MATCH-PP                              04789099
046950       TO WS-TOTL-BILL-ETNI-MATCH-PP                              04790099
046960     MOVE WS-SAVE-BILL-ETNI-MATCH-NH                              04791099
046970       TO WS-TOTL-BILL-ETNI-MATCH-NH                              04792099
046980     MOVE WS-SAVE-BILL-ETNI-MATCH-OK                              04793099
046990       TO WS-TOTL-BILL-ETNI-MATCH-OK                              04794099
047000     MOVE WS-SAVE-PP-BLANK-MATCH-ALL                              04795099
047010       TO WS-TOTL-PP-BLANK-MATCH-ALL                              04796099
047020     MOVE WS-SAVE-BILL-ETNI-DIFF-CNT                              04797099
047030       TO WS-TOTL-BILL-ETNI-DIFF-CNT                              04798099
047040     MOVE WS-SAVE-BILL-NOT-IN-ETNI-CNT                            04799099
047050       TO WS-TOTL-BILL-NOT-IN-ETNI-CNT                            04800099
047060     MOVE WS-SAVE-BILL-NOT-IN-ETNI-NEW                            04801099
047070       TO WS-TOTL-BILL-NOT-IN-ETNI-NEW                            04802099
047080     MOVE WS-SAVE-BILL-NOT-IN-ETNI-PROC                           04803099
047090       TO WS-TOTL-BILL-NOT-IN-ETNI-PROC                           04804099
047100     MOVE WS-SAVE-ETNI-NOT-IN-BILL-CNT                            04805099
047110       TO WS-TOTL-ETNI-NOT-IN-BILL-CNT                            04806099
047120     MOVE WS-SAVE-PO-IN-ETNI-NOT-IN-BILL                          04807099
047130       TO WS-PO-IN-ETNI-NOT-IN-BILL                               04808099
047140     MOVE WS-SAVE-ETNI-NOT-IN-BILL-NEW                            04809099
047150       TO WS-TOTL-ETNI-NOT-IN-BILL-NEW                            04810099
047160     MOVE WS-SAVE-ETNI-NOT-IN-BILL-PROC                           04811099
047170       TO WS-TOTL-ETNI-NOT-IN-BILL-PROC                           04812099
047180     MOVE WS-SAVE-ETNI-NA-NH-CNT                                  04813099
047190       TO WS-TOTL-ETNI-NA-NH-CNT                                  04814099
047200     MOVE WS-SAVE-ETNI-MININV-UPD-CNT                             04815099
047210       TO WS-TOTL-ETNI-MININV-UPD-CNT                             04816099
047220     MOVE WS-SAVE-ETNI-MININV-UPD-ST-CNT                          04817099
047230       TO WS-TOTL-ETNI-MININV-UPD-ST-CNT                          04818099
047240     MOVE WS-SAVE-ETNI-CTNINV-UPD-CNT                             04819099
047250       TO WS-TOTL-ETNI-CTNINV-UPD-CNT                             04820099
047260     MOVE WS-SAVE-ETNI-CTNINV-UPD-ST-CNT                          04821099
047270       TO WS-TOTL-ETNI-CTNINV-UPD-ST-CNT                          04822099
047280     MOVE WS-SAVE-ETNI-CTNINV-INS-CNT                             04823099
047290       TO WS-TOTL-ETNI-CTNINV-INS-CNT                             04824099
047300     MOVE WS-SAVE-ETNI-CTNINV-DUPINS                              04825099
047310       TO WS-TOTL-ETNI-CTNINV-DUPINS                              04826099
047320     MOVE WS-SAVE-ETNI-CTNINV-DLT-CNT                             04827099
047330       TO WS-TOTL-ETNI-CTNINV-DLT-CNT                             04828099
047340     MOVE WS-SAVE-ETNI-CTNHIST-INS-CNT                            04829099
047350       TO WS-TOTL-ETNI-CTNHIST-INS-CNT                            04830099
047360     MOVE WS-SAVE-ETNI-CTNHIST-DUPINS                             04831099
047370       TO WS-TOTL-ETNI-CTNHIST-DUPINS                             04832099
047380     MOVE WS-SAVE-ETNI-NGPCNTS-UPD-CNT                            04833099
047390       TO WS-TOTL-ETNI-NGPCNTS-UPD-CNT                            04834099
047400     MOVE WS-SAVE-ETNI-NGPNLAS-UPD-CNT                            04835099
047410       TO WS-TOTL-ETNI-NGPNLAS-UPD-CNT                            04836099
047420     MOVE WS-SAVE-ERROR-CNT                                       04837099
047430       TO WS-TOTL-ERROR-CNT                                       04838099
047440     MOVE WS-SAVE-ERROR-CTNINV-NOTFND                             04839099
047450       TO WS-TOTL-ERROR-CTNINV-NOTFND                             04840099
047460     MOVE WS-SAVE-ERROR-CTNINV-DUPINS                             04841099
047470       TO WS-TOTL-ERROR-CTNINV-DUPINS                             04842099
047480     MOVE WS-SAVE-ERROR-CTNHIST-DUPINS                            04843099
047490       TO WS-TOTL-ERROR-CTNHIST-DUPINS                            04844099
047500     MOVE WS-SAVE-ERROR-BILLER-NOTMTCH                            04845099
047510       TO WS-TOTL-ERROR-BILLER-NOTMTCH                            04846099
047520     MOVE WS-SAVE-ERROR-LERG6-NOTFND                              04847099
047530       TO WS-TOTL-ERROR-LERG6-NOTFND                              04848099
047540     MOVE WS-SAVE-ERROR-NUMLOC-NOTFND                             04849099
047550       TO WS-TOTL-ERROR-NUMLOC-NOTFND                             04850099
047560     MOVE WS-SAVE-ERROR-NUMGRP-NOTFND                             04851099
047570       TO WS-TOTL-ERROR-NUMGRP-NOTFND                             04852099
047580     MOVE WS-SAVE-ERROR-GRPLOC-NOTFND                             04853099
047590       TO WS-TOTL-ERROR-GRPLOC-NOTFND                             04854099
047600     MOVE WS-SAVE-ERROR-NGPCNT-NOTFND                             04855099
047610       TO WS-TOTL-ERROR-NGPCNT-NOTFND                             04856099
047620     MOVE WS-SAVE-ERROR-NGPNL-NOTFND                              04857099
047630       TO WS-TOTL-ERROR-NGPNL-NOTFND                              04858099
047640     MOVE WS-SAVE-ERROR-DATE-INVALID                              04859099
047650       TO WS-TOTL-ERROR-DATE-INVALID                              04860099
047660     MOVE WS-SAVE-ERROR-TRX-CODE-NOTFND                           04861099
047670       TO WS-TOTL-ERROR-TRX-CODE-NOTFND                           04862099
047680     MOVE WS-SAVE-ERROR-TRX-STAT-NOTFND                           04863099
047690       TO WS-TOTL-ERROR-TRX-STAT-NOTFND                           04864099
047700     MOVE WS-SAVE-ERROR-STATUS-INVALID                            04865099
047710       TO WS-TOTL-ERROR-STATUS-INVALID                            04866099
047720     MOVE WS-SAVE-ERROR-HOLD-REASON                               04867099
047730       TO WS-TOTL-ERROR-HOLD-REASON                               04868099
047740     MOVE WS-SAVE-ERROR-MIN-NUM-NOTFND                            04869099
047750       TO WS-TOTL-ERROR-MIN-NUM-NOTFND                            04870099
047760     MOVE WS-SAVE-ERROR-MIN-NUM-IN-CTN                            04871099
047770       TO WS-TOTL-ERROR-MIN-NUM-IN-CTN                            04872099
047780     MOVE WS-SAVE-ERROR-MIN-NUM-NOTFND-S                          04873099
047790       TO WS-TOTL-ERROR-MIN-NUM-NOTFND-S                          04874099
047800     MOVE WS-SAVE-ERROR-PORT-IND-CHANGED                          04875099
047810       TO WS-TOTL-ERROR-PORT-IND-CHANGED                          04876099
047820     MOVE WS-SAVE-ERROR-PORT-IND-NOT-CHG                          04877099
047830       TO WS-TOTL-ERROR-PORT-IND-NOT-CHG                          04878099
047840*** #870803 SDL BEGIN                                             04879099
047850     MOVE WS-SAVE-ERROR-PRDTYP-MISMATCH                           04880099
047860       TO WS-TOTL-ERROR-PRDTYP-MISMATCH                           04881099
047870*** #870803 SDL END                                               04882099
047880     MOVE WS-SAVE-ERROR-POPO-MISMATCH                             04883099
047890       TO WS-TOTL-ERROR-POPO-MISMATCH                             04884099
047900     MOVE WS-SAVE-ERROR-POIO-MISMATCH                             04885099
047910       TO WS-TOTL-ERROR-POIO-MISMATCH                             04886099
047920     MOVE WS-SAVE-ERROR-NOT-NUMERIC                               04887099
047930       TO WS-TOTL-ERROR-NOT-NUMERIC                               04888099
047940     MOVE WS-SAVE-CNTRLRPT-CNT                                    04889099
047950       TO WS-TOTL-CNTRLRPT-CNT                                    04890099
047960                                                                  04891099
047970* SET REPORT VALUES                                               04892099
047980     IF SYS-RESTART-IND = YES-VALUE                               04893099
047990        PERFORM 2010-VALIDATE-BILL-HEADER                         04894099
048000           THRU 2010-EXIT                                         04895099
048010     END-IF                                                       04896099
048020                                                                  04897099
048030     MOVE WS-SAVE-PAGE-CTR-RECON    TO WS-PAGE-CTR-RECON          04898099
048040     MOVE WS-SAVE-PAGE-CTR-ERROR    TO WS-PAGE-CTR-ERROR          04899099
048050     MOVE WS-SAVE-PAGE-CTR-ERROR-PREPAID TO                       04900099
048060          WS-PAGE-CTR-ERROR-PREPAID                               04901099
048070     MOVE WS-SAVE-PAGE-CTR-ERROR-PO TO                            04902099
048080          WS-PAGE-CTR-ERROR-PO                                    04903099
048090     MOVE WS-SAVE-PAGE-CTR-CNTRLRPT TO WS-PAGE-CTR-CNTRLRPT       04904099
048100                                                                  04905099
048110     COMPUTE WS-LINE-CTR-RECON    = WS-RPT-MAX-LINES + 1          04906099
048120     COMPUTE WS-LINE-CTR-ERROR    = WS-RPT-MAX-LINES + 1          04907099
048130     COMPUTE WS-LINE-CTR-ERROR-PREPAID = WS-RPT-MAX-LINES + 1     04908099
048140     COMPUTE WS-LINE-CTR-ERROR-PO = WS-RPT-MAX-LINES + 1          04909099
048150     COMPUTE WS-LINE-CTR-CNTRLRPT = WS-RPT-MAX-LINES + 1          04910099
048160     MOVE WS-CURR-DATE-TIME-MM         TO HEADING-MM              04911099
048170                                          HEADING-MM-HUB          04912099
048180     MOVE WS-CURR-DATE-TIME-DD         TO HEADING-DD              04913099
048190                                          HEADING-DD-HUB          04914099
048200     MOVE WS-CURR-DATE-TIME-CCYY (3:2) TO HEADING-YY              04915099
048210                                          HEADING-YY-HUB          04916099
048220                                                                  04917099
048230     MOVE WS-CURR-DATE-TIME-HH         TO HEADING-HH              04918099
048240                                          HEADING-HH-HUB          04919099
048250     MOVE WS-CURR-DATE-TIME-MI         TO HEADING-MI              04920099
048260                                          HEADING-M-HUB           04921099
048270                                                                  04922099
048280     MOVE WS-CURR-DATE-TIME-SS         TO HEADING-SS              04923099
048290                                          HEADING-SS-HUB          04924099
048300                                                                  04925099
048310                                                                  04926099
048320* OPEN FILES                                                      04927099
048330     MOVE 'N' TO WS-END-OF-FILE-BILL                              04928099
048340                 WS-END-OF-FILE-ETNI                              04929099
048350                                                                  04930099
048360     PERFORM 8810-OPEN-NMMDNINP-FILE THRU 8810-EXIT               04931099
048370     PERFORM 8100-READ-NEXT-BILL-RECORD                           04932099
048380        THRU 8100-EXIT                                            04933099
048390                                                                  04934099
048400     PERFORM 8820-OPEN-NMCTNINP-FILE THRU 8820-EXIT               04935099
048410     PERFORM 8110-READ-NEXT-ETNI-RECORD                           04936099
048420        THRU 8110-EXIT                                            04937099
048430                                                                  04938099
048440     IF WS-NO-MORE-RECORD-BILL  OR                                04939099
048450        WS-NO-MORE-RECORD-ETNI                                    04940099
048460       DISPLAY '***********************************************'  04941099
048470       DISPLAY '*                                             *'  04942099
048480       DISPLAY '* NO RECORDS PROCESSED. EMPTY INPUT FILE.     *'  04943099
048490       DISPLAY '*                                             *'  04944099
048500       DISPLAY '***********************************************'  04945099
048510       MOVE 'NO RECORDS PROCESSED. EMPTY INPUT FILE'              04946099
048520         TO WS-ABEND-TEXT                                         04947099
048530       PERFORM 9000-ABORT                                         04948099
048540          THRU 9000-EXIT                                          04949099
048550     END-IF                                                       04950099
048560                                                                  04951099
048570     PERFORM 8830-OPEN-RECONOUT-FILE THRU 8830-EXIT               04952099
048580     PERFORM 8840-OPEN-ERROROUT-FILE THRU 8840-EXIT               04953099
048590     PERFORM 8845-OPEN-ERROROUT2-FILE THRU 8845-EXIT              04954099
048600     PERFORM 8847-OPEN-ERROROUT3-FILE THRU 8847-EXIT              04955099
048610     PERFORM 8848-OPEN-ERROROUT4-FILE THRU 8848-EXIT              04956099
048620     PERFORM 8850-OPEN-CNTRLRPT-FILE THRU 8850-EXIT               04957099
048630     PERFORM 8855-OPEN-DTCTLOUT-FILE THRU 8855-EXIT               04958099
048640     PERFORM 1100-GET-PARAM-VALUES-PARMS THRU 1100-EXIT.          04959099
048650                                                                  04960099
048660     OPEN OUTPUT ERRORHUB-FILE                                    04961099
048670                 RECONHUB-FILE.                                   04962099
048680                                                                  04963099
048690*  JA0815  -  Process  New  HUB  Market-Min-Lr  Array             04964099
048700                                                                  04965099
048710     PERFORM  1150-LOAD-MARKET-MIN-LR  THRU                       04966099
048720              1150-LOAD-MARKET-MIN-LR-EXIT                        04967099
048730                                                                  04968099
048740     PERFORM  1150-LOAD-MARKET-MIN-LR-10  THRU  1150-EXIT         04969099
048750        VARYING  WS-MKT-MIN-LR-IDX  FROM  +1  BY  +1              04970099
048760                 UNTIL  WS-SQLCODE   =  +100                      04971099
048770                 OR                                               04972099
048780                 WS-MKT-MIN-LR-IDX  >   WS-MKT-MIN-LR-IDX-MAX     04973099
048790                                                                  04974099
048800     IF  WS-MKT-MIN-LR-IDX  >                                     04975099
048810                          (WS-MKT-MIN-LR-IDX-MAX-LIT * .75)       04976099
048820         MOVE  1  TO  WS-RETURN-CODE                              04977099
048830         DISPLAY  '* * * * * * * * * * * * * * * * * * * * * *'   04978099
048840         DISPLAY  '* * MARKET-MIN-LR  ARRAY  @  75  % Capacity'   04979099
048850         DISPLAY  ' '                                             04980099
048860         DISPLAY  '* * MARKET-MIN-LR  ARRAY  @  75  % Capacity'   04981099
048870         DISPLAY  ' '                                             04982099
048880         DISPLAY  '* * Warning  Return  Code  Was  Set'           04983099
048890         DISPLAY  '* * * * * * * * * * * * * * * * * * * * * *'   04984099
048900     END-IF                                                       04985099
048910                                                                  04986099
048920**  Dynamically  Generate  End  Of  Table  Pointer  **            04987099
048930                                                                  04988099
048940     COMPUTE   WS-MKT-MIN-LR-IDX-MAX  =   WS-MKT-MIN-LR-IDX  +  -204989099
048950                                                                  04990099
048960     .                                                            04991099
048970 1000-EXIT.                                                       04992099
048980      EXIT.                                                       04993099
048990                                                                  04994099
049000                                                                  04995099
049010 1001-MQ-INITIALIZATION.                                          04996099
049020      INITIALIZE WS-QUEUE-RECORD                                  04997099
049030                 WS-QUEUE-INFO                                    04998099
049040                 WS-GATEWAY-VARIABLES                             04999099
049050                 DCLTNI-CLIENT-NAMES                              05000099
049060                 LS-Q-LNKG                                        05001099
049070                 WS-COMMAREA                                      05002099
049080*AXY042706 - BEG                                                  05003099
049090                 SET NO-COMMIT-DSCP TO TRUE                       05004099
049100*AXY042706 - END                                                  05005099
049110      PERFORM Q1020-SELECT-Q-NAME-GATEWAY THRU Q1020-EXIT         05006099
049120      PERFORM Q1021-SELECT-Q-NAMES-ASGN THRU Q1021-EXIT           05007099
049130**  JA0507  - Below Line Commented                                05008099
049140**    PERFORM Q1030-SELECT-Q-MANAGER THRU Q1030-EXIT              05009099
049150      PERFORM Q1040-CONNECT-TO-Q-MGR THRU Q1040-EXIT              05010099
049160      PERFORM Q1050-OPEN-GATEWAY-QUE THRU Q1050-EXIT              05011099
049170      PERFORM Q1051-OPEN-ASGN-QUES THRU Q1051-EXIT.               05012099
049180      PERFORM Q1052-OPEN-CDVC-QUE  THRU Q1052-EXIT.               05013099
049190 1001-EXIT.                                                       05014099
049200      EXIT.                                                       05015099
049210                                                                  05016099
049220                                                                  05017099
049230*-----get the parameterized number of days to wait before issuing-05018099
049240*-----the "PORT-IND UPDT DISALLOWED" message in routine-----------05019099
049250*-----2101-HOW-CURR-IS-LAST-TRX-DATE.-----------------------------05020099
049260                                                                  05021099
049270 1100-GET-PARAM-VALUES-PARMS.                                     05022099
049280**                                                                05023099
049290**  JA1207B  - Comments  Regarding Param-Val Below                05024099
049300**                                                                05025099
049310      MOVE '1100-GET-PARAM-VALUES-PARMS' TO WS-CURR-PARA          05026099
049320                                                                  05027099
049330**                                                                05028099
049340**  JA0709  -  Fix  Latent  Bug                                   05029099
049350**          -  Below  Conditional  Move                           05030099
049360                                                                  05031099
049370     IF SYS-RESTART-IND = YES-VALUE                               05032099
049380        MOVE WS-SAVE-HDR-BILLER-ID   TO   WS-CHECK-BILLER-ID      05033099
049390                                          WS-WHICH-BILLER-ID      05034099
049400        ELSE                                                      05035099
049410                                                                  05036099
049420        MOVE  MDNIN-BILLER-ID  OF  MDNIN-HEADER-FIELDS  TO        05037099
049430                                   WS-CHECK-BILLER-ID             05038099
049440                                   WS-WHICH-BILLER-ID             05039099
049450     END-IF                                                       05040099
049460                                                                  05041099
049470      INITIALIZE SQLCODE                                          05042099
049480      MOVE 'ETNBC16-PORT-IND-DAYS' TO                             05043099
049490            PARAM-CODE OF DCLPARAM-VALUES                         05044099
049500                                                                  05045099
049510      MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES        05046099
049520                                                                  05047099
049530      EXEC SQL                                                    05048099
049540      SELECT                                                      05049099
049550           PRM_VALUE                                              05050099
049560      INTO                                                        05051099
049570          :DCLPARAM-VALUES.PRM-VALUE                              05052099
049580      FROM PARAM_VALUES                                           05053099
049590      WHERE                                                       05054099
049600           PARAM_CODE = :DCLPARAM-VALUES.PARAM-CODE               05055099
049610      END-EXEC                                                    05056099
049620      IF SQLCODE NOT = 0                                          05057099
049630         DISPLAY 'ETNBC16-PORT-IND-DAYS NOT FOUND IN PARAM-VALUES'05058099
049640         DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE             05059099
049650         MOVE SQLCODE TO WS-SQLCODE                               05060099
049660         SET APPL-ERROR TO TRUE                                   05061099
049670         MOVE '1100' TO WS-ERR-LOCATION                           05062099
049680         MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT   05063099
049690         MOVE SQLCODE TO WS-ERR-CODE                              05064099
049700         PERFORM 9000-ABORT THRU 9000-EXIT                        05065099
049710      END-IF                                                      05066099
049720                                                                  05067099
049730     IF PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:2) NUMERIC            05068099
049740        MOVE PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:2) TO            05069099
049750             WS-PORT-IND-DAYS                                     05070099
049760     ELSE                                                         05071099
049770        MOVE ZERO TO WS-PORT-IND-DAYS                             05072099
049780     END-IF.                                                      05073099
049790                                                                  05074099
049800**-------------------------------------------------------------** 05075099
049810**  JA1207B  - 'ETNBC16-CTN-STATUS'                               05076099
049820**                                                                05077099
049830**  Usage:  To NOT process the listed Status's (upto 10)          05078099
049840**          In the event of Not on File from Billing feed, but    05079099
049850**          in eTNI's  Unload                                     05080099
049860**                                                                05081099
049870**  Note:   This Rule takes precedence over the                   05082099
049880**          'ETNBC16-SET-TO-AA ' Listed Below                     05083099
049890**                                                                05084099
049900**          In other words, those items listed in CTN-Status      05085099
049910**          override the Set-To-AA  entries,  thereby  causing    05086099
049920**          matching Status Codes to be Bypassed                  05087099
049930**                                                                05088099
049940**-------------------------------------------------------------** 05089099
049950                                                                  05090099
049960     MOVE 'ETNBC16-CTN-STATUS' TO                                 05091099
049970           PARAM-CODE OF DCLPARAM-VALUES                          05092099
049980                                                                  05093099
049990                                                                  05094099
050000     MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES         05095099
050010                                                                  05096099
050020     EXEC SQL                                                     05097099
050030     SELECT                                                       05098099
050040          PRM_VALUE                                               05099099
050050     INTO                                                         05100099
050060         :DCLPARAM-VALUES.PRM-VALUE                               05101099
050070     FROM PARAM_VALUES                                            05102099
050080     WHERE                                                        05103099
050090          PARAM_CODE = :DCLPARAM-VALUES.PARAM-CODE                05104099
050100     WITH  UR                                                     05105099
050110     END-EXEC                                                     05106099
050120     IF SQLCODE NOT = 0                                           05107099
050130        DISPLAY 'ETNBC16-CTN-STATUS    NOT FOUND IN PARAM-VALUES' 05108099
050140        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05109099
050150        MOVE SQLCODE TO WS-SQLCODE                                05110099
050160        SET APPL-ERROR TO TRUE                                    05111099
050170        MOVE '1100' TO WS-ERR-LOCATION                            05112099
050180        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05113099
050190        MOVE SQLCODE TO WS-ERR-CODE                               05114099
050200        PERFORM 9000-ABORT THRU 9000-EXIT                         05115099
050210     END-IF.                                                      05116099
050220                                                                  05117099
050230     MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:30)  TO            05118099
050240           WS-CTN-STATUS-BYPASS-ARRAY                             05119099
050250                                                                  05120099
050260**-------------------------------------------------------------** 05121099
050270**  JA1207B  - 'ETNBC16-SET-TO-AA '                               05122099
050280**                                                                05123099
050290**  Usage:  Causes the listed Status's (upto 10) to be changed    05124099
050300**          to 'AA', in the event Not on File per Billing &       05125099
050310**          on file per eTNI                                      05126099
050320**                                                                05127099
050330**  Note 1:  This Rule causes the CTN-INV row to be updated to    05128099
050340**           "AA",  please note the MDN MUST Have A MIN for this  05129099
050350**           to Work properly.  Otherwise, the CTN-INV row will   05130099
050360**           be set to "NA".                                      05131099
050370**                                                                05132099
050380**  Note 2:   This Rule is overridden by:                         05133099
050390**           'ETNBC16-CTN-STATUS' Listed Above                    05134099
050400**                                                                05135099
050410**           In other words, those items listed in CTN-Status     05136099
050420**           override the Set-To-AA  entries,  thereby  causing   05137099
050430**           matching Status Codes to be Bypassed                 05138099
050440**                                                                05139099
050450**  Note 3:  An Entry of  'AA'  will  be  ignored.                05140099
050460**                                                                05141099
050470**-------------------------------------------------------------** 05142099
050480                                                                  05143099
050490     MOVE 'ETNBC16-SET-TO-AA ' TO                                 05144099
050500           PARAM-CODE OF DCLPARAM-VALUES                          05145099
050510                                                                  05146099
050520     MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES         05147099
050530                                                                  05148099
050540     EXEC SQL                                                     05149099
050550     SELECT                                                       05150099
050560          PRM_VALUE                                               05151099
050570     INTO                                                         05152099
050580         :DCLPARAM-VALUES.PRM-VALUE                               05153099
050590     FROM PARAM_VALUES                                            05154099
050600     WHERE                                                        05155099
050610          PARAM_CODE = :DCLPARAM-VALUES.PARAM-CODE                05156099
050620     WITH  UR                                                     05157099
050630     END-EXEC                                                     05158099
050640     IF SQLCODE NOT = 0                                           05159099
050650        DISPLAY 'ETNBC16-SET-TO-AA     NOT FOUND IN PARAM-VALUES' 05160099
050660        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05161099
050670        MOVE SQLCODE TO WS-SQLCODE                                05162099
050680        SET APPL-ERROR TO TRUE                                    05163099
050690        MOVE '1100' TO WS-ERR-LOCATION                            05164099
050700        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05165099
050710        MOVE SQLCODE TO WS-ERR-CODE                               05166099
050720        PERFORM 9000-ABORT THRU 9000-EXIT                         05167099
050730     END-IF.                                                      05168099
050740                                                                  05169099
050750     MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:30)  TO            05170099
050760           WS-CTN-STATUS-TO-AA-ARRAY                              05171099
050770                                                                  05172099
050780     INSPECT  WS-CTN-STATUS-TO-AA-ARRAY                           05173099
050790              REPLACING  ALL  "AA"  BY  ".."                      05174099
050800                                                                  05175099
050810**-------------------------------------------------------------** 05176099
050820**  JA0602   - 'ETNBC16-NOT-IN-ETNI'                              05177099
050830**             'APPL-ID =  HUB'                                   05178099
050840**                                                                05179099
050850**  Usage:  Causes the listed Status's (upto 10) to be Bypassed   05180099
050860**          in eTNI, in the event Not on File per ETNI &          05181099
050870**          on file per BILLING  data                             05182099
050880**                                                                05183099
050890**  Note 1: This will ONLY be done,  for  "HUB"  transactions     05184099
050900**          that  have  legitimate  TN,  MIN's.                   05185099
050910**          Legitimate  TN,  MIN's  are confirmed by              05186099
050920**          Market-Min-LR table                                   05187099
050930**                                                                05188099
050940**-------------------------------------------------------------** 05189099
050950                                                                  05190099
050960     MOVE 'ETNBC16-NOT-IN-ETNI ' TO                               05191099
050970           PARAM-CODE OF DCLPARAM-VALUES                          05192099
050980                                                                  05193099
050990     MOVE 'HUB ' TO                                               05194099
051000           PARAM-APPL-ID OF DCLPARAM-VALUES                       05195099
051010                                                                  05196099
051020     MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES         05197099
051030                                                                  05198099
051040     EXEC SQL                                                     05199099
051050     SELECT                                                       05200099
051060          PRM_VALUE                                               05201099
051070     INTO                                                         05202099
051080         :DCLPARAM-VALUES.PRM-VALUE                               05203099
051090     FROM PARAM_VALUES                                            05204099
051100     WHERE                                                        05205099
051110          PARAM_CODE    = :DCLPARAM-VALUES.PARAM-CODE  AND        05206099
051120          PARAM_APPL_ID = :DCLPARAM-VALUES.PARAM-APPL-ID          05207099
051130     WITH  UR                                                     05208099
051140     END-EXEC                                                     05209099
051150                                                                  05210099
051160     IF SQLCODE NOT = 0                                           05211099
051170        DISPLAY 'ETNBC16-NOT-IN-ETNI   NOT FOUND IN PARAM-VALUES' 05212099
051180        DISPLAY '   HUB   '                                       05213099
051190        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05214099
051200        MOVE SQLCODE TO WS-SQLCODE                                05215099
051210        SET APPL-ERROR TO TRUE                                    05216099
051220        MOVE '1100' TO WS-ERR-LOCATION                            05217099
051230        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05218099
051240        MOVE SQLCODE TO WS-ERR-CODE                               05219099
051250        PERFORM 9000-ABORT THRU 9000-EXIT                         05220099
051260     END-IF.                                                      05221099
051270                                                                  05222099
051280     MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:30)  TO            05223099
051290           WS-ETNBC16-NOT-IN-ETNI-ARAY-H                          05224099
051300                                                                  05225099
051310                                                                  05226099
051320**-------------------------------------------------------------** 05227099
051330**  JA0602   - 'ETNBC16-NOT-IN-BILLING'                           05228099
051340**             'APPL-ID =  HUB'                                   05229099
051350**                                                                05230099
051360**  Usage:  Causes the listed Status's (upto 10) to be Bypassed   05231099
051370**          in eTNI, in the event Not on Billing file  &          05232099
051380**          on file per eTNI data                                 05233099
051390**                                                                05234099
051400**  Note 1: This will ONLY be done,  for  "HUB"  transactions     05235099
051410**          that  have  legitimate  TN,  MIN's.                   05236099
051420**          Legitimate  TN,  MIN's  are confirmed by              05237099
051430**          Market-Min-LR table                                   05238099
051440**                                                                05239099
051450**-------------------------------------------------------------** 05240099
051460                                                                  05241099
051470     MOVE 'ETNBC16-NOT-IN-BILLING ' TO                            05242099
051480           PARAM-CODE OF DCLPARAM-VALUES                          05243099
051490                                                                  05244099
051500     MOVE 'HUB ' TO                                               05245099
051510           PARAM-APPL-ID OF DCLPARAM-VALUES                       05246099
051520                                                                  05247099
051530     MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES         05248099
051540                                                                  05249099
051550     EXEC SQL                                                     05250099
051560     SELECT                                                       05251099
051570          PRM_VALUE                                               05252099
051580     INTO                                                         05253099
051590         :DCLPARAM-VALUES.PRM-VALUE                               05254099
051600     FROM PARAM_VALUES                                            05255099
051610     WHERE                                                        05256099
051620          PARAM_CODE    = :DCLPARAM-VALUES.PARAM-CODE  AND        05257099
051630          PARAM_APPL_ID = :DCLPARAM-VALUES.PARAM-APPL-ID          05258099
051640     WITH  UR                                                     05259099
051650     END-EXEC                                                     05260099
051660                                                                  05261099
051670     IF SQLCODE NOT = 0                                           05262099
051680        DISPLAY 'ETNBC16-NOT-IN-BILLING NOT FOUND - PARAM-VALUES' 05263099
051690        DISPLAY '   HUB   '                                       05264099
051700        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05265099
051710        MOVE SQLCODE TO WS-SQLCODE                                05266099
051720        SET APPL-ERROR TO TRUE                                    05267099
051730        MOVE '1100' TO WS-ERR-LOCATION                            05268099
051740        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05269099
051750        MOVE SQLCODE TO WS-ERR-CODE                               05270099
051760        PERFORM 9000-ABORT THRU 9000-EXIT                         05271099
051770     END-IF.                                                      05272099
051780                                                                  05273099
051790     MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:30)  TO            05274099
051800           WS-ETNBC16-N-I-BILLING-ARAY                            05275099
051810                                                                  05276099
051820**  JA0602   -  END                                               05277099
051830                                                                  05278099
051840**-------------------------------------------------------------** 05279099
051850**  JA1208A  - 'ETNBC16-NOT-IN-BILLING'                           05280099
051860**             'APPL-ID =  RETAIL or RESELL'                      05281099
051870**                                                                05282099
051880**  Usage:  Causes the listed Status's (upto 10) to be Bypassed   05283099
051890**          in eTNI, in the event Not on Billing file  &          05284099
051900**          on file per eTNI data                                 05285099
051910**                                                                05286099
051920**  Note 1: This will ONLY be done,  for  "Retail"  or "Reseller" 05287099
051930**          transactions.  CTN  Data  that  matches  the  list of 05288099
051940**          Statuses  will  be  Bypassed  in  the  2300-  Para    05289099
051950**                                                                05290099
051960**-------------------------------------------------------------** 05291099
051970                                                                  05292099
051980     MOVE 'ETNBC16-NOT-IN-BILLING ' TO                            05293099
051990           PARAM-CODE OF DCLPARAM-VALUES                          05294099
052000                                                                  05295099
052010     IF  WS-LEGIT-BILLER-ID-RETAIL                                05296099
052020         MOVE 'RETAIL'  TO   PARAM-APPL-ID OF DCLPARAM-VALUES     05297099
052030     END-IF                                                       05298099
052040                                                                  05299099
052050     IF  WS-LEGIT-BILLER-ID-RESELLER                              05300099
052060         MOVE 'RESELL'  TO   PARAM-APPL-ID OF DCLPARAM-VALUES     05301099
052070     END-IF                                                       05302099
052080                                                                  05303099
052090     IF  WS-LEGIT-BILLER-ID-RETAIL   OR                           05304099
052100         WS-LEGIT-BILLER-ID-RESELLER                              05305099
052110         CONTINUE                                                 05306099
052120       ELSE                                                       05307099
052130         DISPLAY ' RETAIL or RESELL Transaction  Code  Missing'   05308099
052140         DISPLAY ' Can -NOT- Continue  Processing, Abending  NOW' 05309099
052150         SET APPL-ERROR TO TRUE                                   05310099
052160         MOVE 'Trans. Error * ' TO WS-ERR-REASON  WS-ABEND-TEXT   05311099
052170         MOVE '1100' TO WS-ERR-LOCATION                           05312099
052180         PERFORM 9000-ABORT THRU 9000-EXIT                        05313099
052190     END-IF                                                       05314099
052200                                                                  05315099
052210     MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES         05316099
052220                                                                  05317099
052230     EXEC SQL                                                     05318099
052240     SELECT                                                       05319099
052250          PRM_VALUE                                               05320099
052260     INTO                                                         05321099
052270         :DCLPARAM-VALUES.PRM-VALUE                               05322099
052280     FROM PARAM_VALUES                                            05323099
052290     WHERE                                                        05324099
052300          PARAM_CODE    = :DCLPARAM-VALUES.PARAM-CODE  AND        05325099
052310          PARAM_APPL_ID = :DCLPARAM-VALUES.PARAM-APPL-ID          05326099
052320     WITH  UR                                                     05327099
052330     END-EXEC                                                     05328099
052340                                                                  05329099
052350     IF SQLCODE NOT = 0                                           05330099
052360        DISPLAY 'ETNBC16-NOT-IN-BILLING NOT FOUND - PARAM-VALUES' 05331099
052370        DISPLAY ' RETAIL or RESELL '                              05332099
052380        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05333099
052390        MOVE SQLCODE TO WS-SQLCODE                                05334099
052400        SET APPL-ERROR TO TRUE                                    05335099
052410        MOVE '1100' TO WS-ERR-LOCATION                            05336099
052420        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05337099
052430        MOVE SQLCODE TO WS-ERR-CODE                               05338099
052440        PERFORM 9000-ABORT THRU 9000-EXIT                         05339099
052450     END-IF.                                                      05340099
052460                                                                  05341099
052470     MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:30)  TO            05342099
052480           WS-ETNBC16-N-I-BILLING-RE                              05343099
052490                                                                  05344099
052500**-------------------------------------------------------------** 05345099
052510**  JA1208A  - 'ETNBC16-BILLING-PROFILE'                          05346099
052520**             'APPL-ID =  RETAIL '                               05347099
052530**                                                                05348099
052540**  Usage:  Causes the listed Pairs  of  Status's (upto 6)        05349099
052550**          in  eTNI  to  drive  the  Deletion  Attempt  of       05350099
052560**          Billing-Profile-Mdn  table                            05351099
052570**                                                                05352099
052580**  Note 1: This will ONLY be done,  for  "Retail"                05353099
052590**          transactions.  CTN  Data  that  matches  the  list of 05354099
052600**          Statuses  will  be  processed in  the  2100-  Para    05355099
052610**                                                                05356099
052620**  Note 2: Can be expanded  for  "HUB"   &  "Resell",  processng 05357099
052630*                                                                 05358099
052640**-------------------------------------------------------------** 05359099
052650                                                                  05360099
052660     MOVE 'ETNBC16-BILLING-PROFILE'  TO                           05361099
052670                                    PARAM-CODE OF DCLPARAM-VALUES 05362099
052680                                                                  05363099
052690     MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES         05364099
052700                                                                  05365099
052710     IF  WS-LEGIT-BILLER-ID-RETAIL                                05366099
052720                                                                  05367099
052730         MOVE 'RETAIL'  TO   PARAM-APPL-ID OF DCLPARAM-VALUES     05368099
052740                                                                  05369099
052750         EXEC SQL                                                 05370099
052760          SELECT                                                  05371099
052770          PRM_VALUE                                               05372099
052780         INTO                                                     05373099
052790          :DCLPARAM-VALUES.PRM-VALUE                              05374099
052800         FROM PARAM_VALUES                                        05375099
052810         WHERE                                                    05376099
052820          PARAM_CODE    = :DCLPARAM-VALUES.PARAM-CODE  AND        05377099
052830          PARAM_APPL_ID = :DCLPARAM-VALUES.PARAM-APPL-ID          05378099
052840         WITH  UR                                                 05379099
052850         END-EXEC                                                 05380099
052860                                                                  05381099
052870       IF SQLCODE NOT = 0                                         05382099
052880        DISPLAY 'ETNBC16-BILLING-PROFILE  NOT FOUND,PARAM-VALUES' 05383099
052890        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05384099
052900        MOVE SQLCODE TO WS-SQLCODE                                05385099
052910        SET APPL-ERROR TO TRUE                                    05386099
052920        MOVE '1100' TO WS-ERR-LOCATION                            05387099
052930        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05388099
052940        MOVE SQLCODE TO WS-ERR-CODE                               05389099
052950        PERFORM 9000-ABORT THRU 9000-EXIT                         05390099
052960       END-IF                                                     05391099
052970                                                                  05392099
052980       MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:35)  TO          05393099
052990             WS-ETNBC16-I-BILLING                                 05394099
053000                                                                  05395099
053010     END-IF                                                       05396099
053020                                                                  05397099
053030**  JA1208A  -  END                                               05398099
053040                                                                  05399099
053050**-------------------------------------------------------------** 05400099
053060**  JA0809   - 'ETNBC16-INTRA-VISION'                             05401099
053070**             'APPLID  =  VISION '                               05402099
053080**                                                                05403099
053090**  Usage:  Causes the listed Pairs  of  Status's (upto 6)        05404099
053100**          in  eTNI  to  Not  Permit  Updates  for  VISION       05405099
053110**          Cross Instances                                       05406099
053120**                                                                05407099
053130**  Note 1: This will ONLY be done,  for  "Vision"                05408099
053140**          transactions.                                         05409099
053150**                                                                05410099
053160**  Note 2: Only  a  SINGLE  "FROM"  CTN-Status  is  Supported    05411099
053170**                                                                05412099
053180**-------------------------------------------------------------** 05413099
053190                                                                  05414099
053200     IF  WS-VISION                                                05415099
053210                                                                  05416099
053220         MOVE 'ETNBC16-INTRA-VISION'  TO                          05417099
053230                                    PARAM-CODE OF DCLPARAM-VALUES 05418099
053240                                                                  05419099
053250         MOVE 'VISION'  TO   PARAM-APPL-ID OF DCLPARAM-VALUES     05420099
053260                                                                  05421099
053270         MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES     05422099
053280                                                                  05423099
053290         EXEC SQL                                                 05424099
053300          SELECT                                                  05425099
053310          PRM_VALUE                                               05426099
053320         INTO                                                     05427099
053330          :DCLPARAM-VALUES.PRM-VALUE                              05428099
053340         FROM PARAM_VALUES                                        05429099
053350         WHERE                                                    05430099
053360          PARAM_CODE    = :DCLPARAM-VALUES.PARAM-CODE  AND        05431099
053370          PARAM_APPL_ID = :DCLPARAM-VALUES.PARAM-APPL-ID          05432099
053380         WITH  UR                                                 05433099
053390         END-EXEC                                                 05434099
053400                                                                  05435099
053410       IF SQLCODE NOT = 0                                         05436099
053420        DISPLAY 'ETNBC16-INTRA-VISION -NOT FOUND,PARAM-VALUES'    05437099
053430        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05438099
053440        MOVE SQLCODE TO WS-SQLCODE                                05439099
053450        SET APPL-ERROR TO TRUE                                    05440099
053460        MOVE '1100' TO WS-ERR-LOCATION                            05441099
053470        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05442099
053480        MOVE SQLCODE TO WS-ERR-CODE                               05443099
053490        PERFORM 9000-ABORT THRU 9000-EXIT                         05444099
053500       END-IF                                                     05445099
053510                                                                  05446099
053520       MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:30)  TO          05447099
053530             WS-ETNBC16-V-BILLING                                 05448099
053540                                                                  05449099
053550     END-IF                                                       05450099
053560                                                                  05451099
053570                                                                  05452099
053580**-------------------------------------------------------------** 05453099
053590**  JA0310   - 'ETNBC16-CDVC-QUEUE'  -  4G,  Version II           05454099
053600**             'APPLID  =         '                               05455099
053610**                                                                05456099
053620**  Usage:  The  Queue  Name  Accessed  is  used  by  eTNI  to    05457099
053630**          route  a  message  to  ourselves.  This  process      05458099
053640**          make  the  transaction  look  like  it  originated    05459099
053650**          in  a  Billing  System.  In  this  case,  VISION.     05460099
053660**                                                                05461099
053670**-------------------------------------------------------------** 05462099
053680                                                                  05463099
053690     MOVE 'ETNBC16-CDVC-QUEUE'  TO  PARAM-CODE OF DCLPARAM-VALUES 05464099
053700                                                                  05465099
053710     MOVE  SPACES  TO   PARAM-APPL-ID   OF DCLPARAM-VALUES        05466099
053720                        PRM-VALUE-TEXT  OF DCLPARAM-VALUES        05467099
053730                                                                  05468099
053740     EXEC SQL                                                     05469099
053750      SELECT                                                      05470099
053760      PRM_VALUE                                                   05471099
053770      INTO  :DCLPARAM-VALUES.PRM-VALUE                            05472099
053780        FROM PARAM_VALUES                                         05473099
053790      WHERE  PARAM_CODE    = :DCLPARAM-VALUES.PARAM-CODE  AND     05474099
053800             PARAM_APPL_ID = :DCLPARAM-VALUES.PARAM-APPL-ID       05475099
053810         WITH  UR                                                 05476099
053820     END-EXEC                                                     05477099
053830                                                                  05478099
053840     IF SQLCODE NOT = 0                                           05479099
053850        DISPLAY '-------------------------------------------'     05480099
053860        DISPLAY 'PARAM_VALUES Error * * *, accessing CDVC entry'  05481099
053870        DISPLAY 'ETNBC16-CDVC-QUEUE -NOT FOUND,PARAM-VALUES'      05482099
053880        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05483099
053890        DISPLAY '-------------------------------------------'     05484099
053900        MOVE SQLCODE TO WS-SQLCODE                                05485099
053910        SET APPL-ERROR TO TRUE                                    05486099
053920        MOVE '1100' TO WS-ERR-LOCATION                            05487099
053930        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05488099
053940        MOVE SQLCODE TO WS-ERR-CODE                               05489099
053950        PERFORM 9000-ABORT THRU 9000-EXIT                         05490099
053960     END-IF                                                       05491099
053970                                                                  05492099
053980     MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES  TO                  05493099
053990             WS-CDVC-QUEUENAME                                    05494099
054000                                                                  05495099
054010**-------------------------------------------------------------** 05496099
054020**  JA0310   - 'ETNBC16-4G-MATCH'  -  4G,  Version II             05497099
054030**             'APPLID  =  RETAIL or RESELL'                      05498099
054040**                                                                05499099
054050**  Usage:  Governs processing  for  4G  Objects                  05500099
054060**          Indicates "FromTo" Status-Codes                       05501099
054070**          From - Also - New - WS-New-STATUS  (per Billing)      05502099
054080**          To   - Also - Old - WS-Old-STATUS  (per CTN-INV)      05503099
054090**                                                                05504099
054100**  Example: AIAG,  Means  If  'AI' in Billing & 'AG' in 4G       05505099
054110**                           then  Update  to  Billing  Code      05506099
054120**-------------------------------------------------------------** 05507099
054130                                                                  05508099
054140     MOVE 'ETNBC16-4G-MATCH'  TO  PARAM-CODE OF DCLPARAM-VALUES   05509099
054150                                                                  05510099
054160     IF  WS-VISION                                                05511099
054170         MOVE 'RETAIL'  TO     PARAM-APPL-ID  OF DCLPARAM-VALUES  05512099
054180        ELSE                                                      05513099
054190         MOVE 'RESELL'  TO     PARAM-APPL-ID  OF DCLPARAM-VALUES  05514099
054200     END-IF                                                       05515099
054300                                                                  05516099
054310     MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES         05517099
054320                                                                  05518099
054330     EXEC SQL                                                     05519099
054340      SELECT                                                      05520099
054350      PRM_VALUE                                                   05521099
054360      INTO  :DCLPARAM-VALUES.PRM-VALUE                            05522099
054370        FROM PARAM_VALUES                                         05523099
054380      WHERE  PARAM_CODE    = :DCLPARAM-VALUES.PARAM-CODE  AND     05524099
054390             PARAM_APPL_ID = :DCLPARAM-VALUES.PARAM-APPL-ID       05525099
054400         WITH  UR                                                 05526099
054410     END-EXEC                                                     05527099
054420                                                                  05528099
054430     IF SQLCODE NOT = 0                                           05529099
054440        DISPLAY 'ETNBC16-4G-MATCH  -NOT FOUND,PARAM-VALUES'       05530099
054450        DISPLAY 'For: '   PARAM-APPL-ID  OF DCLPARAM-VALUES       05531099
054460        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05532099
054470        MOVE SQLCODE TO WS-SQLCODE                                05533099
054480        SET APPL-ERROR TO TRUE                                    05534099
054490        MOVE '1100' TO WS-ERR-LOCATION                            05535099
054500        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05536099
054510        MOVE SQLCODE TO WS-ERR-CODE                               05537099
054520        PERFORM 9000-ABORT THRU 9000-EXIT                         05538099
054530     END-IF                                                       05539099
054540**                                                                05540099
054550     MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:080)  TO           05541099
054560             WS-ETNBC16-4G-PROCESS-ARAY                           05542099
054570                                                                  05543099
054580     PERFORM  VARYING  WS-CTN-STATUS-D-A-IDX  FROM  1  BY  1      05544099
054590              UNTIL    WS-CTN-STATUS-D-A-IDX  >                   05545099
054600                       WS-CTN-STATUS-D-A-IDX-MAX                  05546099
054610          IF  WS-ETNBC16-4G-PROCESS-ARAY-L(WS-CTN-STATUS-D-A-IDX) 05547099
054620              =  SPACES                                           05548099
054630              MOVE  WS-CTN-STATUS-D-A-IDX  TO                     05549099
054640                       WS-CTN-STATUS-D-A-IDX-MAX                  05550099
054650          END-IF                                                  05551099
054660     END-PERFORM                                                  05552099
054670                                                                  05553099
054680                                                                  05554099
054690**-------------------------------------------------------------** 05555099
054700**  JA1011   - 'ETNBC16-VTS-MATCH'  -                             05556099
054710**                                                                05557099
054720**  Usage:  Governs processing  for  VTS                          05558099
054730**          Indicates "FromTo" Status-Codes                       05559099
054740**          From - Also - New - WS-New-STATUS  (per Billing)      05560099
054750**          To   - Also - Old - WS-Old-STATUS  (per CTN-INV)      05561099
054760**                                                                05562099
054770**  Example: AIAGP  Means  If  'AI' in Billing & 'AG' in eTNI     05563099
054780**                           then  Update  to  Billing  Status    05564099
054790**-------------------------------------------------------------** 05565099
054800     INITIALIZE  DCLPARAM-VALUES                                  05566099
054810                                                                  05567099
054820     MOVE 'ETNBC16-VTS-MATCH' TO  PARAM-CODE OF DCLPARAM-VALUES   05568099
054830                                                                  05569099
054840     MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES         05570099
054850                                                                  05571099
054860     EXEC SQL                                                     05572099
054870      SELECT                                                      05573099
054880      PRM_VALUE                                                   05574099
054890      INTO  :DCLPARAM-VALUES.PRM-VALUE                            05575099
054900        FROM PARAM_VALUES                                         05576099
054910      WHERE  PARAM_CODE    = :DCLPARAM-VALUES.PARAM-CODE  AND     05577099
054920             PARAM_APPL_ID = :DCLPARAM-VALUES.PARAM-APPL-ID       05578099
054930         WITH  UR                                                 05579099
054940     END-EXEC                                                     05580099
054950                                                                  05581099
054960     IF SQLCODE NOT = 0                                           05582099
054970        DISPLAY 'ETNBC16-VTS-MATCH -NOT FOUND,PARAM-VALUES'       05583099
054980        DISPLAY 'For: '   PARAM-APPL-ID  OF DCLPARAM-VALUES       05584099
054990        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05585099
055000        MOVE SQLCODE TO WS-SQLCODE                                05586099
055010        SET APPL-ERROR TO TRUE                                    05587099
055020        MOVE '1100' TO WS-ERR-LOCATION                            05588099
055030        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05589099
055040        MOVE SQLCODE TO WS-ERR-CODE                               05590099
055050        PERFORM 9000-ABORT THRU 9000-EXIT                         05591099
055060     END-IF                                                       05592099
055070**                                                                05593099
055080     MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:100)  TO           05594099
055090             WS-BC16-VTS-MATCH-PROCESS-AREA                       05595099
055100                                                                  05596099
055110     PERFORM  VARYING  WS-CTN-STATUS-V-A1-IDX  FROM  1  BY  1     05597099
055120              UNTIL    WS-CTN-STATUS-V-A1-IDX  >                  05598099
055130                       WS-CTN-STATUS-V-A1-IDX-MAX                 05599099
055140      IF  WS-BC16-VTS-MATCH-PROCESS-AR-L                          05600099
055150                                   (WS-CTN-STATUS-V-A1-IDX)       05601099
055160              =  SPACES                                           05602099
055170              COMPUTE  WS-CTN-STATUS-V-A1-IDX-MAX =               05603099
055180                       WS-CTN-STATUS-V-A1-IDX  +  -1              05604099
055190          END-IF                                                  05605099
055200     END-PERFORM                                                  05606099
055210                                                                  05607099
055220                                                                  05608099
055230**-------------------------------------------------------------** 05609099
055240**  JA1011   - 'ETNBC16-VTS-NOT-IN-BILLING'                       05610099
055250**                                                                05611099
055260**  Usage:  Governs processing  for  VTS                          05612099
055270**          Indicates "FromTo" Status-Codes                       05613099
055280**          From - Also - New - WS-New-STATUS  (per Billing)      05614099
055290**          To   - Also - Old - WS-Old-STATUS  (per CTN-INV)      05615099
055300**                                                                05616099
055310**  Example: AIAGP  Means  If  'AI' in Billing & 'AG' in eTNI     05617099
055320**                           then  Update  to  Billing  Status    05618099
055330**-------------------------------------------------------------** 05619099
055340     INITIALIZE  DCLPARAM-VALUES                                  05620099
055350                                                                  05621099
055360     MOVE 'ETNBC16-VTS-NOT-IN-BILLING'  TO                        05622099
055370                                  PARAM-CODE OF DCLPARAM-VALUES   05623099
055380     MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES         05624099
055390                                                                  05625099
055400     EXEC SQL                                                     05626099
055410      SELECT                                                      05627099
055420      PRM_VALUE                                                   05628099
055430      INTO  :DCLPARAM-VALUES.PRM-VALUE                            05629099
055440        FROM PARAM_VALUES                                         05630099
055450      WHERE  PARAM_CODE    = :DCLPARAM-VALUES.PARAM-CODE  AND     05631099
055460             PARAM_APPL_ID = :DCLPARAM-VALUES.PARAM-APPL-ID       05632099
055470         WITH  UR                                                 05633099
055480     END-EXEC                                                     05634099
055490                                                                  05635099
055500     IF SQLCODE NOT = 0                                           05636099
055510        DISPLAY  'ETNBC16-VTS-NOT-IN-BILLING '                    05637099
055520                                 ' -NOT FOUND,PARAM-VALUES'       05638099
055530        DISPLAY 'For: '   PARAM-APPL-ID  OF DCLPARAM-VALUES       05639099
055540        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05640099
055550        MOVE SQLCODE TO WS-SQLCODE                                05641099
055560        SET APPL-ERROR TO TRUE                                    05642099
055570        MOVE '1100' TO WS-ERR-LOCATION                            05643099
055580        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05644099
055590        MOVE SQLCODE TO WS-ERR-CODE                               05645099
055600        PERFORM 9000-ABORT THRU 9000-EXIT                         05646099
055610     END-IF                                                       05647099
055620**                                                                05648099
055630     MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:100)  TO           05649099
055640             WS-BC16-VTS-NIB-PROCESS-ARAY                         05650099
055650                                                                  05651099
055660     PERFORM  VARYING  WS-CTN-STATUS-V-B-IDX  FROM  1  BY  1      05652099
055670              UNTIL    WS-CTN-STATUS-V-B-IDX  >                   05653099
055680                       WS-CTN-STATUS-V-B-IDX-MAX                  05654099
055690      IF  WS-BC16-VTS-NIB-PROCESS-ARAY-L(WS-CTN-STATUS-V-B-IDX)   05655099
055700              =  SPACES                                           05656099
055710              COMPUTE  WS-CTN-STATUS-V-B-IDX-MAX =                05657099
055720                       WS-CTN-STATUS-V-B-IDX  +  -1               05658099
055730          END-IF                                                  05659099
055740     END-PERFORM                                                  05660099
055750                                                                  05661099
055760                                                                  05662099
055770**-------------------------------------------------------------** 05663099
055780**  JA1011   - 'ETNBC16-VTS-NOT-IN-ETNI'                          05664099
055790**                                                                05665099
055800**  Usage:  Governs processing  for  VTS                          05666099
055810**          Indicates "FromTo" Status-Codes                       05667099
055820**          From - Also - New - WS-New-STATUS  (per Billing)      05668099
055830**          To   - Also - Old - WS-Old-STATUS  (per CTN-INV)      05669099
055840**                                                                05670099
055850**  Example: AIAGP  Means  If  'AI' in Billing & 'AG' in eTNI     05671099
055860**                           then  Update  to  Billing  Status    05672099
055870**-------------------------------------------------------------** 05673099
055880     INITIALIZE  DCLPARAM-VALUES                                  05674099
055890                                                                  05675099
055900     MOVE 'ETNBC16-VTS-NOT-IN-ETNI'  TO                           05676099
055910                                  PARAM-CODE OF DCLPARAM-VALUES   05677099
055920                                                                  05678099
055930     MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES         05679099
055940                                                                  05680099
055950     EXEC SQL                                                     05681099
055960      SELECT                                                      05682099
055970      PRM_VALUE                                                   05683099
055980      INTO  :DCLPARAM-VALUES.PRM-VALUE                            05684099
055990        FROM PARAM_VALUES                                         05685099
056000      WHERE  PARAM_CODE    = :DCLPARAM-VALUES.PARAM-CODE  AND     05686099
056010             PARAM_APPL_ID = :DCLPARAM-VALUES.PARAM-APPL-ID       05687099
056020         WITH  UR                                                 05688099
056030     END-EXEC                                                     05689099
056040                                                                  05690099
056050     IF SQLCODE NOT = 0                                           05691099
056060        DISPLAY  'ETNBC16-VTS-NOT-IN-ETNI  '                      05692099
056070                                 ' -NOT FOUND,PARAM-VALUES'       05693099
056080        DISPLAY 'For: '   PARAM-APPL-ID  OF DCLPARAM-VALUES       05694099
056090        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05695099
056100        MOVE SQLCODE TO WS-SQLCODE                                05696099
056110        SET APPL-ERROR TO TRUE                                    05697099
056120        MOVE '1100' TO WS-ERR-LOCATION                            05698099
056130        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05699099
056140        MOVE SQLCODE TO WS-ERR-CODE                               05700099
056150        PERFORM 9000-ABORT THRU 9000-EXIT                         05701099
056160     END-IF                                                       05702099
056170**                                                                05703099
056180     MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:100)  TO           05704099
056190             WS-BC16-VTS-NIE-PROCESS-ARAY                         05705099
056200                                                                  05706099
056210     PERFORM  VARYING  WS-CTN-STATUS-V-C-IDX  FROM  1  BY  1      05707099
056220              UNTIL    WS-CTN-STATUS-V-C-IDX  >                   05708099
056230                       WS-CTN-STATUS-V-C-IDX-MAX                  05709099
056240      IF  WS-BC16-VTS-NIB-PROCESS-ARAY-L(WS-CTN-STATUS-V-C-IDX)   05710099
056250              =  SPACES                                           05711099
056260              COMPUTE  WS-CTN-STATUS-V-C-IDX-MAX =                05712099
056270                       WS-CTN-STATUS-V-C-IDX  +  -1               05713099
056280          END-IF                                                  05714099
056290     END-PERFORM                                                  05715099
056300                                                                  05716099
056310*  Capture  VTS  NL  List                                         05717099
056320                                                                  05718099
056330     INITIALIZE  WS-VTS-NL-TABLE                                  05719099
056340                 DCLPARAM-VALUES                                  05720099
056350                                                                  05721099
056360     EXEC SQL                                                     05722099
056370        DECLARE GETPARAM CURSOR FOR                               05723099
056380        SELECT NL_ID, RELATED_NL                                  05724099
056390           FROM  NUMBER_LOCATION                                  05725099
056400        WHERE  NL_TYPE         =  'T'                             05726099
056500*       AND    RELATED_NL      =  'DEFLT'                         05727099
056600          WITH  UR                                                05728099
056700     END-EXEC.                                                    05729099
056800                                                                  05730099
056900     EXEC  SQL                                                    05731099
057000           OPEN  GETPARAM                                         05732099
057100     END-EXEC                                                     05733099
057200                                                                  05734099
057210     MOVE  SQLCODE  TO  WS-SQLCODE                                05735099
057220                                                                  05736099
057221     IF SQLCODE NOT = 0                                           05737099
057222        DISPLAY  'OPEN  GETPARAM  '                               05738099
057223                                 ' -NOT FOUND, NL-TYPE = T'       05739099
057224        MOVE   0   TO  WS-SUB-VTS-NL-MAX                          05740099
057225***>> DON  <<***  DO NOT TOUCH ANY PROGRAMS with MY ID            05741099
057226        DISPLAY 'For: '   PARAM-APPL-ID  OF DCLPARAM-VALUES       05742099
057227        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05743099
057228        MOVE SQLCODE TO WS-SQLCODE                                05744099
057229        SET APPL-ERROR TO TRUE                                    05745099
057230        MOVE '1100' TO WS-ERR-LOCATION                            05746099
057231        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05747099
057232        MOVE SQLCODE TO WS-ERR-CODE                               05748099
057233        PERFORM 9000-ABORT THRU 9000-EXIT                         05749099
057234        GO  TO  1100-EXIT                                         05750099
057235     END-IF                                                       05751099
057236                                                                  05752099
057237     PERFORM  UNTIL  SQLCODE  =  +100                             05753099
057238        EXEC  SQL                                                 05754099
057239              FETCH GETPARAM                                      05755099
057240              INTO :DCLNUMBER-LOCATION.NL-ID,                     05756099
057241                   :DCLNUMBER-LOCATION.RELATED-NL                 05757099
056380                   :DCLNL-NULL-INDS.RELATED-NL-NI                 05758099
057242*       AND    RELATED_NL      =  'DEFLT'                         05759099
057243        END-EXEC                                                  05760099
057244                                                                  05761099
057245        IF  SQLCODE  NOT  =  +100                                 05762099
057246            ADD 1 TO WS-SUB-VTS-NL                                05763099
057247            MOVE NL-ID  IN  DCLNUMBER-LOCATION                    05764099
057248                 TO  WS-VTS-NL(WS-SUB-VTS-NL)                     05765099
057249        END-IF                                                    05766099
057250                                                                  05767099
057251        IF  RELATED-NL  IN  DCLNUMBER-LOCATION  =  'DEFLT'        05768099
057252            MOVE  NL-ID  IN  DCLNUMBER-LOCATION  TO               05769099
057253                                          WS-BC16-VTS-NIB-DEFAULT 05770099
057254        END-IF                                                    05771099
057255                                                                  05772099
057256        IF  SQLCODE  <  +0                                        05773099
057257             DISPLAY  'FETCH  GETPARAM  '                         05774099
057258                               ' -Failed  '                       05775099
057259             DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE         05776099
057260             MOVE SQLCODE TO WS-SQLCODE                           05777099
057261             SET APPL-ERROR TO TRUE                               05778099
057262             MOVE '1100' TO WS-ERR-LOCATION                       05779099
057263             MOVE 'ROW NOT FOUND. ' TO                            05780099
057264                                WS-ERR-REASON  WS-ABEND-TEXT      05781099
057265             MOVE SQLCODE TO WS-ERR-CODE                          05782099
057266             PERFORM 9000-ABORT THRU 9000-EXIT                    05783099
057267        END-IF                                                    05784099
057268      END-PERFORM                                                 05785099
057269                                                                  05786099
057270**  JA1012  -  Below  Comment                                     05787099
057269                                                                  05788099
057270     IF  WS-SUB-VTS-NL  >  +1                                     05789099
057271         DISPLAY  'NL  Type  T, exceeds  1 **'                    05790099
057272**       MOVE  2  TO  WS-RETURN-CODE                              05791099
057273     END-IF                                                       05792099
057274                                                                  05793099
057275      EXEC  SQL                                                   05794099
057276            CLOSE  GETPARAM                                       05795099
057277      END-EXEC                                                    05796099
057278                                                                  05797099
057279      COMPUTE  WS-SUB-VTS-NL-MAX  =  WS-SUB-VTS-NL  +  -0         05798099
057280                                                                  05799099
057281      IF  SQLCODE  <  +0                                          05800099
057282          DISPLAY  'FETCH  GETPARAM  '                            05801099
057283                            ' -NOT FOUND,PARAM-VALUES'            05802099
057284          DISPLAY 'For: '   PARAM-APPL-ID                         05803099
057285                            OF DCLPARAM-VALUES                    05804099
057286          DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE            05805099
057287          MOVE SQLCODE TO WS-SQLCODE                              05806099
057288          SET APPL-ERROR TO TRUE                                  05807099
057289          MOVE '1100' TO WS-ERR-LOCATION                          05808099
057290          MOVE 'ROW NOT FOUND. ' TO                               05809099
057291                             WS-ERR-REASON  WS-ABEND-TEXT         05810099
057292          MOVE SQLCODE TO WS-ERR-CODE                             05811099
057293          PERFORM 9000-ABORT THRU 9000-EXIT                       05812099
057294      END-IF                                                      05813099
057295                                                                  05814099
057296                                                                  05815099
057297**-------------------------------------------------------------** 05816099
057298**  JA0412   - 'ETNBC16-5XX-MATCH'  -                             05817099
057299**                                                                05818099
057300**  Usage:  Governs processing  for  5XX  Match                   05819099
057301**          Indicates "FromTo" Status-Codes                       05820099
057302**          From - Also - New - WS-New-STATUS  (per Billing)      05821099
057303**          To   - Also - Old - WS-Old-STATUS  (per CTN-INV)      05822099
057304**                                                                05823099
057305**  Example: AIAGP  Means  If  'AI' in Billing & 'AG' in eTNI     05824099
057306**                           then  Update  to  Billing  Status    05825099
057307**-------------------------------------------------------------** 05826099
057308     INITIALIZE  DCLPARAM-VALUES                                  05827099
057309                                                                  05828099
057310     MOVE 'ETNBC16-5XX-MATCH' TO  PARAM-CODE OF DCLPARAM-VALUES   05829099
057320                                                                  05830099
057330     MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES         05831099
057340                                                                  05832099
057350     EXEC SQL                                                     05833099
057360      SELECT                                                      05834099
057370      PRM_VALUE                                                   05835099
057380      INTO  :DCLPARAM-VALUES.PRM-VALUE                            05836099
057390        FROM PARAM_VALUES                                         05837099
057400      WHERE  PARAM_CODE    = :DCLPARAM-VALUES.PARAM-CODE  AND     05838099
057410             PARAM_APPL_ID = :DCLPARAM-VALUES.PARAM-APPL-ID       05839099
057420         WITH  UR                                                 05840099
057430     END-EXEC                                                     05841099
057440                                                                  05842099
057450     IF SQLCODE NOT = 0                                           05843099
057460        DISPLAY 'ETNBC16-5XX-MATCH -NOT FOUND,PARAM-VALUES'       05844099
057470        DISPLAY 'For: '   PARAM-APPL-ID  OF DCLPARAM-VALUES       05845099
057480        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05846099
057490        MOVE SQLCODE TO WS-SQLCODE                                05847099
057500        SET APPL-ERROR TO TRUE                                    05848099
057510        MOVE '1100' TO WS-ERR-LOCATION                            05849099
057520        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05850099
057530        MOVE SQLCODE TO WS-ERR-CODE                               05851099
057540        PERFORM 9000-ABORT THRU 9000-EXIT                         05852099
057550     END-IF                                                       05853099
057560**                                                                05854099
057570     MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:100)  TO           05855099
057580             WS-BC16-5XX-MATCH-PROCESS-AREA                       05856099
057590                                                                  05857099
057600     PERFORM  VARYING  WS-CTN-STATUS-V-A1-IDX  FROM  1  BY  1     05858099
057610              UNTIL    WS-CTN-STATUS-V-A1-IDX  >                  05859099
057620                       WS-CTN-STATUS-V-A1-IDX-MAX                 05860099
057630      IF  WS-BC16-5XX-MATCH-PROCESS-AR-L                          05861099
057640                                   (WS-CTN-STATUS-V-A1-IDX)       05862099
057650              =  SPACES                                           05863099
057660              COMPUTE  WS-CTN-STATUS-V-A1-IDX-MAX =               05864099
057670                       WS-CTN-STATUS-V-A1-IDX  +  -1              05865099
057680          END-IF                                                  05866099
057690     END-PERFORM                                                  05867099
057700                                                                  05868099
057710                                                                  05869099
057720**-------------------------------------------------------------** 05870099
057730**  JA0412   - 'ETNBC16-5XX-NOT-IN-BILLING'                       05871099
057740**                                                                05872099
057750**  Usage:  Governs processing  for  VTS                          05873099
057760**          Indicates "FromTo" Status-Codes                       05874099
057770**          From - Also - New - WS-New-STATUS  (per Billing)      05875099
057780**          To   - Also - Old - WS-Old-STATUS  (per CTN-INV)      05876099
057790**                                                                05877099
057800**  Example: AIAGP  Means  If  'AI' in Billing & 'AG' in eTNI     05878099
057810**                           then  Update  to  Billing  Status    05879099
057820**-------------------------------------------------------------** 05880099
057830     INITIALIZE  DCLPARAM-VALUES                                  05881099
057840                                                                  05882099
057850     MOVE 'ETNBC16-5XX-NOT-IN-BILLING'  TO                        05883099
057860                                  PARAM-CODE OF DCLPARAM-VALUES   05884099
057870     MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES         05885099
057880                                                                  05886099
057890     EXEC SQL                                                     05887099
057900      SELECT                                                      05888099
057910      PRM_VALUE                                                   05889099
057920      INTO  :DCLPARAM-VALUES.PRM-VALUE                            05890099
057930        FROM PARAM_VALUES                                         05891099
057940      WHERE  PARAM_CODE    = :DCLPARAM-VALUES.PARAM-CODE  AND     05892099
057950             PARAM_APPL_ID = :DCLPARAM-VALUES.PARAM-APPL-ID       05893099
057960         WITH  UR                                                 05894099
057970     END-EXEC                                                     05895099
057980                                                                  05896099
057990     IF SQLCODE NOT = 0                                           05897099
058000        DISPLAY  'ETNBC16-5XX-NOT-IN-BILLING '                    05898099
058010                                 ' -NOT FOUND,PARAM-VALUES'       05899099
058020        DISPLAY 'For: '   PARAM-APPL-ID  OF DCLPARAM-VALUES       05900099
058030        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05901099
058040        MOVE SQLCODE TO WS-SQLCODE                                05902099
058050        SET APPL-ERROR TO TRUE                                    05903099
058060        MOVE '1100' TO WS-ERR-LOCATION                            05904099
058070        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05905099
058080        MOVE SQLCODE TO WS-ERR-CODE                               05906099
058090        PERFORM 9000-ABORT THRU 9000-EXIT                         05907099
058100     END-IF                                                       05908099
058110**                                                                05909099
058120     MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:100)  TO           05910099
058130             WS-BC16-5XX-NIB-PROCESS-ARAY                         05911099
058140                                                                  05912099
058150     PERFORM  VARYING  WS-CTN-STATUS-V-B-IDX  FROM  1  BY  1      05913099
058160              UNTIL    WS-CTN-STATUS-V-B-IDX  >                   05914099
058170                       WS-CTN-STATUS-V-B-IDX-MAX                  05915099
058180      IF  WS-BC16-5XX-NIB-PROCESS-ARAY-L(WS-CTN-STATUS-V-B-IDX)   05916099
058190              =  SPACES                                           05917099
058200              COMPUTE  WS-CTN-STATUS-V-B-IDX-MAX =                05918099
058210                       WS-CTN-STATUS-V-B-IDX  +  -1               05919099
058220          END-IF                                                  05920099
058230     END-PERFORM                                                  05921099
058240                                                                  05922099
058250**-------------------------------------------------------------** 05923099
058260**  JA0412   - 'ETNBC16-5XX-NOT-IN-ETNI'                          05924099
058270**                                                                05925099
058280**  Usage:  Governs processing  for  VTS                          05926099
058290**          Indicates "FromTo" Status-Codes                       05927099
058300**          From - Also - New - WS-New-STATUS  (per Billing)      05928099
058310**          To   - Also - Old - WS-Old-STATUS  (per CTN-INV)      05929099
058320**                                                                05930099
058330**  Example: AIAGP  Means  If  'AI' in Billing & 'AG' in eTNI     05931099
058340**                           then  Update  to  Billing  Status    05932099
058350**-------------------------------------------------------------** 05933099
058360     INITIALIZE  DCLPARAM-VALUES                                  05934099
058370                                                                  05935099
058380     MOVE 'ETNBC16-5XX-NOT-IN-ETNI'  TO                           05936099
058390                                  PARAM-CODE OF DCLPARAM-VALUES   05937099
058400                                                                  05938099
058410     MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES         05939099
058420                                                                  05940099
058430     EXEC SQL                                                     05941099
058440      SELECT                                                      05942099
058450      PRM_VALUE                                                   05943099
058460      INTO  :DCLPARAM-VALUES.PRM-VALUE                            05944099
058470        FROM PARAM_VALUES                                         05945099
058480      WHERE  PARAM_CODE    = :DCLPARAM-VALUES.PARAM-CODE  AND     05946099
058490             PARAM_APPL_ID = :DCLPARAM-VALUES.PARAM-APPL-ID       05947099
058500         WITH  UR                                                 05948099
058510     END-EXEC                                                     05949099
058520                                                                  05950099
058530     IF SQLCODE NOT = 0                                           05951099
058540        DISPLAY  'ETNBC16-5XX-NOT-IN-ETNI  '                      05952099
058550                                 ' -NOT FOUND,PARAM-VALUES'       05953099
058560        DISPLAY 'For: '   PARAM-APPL-ID  OF DCLPARAM-VALUES       05954099
058570        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              05955099
058580        MOVE SQLCODE TO WS-SQLCODE                                05956099
058590        SET APPL-ERROR TO TRUE                                    05957099
058600        MOVE '1100' TO WS-ERR-LOCATION                            05958099
058610        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    05959099
058620        MOVE SQLCODE TO WS-ERR-CODE                               05960099
058630        PERFORM 9000-ABORT THRU 9000-EXIT                         05961099
058640     END-IF                                                       05962099
058650**                                                                05963099
058660     MOVE  PRM-VALUE-TEXT OF DCLPARAM-VALUES(1:100)  TO           05964099
058670             WS-BC16-5XX-NIE-PROCESS-ARAY                         05965099
058680                                                                  05966099
058690     PERFORM  VARYING  WS-CTN-STATUS-V-C-IDX  FROM  1  BY  1      05967099
058700              UNTIL    WS-CTN-STATUS-V-C-IDX  >                   05968099
058710                       WS-CTN-STATUS-V-C-IDX-MAX                  05969099
058720      IF  WS-BC16-5XX-NIB-PROCESS-ARAY-L(WS-CTN-STATUS-V-C-IDX)   05970099
058730              =  SPACES                                           05971099
058740              COMPUTE  WS-CTN-STATUS-V-C-IDX-MAX =                05972099
058750                       WS-CTN-STATUS-V-C-IDX  +  -1               05973099
058760          END-IF                                                  05974099
058770     END-PERFORM                                                  05975099
058780                                                                  05976099
058790*  Capture  5XX  NL  List                                         05977099
058800                                                                  05978099
058810     INITIALIZE  WS-5XX-NL-TABLE                                  05979099
058820                 DCLPARAM-VALUES                                  05980099
058830                                                                  05981099
058840     EXEC SQL                                                     05982099
058850        DECLARE GET5XX  CURSOR FOR                                05983099
058860        SELECT NL_ID,                                             05984099
058870               RELATED_NL                                         05985099
058880           FROM  NUMBER_LOCATION                                  05986099
058890        WHERE  NL_TYPE         =  'X'                             05987099
058900*       AND    RELATED_NL      =  'DEFLT'                         05988099
059000          WITH  UR                                                05989099
059100     END-EXEC.                                                    05990099
059200                                                                  05991099
059300     EXEC  SQL                                                    05992099
059400           OPEN  GET5XX                                           05993099
059500     END-EXEC                                                     05994099
059600                                                                  05995099
059700     MOVE  SQLCODE  TO  WS-SQLCODE                                05996099
059710                                                                  05997099
059720     IF SQLCODE NOT = 0                                           05998099
059730        DISPLAY  'OPEN  GET5XX  '                                 05999099
059740                                 ' -NOT FOUND, NL-TYPE = X'       06000099
059741        MOVE   0   TO  WS-SUB-5XX-NL-MAX                          06001099
059742        DISPLAY 'For: '   PARAM-APPL-ID  OF DCLPARAM-VALUES       06002099
059743        DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE              06003099
059744        MOVE SQLCODE TO WS-SQLCODE                                06004099
059745        SET APPL-ERROR TO TRUE                                    06005099
059746        MOVE '1100' TO WS-ERR-LOCATION                            06006099
059747        MOVE 'ROW NOT FOUND. ' TO WS-ERR-REASON  WS-ABEND-TEXT    06007099
059748        MOVE SQLCODE TO WS-ERR-CODE                               06008099
059749        PERFORM 9000-ABORT THRU 9000-EXIT                         06009099
059750        GO  TO  1100-EXIT                                         06010099
059751     END-IF                                                       06011099
059752                                                                  06012099
059753     PERFORM  UNTIL  SQLCODE  =  +100                             06013099
059754        EXEC  SQL                                                 06014099
059755              FETCH GET5XX                                        06015099
059756              INTO :DCLNUMBER-LOCATION.NL-ID,                     06016099
059757                   :DCLNUMBER-LOCATION.RELATED-NL                 06017099
056380                   :DCLNL-NULL-INDS.RELATED-NL-NI                 06018099
059758        END-EXEC                                                  06019099
059759                                                                  06020099
059760        IF  SQLCODE  NOT  =  +100                                 06021099
059761            ADD 1 TO WS-SUB-5XX-NL                                06022099
059762            MOVE NL-ID  IN  DCLNUMBER-LOCATION                    06023099
059763                 TO  WS-5XX-NL(WS-SUB-5XX-NL)                     06024099
059764            MOVE RELATED-NL  IN  DCLNUMBER-LOCATION               06025099
059765                 TO  WS-5XX-RELATED-NL(WS-SUB-5XX-NL)             06026099
059766            IF  RELATED-NL  IN  DCLNUMBER-LOCATION  =  'DEFLT'    06027099
059767                MOVE  NL-ID  IN  DCLNUMBER-LOCATION  TO           06028099
059768                                        WS-BC16-5XX-NIB-DEFAULT   06029099
059769            END-IF                                                06030099
059770        END-IF                                                    06031099
059771                                                                  06032099
059772        IF  SQLCODE  <  +0                                        06033099
059773             DISPLAY  'FETCH  GET5XX  '                           06034099
059774                               ' -Failed  '                       06035099
059775             DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE         06036099
059776             MOVE SQLCODE TO WS-SQLCODE                           06037099
059777             SET APPL-ERROR TO TRUE                               06038099
059778             MOVE '1100' TO WS-ERR-LOCATION                       06039099
059779             MOVE 'ROW NOT FOUND. ' TO                            06040099
059780                                WS-ERR-REASON  WS-ABEND-TEXT      06041099
059781             MOVE SQLCODE TO WS-ERR-CODE                          06042099
059782             PERFORM 9000-ABORT THRU 9000-EXIT                    06043099
059783        END-IF                                                    06044099
059784      END-PERFORM                                                 06045099
059785                                                                  06046099
059786     IF  WS-SUB-5XX-NL  >  +1                                     06047099
059787         DISPLAY  'NL  Type  X, exceeds  1 **'                    06048099
059788*        MOVE  2  TO  WS-RETURN-CODE                              06049099
059789     END-IF                                                       06050099
059790                                                                  06051099
059791      EXEC  SQL                                                   06052099
059792            CLOSE  GET5XX                                         06053099
059793      END-EXEC                                                    06054099
059794                                                                  06055099
059795      COMPUTE  WS-SUB-5XX-NL-MAX  =  WS-SUB-5XX-NL  +  -0         06056099
059796                                                                  06057099
059797      IF  SQLCODE  <  +0                                          06058099
059798          DISPLAY  'FETCH  GET5XX  '                              06059099
059799                            ' -NOT FOUND,PARAM-VALUES'            06060099
059800          DISPLAY 'For: '   PARAM-APPL-ID                         06061099
059801                            OF DCLPARAM-VALUES                    06062099
059802          DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE            06063099
059803          MOVE SQLCODE TO WS-SQLCODE                              06064099
059804          SET APPL-ERROR TO TRUE                                  06065099
059805          MOVE '1100' TO WS-ERR-LOCATION                          06066099
059806          MOVE 'ROW NOT FOUND. ' TO                               06067099
059807                             WS-ERR-REASON  WS-ABEND-TEXT         06068099
059808          MOVE SQLCODE TO WS-ERR-CODE                             06069099
059809          PERFORM 9000-ABORT THRU 9000-EXIT                       06070099
059810      END-IF                                                      06071099
059811     .                                                            06072099
059812 1100-EXIT.                                                       06073099
059813      EXIT.                                                       06074099
059814                                                                  06075099
059815**  JA0815   -  BELOW  PARA                                       06076099
059816                                                                  06077099
059817 1150-LOAD-MARKET-MIN-LR.                                         06078099
059818******************************************************************06079099
059819**                                                                06080099
059820**  Process  Market-Min-Lr  Cursor  &  Populate  Array            06081099
059830**                                                                06082099
059840******************************************************************06083099
059850                                                                  06084099
059860     MOVE '1150-LOAD-MARKET-MIN-LR  '  TO  WS-CURR-PARA           06085099
059870                                                                  06086099
059880     EXEC SQL                                                     06087099
059890        DECLARE GETMKT  CURSOR  FOR                               06088099
059900        SELECT MIN_BLK                                            06089099
059910           FROM  MARKET_MIN_LR                                    06090099
059920        WHERE MIN_BLK            > :WS-MIN-BLK                    06091099
059930        AND   LOGICAL_VM_MACHINE = :WS-HUB-TEXT                   06092099
059940          ORDER  BY  MIN_BLK                                      06093099
059950          WITH  UR                                                06094099
059960     END-EXEC.                                                    06095099
059970                                                                  06096099
059980     EXEC  SQL                                                    06097099
059990           OPEN  GETMKT                                           06098099
060000     END-EXEC                                                     06099099
060010                                                                  06100099
060020     MOVE  SQLCODE  TO  WS-SQLCODE                                06101099
060030                                                                  06102099
060040     IF  WS-SQLCODE  =  ZERO                                      06103099
060050         CONTINUE                                                 06104099
060060         ELSE                                                     06105099
060070         PERFORM  9000-ABORT       THRU    9000-EXIT              06106099
060080     END-IF                                                       06107099
060090                                                                  06108099
060100     .                                                            06109099
060110 1150-LOAD-MARKET-MIN-LR-EXIT.  EXIT.                             06110099
060120                                                                  06111099
060130 1150-LOAD-MARKET-MIN-LR-10.                                      06112099
060140                                                                  06113099
060150     MOVE '1150-LOAD-MARKET-MIN-LR-10'  TO  WS-CURR-PARA          06114099
060160                                                                  06115099
060170***  COMPUTE   WS-MKT-MIN-LR-IDX-MAX  =   WS-MKT-MIN-LR-IDX  +  -106116099
060180                                                                  06117099
060190     EXEC  SQL                                                    06118099
060200           FETCH GETMKT                                           06119099
060210           INTO :DCLMARKET-MIN-LR.MIN-BLK                         06120099
060220     END-EXEC                                                     06121099
060230                                                                  06122099
060240     MOVE  SQLCODE  TO  WS-SQLCODE                                06123099
060250                                                                  06124099
060260     IF  WS-SQLCODE  =  +100                                      06125099
060270         EXEC  SQL                                                06126099
060280               CLOSE   GETMKT                                     06127099
060290         END-EXEC                                                 06128099
060300         MOVE  WS-MKT-MIN-LR-IDX  TO  WS-MKT-MIN-LR-IDX-MAX       06129099
060310         GO  TO  1150-EXIT                                        06130099
060320     END-IF                                                       06131099
060330                                                                  06132099
060340     IF  WS-SQLCODE  =  ZERO                                      06133099
060350         CONTINUE                                                 06134099
060360         ELSE                                                     06135099
060370         PERFORM  9000-ABORT       THRU    9000-EXIT              06136099
060380     END-IF                                                       06137099
060390                                                                  06138099
060400     MOVE  MIN-BLK  OF  DCLMARKET-MIN-LR  TO  WS-MIN-BLK          06139099
060410     MOVE  WS-MIN-BLK  TO  WS-MARKET-MIN-LR(WS-MKT-MIN-LR-IDX)    06140099
060420                                                                  06141099
060430                                                                  06142099
060440     .                                                            06143099
060450 1150-EXIT.                                                       06144099
060460      EXIT.                                                       06145099
060470                                                                  06146099
060480 2000-PROGRAM-MAIN.                                               06147099
060490******************************************************************06148099
060500*                                                                 06149099
060510*   PARAGRAPH NAME:  2000-PROGRAM-MAIN                            06150099
060520*                                                                 06151099
060530*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   06152099
060540*             DO MAIN FLOW                                        06153099
060550*                                                                 06154099
060560*   PRIMARY PARAGRAPH FUNCTIONS:                                  06155099
060570*     - 2100-MDN-MATCH                                            06156099
060580*     - 2200-MDN-NOT-IN-ETNI                                      06157099
060590*     - 2300-MDN-NOT-IN-BILL                                      06158099
060600*                                                                 06159099
060610******************************************************************06160099
060620     MOVE '2000-PROGRAM-MAIN'  TO WS-CURR-PARA                    06161099
060630                                                                  06162099
060640     MOVE  SPACES  TO  WS-CTNIN-CTN-STATUS-PREV                   06163099
060650                                                                  06164099
060660* CHECK IF THERE ARE NO MORE RECORDS TO BE PROCESSED              06165099
060670     IF WS-NO-MORE-RECORD-BILL OR                                 06166099
060680        WS-NO-MORE-RECORD-ETNI                                    06167099
060690        PERFORM 2500-WRAP-UP-ROUTINE     THRU 2500-EXIT           06168099
060700          UNTIL WS-NO-MORE-RECORD-BILL                            06169099
060710            AND WS-NO-MORE-RECORD-ETNI                            06170099
060720        GO TO 2000-EXIT                                           06171099
060730     END-IF                                                       06172099
060740                                                                  06173099
060750* BYPASS MDN HEADER RECORD                                        06174099
                                                                        06175099
060760     IF WS-MDNIN-HEADER                                           06176099
060770        DISPLAY 'LOCAL BILLING SYSTEM MDN FILE HEADER: '          06177099
060780        DISPLAY '   DATE/TIME   : ' MDNIN-DATE-TIME               06178099
060790                                 OF MDNIN-HEADER-FIELDS           06179099
060800        DISPLAY '   REF TABLE ID: ' MDNIN-REF-TABLE-ID            06180099
060810                                 OF MDNIN-HEADER-FIELDS           06181099
060820        DISPLAY '   BILLER ID   : ' MDNIN-BILLER-ID               06182099
060830                                 OF MDNIN-HEADER-FIELDS           06183099
060840        DISPLAY '   USER ID     : ' MDNIN-USER-ID                 06184099
060850                                 OF MDNIN-HEADER-FIELDS           06185099
060860        DISPLAY '   APPL ID     : ' MDNIN-APPL-ID                 06186099
060870                                 OF MDNIN-HEADER-FIELDS           06187099
060880        DISPLAY '   RUN NO      : ' MDNIN-RUN-NO                  06188099
060890                                 OF MDNIN-HEADER-FIELDS           06189099
060900        DISPLAY ' '                                               06190099
060910        MOVE MDNIN-BILLER-ID OF MDNIN-HEADER-FIELDS TO            06191099
060920             WS-SAVE-MDNIN-BILLER-ID                              06192099
060930                                                                  06193099
060940*-------if input parm is REPORT/UPDATE/UPDDEL/UPDDNA,      we have06194099
060950*-------to be sensitive to the input MDNIN date. It can't be less-06195099
060960*-------than the current date. If so, show error message and abend06196099
060970*-------(If input parm is REPORX/UPDATX/UPDDEX, no test on date)--06197099
060980                                                                  06198099
060990                                                                  06199099
061000*ANDY:                                                            06200099
061010*-------just for tests, make file date & curr date the same-------06201099
061020*       MOVE MDNIN-DATE-TIME OF MDNIN-HEADER-FIELDS TO            06202099
061030*            WS-CURR-DATE-TIME-MINUS-1DAY                         06203099
061040*-----------------------------------------------------------------06204099
061050                                                                  06205099
061060        IF (WS-PARM-UPDATE OR WS-PARM-REPORT OR                   06206099
061070            WS-PARM-UPDDEL OR WS-PARM-UPDDNA)                     06207099
061080            AND                                                   06208099
061090            MDNIN-DATE-TIME OF MDNIN-HEADER-FIELDS  <             06209099
061100            WS-CURR-DATE-TIME-MINUS-1DAY                          06210099
061110            DISPLAY ' ' DISPLAY ' ' DISPLAY                       06211099
061120           ' ____________________________________'                06212099
061130            DISPLAY                                               06213099
061140           ' | E R R O R   i n   E T N B C 1 6  |'                06214099
061150            DISPLAY                                               06215099
061160           ' |                                  |'                06216099
061170            DISPLAY                                               06217099
061180           ' | The parm passed to ETNBC16 was   |'                06218099
061190            DISPLAY                                               06219099
061200           ' | either "REPORT" or "UPDATE" or   |'                06220099
061210            DISPLAY                                               06221099
061220           ' | "UPDDEL" or "UPDDNA"             |'                06222099
061230            DISPLAY                                               06223099
061240           ' | and the MDNIN Header             |'                06224099
061250            DISPLAY                                               06225099
061260           ' | Date was less than Current Date. |'                06226099
061270            DISPLAY                                               06227099
061280           ' | The input MDNIN file may be old. |'                06228099
061290            DISPLAY                                               06229099
061300           ' | The program performed no         |'                06230099
061310            DISPLAY                                               06231099
061320           ' | processing and will abend.       |'                06232099
061330            DISPLAY                                               06233099
061340           ' |__________________________________|'                06234099
061350            DISPLAY ' '                                           06235099
061360            DISPLAY ' MDNIN Header Date:        '                 06236099
061370                      MDNIN-DATE-TIME OF MDNIN-HEADER-FIELDS      06237099
061380            DISPLAY ' Current Date Minus 1 Day: '                 06238099
061390                      WS-CURR-DATE-TIME-MINUS-1DAY                06239099
061400            DISPLAY ' ' DISPLAY ' '                               06240099
061410            MOVE 'OBSOLETE INPUT MDNIN FILE.' TO WS-ABEND-TEXT    06241099
061420            PERFORM 9000-ABORT THRU 9000-EXIT                     06242099
061430        END-IF                                                    06243099
061440                                                                  06244099
061450*-------now that we're done with the "X" parms, reset to normal---06245099
061460        IF WS-PARM-UPDATX                                         06246099
061470           MOVE 'UPDATE' TO WS-PARM-PROCESS-REQ                   06247099
061480        END-IF                                                    06248099
061490        IF WS-PARM-REPORX                                         06249099
061500           MOVE 'REPORT' TO WS-PARM-PROCESS-REQ                   06250099
061510        END-IF                                                    06251099
061520        IF WS-PARM-UPDDEX                                         06252099
061530           MOVE 'UPDDEL' TO WS-PARM-PROCESS-REQ                   06253099
061540        END-IF                                                    06254099
061550        IF WS-PARM-UPDDNX                                         06255099
061560           MOVE 'UPDDNA' TO WS-PARM-PROCESS-REQ                   06256099
061570        END-IF                                                    06257099
061580                                                                  06258099
061590*-------populate print line with MDNIN Header data to be printed--06259099
061600*-------later at the end of program in the Control Report---------06260099
061610        MOVE MDNIN-DATE-TIME OF MDNIN-HEADER-FIELDS TO            06261099
061620             HDR-LINE-DATE-TIME                                   06262099
061630        MOVE MDNIN-REF-TABLE-ID OF MDNIN-HEADER-FIELDS TO         06263099
061640             HDR-LINE-REF-TABLE-ID                                06264099
061650        MOVE MDNIN-BILLER-ID OF MDNIN-HEADER-FIELDS TO            06265099
061660             HDR-LINE-BILLER-ID                                   06266099
061670        MOVE MDNIN-USER-ID OF MDNIN-HEADER-FIELDS TO              06267099
061680             HDR-LINE-USER-ID                                     06268099
061690        MOVE MDNIN-APPL-ID OF MDNIN-HEADER-FIELDS TO              06269099
061700             HDR-LINE-APPL-ID                                     06270099
061710        MOVE MDNIN-RUN-NO OF MDNIN-HEADER-FIELDS TO               06271099
061720             HDR-LINE-RUN-NO                                      06272099
061730        MOVE MDNIN-BILLER-ID OF MDNIN-HEADER-FIELDS TO            06273099
061740             WS-SAVE-HDR-BILLER-ID                                06274099
061750        PERFORM 2010-VALIDATE-BILL-HEADER THRU 2010-EXIT          06275099
061760        MOVE 'Y' TO WS-DISPLAY-HDR-DATE                           06276099
061770        PERFORM 2040-PROCESS-HDR-DATE THRU 2040-EXIT              06277099
061780        PERFORM 6700-WRITE-DTCTLOUT-RECORD THRU 6700-EXIT         06278099
061790        PERFORM 8100-READ-NEXT-BILL-RECORD THRU 8100-EXIT         06279099
061800        GO TO 2000-EXIT                                           06280099
061810        END-IF                                                    06281099
061820                                                                  06282099
061830*----bypass MDN trailer record------------------------------------06283099
061840     IF WS-MDNIN-TRAILER                                          06284099
061850        DISPLAY ' '                                               06285099
061860        DISPLAY 'LOCAL BILLING SYSTEM MDN FILE TRAILER: '         06286099
061870        DISPLAY '   RECORD COUNT: ' MDNIN-RECORD-COUNT            06287099
061880        PERFORM 8100-READ-NEXT-BILL-RECORD                        06288099
061890           THRU 8100-EXIT                                         06289099
061900        GO TO 2000-EXIT                                           06290099
061910     END-IF                                                       06291099
061920                                                                  06292099
061930     INITIALIZE WS-COMINGLED-IND                                  06293099
061940                DCLCTN-INV                                        06294099
061950                DCLCTN-INV-HISTORY                                06295099
061960                WS-MATCH-KEY-BILL                                 06296099
061970                WS-MATCH-KEY-ETNI                                 06297099
061980                USE-CTN-FIELDS-FOR-KEY                            06298099
061990                CTN-HAS-VZW-SPID                                  06299099
062000                ALLOW-PORT-IND-CHG                                06300099
062010                IS-THIS-I2K-INPUT                                 06301099
062020                SAVE-IS-THIS-I2K-INPUT                            06302099
062030                WS-SAVED-NL                                       06303099
062040                                                                  06304099
062050*----Mins are NOT updated when processing I2K input (sometimes!)--06305099
062060**** JA0507 - Comment  Below                                      06306099
062070**** PERFORM 2400-CHECK-FOR-I2K THRU 2400-EXIT                    06307099
062080                                                                  06308099
062090                                                                  06309099
062100*=================================================================06310099
062110                                                                  06311099
062120*----capture CTNs from both Biller and eTNI input files-----------06312099
062130     MOVE MDNIN-MDN TO WS-MATCH-KEY-BILL-MDN                      06313099
062140                                                                  06314099
062150*----if the PREVIOUS iteration was a Forced MDN match, then-------06315099
062160*----populate the next eTNI CTN with the saved value populated----06316099
062170*----during the Forced MDN match routine in last process cycle.---06317099
062180*----Also, restore the original eTNI input record read in the last06318099
062190*----process cycle, stored just before overlay by CTN-INV fields.-06319099
062200     IF FORCED-MDN-MATCH-FLAG = 'Y'                               06320099
062210        INITIALIZE FORCED-MDN-MATCH-FLAG                          06321099
062220        MOVE WS-MATCH-KEY-ETNI-MDN-SAVE TO                        06322099
062230             WS-MATCH-KEY-ETNI-MDN                                06323099
062240        MOVE WS-CTNIN-RECORD-SAVED TO WS-CTNIN-RECORD             06324099
062250     ELSE                                                         06325099
062260*----previous iteration was NOT a forced MDN match. Populate match06326099
062270*----key from incomming flat eTNI input file----------------------06327099
062280        MOVE WS-CTNIN-CTN-TEXT (1:WS-CTNIN-CTN-LEN) TO            06328099
062290             WS-MATCH-KEY-ETNI-MDN                                06329099
062300     END-IF                                                       06330099
062310                                                                  06331099
062320*=================================================================06332099
062330                                                                  06333099
062340                                                                  06334099
062350     MOVE WS-MATCH-KEY-BILL-MDN TO WS-MATCH-KEY-BILL-MDN-SAVE     06335099
062360     MOVE WS-MATCH-KEY-ETNI-MDN TO WS-MATCH-KEY-ETNI-MDN-SAVE     06336099
062370                                                                  06337099
062380                                                                  06338099
062390*    Clear off flags from previous MDN/CTN iteration              06339099
062400     INITIALIZE EXISTANCE-VARIABLES                               06340099
062410                                                                  06341099
062420*----We want to filter out eTNI records with an "AG" in Status----06342099
062430*----and a "SB" in Port-Indicator and a null Number location.-----06343099
062440*----Billing will not have these. These will be updated in the----06344099
062450*----batch process for Snapbacks.---------------------------------06345099
062460                                                                  06346099
062470     IF WS-CTNIN-CTN-STATUS = 'AG' AND                            06347099
062480        WS-CTNIN-PORT-IND = 'SB' AND                              06348099
062490       (WS-CTNIN-NL = SPACES OR WS-CTNIN-NL = LOW-VALUES)         06349099
062500           ADD 1 TO FILTERED-SNAPBACKS                            06350099
062510           PERFORM 8110-READ-NEXT-ETNI-RECORD THRU 8110-EXIT      06351099
062520           GO TO 2000-EXIT                                        06352099
062530     END-IF                                                       06353099
062540                                                                  06354099
062550*    M I S M A T C H E D   B I L L E R  C H E C K                 06355099
062560                                                                  06356099
062570*----Before file matches begin - perform this test.---------------06357099
062580*----If Biller MDN not in eTNI, see if this CTN exists in CTN-INV-06358099
062590*----under a different Biller with a Status of PO.----------------06359099
062600*----If so, move CTN-INV to WS-CTNIN fields (input etni field) and06360099
062610*----and run through 2100-MDN-MATCH routine-----------------------06361099
062620                                                                  06362099
062630     IF WS-MATCH-KEY-BILL < WS-MATCH-KEY-ETNI                     06363099
062640        MOVE MDNIN-MDN TO WS-MDN                                  06364099
062650                                                                  06365099
062660*       read CTN-INV using this Biller's MDN as key               06366099
062670        PERFORM 7001-SELECT-CTN-INV THRU 7001-EXIT                06367099
062680                                                                  06368099
062690*       if found, populate WS-CTNIN eTNI input file fields        06369099
062700*       and set eTNI match key (will equal Biller match key).     06370099
062710        IF FORCED-MDN-MATCH-FLAG = 'Y'                            06371099
062720           PERFORM 7002-MOVE-CTN-INV-TO-WS-CTNIN THRU             06372099
062730                   7002-EXIT                                      06373099
062740           MOVE WS-CTNIN-CTN-TEXT(1:WS-CTNIN-CTN-LEN) TO          06374099
062750                WS-MATCH-KEY-ETNI-MDN                             06375099
062760           PERFORM 2100-MDN-MATCH THRU 2100-EXIT                  06376099
062770           PERFORM 8500-CHECK-COMMIT THRU 8500-EXIT               06377099
062780*          after 2100-MDN-MATCH is done, clean off CTN-INV dclgen,06378099
062790*          reset eTNI match key to saved CTN, read next Biller    06379099
062800*          record and exit routine to loop for next iteration.    06380099
062810           INITIALIZE DCLCTN-INV                                  06381099
062820           PERFORM 8100-READ-NEXT-BILL-RECORD THRU 8100-EXIT      06382099
062830           GO TO 2000-EXIT                                        06383099
062840        END-IF                                                    06384099
062850                                                                  06385099
062860*       not found in CTN-INV, clean CTN-INV dclgen & reset match  06386099
062870*       key's original input file value. Continue on and perform  06387099
062880*       match logic below. (no special processing for RSS).       06388099
062890        IF FORCED-MDN-MATCH-FLAG NOT = 'Y'                        06389099
062900           INITIALIZE FORCED-MDN-MATCH-FLAG                       06390099
062910           INITIALIZE DCLCTN-INV                                  06391099
062920           MOVE WS-MATCH-KEY-ETNI-MDN-SAVE TO                     06392099
062930                WS-MATCH-KEY-ETNI-MDN                             06393099
062940        END-IF                                                    06394099
062950     END-IF                                                       06395099
062960                                                                  06396099
062970*----NGP Extension Project:                                       06397099
062980*----if incomming eTNI NGP is empty, write error message to-------06398099
062990*----error report. Based on match keys, read the correct files----06399099
063000*----and leave this iteration of 2000 routine---------------------06400099
063010     IF WS-CTNIN-NGP = SPACE OR                                   06401099
063020        WS-CTNIN-NGP = LOW-VALUES                                 06402099
063030        ADD 1 TO WS-TOTL-ERROR-NGP-ARE-EMPTY                      06403099
063040        MOVE 'ETNI' TO WS-SYSTEM                                  06404099
063050        MOVE 'ETNI NGP BLANK - SKIPPED' TO WS-COMMENT             06405099
063060        MOVE WS-CTNIN-NGP TO WS-ADDTL-INFO                        06406099
063070        PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT              06407099
063080        PERFORM 6500-WRITE-ERROR-RPT  THRU 6500-EXIT              06408099
063090        PERFORM 8500-CHECK-COMMIT     THRU 8500-EXIT              06409099
063100                                                                  06410099
063110        IF WS-MATCH-KEY-BILL = WS-MATCH-KEY-ETNI                  06411099
063120           PERFORM 8100-READ-NEXT-BILL-RECORD THRU 8100-EXIT      06412099
063130           PERFORM 8110-READ-NEXT-ETNI-RECORD THRU 8110-EXIT      06413099
063140           GO TO 2000-EXIT                                        06414099
063150       END-IF                                                     06415099
063160                                                                  06416099
063170        IF WS-MATCH-KEY-BILL < WS-MATCH-KEY-ETNI                  06417099
063180           PERFORM 8100-READ-NEXT-BILL-RECORD THRU 8100-EXIT      06418099
063190           GO TO 2000-EXIT                                        06419099
063200        END-IF                                                    06420099
063210                                                                  06421099
063220        IF WS-MATCH-KEY-BILL > WS-MATCH-KEY-ETNI                  06422099
063230           PERFORM 8110-READ-NEXT-ETNI-RECORD THRU 8110-EXIT      06423099
063240           GO TO 2000-EXIT                                        06424099
063250        END-IF                                                    06425099
063260     END-IF                                                       06426099
063270                                                                  06427099
063280*----NGP Extension Project:                                       06428099
063290*----fetch Biller-ID from Number Group table instead of using-----06429099
063300*----the first position of NGP.-----------------------------------06430099
063310*----If NGP not found in NUMBER-GROUP table in 7040 routine-------06431099
063320*----write error message to error report. Based on match keys,----06432099
063330*----read the correct files and leave this iteration of 2000 rtn.-06433099
063340*----(after 7040 rtn, the Biller ends up in WS-ETNDC38-BILLER)----06434099
063350                                                                  06435099
063360     IF WS-CTNIN-NGP NOT = WS-HOLD-NGP                            06436099
063370        MOVE WS-CTNIN-NGP TO WS-HOLD-NGP                          06437099
063380        PERFORM 7040-GET-BILLER-FROM-NGP-TABLE THRU 7040-EXIT     06438099
063390        IF WS-SKIPPED-FLAG = 'Y'                                  06439099
063400           MOVE SPACE TO WS-SKIPPED-FLAG                          06440099
063410           PERFORM 8500-CHECK-COMMIT THRU 8500-EXIT               06441099
063420                                                                  06442099
063430           IF WS-MATCH-KEY-BILL = WS-MATCH-KEY-ETNI               06443099
063440              PERFORM 8100-READ-NEXT-BILL-RECORD THRU 8100-EXIT   06444099
063450              PERFORM 8110-READ-NEXT-ETNI-RECORD THRU 8110-EXIT   06445099
063460              GO TO 2000-EXIT                                     06446099
063470           END-IF                                                 06447099
063480                                                                  06448099
063490           IF WS-MATCH-KEY-BILL < WS-MATCH-KEY-ETNI               06449099
063500              PERFORM 8100-READ-NEXT-BILL-RECORD THRU 8100-EXIT   06450099
063510              GO TO 2000-EXIT                                     06451099
063520           END-IF                                                 06452099
063530                                                                  06453099
063540           IF WS-MATCH-KEY-BILL > WS-MATCH-KEY-ETNI               06454099
063550              PERFORM 8110-READ-NEXT-ETNI-RECORD THRU 8110-EXIT   06455099
063560              GO TO 2000-EXIT                                     06456099
063570           END-IF                                                 06457099
063580        END-IF                                                    06458099
063590     END-IF                                                       06459099
063600                                                                  06460099
063610                                                                  06461099
063620*=================================================================06462099
063630*-------Program's Main Match/Control Break routine is below-------06463099
063640*=================================================================06464099
063650                                                                  06465099
063660*       CASE 1: Biller's MDN matches eTNI's CTN                   06466099
063670        IF WS-MATCH-KEY-BILL = WS-MATCH-KEY-ETNI                  06467099
063680           PERFORM 2100-MDN-MATCH             THRU 2100-EXIT      06468099
063690           PERFORM 8500-CHECK-COMMIT          THRU 8500-EXIT      06469099
063700           PERFORM 8100-READ-NEXT-BILL-RECORD THRU 8100-EXIT      06470099
063710           PERFORM 8110-READ-NEXT-ETNI-RECORD THRU 8110-EXIT      06471099
063720           GO TO 2000-EXIT                                        06472099
063730        END-IF                                                    06473099
063740                                                                  06474099
063750*       CASE 2: Biller's MDN not on eTNI's file                   06475099
063760        IF WS-MATCH-KEY-BILL < WS-MATCH-KEY-ETNI                  06476099
063770           PERFORM 2200-MDN-NOT-IN-ETNI       THRU 2200-EXIT      06477099
063780           PERFORM 8100-READ-NEXT-BILL-RECORD THRU 8100-EXIT      06478099
063790           GO TO 2000-EXIT                                        06479099
063800        END-IF                                                    06480099
063810                                                                  06481099
063820**                                                                06482099
063830                                                                  06483099
063840**  JA0507 - End                                                  06484099
063850                                                                  06485099
063860*       CASE 3: eTNI's CTN not on Biller's file                   06486099
063870        IF WS-MATCH-KEY-BILL > WS-MATCH-KEY-ETNI                  06487099
063880           PERFORM 2300-MDN-NOT-IN-BILL       THRU 2300-EXIT      06488099
063890*AXY042706 - BEG                                                  06489099
063900**         IF COMMIT-DSCP                                         06490099
063910** JA0410     PERFORM Q1011-CMIT-QUEUE        THRU Q1011-EXIT     06491099
063920**         END-IF                                                 06492099
063930*AXY042706 - END                                                  06493099
063940           PERFORM 8110-READ-NEXT-ETNI-RECORD THRU 8110-EXIT      06494099
063950           GO TO 2000-EXIT                                        06495099
063960        END-IF                                                    06496099
063970                                                                  06497099
063980     .                                                            06498099
063990 2000-EXIT.                                                       06499099
064000     EXIT.                                                        06500099
064010                                                                  06501099
064020                                                                  06502099
064030 2010-VALIDATE-BILL-HEADER.                                       06503099
064040******************************************************************06504099
064050*                                                                 06505099
064060*   PARAGRAPH NAME:  2010-VALIDATE-BILL-HEADER                    06506099
064070*                                                                 06507099
064080*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   06508099
064090*             EDIT                                                06509099
064100*                                                                 06510099
064110******************************************************************06511099
064120     MOVE '2010-VALIDATE-BILL-HEADER' TO WS-CURR-PARA             06512099
064130                                                                  06513099
064140                                                                  06514099
064150*AGB 11/21/05                                                     06515099
064160     MOVE WS-SAVE-HDR-BILLER-ID TO                                06516099
064170          WS-CHECK-BILLER-ID OF WS-COMMON-BILLERID                06517099
064180                                                                  06518099
064190     IF NOT WS-LEGIT-BILLER-ID-ALL                                06519099
064200        DISPLAY '                                            '    06520099
064210        DISPLAY '********************************************'    06521099
064220        DISPLAY '*                                           '    06522099
064230        DISPLAY '* I N V A L I D   H D R   B I L L E R   I D '    06523099
064240        DISPLAY '*                                           '    06524099
064250        DISPLAY '* VALUE: ' WS-SAVE-HDR-BILLER-ID                 06525099
064260        DISPLAY '*                                           '    06526099
064270        DISPLAY '********************************************'    06527099
064280        MOVE 'INVALID BILL HEADER BILLER ID' TO WS-ABEND-TEXT     06528099
064290        PERFORM 9000-ABORT THRU 9000-EXIT                         06529099
064300     END-IF                                                       06530099
064310                                                                  06531099
064320     MOVE WS-SAVE-HDR-BILLER-ID TO                                06532099
064330          WS-WHICH-BILLER-ID OF WS-COMMON-BILLERID                06533099
064340***                                                               06534099
064350     IF WS-VISION-EAST                                            06535099
064360        MOVE WS-VISION-EAST-DESC  TO HEADING-2-BILL               06536099
064370                                     WS-HEADING-2-HUB             06537099
064380     END-IF                                                       06538099
064390     IF WS-VISION-WEST                                            06539099
064400        MOVE WS-VISION-WEST-DESC  TO HEADING-2-BILL               06540099
064410                                     WS-HEADING-2-HUB             06541099
064420     END-IF                                                       06542099
064430     IF WS-VISION-NORTH                                           06543099
064440        MOVE WS-VISION-NORTH-DESC  TO HEADING-2-BILL              06544099
064450                                     WS-HEADING-2-HUB             06545099
064460     END-IF                                                       06546099
064470     IF WS-RSS                                                    06547099
064480        MOVE WS-RSS-DESC        TO HEADING-2-BILL                 06548099
064490                                     WS-HEADING-2-HUB             06549099
064500     END-IF                                                       06550099
064510                                                                  06551099
064520**  JA0402  - OPC                                                 06552099
064530                                                                  06553099
064540     IF WS-OPC                                                    06554099
064550        MOVE WS-OPC-DESC        TO HEADING-2-BILL                 06555099
064560                                     WS-HEADING-2-HUB             06556099
064570     END-IF                                                       06557099
064580                                                                  06558099
064590**  JA0312                                                        06559099
064600     IF WS-OPC                                                    06560099
064610        AND  MDNIN-USER-ID  OF MDNIN-HEADER-FIELDS(1:3)  =  'VTS' 06561099
064620             MOVE  'O'    TO  WS-OPC-DESC1(2:1)                   06562099
064630             MOVE  'VTS'  TO  WS-OPC-DESC2(1:3)                   06563099
064640                                                                  06564099
064650             MOVE WS-OPC-DESC        TO HEADING-2-BILL            06565099
064660                                        WS-HEADING-2-HUB          06566099
064670     END-IF                                                       06567099
064680                                                                  06568099
      *  JA0612A  -  Vision B_to_B                                      06569099
097010                                                                  06570099
097020     IF  WS-VISION-B2B                                            06571099
064650         MOVE  WS-VISION-B2B-DESC   TO  HEADING-2-BILL            06572099
064660                                        WS-HEADING-2-HUB          06573099
           END-IF                                                       06574099
           .                                                            06575099
                                                                        06576099
064700 2010-EXIT.                                                       06577099
064710     EXIT.                                                        06578099
064720                                                                  06579099
064730 2020-CONVERT-BILL-DATE.                                          06580099
064740******************************************************************06581099
064750*                                                                 06582099
064760*   PARAGRAPH NAME:  2020-CONVERT-BILL-DATE                       06583099
064770*                                                                 06584099
064780*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   06585099
064790*             DATE                                                06586099
064800*                                                                 06587099
064810******************************************************************06588099
064820     MOVE '2020-CONVERT-BILL-DATE' TO WS-CURR-PARA                06589099
064830                                                                  06590099
064840*----take Biller's LAST-TRX-DATE and convert into-----------------06591099
064850*----WS-BILL-LAST-TRX-1-DATE for update into CTN-INV--------------06592099
064860                                                                  06593099
064870     MOVE MDNIN-LAST-TRX-DATE     TO WS-BILL-LAST-TRX-DATE-2      06594099
064880     MOVE WS-BILL-LAST-TRX-2-CCYY TO WS-BILL-LAST-TRX-1-CCYY      06595099
064890     MOVE WS-BILL-LAST-TRX-2-MM   TO WS-BILL-LAST-TRX-1-MM        06596099
064900     MOVE WS-BILL-LAST-TRX-2-DD   TO WS-BILL-LAST-TRX-1-DD        06597099
064910     MOVE WS-BILL-LAST-TRX-2-HH   TO WS-BILL-LAST-TRX-1-HH        06598099
064920     MOVE WS-BILL-LAST-TRX-2-MI   TO WS-BILL-LAST-TRX-1-MI        06599099
064930     MOVE WS-BILL-LAST-TRX-2-SS   TO WS-BILL-LAST-TRX-1-SS        06600099
064940     MOVE '000001'                TO WS-BILL-LAST-TRX-1-MS        06601099
064950     .                                                            06602099
064960 2020-EXIT.                                                       06603099
064970     EXIT.                                                        06604099
064980                                                                  06605099
064990                                                                  06606099
065000 2030-CONVERT-ETNI-DATE.                                          06607099
065010******************************************************************06608099
065020*                                                                 06609099
065030*   PARAGRAPH NAME:  2030-CONVERT-ETNI-DATE                       06610099
065040*                                                                 06611099
065050*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   06612099
065060*             DATE                                                06613099
065070*                                                                 06614099
065080******************************************************************06615099
065090     MOVE '2030-CONVERT-ETNI-DATE' TO WS-CURR-PARA                06616099
065100                                                                  06617099
065110     MOVE WS-CTNIN-LAST-TRX-DATE  TO WS-ETNI-LAST-TRX-DATE-1      06618099
065120     MOVE WS-ETNI-LAST-TRX-1-CCYY TO WS-ETNI-LAST-TRX-2-CCYY      06619099
065130     MOVE WS-ETNI-LAST-TRX-1-MM   TO WS-ETNI-LAST-TRX-2-MM        06620099
065140     MOVE WS-ETNI-LAST-TRX-1-DD   TO WS-ETNI-LAST-TRX-2-DD        06621099
065150     MOVE WS-ETNI-LAST-TRX-1-HH   TO WS-ETNI-LAST-TRX-2-HH        06622099
065160     MOVE WS-ETNI-LAST-TRX-1-MI   TO WS-ETNI-LAST-TRX-2-MI        06623099
065170     MOVE WS-ETNI-LAST-TRX-1-SS   TO WS-ETNI-LAST-TRX-2-SS        06624099
065180                                                                  06625099
065190     .                                                            06626099
065200 2030-EXIT.                                                       06627099
065210     EXIT.                                                        06628099
065220                                                                  06629099
065230 2040-PROCESS-HDR-DATE.                                           06630099
065240******************************************************************06631099
065250*                                                                 06632099
065260*   PARAGRAPH NAME:  2040-PROCESS-HDR-DATE                        06633099
065270*                                                                 06634099
065280*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   06635099
065290*             DATE                                                06636099
065300*                                                                 06637099
065310******************************************************************06638099
065320     MOVE '2040-PROCESS-HDR-DATE' TO WS-CURR-PARA                 06639099
065330                                                                  06640099
065340     MOVE    MDNIN-DATE-TIME   OF MDNIN-HEADER-FIELDS             06641099
065350       TO    WS-HDR-DATE-TIME                                     06642099
065360             WS-HDR-DATE-TIME-MINUS-1                             06643099
065370                                                                  06644099
065380     COMPUTE WS-HDR-DATE-MINUS-1-NUM =                            06645099
065390             FUNCTION DATE-OF-INTEGER                             06646099
065400            (FUNCTION INTEGER-OF-DATE (WS-HDR-DATE-NUM) - 1)      06647099
065410                                                                  06648099
065420     IF WS-DISPLAY-HDR-DATE = 'Y'                                 06649099
065430        DISPLAY 'MDNIN HEADER DATE MINUS 1 DAY: '                 06650099
065440                 WS-HDR-DATE-TIME-MINUS-1DAY                      06651099
065450        DISPLAY ' '                                               06652099
065460     END-IF                                                       06653099
065470     .                                                            06654099
065480 2040-EXIT.                                                       06655099
065490     EXIT.                                                        06656099
065500                                                                  06657099
065510 2041-CONVERT-VORA-DATE.                                          06658099
065520                                                                  06659099
065530     MOVE '2041-CONVERT-VORA-DATE' TO WS-CURR-PARA                06660099
065540                                                                  06661099
065550     MOVE SYS-UPDATE-DATE  OF  DCLVORA-IMSI-INV                   06662099
065560                                  TO WS-VORA-SYS-UPDATE-DATE1     06663099
065570     MOVE WS-VORA-SYS-UPDATE-1-CCYY TO WS-VORA-SYS-UPDATE-2-CCYY  06664099
065580     MOVE WS-VORA-SYS-UPDATE-1-MM TO WS-VORA-SYS-UPDATE-2-MM      06665099
065590     MOVE WS-VORA-SYS-UPDATE-1-DD TO WS-VORA-SYS-UPDATE-2-DD      06666099
065600     MOVE WS-VORA-SYS-UPDATE-1-HH TO WS-VORA-SYS-UPDATE-2-HH      06667099
065610     MOVE WS-VORA-SYS-UPDATE-1-MI TO WS-VORA-SYS-UPDATE-2-MI      06668099
065620     MOVE WS-VORA-SYS-UPDATE-1-SS TO WS-VORA-SYS-UPDATE-2-SS      06669099
065630                                                                  06670099
065640     .                                                            06671099
065650 2041-EXIT.                                                       06672099
065660     EXIT.                                                        06673099
065670                                                                  06674099
065680 2051-CONVERT-SIM-DATE.                                           06675099
065690                                                                  06676099
065700     MOVE '2051-CONVERT-SIM-DATE' TO WS-CURR-PARA                 06677099
065710                                                                  06678099
065720     MOVE SYS-UPDATE-DATE  OF  DCLSIM-INV                         06679099
065730                                  TO WS-SIM-SYS-UPDATE-DATE1      06680099
065740     MOVE WS-SIM-SYS-UPDATE-1-CCYY TO WS-SIM-SYS-UPDATE-2-CCYY    06681099
065750     MOVE WS-SIM-SYS-UPDATE-1-MM  TO WS-SIM-SYS-UPDATE-2-MM       06682099
065760     MOVE WS-SIM-SYS-UPDATE-1-DD  TO WS-SIM-SYS-UPDATE-2-DD       06683099
065770     MOVE WS-SIM-SYS-UPDATE-1-HH  TO WS-SIM-SYS-UPDATE-2-HH       06684099
065780     MOVE WS-SIM-SYS-UPDATE-1-MI  TO WS-SIM-SYS-UPDATE-2-MI       06685099
065790     MOVE WS-SIM-SYS-UPDATE-1-SS  TO WS-SIM-SYS-UPDATE-2-SS       06686099
065800                                                                  06687099
065810     .                                                            06688099
065820 2051-EXIT.                                                       06689099
065830     EXIT.                                                        06690099
065840                                                                  06691099
065850                                                                  06692099
065860 2100-MDN-MATCH.                                                  06693099
065870******************************************************************06694099
065880*                                                                 06695099
065890*   PARAGRAPH NAME:  2100-MDN-MATCH                               06696099
065900*                                                                 06697099
065910*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   06698099
065920*             BILL MATCH ETNI                                     06699099
065930*                                                                 06700099
065940******************************************************************06701099
065950     MOVE '2100-MDN-MATCH' TO WS-CURR-PARA                        06702099
065960     MOVE 'Y' TO MDN-MATCH-FLAG                                   06703099
065970     ADD +1 TO WS-TOTL-BILL-ETNI-MATCH-CNT                        06704099
065980     SET       WS-REC-MATCH TO TRUE                               06705099
065990                                                                  06706099
066000     MOVE SPACES TO WS-ERROR-FIELDS-SW                            06707099
066010                    WS-COMMENT                                    06708099
066020                    WS-ADDTL-INFO                                 06709099
066030                    WS-4G-CDVC-SW                                 06710099
066040*  JA0412  -  Override  MDNIN-IMSI  to  Spaces                    06711099
066050                    MDNIN-IMSI                                    06712099
066060*  JA0612  -                                                      06713099
066070                    MODIFIED-MIN-STATUS                           06714099
066060*  JA0912  -                                                      06715099
066070                    WS-NEW-STATUS                                 06716099
066070                    WS-OLD-STATUS                                 06717099
066080                                                                  06718099
066090     INITIALIZE CTN-HAS-VZW-SPID                                  06719099
066100                ALLOW-PORT-IND-CHG                                06720099
066110                GATEWAY-INTRASERV-PORT                            06721099
066120                PORT-IND-IS-THE-ONLY-CHANGE                       06722099
066130                WS-OWNERSHIP-VARIABLES                            06723099
066140                NH-AND-PENDDASG-R-FLAG                            06724099
066150                NH-AND-OTHER-PENDING-FLAG                         06725099
066160                                                                  06726099
066170* REFORMAT BILL LAST TRANSACTION DATE                             06727099
066180     PERFORM 2020-CONVERT-BILL-DATE THRU 2020-EXIT                06728099
066190                                                                  06729099
066200* REFORMAT ETNI LAST TRANSACTION DATE                             06730099
066210     PERFORM 2030-CONVERT-ETNI-DATE THRU 2030-EXIT                06731099
066220                                                                  06732099
066230*  JA0312A -   Over-Ride  NL  For  Alarm.com                      06733099
066230*  JA0912  -   Generic  Over-Ride  NL  For  Alarm.com             06734099
066230*              Has  Been  Commented  Out                          06735099
057270*  JA1012  -  Below  Comment  VRTEL                               06736099
066240                                                                  06737099
066250     IF  WS-VISION                                                06738099
066260         IF  WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA   06739099
066270             IF  WS-CTNIN-NL(2:4)  =  'RTEL'                      06740099
066270******       IF  WS-CTNIN-NL       =  'VRTEL'                     06741099
066280                 MOVE  WS-CTNIN-NL  TO  MDNIN-NL                  06742099
066290             END-IF                                               06743099
066300         END-IF                                                   06744099
066310     END-IF                                                       06745099
066320                                                                  06746099
066330*  JA0809  -   Over-Ride  NL  For  Permanent  Reserves            06747099
066340                                                                  06748099
066350     IF  WS-VISION                                                06749099
066360         IF  WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA   06750099
066370             IF  WS-CTNIN-NL(2:1) = 'H'                           06751099
066380                 MOVE  WS-CTNIN-NL  TO  MDNIN-NL                  06752099
066390             END-IF                                               06753099
066400         END-IF                                                   06754099
066410     END-IF                                                       06755099
066420                                                                  06756099
066430** JA1211  -  Override  RSS  Port-Ind                             06757099
066440**         -  No  Change  or Editting  Allowed                    06758099
066450     IF  WS-RSS                                                   06759099
066460         MOVE  WS-CTNIN-PORT-IND  TO  MDNIN-PORT-IND              06760099
066470     END-IF                                                       06761099
066480                                                                  06762099
066490* BYPASS NEW TRANSACTIONS                                         06763099
066500*----compare Biller's LAST TRX DATE to Biller Hdr date minus 1 day06764099
066510*----if detail LAST TRX DATE too recent,      do not process and--06765099
066520*----write both eTNI and Biller record to ERROROU4 audit trail----06766099
066530                                                                  06767099
066540*----AGB 5/08/06                                                  06768099
066550*----Do NOT perform these date tests if eTNI has a "BKO" in-------06769099
066560*----LAST-TRX-CODE. That means a user has specifically backed out-06770099
066570*----a change and needs to have this CTN updated from Biller info-06771099
066580                                                                  06772099
066590     IF WS-CTNIN-LAST-TRX-CODE NOT = 'BKO'                        06773099
066600        IF MDNIN-LAST-TRX-DATE > WS-HDR-DATE-TIME-MINUS-1DAY      06774099
066610           ADD +1 TO WS-TOTL-BILL-ETNI-MATCH-NEW                  06775099
066620           MOVE '001' TO WS-ERROR4-REASON                         06776099
066630           PERFORM 8878-WRITE-NOT-PROCESSED-FILE THRU 8878-EXIT   06777099
066640***JA1210  GO TO 2100-ADDITIONAL-CHECKS                           06778099
066650           GO TO 2100-EXIT                                        06779099
066660        END-IF                                                    06780099
066670                                                                  06781099
066680        IF WS-ETNI-LAST-TRX-DATE-2-NUM >                          06782099
066690           WS-HDR-DATE-TIME-MINUS-1DAY                            06783099
066700           ADD +1 TO WS-TOTL-BILL-ETNI-MATCH-NEW                  06784099
066710           MOVE '002' TO WS-ERROR4-REASON                         06785099
066720           PERFORM 8878-WRITE-NOT-PROCESSED-FILE THRU 8878-EXIT   06786099
066730***JA1210  GO TO 2100-ADDITIONAL-CHECKS                           06787099
066740           GO TO 2100-EXIT                                        06788099
066750        END-IF                                                    06789099
066760     END-IF                                                       06790099
066770                                                                  06791099
066780* JA1011  -  VTS  Processing                                      06792099
066790                                                                  06793099
066800     SET  NOT-VTS-MDN  TO  TRUE                                   06794099
066810     SET  WS-VTS-PROCESSED-NOT  TO  TRUE                          06795099
066820     PERFORM  WITH  TEST  BEFORE                                  06796099
066830              VARYING  WS-SUB-VTS-NL FROM +1 BY  +1               06797099
066840                 UNTIL  VTS-MDN                                   06798099
066850                 OR                                               06799099
066860                 WS-SUB-VTS-NL      >   WS-SUB-VTS-NL-MAX         06800099
066870        IF  WS-VTS-NL  (WS-SUB-VTS-NL) =  MDNIN-NL                06801099
066880            SET  VTS-MDN  TO  TRUE                                06802099
066890        END-IF                                                    06803099
066900     END-PERFORM                                                  06804099
066910                                                                  06805099
066920     IF  VTS-MDN                                                  06806099
066930         MOVE  MDNIN-MDN(1:10)  TO  MDNIN-MIN-NUM                 06807099
066940         PERFORM  2100-VTS-MATCH  THRU  2100-VTS-MATCH-EXIT       06808099
066950         GO  TO   2100-EXIT                                       06809099
066960     END-IF                                                       06810099
066970                                                                  06811099
066980* JA0412  -  5XX  Processing                                      06812099
066990                                                                  06813099
067000     SET  NOT-5XX-MDN  TO  TRUE                                   06814099
067010     SET  WS-5XX-PROCESSED-NOT  TO  TRUE                          06815099
067020     PERFORM  WITH  TEST  BEFORE                                  06816099
067030              VARYING  WS-SUB-5XX-NL FROM +1 BY  +1               06817099
067040                 UNTIL  5XX-MDN                                   06818099
067050                 OR                                               06819099
067060                 WS-SUB-5XX-NL      >   WS-SUB-5XX-NL-MAX         06820099
067070        IF  WS-5XX-NL  (WS-SUB-5XX-NL)  =  WS-CTNIN-NL            06821099
067080            SET  5XX-MDN  TO  TRUE                                06822099
067090        END-IF                                                    06823099
067100     END-PERFORM                                                  06824099
067110                                                                  06825099
067120     IF  5XX-MDN                                                  06826099
067130         MOVE  MDNIN-MDN(1:10)  TO  MDNIN-MIN-NUM                 06827099
067140         MOVE  WS-CTNIN-NL      TO  MDNIN-NL                      06828099
067150         PERFORM  2100-5XX-MATCH  THRU  2100-5XX-MATCH-EXIT       06829099
067160         GO  TO   2100-EXIT                                       06830099
067170     END-IF                                                       06831099
067180                                                                  06832099
      *  JA1112  -   Special  Emer.  Fix  Due  to  Probable  VISION  bug06833099
066340                                                                  06834099
066350     IF  WS-VISION                                                06835099
066360         IF  WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA   06836099
067220             IF  WS-CTNIN-CTN-STATUS    =  'AR'                   06837099
067230                 AND  MDNIN-MDN-STATUS  =  'AI'                   06838099
067590               IF  MDNIN-ICC-ID-4G  >  ' '                        06839099
067610                   IF  WS-CTNIN-ICC-ID-4G  =  ' '                 06840099
067590                       PERFORM  4G-CHECK-SIM-STATUS     THRU      06841099
067590                                4G-CHECK-SIM-STATUS-EXIT          06842099
067590                       IF  WS-SIM-STATUS  =  'AD'                 06843099
067590                           PERFORM  4G-HYBRID-CDVC-TRANS  THRU    06844099
067590                                    4G-HYBRID-CDVC-TRANS-EXIT     06845099
079550                       IF  WS-4G-ERROR-YES                        06846099
                                 PERFORM  6000-MOVE-BILL-MDN-TO-RPT     06847099
                                          THRU  6000-EXIT               06848099
                                 PERFORM  6500-WRITE-ERROR-RPT          06849099
                                          THRU  6500-EXIT               06850099
                                 PERFORM  6010-MOVE-ETNI-TO-RPT         06851099
                                          THRU  6010-EXIT               06852099
                                 PERFORM  6500-WRITE-ERROR-RPT          06853099
                                          THRU  6500-EXIT               06854099
                                 GO  TO   2100-EXIT                     06855099
                                ELSE                                    06856099
                                 PERFORM  6000-MOVE-BILL-MDN-TO-RPT     06856199
                                          THRU  6000-EXIT               06856299
                                 PERFORM  6400-WRITE-RECON-RPT          06856399
                                          THRU 6400-EXIT                06856499
                                 PERFORM  6010-MOVE-ETNI-TO-RPT         06856799
                                          THRU  6010-EXIT               06856899
                                 PERFORM  6400-WRITE-RECON-RPT          06856999
                                          THRU 6400-EXIT                06857099
094950                           MOVE LIT-UPDATED-COMMENT               06857199
094950                                                 TO   WS-COMMENT  06857299
094960                           MOVE SPACES    TO   WS-ADDTL-INFO      06857399
                                 PERFORM  6020-MOVE-ETNI-TO-RPT-NEW     06857499
                                          THRU  6020-EXIT               06857599
094940                           MOVE 'ETNI'    TO   WS-SYSTEM          06857799
094940                           MOVE 'AI'      TO   DETAIL-1-CTN-STATUS06857999
                                 PERFORM  6400-WRITE-RECON-RPT          06858499
                                          THRU 6400-EXIT                06858599
259280                           INITIALIZE  DETAIL-LINE-1              06858699
259290                           MOVE  'SIM '   TO  DETAIL-1-SYSTEM     06858799
259300                           MOVE  MDNIN-MDN    TO  DETAIL-1-MDN    06858899
259300                           MOVE  MDNIN-ICC-ID-4G  TO              06858999
259300                                              DETAIL-1-ICC-IMSI   06859099
067230                           MOVE  MDNIN-MDN-STATUS  TO             06859199
259300                                              DETAIL-1-CTN-STATUS 06859299
                                 PERFORM  6400-WRITE-RECON-RPT          06859399
                                          THRU 6400-EXIT                06859499
                                 GO  TO   2100-EXIT                     06859599
                             END-IF                                     06859699
067170                   END-IF                                         06859799
067170                 END-IF                                           06860099
067170               END-IF                                             06861099
067170             END-IF                                               06862099
067170         END-IF                                                   06863099
067170     END-IF                                                       06864099
067180                                                                  06865099
067190** JA0312  -  Special  OPC  Edit  -  Prevent  Backwards  Updates  06866099
067200     IF  WS-OPC  AND                                              06867099
067210       (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)  AND  06868099
067220       (WS-CTNIN-CTN-STATUS  =  'AI'                              06869099
067230           AND  MDNIN-MDN-STATUS(1:1)  =  'A'                     06870099
067240             AND  MDNIN-MDN-STATUS   NOT  =  'AI'                 06871099
067250                 AND  MDNIN-USER-ID  OF MDNIN-HEADER-FIELDS(1:3)  06872099
067260                      NOT  =  'VTS')                              06873099
067270               PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT 06874099
067280               MOVE  '* Billng Status Err- *'                     06875099
067290                                             TO  DETAIL-1-COMMENT 06876099
067300               PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT 06877099
067310               PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT 06878099
067320               MOVE  '* Billng Status Err- *'                     06879099
067330                                             TO  DETAIL-1-COMMENT 06880099
067340               PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT 06881099
067350               GO  TO  2100-EXIT                                  06882099
067360     END-IF                                                       06883099
067370                                                                  06884099
067380*  JA1210  - Bypass  - Backward Updates                           06885099
067390                                                                  06886099
067400     IF  MDNIN-MDN-STATUS  =  'AR'                                06887099
067410        IF  WS-CTNIN-CTN-STATUS  =  'AG'                          06888099
067420              PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT  06889099
067430              MOVE  '* Billng Status Err- AR *'                   06890099
067440                                            TO  DETAIL-1-COMMENT  06891099
067450              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  06892099
067460              PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT  06893099
067470              MOVE  '* Billng Status Err- AR *'                   06894099
067480                                            TO  DETAIL-1-COMMENT  06895099
067490              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  06896099
067500              GO  TO  2100-EXIT                                   06897099
067510        END-IF                                                    06898099
067520     END-IF                                                       06899099
067530                                                                  06900099
067380*  JA0912  - Bypass  - Backward Updates                           06901099
067390                                                                  06902099
067400     IF  MDNIN-MDN-STATUS  =  'AR'                                06903099
067410        IF  WS-CTNIN-CTN-STATUS  =  'AI'                          06904099
067420            PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT    06905099
067430            MOVE  '* Billng Status Err- AR *'                     06906099
067440                                          TO  DETAIL-1-COMMENT    06907099
067450            PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT    06908099
067460            PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT    06909099
067470            MOVE  '* Billng Status Err- AR *'                     06910099
067480                                          TO  DETAIL-1-COMMENT    06911099
067490            PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT    06912099
067500            GO  TO  2100-EXIT                                     06913099
067510        END-IF                                                    06914099
067520     END-IF                                                       06915099
067530                                                                  06916099
067540*  JA1210  - Bypass  Vision  Errors - Backward Updates            06917099
067550                                                                  06918099
067560     IF  MDNIN-MDN-STATUS  =  'AR'                                06919099
067570        IF  WS-CTNIN-CTN-STATUS  =  'AI'                          06920099
067580          IF  WS-VISION                                           06921099
067590            IF  MDNIN-ICC-ID-4G  =  ' '                           06922099
067600             IF  MDNIN-IMSI      =  ' '                           06923099
067610               IF  WS-CTNIN-ICC-ID-4G  >  ' '                     06924099
067620                   PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT  06925099
067630              PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT  06926099
067640              MOVE  '* Vision Status Err-SIM *'                   06927099
067650                                            TO  DETAIL-1-COMMENT  06928099
067660              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  06929099
067670              PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT  06930099
067680              MOVE  '* Vision Status Err-SIM *'                   06931099
067690                                            TO  DETAIL-1-COMMENT  06932099
067700              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  06933099
067710              GO  TO  2100-EXIT                                   06934099
067720              END-IF                                              06935099
067730            END-IF                                                06936099
067740           END-IF                                                 06937099
067750          END-IF                                                  06938099
067760        END-IF                                                    06939099
067770     END-IF                                                       06940099
067780                                                                  06941099
067790     IF  MDNIN-MDN-STATUS  =  'AR'                                06942099
067800        IF  WS-CTNIN-CTN-STATUS  =  'AI'                          06943099
067810          IF  WS-VISION                                           06944099
067820            IF  MDNIN-ICC-ID-4G  =  ' '                           06945099
067830             IF  MDNIN-IMSI      =  ' '                           06946099
067840               IF  WS-CTNIN-IMSI >  ' '                           06947099
067850                   PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT  06948099
067860              PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT  06949099
067870              MOVE  '* Vision Status Error -IMSI*'                06950099
067880                                            TO  DETAIL-1-COMMENT  06951099
067890              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  06952099
067900              PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT  06953099
067910              MOVE  '* Vision Status Error -IMSI*'                06954099
067920                                            TO  DETAIL-1-COMMENT  06955099
067930              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  06956099
067940              GO  TO  2100-EXIT                                   06957099
067950              END-IF                                              06958099
067960            END-IF                                                06959099
067970           END-IF                                                 06960099
067980          END-IF                                                  06961099
067990        END-IF                                                    06962099
068000     END-IF                                                       06963099
068010                                                                  06964099
068020*  JA0412  - Bypass  Vision  Errors - Backward Updates            06965099
068030                                                                  06966099
068040     IF  MDNIN-MDN-STATUS  =  'AR'                                06967099
068050        IF  WS-CTNIN-CTN-STATUS  =  'AI'                          06968099
068060          IF  WS-VISION                                           06969099
068070            IF  MDNIN-ICC-ID-4G  >  ' '                           06970099
068080             IF  MDNIN-IMSI      =  ' '                           06971099
068090               IF  WS-CTNIN-ICC-ID-4G  >  ' '                     06972099
068100                 IF  WS-CTNIN-ICC-ID-4G  NOT  =                   06973099
068110                                              MDNIN-ICC-ID-4G     06974099
068120                   PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT  06975099
068130              PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT  06976099
068140              MOVE  '* Vision Status Err-SIM *'                   06977099
068150                                            TO  DETAIL-1-COMMENT  06978099
068160              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  06979099
068170              PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT  06980099
068180              MOVE  '* Vision Status Err-SIM *'                   06981099
068190                                            TO  DETAIL-1-COMMENT  06982099
068200              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  06983099
068210              GO  TO  2100-EXIT                                   06984099
068220               END-IF                                             06985099
068230              END-IF                                              06986099
068240            END-IF                                                06987099
068250           END-IF                                                 06988099
068260          END-IF                                                  06989099
068270        END-IF                                                    06990099
068280     END-IF                                                       06991099
068290                                                                  06992099
068300     IF  MDNIN-MDN-STATUS  =  'AR'                                06993099
068310        IF  WS-CTNIN-CTN-STATUS  =  'AI'                          06994099
068320          IF  WS-VISION                                           06995099
068330            IF  MDNIN-ICC-ID-4G  =  ' '                           06996099
068340             IF  MDNIN-IMSI      >  ' '                           06997099
068350               IF  WS-CTNIN-IMSI >  ' '                           06998099
068360                IF  WS-CTNIN-IMSI   NOT  =  MDNIN-IMSI            06999099
068370                   PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT  07000099
068380              PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT  07001099
068390              MOVE  '* Vision Status Error -IMSI*'                07002099
068400                                            TO  DETAIL-1-COMMENT  07003099
068410              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  07004099
068420              PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT  07005099
068430              MOVE  '* Vision Status Error -IMSI*'                07006099
068440                                            TO  DETAIL-1-COMMENT  07007099
068450              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  07008099
068460              GO  TO  2100-EXIT                                   07009099
068470              END-IF                                              07010099
068480             END-IF                                               07011099
068490            END-IF                                                07012099
068500           END-IF                                                 07013099
068510          END-IF                                                  07014099
068520        END-IF                                                    07015099
068530     END-IF                                                       07016099
068540                                                                  07017099
068550*  JA0322  - Bypass  Vision  Errors - Backward Updates - SIM only 07018099
068560                                                                  07019099
068570     IF  MDNIN-MDN-STATUS  =  'AR'                                07020099
068580        IF  WS-CTNIN-CTN-STATUS  =  'AI'                          07021099
068590          IF  WS-VISION                                           07022099
068600            IF  MDNIN-ICC-ID-4G  >  ' '                           07023099
068610              IF  WS-CTNIN-ICC-ID-4G  =  ' '                      07024099
068620                   PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT  07025099
068630              PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT  07026099
068640              MOVE  '* Vision Status Err-SIM *'                   07027099
068650                                            TO  DETAIL-1-COMMENT  07028099
068660              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  07029099
068670              PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT  07030099
068680              MOVE  '* Vision Status Err-SIM *'                   07031099
068690                                            TO  DETAIL-1-COMMENT  07032099
068700              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  07033099
068710              GO  TO  2100-EXIT                                   07034099
068720              END-IF                                              07035099
068730            END-IF                                                07036099
068740           END-IF                                                 07037099
068750          END-IF                                                  07038099
068760        END-IF                                                    07039099
068770                                                                  07040099
068780*  JA0322  - Bypass  Vision  Errors - Backward Updates - IMSI only07041099
068790                                                                  07042099
068800     IF  MDNIN-MDN-STATUS  =  'AR'                                07043099
068810        IF  WS-CTNIN-CTN-STATUS  =  'AI'                          07044099
068820          IF  WS-VISION                                           07045099
068830            IF  MDNIN-ICC-ID-4G  =  ' '                           07046099
068840             IF  MDNIN-IMSI      >  ' '                           07047099
068850              IF  WS-CTNIN-IMSI =  ' '                            07048099
068860                   PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT  07049099
068870              PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT  07050099
068880              MOVE  '* Vision Status Error -IMSI*'                07051099
068890                                            TO  DETAIL-1-COMMENT  07052099
068900              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  07053099
068910              PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT  07054099
068920              MOVE  '* Vision Status Error -IMSI*'                07055099
068930                                            TO  DETAIL-1-COMMENT  07056099
068940              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  07057099
068950              GO  TO  2100-EXIT                                   07058099
068960              END-IF                                              07059099
068970            END-IF                                                07060099
068980           END-IF                                                 07061099
068990          END-IF                                                  07062099
069000        END-IF                                                    07063099
069010     END-IF                                                       07064099
069020                                                                  07065099
068790                                                                  07066099
      *  JA0812  -  Prohibit  Backward  Update                          07067099
068800     IF  MDNIN-MDN-STATUS  =  'AR'                                07068099
068810        IF  WS-CTNIN-CTN-STATUS  =  'AI'                          07069099
068820          IF  WS-VISION                                           07070099
068870              PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT  07071099
068880              MOVE  '* Backward  Update  Blocked '                07072099
068890                                            TO  DETAIL-1-COMMENT  07073099
068900              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  07074099
068910              PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT  07075099
068880              MOVE  '* Backward  Update  Blocked '                07076099
068930                                            TO  DETAIL-1-COMMENT  07077099
068940              PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT  07078099
068950              GO  TO  2100-EXIT                                   07079099
068990          END-IF                                                  07080099
069000        END-IF                                                    07081099
069010     END-IF                                                       07082099
069020                                                                  07083099
069030     IF MDNIN-MDN-STATUS = 'AG'                                   07084099
069040        AND                                                       07085099
069050          (WS-CTNIN-CTN-STATUS = 'PO' AND                         07086099
069060           WS-CTNIN-PORT-IND = 'PO')                              07087099
069070           ADD 1 TO WS-TOTL-ERROR-POPO-MISMATCH                   07088099
069080           SET  WS-ERROR-FIELDS-FOUND TO TRUE                     07089099
069090           MOVE LIT-ETNI-PORTED-PO-ERROR TO WS-COMMENT            07090099
069100           MOVE LIT-ETNI-PO-PO TO WS-ADDTL-INFO                   07091099
069110**         PERFORM  7036-IS-IT-A-BILLING-HUB    THRU  7036-EXIT   07092099
069120            IF  WS-HUB-BILL                                       07093099
069130                PERFORM  6000-MOVE-BILL-TO-RPT-HUB  THRU          07094099
069140                         6000-EXIT-HUB                            07095099
069150                PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU          07096099
069160                         6510-EXIT                                07097099
069170                GO TO 2100-ADDITIONAL-CHECKS                      07098099
069180              ELSE                                                07099099
069190                PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT  07100099
069200                PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT 07101099
069210                GO TO 2100-ADDITIONAL-CHECKS                      07102099
069220            END-IF                                                07103099
069230     END-IF                                                       07104099
069240                                                                  07105099
069250*----If Biller Status is in Aging (AG) and both eTNI Status and---07106099
069260*----Port-Ind are "PO" (Ported out),      write an error message--07107099
069270*----to the output error file & exit routine.---------------------07108099
069280*----This disallows updates to ported-out eTNI CTNs.--------------07109099
069290*----(no update is performed in this case: both Biller and--------07110099
069300*----eTNI files are read after 2100-exit)-------------------------07111099
069310                                                                  07112099
069320**  JA1207E - RSS Condition  For  Exception  Report               07113099
069330                                                                  07114099
069340**  JA0402  -   WS-LEGIT-BILLER-ID-RESELLER  Added                07115099
069350                                                                  07116099
069360     IF  (WS-LEGIT-BILLER-ID-RESELLER)                            07117099
069370         IF  MDNIN-MDN-STATUS   =  'PA'                           07118099
069380           AND                                                    07119099
069390          (WS-CTNIN-CTN-STATUS  =  'AG'  OR                       07120099
069400           WS-CTNIN-CTN-STATUS  =  'AR'  OR                       07121099
069410           WS-CTNIN-CTN-STATUS  =  'AI'  OR                       07122099
069420           WS-CTNIN-CTN-STATUS  =  'AT'  OR                       07123099
069430           WS-CTNIN-CTN-STATUS  =  'PO')                          07124099
069440           ADD 1 TO WS-TOTL-ERROR-PA-ERROR                        07125099
069450           SET  WS-ERROR-FIELDS-FOUND    TO TRUE                  07126099
069460           MOVE LIT-PA-ERROR             TO WS-COMMENT            07127099
069470           MOVE SPACES                   TO WS-ADDTL-INFO         07128099
069480           MOVE WS-SAVE-HDR-BILLER-ID  TO  WS-BILLER-ID           07129099
069490**         PERFORM  7036-IS-IT-A-BILLING-HUB    THRU  7036-EXIT   07130099
069500            IF  WS-HUB-BILL                                       07131099
069510                PERFORM  6000-MOVE-BILL-TO-RPT-HUB  THRU          07132099
069520                         6000-EXIT-HUB                            07133099
069530                PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU          07134099
069540                         6510-EXIT                                07135099
069550                GO TO 2100-ADDITIONAL-CHECKS                      07136099
069560              ELSE                                                07137099
069570                PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT 07138099
069580                PERFORM 6500-WRITE-ERROR-RPT      THRU  6500-EXIT 07139099
069590                GO TO 2100-ADDITIONAL-CHECKS                      07140099
069600            END-IF                                                07141099
069610         END-IF                                                   07142099
069620     END-IF                                                       07143099
069630                                                                  07144099
069640*----same as above, but if eTNI CTN has "PO" and "IO"------------ 07145099
069650                                                                  07146099
069660     IF MDNIN-MDN-STATUS = 'AG'                                   07147099
069670        AND                                                       07148099
069680          (WS-CTNIN-CTN-STATUS = 'PO' AND                         07149099
069690           WS-CTNIN-PORT-IND = 'IO')                              07150099
069700           ADD 1 TO WS-TOTL-ERROR-POIO-MISMATCH                   07151099
069710           SET  WS-ERROR-FIELDS-FOUND     TO TRUE                 07152099
069720           MOVE LIT-ETNI-PORTED-IO-ERROR TO WS-COMMENT            07153099
069730           MOVE LIT-ETNI-PO-IO TO WS-ADDTL-INFO                   07154099
069740**         PERFORM  7036-IS-IT-A-BILLING-HUB    THRU  7036-EXIT   07155099
069750            IF  WS-HUB-BILL                                       07156099
069760                PERFORM  6000-MOVE-BILL-TO-RPT-HUB  THRU          07157099
069770                         6000-EXIT-HUB                            07158099
069780                PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU          07159099
069790                         6510-EXIT                                07160099
069800                GO TO 2100-ADDITIONAL-CHECKS                      07161099
069810              ELSE                                                07162099
069820                PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT  07163099
069830                PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT  07164099
069840                GO TO 2100-ADDITIONAL-CHECKS                      07165099
069850            END-IF                                                07166099
069860     END-IF                                                       07167099
069870                                                                  07168099
069880**  JA0602  - START                                               07169099
069890**--------------------------------------------------------------- 07170099
069900**  Reseller  Transaction, Any Process Mode  &  Billing - or eTNI 07171099
069910**          TN  MIN's  are  "HUB",  Error                         07172099
069920**--------------------------------------------------------------- 07173099
069930***                                                               07174099
069940     IF  WS-LEGIT-BILLER-ID-RESELLER                              07175099
069950**         PERFORM  7036-IS-IT-A-BILLING-HUB    THRU  7036-EXIT   07176099
069960**         PERFORM  7035-IS-IT-AN-ETNI-HUB      THRU  7035-EXIT   07177099
069970            IF  WS-HUB-BILL                                       07178099
069980                ADD  1  TO  WS-TOTL-RESELLER-HUB-ERROR            07179099
069990                MOVE  LIT-TN-MINS-ARE-HUB  TO  WS-COMMENT         07180099
070000                MOVE  'Billing MIN Error *' TO  WS-ADDTL-INFO     07181099
070010                PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT07182099
070020                PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT07183099
070030            END-IF                                                07184099
070040            IF  WS-HUB-ETNI                                       07185099
070050                ADD  1  TO  WS-TOTL-RESELLER-HUB-ERROR            07186099
070060                MOVE  LIT-TN-MINS-ARE-HUB  TO  WS-COMMENT         07187099
070070                MOVE  'ETNI MIN Error  *' TO  WS-ADDTL-INFO       07188099
070080                PERFORM  6010-MOVE-ETNI-TO-RPT  THRU  6010-EXIT   07189099
070090                PERFORM  6500-WRITE-ERROR-RPT   THRU  6500-EXIT   07190099
070100            END-IF                                                07191099
070110            IF  WS-HUB-BILL  OR  WS-HUB-ETNI                      07192099
070120                GO  TO  2100-ADDITIONAL-CHECKS                    07193099
070130            END-IF                                                07194099
070140     END-IF                                                       07195099
070150**--------------------------------------------------------------- 07196099
070160**  VISION  Transaction, Update Mode  &  Both  BILLING  and       07197099
070170**          eTNI  TN  MIN's  are  "HUB", otherwise  Error         07198099
070180**--------------------------------------------------------------- 07199099
070190                                                                  07200099
070200     IF  WS-VISION                                                07201099
070210       IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA      07202099
070220**         PERFORM  7036-IS-IT-A-BILLING-HUB    THRU  7036-EXIT   07203099
070230**         PERFORM  7035-IS-IT-AN-ETNI-HUB      THRU  7035-EXIT   07204099
070240                                                                  07205099
070250           IF  WS-ERROR-FIELDS-FOUND                              07206099
070260              GO  TO  2100-ADDITIONAL-CHECKS                      07207099
070270           END-IF                                                 07208099
070280                                                                  07209099
070290         IF  WS-HUB-BILL  AND  WS-HUB-ETNI                        07210099
070300                                                                  07211099
070310             PERFORM  7037-HUB-MATCH  THRU  7037-EXIT             07212099
070320             GO  TO  2100-ADDITIONAL-CHECKS                       07213099
070330         END-IF                                                   07214099
070340       END-IF                                                     07215099
070350     END-IF                                                       07216099
070360                                                                  07217099
070370**  Next  Cond.                                                   07218099
070380     IF  WS-VISION                                                07219099
070390       IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA      07220099
070400                                                                  07221099
070410         IF  WS-HUB-BILL  OR   WS-HUB-ETNI                        07222099
070420**                                                                07223099
070430**   Error  Processing  needed  for  both transactions            07224099
070440**    to  both  ERROR  Rpts                                       07225099
070450**                                                                07226099
070460             MOVE  LIT-TN-MINS-NOT-BOTH-HUB  TO   WS-COMMENT      07227099
070470             ADD  +1  TO  WS-TOTL-HUB-MIN-ERRORS                  07228099
070480             PERFORM  6000-MOVE-BILL-TO-RPT-HUB  THRU             07229099
070490                      6000-EXIT-HUB                               07230099
070500             PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU  6510-EXIT  07231099
070510             PERFORM  6000-MOVE-BILL-MDN-TO-RPT  THRU  6000-EXIT  07232099
070520             PERFORM  6500-WRITE-ERROR-RPT       THRU  6500-EXIT  07233099
070530           IF  WS-HUB-BILL                                        07234099
070540              ADD  +1  TO  WS-TOTL-HUB-MIN-ERRORS-ETNI            07235099
070550              MOVE  LIT-TN-MINS-ETNI-NOT-HUB  TO   WS-COMMENT     07236099
070560              ELSE                                                07237099
070570              ADD  +1  TO  WS-TOTL-HUB-MIN-ERRORS-BILL            07238099
070580              MOVE  LIT-TN-MINS-BILL-NOT-HUB  TO   WS-COMMENT     07239099
070590           END-IF                                                 07240099
070600              PERFORM  6010-MOVE-ETNI-TO-RPT-HUB  THRU            07241099
070610                       6010-EXIT-HUB                              07242099
070620              PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU  6510-EXIT 07243099
070630              PERFORM  6010-MOVE-ETNI-TO-RPT      THRU  6010-EXIT 07244099
070640              PERFORM  6500-WRITE-ERROR-RPT       THRU  6500-EXIT 07245099
070650              GO  TO  2100-ADDITIONAL-CHECKS                      07246099
070660        END-IF                                                    07247099
070670       END-IF                                                     07248099
070680      END-IF                                                      07249099
070690                                                                  07250099
070700**  JA0602   -  END                                               07251099
070710**  JA0502  - START                                               07252099
070720**                                                                07253099
070730**   If UPDATE  AND  NGP  Change  Requested;                      07254099
070740**      Fail Transaction request & create Error Report            07255099
070750*                                                                 07256099
070760**  JA0410  /  JA0810  -  Removed  Comments                       07257099
070770     IF  WS-VISION                                                07258099
070780       IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA      07259099
070790          IF  MDNIN-NGP  NOT  =  WS-CTNIN-NGP                     07260099
070800                                                                  07261099
070810         ADD  1  TO  WS-TOTL-NGP-BILLER-ERROR                     07262099
070820         SET  WS-ERROR-FIELDS-FOUND    TO TRUE                    07263099
070830         MOVE WS-CTNIN-NGP             TO                         07264099
070840                         LIT-NGP-BILLER-ERROR1(23:3)              07265099
070850         MOVE LIT-NGP-BILLER-ERROR1    TO WS-COMMENT              07266099
070860         MOVE SPACES                   TO WS-ADDTL-INFO           07267099
070870         MOVE 'BILL' TO WS-SYSTEM                                 07268099
070880         MOVE WS-SAVE-HDR-BILLER-ID  TO  WS-BILLER-ID             07269099
070890         PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT         07270099
070900         PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT         07271099
070910*   JA0211  -  Update  LRN-Updt-Req                               07272099
070920         PERFORM 6800-INSERT-LRN-UPD-REQT  THRU 6800-EXIT         07273099
070930         GO TO 2100-ADDITIONAL-CHECKS                             07274099
070940          END-IF                                                  07275099
070950       END-IF                                                     07276099
070960     END-IF                                                       07277099
070970                                                                  07278099
070980**  JA0502  - End                                                 07279099
070990**  JA0507  - START                                               07280099
071000                                                                  07281099
071010     IF  WS-VISION                                                07282099
071020      IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA       07283099
071030       IF MDNIN-MDN-STATUS = 'PA'                                 07284099
071040           ADD 1 TO WS-TOTL-ERROR-PA-ERROR                        07285099
071050           SET  WS-ERROR-FIELDS-FOUND    TO TRUE                  07286099
071060           MOVE LIT-PA-ERROR             TO WS-COMMENT            07287099
071070           MOVE SPACES                   TO WS-ADDTL-INFO         07288099
071080           MOVE 'BILL' TO WS-SYSTEM                               07289099
071090           MOVE WS-SAVE-HDR-BILLER-ID  TO  WS-BILLER-ID           07290099
071100           PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT       07291099
071110           PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT       07292099
071120           GO TO 2100-ADDITIONAL-CHECKS                           07293099
071130       END-IF                                                     07294099
071140      END-IF                                                      07295099
071150     END-IF                                                       07296099
071160                                                                  07297099
071170**  JA0507  - START                                               07298099
071180**                                                                07299099
071190**   If VISION  AND                                               07300099
071200**      If Biller Status is 'AA'  - It's an Error                 07301099
071210**                                                                07302099
071220     IF  WS-VISION                                                07303099
071230       IF MDNIN-MDN-STATUS = 'AA'                                 07304099
071240           ADD 1 TO WS-TOTL-ERROR-AA                              07305099
071250           SET  WS-ERROR-FIELDS-FOUND    TO TRUE                  07306099
071260           MOVE LIT-AA-ERROR             TO WS-COMMENT            07307099
071270           MOVE SPACES                   TO WS-ADDTL-INFO         07308099
071280           MOVE 'BILL' TO WS-SYSTEM                               07309099
071290           MOVE WS-SAVE-HDR-BILLER-ID  TO  WS-BILLER-ID           07310099
071300           PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT       07311099
071310           PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT       07312099
071320           GO TO 2100-ADDITIONAL-CHECKS                           07313099
071330        END-IF                                                    07314099
071340     END-IF                                                       07315099
071350*                                                                 07316099
071360                                                                  07317099
071370* NI2KLXS BEGIN 06/23/2005                                        07318099
071380*----If Biller Status is in Assigned Available(AA) and both eTNI--07319099
071390*----Status and Port-Ind are "PO" (Ported out),     write an------07320099
071400*----error message to the output error file & exit routine.-------07321099
071410*----This disallows updates to ported-out eTNI CTNs.--------------07322099
071420*----(no update is performed in this case: both Biller and--------07323099
071430*----eTNI files are read after 2100-exit)-------------------------07324099
071440                                                                  07325099
071450     IF MDNIN-MDN-STATUS = 'AA'                                   07326099
071460        AND                                                       07327099
071470          (WS-CTNIN-CTN-STATUS = 'PO' AND                         07328099
071480           WS-CTNIN-PORT-IND = 'PO')                              07329099
071490           ADD 1 TO WS-TOTL-ERROR-POPO-MISMATCH                   07330099
071500           SET  WS-ERROR-FIELDS-FOUND TO TRUE                     07331099
071510           MOVE LIT-ETNI-PORTED-PO-ERROR TO WS-COMMENT            07332099
071520           MOVE LIT-ETNI-PO-PO TO WS-ADDTL-INFO                   07333099
071530           PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT       07334099
071540           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      07335099
071550           GO TO 2100-ADDITIONAL-CHECKS                           07336099
071560     END-IF                                                       07337099
071570                                                                  07338099
071580*----same as above, but if eTNI CTN has "PO" and "IO"------------ 07339099
071590                                                                  07340099
071600     IF MDNIN-MDN-STATUS = 'AA'                                   07341099
071610        AND                                                       07342099
071620          (WS-CTNIN-CTN-STATUS = 'PO' AND                         07343099
071630           WS-CTNIN-PORT-IND = 'IO')                              07344099
071640           ADD 1 TO WS-TOTL-ERROR-POIO-MISMATCH                   07345099
071650           SET  WS-ERROR-FIELDS-FOUND     TO TRUE                 07346099
071660           MOVE LIT-ETNI-PORTED-IO-ERROR TO WS-COMMENT            07347099
071670           MOVE LIT-ETNI-PO-IO TO WS-ADDTL-INFO                   07348099
071680           PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT       07349099
071690           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      07350099
071700           GO TO 2100-ADDITIONAL-CHECKS                           07351099
071710     END-IF                                                       07352099
071720                                                                  07353099
071730* NI2KLXS END 06/23/2005                                          07354099
071740*  P O R T   I N D I C A T O R   C H A N G E   A L L O W A N C E  07355099
071750                                                                  07356099
071760                                                                  07357099
071770*----Biller Status is Active (AI) and has a Port-Ind of "RE".-----07358099
071780*----eTNI has the same CTN with PO Status and PO Port-Indicator.--07359099
071790*----Check the LSMS table. If this CTN found with a NON-VZW Spid--07360099
071800*----allow update of Biller's Status to eTNI and leave eTNI-------07361099
071810*----Port-Ind as is. (a partial update)---------------------------07362099
071820                                                                  07363099
071830*----If this CTN found with a VZW Spid, allow full update of------07364099
071840*----Biller's Status and Biller's Port-Ind to eTNI. Routine-------07365099
071850*----7200 sets CTN-HAS-VZW-SPID to "N" or "Y"---------------------07366099
071860                                                                  07367099
071870     IF MDNIN-MDN-STATUS = 'AI' AND MDNIN-PORT-IND = 'RE'         07368099
071880     AND                                                          07369099
071890        WS-CTNIN-CTN-STATUS = 'PO' AND WS-CTNIN-PORT-IND = 'PO'   07370099
071900           MOVE WS-CTNIN-CTN-TEXT(1:10) TO NUMERIC-CTNIN-CTN      07371099
071910           MOVE NUMERIC-CTNIN-CTN TO MDN OF DCLTVZW-LSMS          07372099
071920           PERFORM 7200-CHECK-SPID-IN-LSMS THRU 7200-EXIT         07373099
071930           IF CTN-HAS-VZW-SPID = 'Y'                              07374099
071940              MOVE 'Y' TO ALLOW-PORT-IND-CHG                      07375099
071950              GO TO 2100-TEST-ON-RSS                              07376099
071960           END-IF                                                 07377099
071970     END-IF                                                       07378099
071980                                                                  07379099
071990*----new rules for determining PORT-IND change allowance 11/16/04-07380099
072000     IF MDNIN-PORT-IND = 'PI' OR                                  07381099
072010        MDNIN-PORT-IND = 'PO' OR                                  07382099
072020        MDNIN-PORT-IND = 'RE'                                     07383099
072030           MOVE WS-CTNIN-CTN-TEXT(1:10) TO NUMERIC-CTNIN-CTN      07384099
072040           MOVE NUMERIC-CTNIN-CTN TO MDN OF DCLTVZW-LSMS          07385099
072050           PERFORM 7200-CHECK-SPID-IN-LSMS THRU 7200-EXIT         07386099
072060     END-IF                                                       07387099
072070                                                                  07388099
072080*----if changing to PI & MDN in LSMS with 6006 SPID, OK to change-07389099
072090     IF MDNIN-PORT-IND = 'PI' AND                                 07390099
072100        CTN-HAS-VZW-SPID = 'Y'                                    07391099
072110            MOVE 'Y' TO ALLOW-PORT-IND-CHG                        07392099
072120            GO TO 2100-TEST-ON-RSS                                07393099
072130     END-IF                                                       07394099
072140                                                                  07395099
072150*----if changing to PO & MDN in LSMS with non-6006 SPID, OK to chg07396099
072160     IF MDNIN-PORT-IND = 'PO' AND                                 07397099
072170        CTN-HAS-VZW-SPID = 'N'                                    07398099
072180            MOVE 'Y' TO ALLOW-PORT-IND-CHG                        07399099
072190            GO TO 2100-TEST-ON-RSS                                07400099
072200     END-IF                                                       07401099
072210                                                                  07402099
072220*----if changing to PO & MDN NOT in LSMS. Check Gateway messages--07403099
072230*----to see if this MDN is an Intra-Service Port (VZW to VZW port)07404099
072240     IF MDNIN-PORT-IND = 'PO' AND                                 07405099
072250        CTN-HAS-VZW-SPID = '?'                                    07406099
072260            PERFORM 7075-IS-GATEWAY-INTRASERV-PORT THRU 7075-EXIT 07407099
072270            IF GATEWAY-INTRASERV-PORT = 'Y'                       07408099
072280               MOVE 'Y' TO ALLOW-PORT-IND-CHG                     07409099
072290               GO TO 2100-TEST-ON-RSS                             07410099
072300            END-IF                                                07411099
072310     END-IF                                                       07412099
072320                                                                  07413099
072330*----if changing to RE & MDN NOT in LSMS. Check LERG13 for VZW----07414099
072340*----ownership on Code or Block level-----------------------------07415099
072350     IF MDNIN-PORT-IND = 'RE' AND                                 07416099
072360        CTN-HAS-VZW-SPID = '?'                                    07417099
072370            PERFORM 7080-CHECK-OWNERSHIP-LERG13 THRU 7080-EXIT    07418099
072380            IF WS-VZW-OWNED-AS-CODE-HOLDER = 'Y' OR               07419099
072390               WS-VZW-OWNED-AS-CODE-HOLDER-EX = 'Y' OR            07420099
072400               WS-VZW-OWNED-AS-BLOCK-HOLDER = 'Y'                 07421099
072410               MOVE 'Y' TO ALLOW-PORT-IND-CHG                     07422099
072420               GO TO 2100-TEST-ON-RSS                             07423099
072430            END-IF                                                07424099
072440     END-IF.                                                      07425099
072450                                                                  07426099
072460 2100-TEST-ON-RSS.                                                07427099
072470                                                                  07428099
072480*----if Biller is RSS, they don't supply a Product Type, so copy--07429099
072490*----the one from eTNI to the input Biller file. This way, they'll07430099
072500*----always be in sync--------------------------------------------07431099
072510**   JA0402E - Below  Cond                                        07432099
072520                                                                  07433099
072530*****IF WS-SAVE-HDR-BILLER-ID = 'R'                               07434099
072540                                                                  07435099
072550     IF  WS-LEGIT-BILLER-ID-RESELLER                              07436099
072560        MOVE WS-CTNIN-PRODUCT-TYPE TO MDNIN-PRODUCT-TYPE          07437099
072570     END-IF                                                       07438099
072580                                                                  07439099
072590*----if Biller is RSS, do NOT compare their NGP to eTNI's to------07440099
072600*----determine if a recon is needed for this MDN. RSS doesn't-----07441099
072610*----use the NGP in any way. The easiest way to do this is to-----07442099
072620*----simply move eTNI's NGP to the RSS file's NGP so they'll------07443099
072630*----always be equal and will pass right through all tests--------07444099
072640                                                                  07445099
072650**   JA0402E - Below  Cond                                        07446099
072660*****IF WS-SAVE-HDR-BILLER-ID = 'R'                               07447099
072670                                                                  07448099
072680     IF  WS-LEGIT-BILLER-ID-RESELLER                              07449099
072690        MOVE WS-CTNIN-NGP TO MDNIN-NGP                            07450099
072700     END-IF                                                       07451099
072710                                                                  07452099
072720*** #870803 SDL BEGIN                                             07453099
072730*** ALLOW PRODUCT TYPE MISMATCH IF NPANXX IS COMINGLED.           07454099
072740*** IF COMINGLED USE CTNIN PRODUCT TYPE INSTEAD AND SAVE          07455099
072750*** MDNIN PRODUCT TYPE FOR REPORTING                              07456099
072760                                                                  07457099
072770     IF MDNIN-PRODUCT-TYPE NOT = WS-CTNIN-PRODUCT-TYPE            07458099
072780        MOVE WS-MATCH-KEY-ETNI-MDN (1:6) TO WS-NPANXX             07459099
072790        MOVE WS-NPANXX-NUMERIC                                    07460099
072800          TO NPA-NXX-NUM OF DCLTNI-NPANXX-MDN                     07461099
072810        PERFORM 7A00-SEL-TNI-NPANXX-MDN THRU 7A00-EXIT            07462099
072820        IF WS-COMINGLED-IND = 'Y'                                 07463099
072830           MOVE MDNIN-PRODUCT-TYPE TO WS-MDNIN-PRODUCT-TYPE-SAVE  07464099
072840           MOVE WS-CTNIN-PRODUCT-TYPE TO MDNIN-PRODUCT-TYPE       07465099
072850        ELSE                                                      07466099
072860           ADD  +1 TO WS-TOTL-ERROR-PRDTYP-MISMATCH               07467099
072870           SET  WS-ERROR-FIELDS-FOUND     TO TRUE                 07468099
072880           MOVE LIT-PRODUCT-TYPE-MISMATCH TO WS-COMMENT           07469099
072890           MOVE MDNIN-PRODUCT-TYPE        TO WS-ADDTL-INFO (1:1)  07470099
072900           MOVE 'VS'                      TO WS-ADDTL-INFO (3:2)  07471099
072910           MOVE WS-CTNIN-PRODUCT-TYPE     TO WS-ADDTL-INFO (6:1)  07472099
072920           PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT       07473099
072930           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      07474099
072940           GO TO 2100-ADDITIONAL-CHECKS                           07475099
072950        END-IF                                                    07476099
072960     END-IF                                                       07477099
072970                                                                  07478099
072980*** #870803 SDL END                                               07479099
072990                                                                  07480099
073000                                                                  07481099
073010* BYPASS PREPAID NUMBERS ON-HOLD                                  07482099
073020*AY070804 - BEG                                                   07483099
073030*---*Allow updates to Holding Number Location when the MDN        07484099
073040*---*is in 'AI' status in billing                                 07485099
073050     IF (MDNIN-MDN-STATUS = 'AI') AND                             07486099
073060        (WS-CTNIN-NL(2:1) = 'H')                                  07487099
073070        CONTINUE                                                  07488099
073080     ELSE                                                         07489099
073090        IF WS-CTNIN-NL(2:1) = 'H'                                 07490099
073100           ADD     +1 TO WS-TOTL-BILL-ETNI-MATCH-PP               07491099
073110           MOVE    'ETNI'                     TO WS-SYSTEM        07492099
073120           MOVE    LIT-HELD-CONTRACT-RSV      TO WS-COMMENT       07493099
073130           MOVE    WS-CTNIN-NL                TO WS-ADDTL-INFO    07494099
073140           PERFORM 6010-MOVE-ETNI-TO-RPT      THRU 6010-EXIT      07495099
073150           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      07496099
073160           GO TO 2100-ADDITIONAL-CHECKS                           07497099
073170        END-IF                                                    07498099
073180     END-IF                                                       07499099
073190*AY070804 - END                                                   07500099
073200                                                                  07501099
073210*----AGB 6/30/04--------------------------------------------------07502099
073220*----allow the processing of the following (do NOT bypass!)-------07503099
073230*----If eTNI has a status of "NH" and a Hold-Reason of "DONATE"---07504099
073240*----and the Biller has an AR or AI Status and a Port-Ind of PI---07505099
073250*----(not-assigned/held/donated in eTNI but active/ported-in at---07506099
073260*----the Biller, update eTNI to Biller's values)------------------07507099
073270                                                                  07508099
073280*----AGB 5/31/05--------------------------------------------------07509099
073290*----also allow processing if CTNIN's HOLD-REASON-CODE is one of  07510099
073300*----the valid Pending Hold Reason Codes.-------------------------07511099
073310                                                                  07512099
073320     MOVE WS-CTNIN-HOLD-REASON(1:10) TO PENDING-HOLD-REASON-CODES 07513099
073330                                                                  07514099
073340**  JA1210  -  Retain  Port-Ind  for  DONATE                      07515099
073350                                                                  07516099
073360     IF  WS-CTNIN-STATUS-REASON-CD(1:6)  = 'DONATE'               07517099
073370       IF  WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA     07518099
073380          IF WS-CTNIN-CTN-STATUS = 'AI' OR 'AR' OR 'AG' OR 'PA'   07519099
073390             MOVE  WS-CTNIN-PORT-IND  TO  MDNIN-PORT-IND          07520099
073400             GO TO 2100-CONTINUE                                  07521099
073410          END-IF                                                  07522099
073420        END-IF                                                    07523099
073430     END-IF                                                       07524099
073440                                                                  07525099
073450     IF WS-CTNIN-CTN-STATUS = 'NH' AND                            07526099
073460       (WS-CTNIN-HOLD-REASON(1:6) = 'DONATE' OR                   07527099
073470        VALID-PENDING-HOLD-REASON-CODE)                           07528099
073480     AND                                                          07529099
073490       (MDNIN-MDN-STATUS = 'AR' OR MDNIN-MDN-STATUS = 'AI')       07530099
073500     AND                                                          07531099
073510        MDNIN-PORT-IND = 'PI'                                     07532099
073520        GO TO 2100-CONTINUE                                       07533099
073530     END-IF                                                       07534099
073540                                                                  07535099
      * BYPASS LOCAL BILLING (WHATEVER STATUS) WITH MATCHING ETNI 'NH'  07536099
073560*----AGB 5/31/05--------------------------------------------------07537099
073570*----bypass processing if CTNIN's HOLD-REASON-CODE is NOT one of--07538099
073580*----the valid Pending Hold Reason Codes.-------------------------07539099
073590     IF WS-CTNIN-CTN-STATUS = 'NH' AND NOT                        07540099
073600        VALID-PENDING-HOLD-REASON-CODE                            07541099
073610        ADD     +1 TO WS-TOTL-BILL-ETNI-MATCH-NH                  07542099
073620        MOVE    'BILL'                     TO WS-SYSTEM           07543099
073630        MOVE    LIT-BILL-ETNINH-ERROR      TO WS-COMMENT          07544099
073640        MOVE    MDNIN-MDN                  TO WS-ADDTL-INFO       07545099
073650        PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT         07546099
073660        PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT         07547099
073670        GO TO 2100-ADDITIONAL-CHECKS                              07548099
073680     END-IF.                                                      07549099
073690                                                                  07550099
073700 2100-CONTINUE.                                                   07551099
073710      IF (MDNIN-MDN-STATUS = 'NA' OR 'NH')                        07552099
073720           MOVE ZEROS TO MDNIN-MIN-NUM                            07553099
073730      END-IF                                                      07554099
073740                                                                  07555099
073750*======================================================           07556099
073760* NO NEED TO PROCESS IF NO DIFFERENCES                            07557099
073770* OR IF BOTH FIELDS ARE NULLS                                     07558099
073780* (note that PORT-INDS are not compared. Biller                   07559099
073790* cannot change eTNI Port indicator).                             07560099
073800*======================================================           07561099
073810                                                                  07562099
073820*----AGB 10/11/05: To prevent the recon from considering a SPACE--07563099
073830*----and an "N" as two different values in Prepaid-Ind, move the--07564099
073840*----Biller file Prepaid-Ind to eTNI file Prepaid-Ind in the------07565099
073850*----following two cases. ("N" should be equated with space)------07566099
073860                                                                  07567099
073870*    1) Biller has "N" and eTNI has space. Move "N" to eTNI.      07568099
073880     IF MDNIN-PREPAID-IND = 'N' AND                               07569099
073890       (WS-CTNIN-PREPAID-IND = SPACE OR                           07570099
073900        WS-CTNIN-PREPAID-IND = LOW-VALUES)                        07571099
073910        MOVE MDNIN-PREPAID-IND TO WS-CTNIN-PREPAID-IND            07572099
073920     END-IF                                                       07573099
073930                                                                  07574099
073940*    2) Biller has space and eTNI has "N". Move space to eTNI.    07575099
073950     IF (MDNIN-PREPAID-IND = SPACE OR                             07576099
073960         MDNIN-PREPAID-IND = LOW-VALUES) AND                      07577099
073970         WS-CTNIN-PREPAID-IND = 'N'                               07578099
073980         MOVE MDNIN-PREPAID-IND TO WS-CTNIN-PREPAID-IND           07579099
073990     END-IF                                                       07580099
074000                                                                  07581099
074010** JA1207B  -  Below  Condition                                   07582099
074020*    3) Biller has "X";  Move "X" to eTNI.                        07583099
074030*                                                                 07584099
074040     IF MDNIN-PREPAID-IND = 'X'                                   07585099
074050        MOVE MDNIN-PREPAID-IND TO WS-CTNIN-PREPAID-IND            07586099
074060     END-IF                                                       07587099
074070                                                                  07588099
074080**  JA1207C - Handle MDNID-REVENUE-IND, Default is "Y"            07589099
074090                                                                  07590099
074100**   IF MDNIN-REVENUE-IND NOT  =  'N'                             07591099
074110**      CONTINUE                                                  07592099
074120**      ELSE                                                      07593099
074130**      PERFORM  xxxx-INSERT-CTN-REV  THRU  XXXX-EXIT             07594099
074140**   END-IF                                                       07595099
074150                                                                  07596099
074160                                                                  07597099
074170*----if Biller's Prepaid-ind is space or low-values, it's empty.--07598099
074180*----In this case, add to an accum, but DO NOT reconcile this MDN-07599099
074190*----when Biller PrePaid-ind was blank and all other flds match---07600099
074200                                                                  07601099
074210     IF (MDNIN-PREPAID-IND = SPACE OR                             07602099
074220         MDNIN-PREPAID-IND = LOW-VALUES)                          07603099
074230     AND                                                          07604099
074240        ((MDNIN-MIN-NUM = WS-CTNIN-MIN-NUM-TEXT)                  07605099
074250          OR                                                      07606099
074260         (MDNIN-MIN-NUM           =                               07607099
074270            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07608099
074280             AND                                                  07609099
074290          WS-CTNIN-MIN-NUM-TEXT   =                               07610099
074300            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07611099
074310                                                                  07612099
074320        ((MDNIN-MDN-STATUS        = WS-CTNIN-CTN-STATUS)          07613099
074330          OR                                                      07614099
074340         (MDNIN-MDN-STATUS        =                               07615099
074350            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07616099
074360             AND                                                  07617099
074370          WS-CTNIN-CTN-STATUS     =                               07618099
074380            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07619099
074390                                                                  07620099
074400        ((MDNIN-NL                = WS-CTNIN-NL)                  07621099
074410          OR                                                      07622099
074420         (MDNIN-NL                =                               07623099
074430            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07624099
074440             AND                                                  07625099
074450          WS-CTNIN-NL             =                               07626099
074460            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07627099
074470                                                                  07628099
074480        ((MDNIN-NGP               = WS-CTNIN-NGP)                 07629099
074490          OR                                                      07630099
074500         (MDNIN-NGP               =                               07631099
074510            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07632099
074520             AND                                                  07633099
074530          WS-CTNIN-NGP            =                               07634099
074540            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07635099
074550                                                                  07636099
074560        ((MDNIN-PORT-IND           = WS-CTNIN-PORT-IND)           07637099
074570          OR                                                      07638099
074580         (MDNIN-PORT-IND           =                              07639099
074590            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07640099
074600             AND                                                  07641099
074610         WS-CTNIN-PORT-IND        =                               07642099
074620            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07643099
074630                                                                  07644099
074640        ((WS-SAVE-HDR-BILLER-ID   = WS-CTNIN-BILLER-ID)           07645099
074650          OR                                                      07646099
074660         (WS-SAVE-HDR-BILLER-ID   =                               07647099
074670            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07648099
074680             AND                                                  07649099
074690          WS-CTNIN-BILLER-ID      =                               07650099
074700            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)))     07651099
074710          ADD +1 TO WS-TOTL-PP-BLANK-MATCH-ALL                    07652099
074720          GO TO 2100-ADDITIONAL-CHECKS                            07653099
074730     END-IF                                                       07654099
074740                                                                  07655099
074750                                                                  07656099
074760*----see if the Port-Indicator is the only field that's different-07657099
074770*----If so, set a flag that's used later to prevent needless------07658099
074780*----updates of CTN-INV and CTN-INV-HISTORY and MIN-INV-----------07659099
074790                                                                  07660099
074800     IF ((MDNIN-MIN-NUM           = WS-CTNIN-MIN-NUM-TEXT)        07661099
074810          OR                                                      07662099
074820         (MDNIN-MIN-NUM           =                               07663099
074830            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07664099
074840             AND                                                  07665099
074850          WS-CTNIN-MIN-NUM-TEXT   =                               07666099
074860            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07667099
074870                                                                  07668099
074880        ((MDNIN-MDN-STATUS        = WS-CTNIN-CTN-STATUS)          07669099
074890          OR                                                      07670099
074900         (MDNIN-MDN-STATUS        =                               07671099
074910            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07672099
074920             AND                                                  07673099
074930          WS-CTNIN-CTN-STATUS     =                               07674099
074940            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07675099
074950                                                                  07676099
074960        ((MDNIN-NL                = WS-CTNIN-NL)                  07677099
074970          OR                                                      07678099
074980         (MDNIN-NL                =                               07679099
074990            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07680099
075000             AND                                                  07681099
075010          WS-CTNIN-NL             =                               07682099
075020            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07683099
075030                                                                  07684099
075040        ((MDNIN-NGP               = WS-CTNIN-NGP)                 07685099
075050          OR                                                      07686099
075060         (MDNIN-NGP               =                               07687099
075070            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07688099
075080             AND                                                  07689099
075090          WS-CTNIN-NGP            =                               07690099
075100            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07691099
075110                                                                  07692099
075120**      ((MDNIN-PREPAID-IND       = WS-CTNIN-PREPAID-IND)         07693099
075130**        OR                                                      07694099
075140**       (MDNIN-PREPAID-IND       =                               07695099
075150**          (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07696099
075160**           AND                                                  07697099
075170**        WS-CTNIN-PREPAID-IND    =                               07698099
075180**          (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07699099
075190                                                                  07700099
075200*-----------------------------------------------------------------07701099
075210        (MDNIN-PORT-IND NOT = WS-CTNIN-PORT-IND)              AND 07702099
075220*-----------------------------------------------------------------07703099
075230                                                                  07704099
075240        ((WS-SAVE-HDR-BILLER-ID   = WS-CTNIN-BILLER-ID)           07705099
075250          OR                                                      07706099
075260         (WS-SAVE-HDR-BILLER-ID   =                               07707099
075270            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07708099
075280             AND                                                  07709099
075290          WS-CTNIN-BILLER-ID      =                               07710099
075300            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)))     07711099
075310          MOVE 'Y' TO PORT-IND-IS-THE-ONLY-CHANGE                 07712099
075320          ADD 1 TO PORT-INDS-DIFFERENT                            07713099
075330     END-IF                                                       07714099
075340                                                                  07715099
075350*----we know that the biller's prepaid-ind is NOT spaces nor is---07716099
075360*----it the only field different between eTNI & Biller.-----------07717099
075370*----See which ones ARE different---------------------------------07718099
075380                                                                  07719099
075390     IF ((MDNIN-MIN-NUM           = WS-CTNIN-MIN-NUM-TEXT)        07720099
075400          OR                                                      07721099
075410         (MDNIN-MIN-NUM           =                               07722099
075420            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07723099
075430             AND                                                  07724099
075440          WS-CTNIN-MIN-NUM-TEXT   =                               07725099
075450            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07726099
075460                                                                  07727099
075470        ((MDNIN-MDN-STATUS        = WS-CTNIN-CTN-STATUS)          07728099
075480          OR                                                      07729099
075490         (MDNIN-MDN-STATUS        =                               07730099
075500            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07731099
075510             AND                                                  07732099
075520          WS-CTNIN-CTN-STATUS     =                               07733099
075530            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07734099
075540                                                                  07735099
075550        ((MDNIN-NL                = WS-CTNIN-NL)                  07736099
075560          OR                                                      07737099
075570         (MDNIN-NL                =                               07738099
075580            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07739099
075590             AND                                                  07740099
075600          WS-CTNIN-NL             =                               07741099
075610            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07742099
075620                                                                  07743099
075630        ((MDNIN-NGP               = WS-CTNIN-NGP)                 07744099
075640          OR                                                      07745099
075650         (MDNIN-NGP               =                               07746099
075660            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07747099
075670             AND                                                  07748099
075680          WS-CTNIN-NGP            =                               07749099
075690            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07750099
075700                                                                  07751099
075710*--------added prepaid-ind as a compare field on 10/13/04---      07752099
075720        ((MDNIN-PREPAID-IND       = WS-CTNIN-PREPAID-IND)         07753099
075730          OR                                                      07754099
075740         (MDNIN-PREPAID-IND       =                               07755099
075750            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07756099
075760             AND                                                  07757099
075770          WS-CTNIN-PREPAID-IND    =                               07758099
075780            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07759099
075790*-----------------------------------------------------------------07760099
075800                                                                  07761099
075810                                                                  07762099
075820*--------added PORT-IND as a compare field on 10/15/04------      07763099
075830        ((MDNIN-PORT-IND          = WS-CTNIN-PORT-IND)            07764099
075840          OR                                                      07765099
075850         (MDNIN-PORT-IND          =                               07766099
075860            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07767099
075870             AND                                                  07768099
075880         WS-CTNIN-PORT-IND        =                               07769099
075890            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 07770099
075900*-----------------------------------------------------------------07771099
075910                                                                  07772099
075920        ((WS-SAVE-HDR-BILLER-ID   = WS-CTNIN-BILLER-ID)           07773099
075930          OR                                                      07774099
075940         (WS-SAVE-HDR-BILLER-ID   =                               07775099
075950            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       07776099
075960             AND                                                  07777099
075970          WS-CTNIN-BILLER-ID      =                               07778099
075980            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)))     07779099
075990*-----every field matched: nothing to reconcile!------------------07780099
076000          ADD +1 TO WS-TOTL-BILL-ETNI-MATCH-OK                    07781099
076010          GO TO 2100-ADDITIONAL-CHECKS                            07782099
076020     END-IF                                                       07783099
076030                                                                  07784099
076040*  " F o r   e f f i c i e n c y " -                              07785099
076050                                                                  07786099
076060*----if this is an MDN match, and only PORT-IND changed, but------07787099
076070*----PORT-IND change was disallowed, do not perform any updates---07788099
076080*----for this MDN.      exit the 2100-   routine.-----------------07789099
076090*----This is for efficiency: prevents needless updates------------07790099
076100*  JA1211                                                         07791099
076110     IF  NOT  WS-RSS                                              07792099
076120      IF PORT-IND-IS-THE-ONLY-CHANGE = 'Y' AND                    07793099
076130        ALLOW-PORT-IND-CHG NOT = 'Y'                              07794099
076140          MOVE ZERO TO SQLCODE                                    07795099
076150*---------dont report error if LAST-TRX-DATE with 5 days of curnt-07796099
076160          PERFORM 2101-HOW-CURR-IS-LAST-TRX-DATE THRU 2101-EXIT   07797099
076170          IF TRX-DATE-TOO-RECENT = 'Y'                            07798099
076180             GO TO 2100-ADDITIONAL-CHECKS                         07799099
076190          END-IF                                                  07800099
076200                                                                  07801099
076210          ADD 1 TO PORT-INDS-DIFF-BUT-DISALLOW                    07802099
076220          MOVE LIT-PORT-IND-CHANGE-ERROR TO WS-COMMENT            07803099
076230          MOVE WS-CTNIN-PORT-IND TO OLD-PORT-IND-KEPT-PORT        07804099
076240          MOVE LIT-OLD-PORT-KEPT TO WS-ADDTL-INFO                 07805099
076250          MOVE 'ETNI' TO WS-SYSTEM                                07806099
076260          PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT       07807099
076270          PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT       07808099
076280          GO TO 2100-ADDITIONAL-CHECKS                            07809099
076290       END-IF                                                     07810099
076300     END-IF                                                       07811099
076310                                                                  07812099
076320* _______________________________________________________________ 07813099
076330* | At least 1 field was different, so continue on to reconcile | 07814099
076340* | Biller and eTNI records.                                    | 07815099
076350* |_____________________________________________________________| 07816099
076360                                                                  07817099
076370*----If the prepaid-ind was the ONLY field which was different----07818099
076380*----then set a flag used later for reporting purposes------------07819099
076390                                                                  07820099
076400     INITIALIZE RPT-MDNIN-PREPAID-IND RPT-CTNIN-PREPAID-IND       07821099
076410                ONLY-PREPAID-IND-CHANGED                          07822099
076420                                                                  07823099
076430     IF MDNIN-PREPAID-IND NOT = WS-CTNIN-PREPAID-IND              07824099
076440     AND                                                          07825099
076450        MDNIN-PORT-IND = WS-CTNIN-PORT-IND AND                    07826099
076460        MDNIN-MIN-NUM = WS-CTNIN-MIN-NUM-TEXT AND                 07827099
076470        MDNIN-MDN-STATUS = WS-CTNIN-CTN-STATUS AND                07828099
076480        MDNIN-NL = WS-CTNIN-NL AND                                07829099
076490        MDNIN-NGP = WS-CTNIN-NGP AND                              07830099
076500        WS-SAVE-HDR-BILLER-ID = WS-CTNIN-BILLER-ID                07831099
076510           MOVE MDNIN-PREPAID-IND TO RPT-MDNIN-PREPAID-IND        07832099
076520           MOVE WS-CTNIN-PREPAID-IND TO RPT-CTNIN-PREPAID-IND     07833099
076530           MOVE 'Y' TO ONLY-PREPAID-IND-CHANGED                   07834099
076540     END-IF                                                       07835099
076550*  JA1207A  -  Next  Cond. - NOT an ERROR, Just Bypass Cond.      07836099
076560***                                                               07837099
076570     IF  ONLY-PREPAID-IND-CHANGED     =  'Y'                      07838099
076580         AND  MDNIN-MDN-STATUS  OF  MDNIN-DETAIL-FIELDS  =  'AG'  07839099
076590         GO  TO  2100-ADDITIONAL-CHECKS                           07840099
076600     END-IF                                                       07841099
076610                                                                  07842099
076620                                                                  07843099
076630*----sometimes, because of a transfer failure, an MDN will show---07844099
076640*----with one biller in the Biller's input file and a different---07845099
076650*----biller in the eTNI CTN Inventory table. (because Biller's----07846099
076660*----portion of the Xfer failed but the eTNI portion worked).-----07847099
076670*----When this is encountered, don't process this Biller record---07848099
076680*----and produce an error message that CTN belongs to another-----07849099
076690*----biller in eTNI-----------------------------------------------07850099
076700                                                                  07851099
076710*----Do NOT do this if currently in a "forced match" situation.---07852099
076720*----(only perform in regular Biller matches eTNI situations)-----07853099
076730                                                                  07854099
076740                                                                  07855099
076750     IF FORCED-MDN-MATCH-FLAG NOT = 'Y' AND                       07856099
076760        WS-SAVE-HDR-BILLER-ID NOT = WS-CTNIN-BILLER-ID            07857099
076770           MOVE LIT-DUPE-BILLER-ID TO WS-COMMENT                  07858099
076780           STRING                                                 07859099
076790          'ETNI BILLER: '            DELIMITED BY SIZE            07860099
076800           WS-CTNIN-BILLER-ID        DELIMITED BY SIZE            07861099
076810           INTO WS-ADDTL-INFO                                     07862099
076820           END-STRING                                             07863099
076830**  JA1207F  - Below  Modified to report on Both Billing & eTNI   07864099
076840           MOVE 'BILL' TO WS-SYSTEM                               07865099
076850           PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT       07866099
076860           PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT            07867099
076870           MOVE 'ETNI' TO WS-SYSTEM                               07868099
076880           MOVE  MDNIN-MDN  TO  WS-MDN                            07869099
076890           PERFORM 7000-SELECT-CTN-INV       THRU 7000-EXIT       07870099
076900           PERFORM 7054-WRITE-ERROR-RPT      THRU 7054-EXIT       07871099
076910           GO TO 2100-ADDITIONAL-CHECKS                           07872099
076920     END-IF                                                       07873099
076930                                                                  07874099
076940*IR#071503 BEG KIN                                                07875099
076950* PROHIBIT RSS UPDATE PROCESS WHEN BILLER-ID EQUAL TO THE         07876099
076960*          NL FIRST CHARACTER FROM THE HEADER.....                07877099
076970*  JA0410  - Added  Perm Reserve  NL(2:1) = H..Below              07878099
076980                                                                  07879099
076990     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        07880099
077000*-------port-outs have spaces in NL, so only compare NLs 1st byte-07881099
077010*-------to Biller from Header if the NL is populated!-------------07882099
077020          IF MDNIN-NL OF WS-MDNIN-RECORD(1:1) NOT = SPACE AND     07883099
077030             MDNIN-NL OF WS-MDNIN-RECORD(1:1) NOT = LOW-VALUES AND07884099
077040             MDNIN-NL OF WS-MDNIN-RECORD(1:1) NOT =               07885099
077050                         WS-SAVE-HDR-BILLER-ID  AND               07886099
077060             MDNIN-NL OF WS-MDNIN-RECORD(2:1) NOT =  'H'          07887099
077070             ADD  +1 TO WS-TOTL-ERROR-RSS-BILL-NL-BYP             07888099
077080             MOVE MDNIN-NL OF WS-MDNIN-RECORD TO LIT-RSS-NL       07889099
077090             MOVE WS-SAVE-HDR-BILLER-ID TO LIT-RSS-BILLER         07890099
077100             MOVE LIT-RSS-NL-1ST-TO-BILL-ID TO WS-COMMENT         07891099
077110             INITIALIZE WS-ADDTL-INFO                             07892099
077120             PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT     07893099
077130             PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT     07894099
077140             GO TO 2100-ADDITIONAL-CHECKS                         07895099
077150          END-IF                                                  07896099
077160     END-IF                                                       07897099
077170*IR#071503 END KIN                                                07898099
077180                                                                  07899099
077190                                                                  07900099
077200* PROCESS RECORD, ONE OF THE FIELDS ABOVE DIFFER                  07901099
077210     ADD    +1 TO WS-TOTL-BILL-ETNI-DIFF-CNT                      07902099
077220*----the input eTNI CTN-INV fields are considered the "old" ones--07903099
077230     MOVE    WS-CTNIN-BILLER-ID        TO WS-BILLER-ID            07904099
077240     MOVE    WS-CTNIN-MIN-NUM-TEXT     TO WS-OLD-MIN-NUM          07905099
077250     MOVE    WS-CTNIN-CTN-STATUS       TO WS-OLD-STATUS           07906099
077260     MOVE    WS-CTNIN-PRODUCT-TYPE     TO WS-OLD-PRODUCT-TYPE     07907099
077270     MOVE    WS-CTNIN-NL               TO WS-OLD-NL               07908099
077280     MOVE    WS-CTNIN-NGP              TO WS-OLD-NGP              07909099
077290     MOVE    WS-CTNIN-PORT-IND         TO WS-OLD-PORT-IND         07910099
077300*----the input Biller file fields are considered the "new" ones---07911099
077310     MOVE    MDNIN-MIN-NUM             TO WS-NEW-MIN-NUM          07912099
077320     MOVE    MDNIN-MDN-STATUS          TO WS-NEW-STATUS           07913099
077330     MOVE    MDNIN-PRODUCT-TYPE        TO WS-NEW-PRODUCT-TYPE     07914099
077340     MOVE    MDNIN-NL                  TO WS-NEW-NL               07915099
077350     MOVE    MDNIN-NGP                 TO WS-NEW-NGP              07916099
077360     MOVE    MDNIN-PORT-IND            TO WS-NEW-PORT-IND         07917099
077370     MOVE    MDNIN-LAST-TRX-CODE       TO WS-TRANS-CODE           07918099
077380                                                                  07919099
077390*----if Biller's Status different from eTNI's and eTNI's is "NH"--07920099
077400*----set a flag to later null out the eTNI ICC-ID column.---------07921099
077410*----(part of eTNI Assignment Synchronicity project)--------------07922099
077420     MOVE SPACE TO NULL-ICC-ID-FLAG                               07923099
077430     IF MDNIN-MDN-STATUS NOT = WS-CTNIN-CTN-STATUS AND            07924099
077440        WS-CTNIN-CTN-STATUS = 'NH'                                07925099
077450        MOVE 'Y' TO NULL-ICC-ID-FLAG                              07926099
077460     END-IF                                                       07927099
077470                                                                  07928099
077480*=================================================================07929099
077490* VALIDATE LOCAL BILLING SYSTEM FIELDS                            07930099
077500*=================================================================07931099
077510                                                                  07932099
077520*  here in 2100-MDN-MATCH, it is possible to have the Biller      07933099
077530*  update the eTNI PORT-IND under specfic circumstances as        07934099
077540*  determined above in 7200-CHECK-SPID-IN-LSMS, which sets        07935099
077550*  ALLOW-PORT-IND-CHG to either "Y" or "N".                       07936099
077560*  2110-VALIDATE-BILL-MDN-FIELDS, below,      uses that flag to   07937099
077570*  add to counters and set correct text in the detail line.       07938099
077580                                                                  07939099
077590     PERFORM 2110-VALIDATE-BILL-MDN-FIELDS THRU 2110-EXIT         07940099
077600                                                                  07941099
077610*----after above validation, if error found, write to error rpt---07942099
077620     IF WS-ERROR-FIELDS-FOUND                                     07943099
077630        PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT         07944099
077640        PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT         07945099
077650        GO TO 2100-ADDITIONAL-CHECKS                              07946099
077660     END-IF                                                       07947099
077670                                                                  07948099
077680*-AGB 2/01/06. To prevent the Biller from updating eTNI with an---07949099
077690*-----illegal combination of Status and Port-Ind, check here.-----07950099
077700*-----(Reported on Error Report but no updates performed)---------07951099
077710                                                                  07952099
077720     IF WS-CTNIN-CTN-STATUS = 'AR' AND WS-CTNIN-PORT-IND = 'PI'   07953099
077730       AND                                                        07954099
077740        MDNIN-MDN-STATUS = 'AA' AND MDNIN-PORT-IND = 'PI'         07955099
077750        PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT         07956099
077760        MOVE 'BLR STATUS/PORT ILLEGAL:'  TO DETAIL-1-COMMENT      07957099
077770        MOVE LIT-BILLER-AA-PI TO DETAIL-1-ADDTL-INFO              07958099
077780        PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT               07959099
077790        GO TO 2100-ADDITIONAL-CHECKS                              07960099
077800     END-IF                                                       07961099
077810                                                                  07962099
077820*----No errors were found and at least 1 biller/etni field is-----07963099
077830*----different. Write to Recon report and update eTNI-------------07964099
077840                                                                  07965099
078060*-AGB 1/30/06. If prepaid-ind is the ONLY change and the MDN's----07966099
078070*-----new status (from Biller) is "AI"/"AG",      perform updates.07967099
078080***                                          Else  Bypass         07968099
                                                                        07969099
078090**  JA0912  -  moved  above / below :: Comment / Code             07970099
078090     IF ONLY-PREPAID-IND-CHANGED = 'Y' AND                        07971099
078100       (MDNIN-MDN-STATUS NOT = 'AI' AND                           07972099
078110        MDNIN-MDN-STATUS NOT = 'AG')                              07973099
078120        GO TO 2100-ADDITIONAL-CHECKS                              07974099
078130     END-IF                                                       07975099
                                                                        07976099
077850* REPORT LOCAL BILLING FIELDS                                     07977099
077860     MOVE   'BILL'                         TO   WS-SYSTEM         07978099
077870     MOVE SPACES                           TO   WS-COMMENT        07979099
077880                                                WS-ADDTL-INFO     07980099
077890     PERFORM 6000-MOVE-BILL-MDN-TO-RPT     THRU 6000-EXIT         07981099
077900     PERFORM 6400-WRITE-RECON-RPT          THRU 6400-EXIT         07982099
077910                                                                  07983099
077920* REPORT ETNI FIELDS                                              07984099
077930     MOVE   'ETNI'                         TO   WS-SYSTEM         07985099
077940*----if the Port-Ind changed and change was allowed, show it------07986099
077950     IF PORT-INDS-DONT-MATCH = 'Y' AND                            07987099
077960        ALLOW-PORT-IND-CHG = 'Y'                                  07988099
077970            MOVE HOLD-WS-COMMENT           TO   WS-COMMENT        07989099
077980            MOVE HOLD-WS-ADDTL-INFO        TO   WS-ADDTL-INFO     07990099
077990     ELSE                                                         07991099
078000        MOVE SPACES                        TO   WS-COMMENT        07992099
078010                                                WS-ADDTL-INFO     07993099
078020        END-IF                                                    07994099
                                                                        07995099
      *  JA0912                                                         07996099
           IF  WS-COMMENT  =  SPACES                                    07997099
             IF  ONLY-PREPAID-IND-CHANGED  =  'Y'                       07998099
077970           MOVE  LIT-PREPAID-IND-UPDATED  TO   WS-COMMENT         07999099
078020       END-IF                                                     08000099
078020     END-IF                                                       08001099
                                                                        08002099
078030     PERFORM 6010-MOVE-ETNI-TO-RPT         THRU 6010-EXIT         08003099
078040     PERFORM 6400-WRITE-RECON-RPT          THRU 6400-EXIT         08004099
                                                                        08005099
      *  JA0912  -  RSS  Change,  Force  History  For  Prepaid  Only    08006099
           IF  WS-RSS                                                   08007099
               IF  ONLY-PREPAID-IND-CHANGED  =  'Y'                     08008099
                  IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA 08009099
                     GO  TO  2100-RSS-CONT-010                          08010099
                  END-IF                                                08011099
               END-IF                                                   08012099
           END-IF                                                       08013099
                                                                        08014099
078240     .                                                            08015099
       2100-RSS-CONT-010.                                               08016099
078140                                                                  08017099
078150* UPDATE PROCESS - only if parm is "UPDATE" or "UPDDEL"           08018099
078160*                  or "UPDDNA                                     08019099
078180* CREATE CTN-INV-HIST ROW BEFORE DOING ANY UPDATE ON CTN-INV      08020099
078140                                                                  08021099
078170     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        08022099
078190        INITIALIZE USE-CTN-FIELDS-FOR-KEY                         08023099
078200        PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT               08024099
078210        IF WS-ERROR-FIELDS-FOUND                                  08025099
078220           GO TO 2100-ADDITIONAL-CHECKS                           08026099
078230        END-IF                                                    08027099
078240                                                                  08028099
078240                                                                  08029099
078250*-------move Biller fields to CTN-INV DCLGEN for update below-----08030099
078260*-------(routine uses flag set in 2110-VALIDATE-BILL-MDN-FIELDS---08031099
078270*-------to determine if Biller Port-Ind should be move to eTNI)---08032099
078280        PERFORM 2140-MOVE-BILL-TO-ETNI-CTN    THRU 2140-EXIT      08033099
078290        IF WS-ERROR-FIELDS-FOUND                                  08034099
078300*          reset update/no-update min flag to original setting    08035099
078310           MOVE SAVE-IS-THIS-I2K-INPUT TO IS-THIS-I2K-INPUT       08036099
078320           MOVE   'ETNI'                      TO   WS-SYSTEM      08037099
078330           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      08038099
078340           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      08039099
078350           PERFORM 2105-REPORT-UPDATE-STATUS  THRU 2105-EXIT      08040099
078360           GO TO 2100-ADDITIONAL-CHECKS                           08041099
078370        END-IF                                                    08042099
078380                                                                  08043099
078390*       added next line on 3/26/04...                             08044099
078400        MOVE WS-CTNIN-CTN-TEXT(1:10) TO WS-MDN                    08045099
078410*agb**  MOVE WS-CTNIN-BILLER-ID TO WS-SAVE-HDR-BILLER-ID          08046099
078420        PERFORM 7010-UPDATE-CTN-INV THRU 7010-EXIT                08047099
078430*       reset update/no-update min flag to original setting       08048099
078440        MOVE SAVE-IS-THIS-I2K-INPUT TO IS-THIS-I2K-INPUT          08049099
078450                                                                  08050099
078460        PERFORM 2150-UPDATE-STATUS-COUNTERS   THRU 2150-EXIT      08051099
078470        IF WS-ERROR-FIELDS-FOUND                                  08052099
078480           MOVE   'BILL'                      TO   WS-SYSTEM      08053099
078490           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      08054099
078500           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      08055099
078510           PERFORM 2105-REPORT-UPDATE-STATUS  THRU 2105-EXIT      08056099
078520           GO TO 2100-ADDITIONAL-CHECKS                           08057099
078530        END-IF                                                    08058099
078540                                                                  08059099
078550        PERFORM 2180-UPDATE-MIN-INV-STATUS    THRU 2180-EXIT      08060099
078560        IF WS-ERROR-FIELDS-FOUND                                  08061099
078570           MOVE   'BILL'                      TO   WS-SYSTEM      08062099
078580           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      08063099
078590           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      08064099
078600           PERFORM 2105-REPORT-UPDATE-STATUS  THRU 2105-EXIT      08065099
078610           GO TO 2100-ADDITIONAL-CHECKS                           08066099
078620        END-IF                                                    08067099
078630     END-IF                                                       08068099
078640                                                                  08069099
078650                                                                  08070099
078660* REPORT PROCESS - only if parm is "REPORT"...                    08071099
078670*-------if parm is "REPORT", just write ETNI line to error file---08072099
078680*-------but DO NOT perform 7010-UPDATE-CTN-INV & other updates----08073099
078690     IF WS-PARM-REPORT                                            08074099
078700        PERFORM 2140-MOVE-BILL-TO-ETNI-CTN    THRU 2140-EXIT      08075099
078710*       reset update/no-update min flag to original setting       08076099
078720        MOVE SAVE-IS-THIS-I2K-INPUT TO IS-THIS-I2K-INPUT          08077099
078730        IF WS-ERROR-FIELDS-FOUND                                  08078099
078740           MOVE   'ETNI'                      TO   WS-SYSTEM      08079099
078750           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      08080099
078760           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      08081099
078770           PERFORM 2105-REPORT-UPDATE-STATUS  THRU 2105-EXIT      08082099
078780           GO TO 2100-ADDITIONAL-CHECKS                           08083099
078790        END-IF                                                    08084099
078800      END-IF                                                      08085099
078810                                                                  08086099
078820     PERFORM 2105-REPORT-UPDATE-STATUS THRU 2105-EXIT             08087099
078830*    reset update/no-update min flag to original setting          08088099
078840     MOVE SAVE-IS-THIS-I2K-INPUT TO IS-THIS-I2K-INPUT             08089099
078850                                                                  08090099
078860     .                                                            08091099
078870 2100-ADDITIONAL-CHECKS.                                          08092099
078880                                                                  08093099
078890**  JA1208A  -  Start                                             08094099
078900                                                                  08095099
078910     IF  (WS-VISION         AND                                   08096099
078920         NOT  WS-HUB-BILL   AND                                   08097099
078930          WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)     08098099
078940                                                                  08099099
078950**  LOOKUP  BYPASS,  IF  MAX  -OR-  IN  BYPASS  LIST;  BYPASS     08100099
078960                                                                  08101099
078970          PERFORM  VARYING   WS-CTN-STATUS-C-A-IDX                08102099
078980                   FROM  1  BY  1                                 08103099
078990                   UNTIL  WS-CTN-STATUS-C-A-IDX  >                08104099
079000                          WS-CTN-STATUS-C-A-IDX-MAX               08105099
079010                                                                  08106099
079020          OR                                                      08107099
079030        WS-ETNBC16-I-BILL-ARAY-F-T(WS-CTN-STATUS-C-A-IDX)(1:2)    08108099
079040                       =                                          08109099
079050            WS-CTNIN-CTN-STATUS                                   08110099
079060                                                                  08111099
079070          AND                                                     08112099
079080                                                                  08113099
079090        WS-ETNBC16-I-BILL-ARAY-F-T(WS-CTN-STATUS-C-A-IDX)(3:2)    08114099
079100                       =                                          08115099
079110            MDNIN-MDN-STATUS                                      08116099
079120                                                                  08117099
079130          END-PERFORM                                             08118099
079140                                                                  08119099
079150          IF  WS-CTN-STATUS-C-A-IDX  >                            08120099
079160              WS-CTN-STATUS-C-A-IDX-MAX                           08121099
079170              CONTINUE                                            08122099
079180             ELSE                                                 08123099
079190                                                                  08124099
079200**  Attempt  To  Delete  As  Match  Occured  -                    08125099
079210                                                                  08126099
079220             PERFORM  7095-ATTEMPT-DELETE-BILLING-PR    THRU      08127099
079230                      7095-EXIT                                   08128099
079240****            GO TO 2100-EXIT      - JA0310  - Comment          08129099
079250            END-IF                                                08130099
079260     END-IF                                                       08131099
079270                                                                  08132099
079280*---------------------------------------------------------------- 08133099
079290*  JA1109  -   4G  Processing  Area  -                            08134099
079300*---------------------------------------------------------------- 08135099
079310                                                                  08136099
079320**  Exit  Before  4G  Processing  Attempted, If  Errors           08137099
079330                                                                  08138099
079340     IF  WS-ERROR-FIELDS-FOUND                                    08139099
079350         GO TO 2100-EXIT                                          08140099
079360     END-IF                                                       08141099
079370                                                                  08142099
079380**  Both  Matching  'AI'  -  Attempt  CDVC,  If  required         08143099
079390                                                                  08144099
079400     IF  MDNIN-IMSI          >  ' '  OR                           08145099
079410         MDNIN-ICC-ID-4G     >  ' '  OR                           08146099
079420         WS-CTNIN-IMSI       >  ' '  OR                           08147099
079430         WS-CTNIN-ICC-ID-4G  >  ' '                               08148099
079440         INITIALIZE  WS-LTE-DATA-LAYER                            08149099
079450                     WS-4G-DETAIL-LINE                            08150099
079460                     DETAIL-LINE-1                                08151099
079470                     WS-4G-ERROR-SW                               08152099
079480                     DCLSIM-INV                                   08153099
079490                     DCLVORA-IMSI-INV                             08154099
079500                                                                  08155099
079510         IF  (MDNIN-MDN-STATUS           =  'AI'  AND             08156099
079520             WS-CTNIN-CTN-STATUS         =  'AI'  AND             08157099
079530            (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)) 08158099
079540             PERFORM  4G-1000-DETERMINE-CDVC  THRU  4G-1000-EXIT  08159099
079550            IF  WS-4G-ERROR-YES                                   08160099
079560               PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT 08161099
079570               PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT 08162099
079580               PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT 08163099
079590               PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT 08164099
079600               GO  TO  2100-EXIT                                  08165099
079610            END-IF                                                08166099
079620         END-IF                                                   08167099
079630                                                                  08168099
079640***  Was a CDVC  Generated  ?                                     08169099
079650                                                                  08170099
079660         IF  WS-4G-CDVC-YES                                       08171099
079670             PERFORM  4G-REPORT-BUILD THRU 4G-REPORT-BUILD-EXIT   08172099
079680             GO  TO  2100-EXIT                                    08173099
079690         END-IF                                                   08174099
079700                                                                  08175099
079710*  Determine if  High-Level  Error                                08176099
079720                                                                  08177099
079730         IF  MDNIN-ICC-ID-4G     =  ' '  AND                      08178099
079740             MDNIN-IMSI          =  ' '  AND                      08179099
079750             WS-CTNIN-ICC-ID-4G  >  SPACES                        08180099
079760             MOVE  LIT-BILL-ETNI-SIM-MISMATCH  TO  WS-COMMENT     08181099
079770             ADD  +1  TO  WS-T-BILL-ETNI-SIM-MISMATCH             08182099
079780             PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT   08183099
079790             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   08184099
079800             PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT   08185099
079810             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   08186099
079820             GO  TO  2100-EXIT                                    08187099
079830         END-IF                                                   08188099
079840*  Determine if  High-Level  Error                                08189099
079850                                                                  08190099
079860         IF  MDNIN-ICC-ID-4G     =  ' '  AND                      08191099
079870             MDNIN-IMSI          =  ' '  AND                      08192099
079880             WS-CTNIN-IMSI       >  SPACES                        08193099
079890             MOVE  LIT-BILL-ETNI-IMSI-MISMATCH  TO  WS-COMMENT    08194099
079900             ADD  +1  TO  WS-T-BILL-ETNI-IMSI-MISMATCH            08195099
079910             PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT   08196099
079920             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   08197099
079930             PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT   08198099
079940             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   08199099
079950             GO  TO  2100-EXIT                                    08200099
079960         END-IF                                                   08201099
079970                                                                  08202099
079980         PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT            08203099
079990         IF  WS-4G-ERROR-YES                                      08204099
080000             PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT   08205099
080010             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   08206099
080020             PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT   08207099
080030             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   08208099
080040             GO  TO  2100-EXIT                                    08209099
080050         END-IF                                                   08210099
080060                                                                  08211099
080070*  JA0310  -   4G Update                                          08212099
080080                                                                  08213099
080090         IF   WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA  08214099
080100              PERFORM  4G-UPDATE      THRU  4G-UPDATE-EXIT        08215099
080110         END-IF                                                   08216099
080120       END-IF                                                     08217099
080130     .                                                            08218099
080140 2100-EXIT.                                                       08219099
080150      EXIT.                                                       08220099
080160                                                                  08221099
080170                                                                  08222099
080180 2100-VTS-MATCH.                                                  08223099
080190******************************************************************08224099
080200*                                                                 08225099
080210*     VTS  -  Match                                               08226099
080220*                                                                 08227099
080230******************************************************************08228099
080240**  LOOKUP  BYPASS,  IF  MAX  -OR-  IN  BYPASS  LIST;  BYPASS     08229099
080250*                                                                 08230099
080260**---------------------------------                               08231099
080270**  Layout:  of  Array                                            08232099
080280**    From_eTNI_Status  (1:2)                                     08233099
080290**    To_Bill_Status    (3:2)                                     08234099
080300**    Filler            (5:1)                                     08235099
080310**                                                                08236099
080320**    Reads  From / To                                            08237099
080330**                                                                08238099
080340**    Status  Code  Combinations  Allow  Processing  To  Continue 08239099
080350**---------------------------------                               08240099
080360                                                                  08241099
080370**  Bypass  Matching  VTS  Status  Codes  As  this is the Only    08242099
080380**    VTS  Updated  Column                                        08243099
080390                                                                  08244099
080400     IF  WS-CTNIN-CTN-STATUS  =  MDNIN-MDN-STATUS                 08245099
080410         GO  TO  2100-VTS-MATCH-EXIT                              08246099
080420     END-IF                                                       08247099
080430                                                                  08248099
080440     SET  WS-VTS-PROCESSED  TO  TRUE                              08249099
080450                                                                  08250099
080460     PERFORM  VARYING   WS-CTN-STATUS-V-A1-IDX                    08251099
080470              FROM  1  BY  1                                      08252099
080480              UNTIL  WS-CTN-STATUS-V-A1-IDX  >                    08253099
080490                     WS-CTN-STATUS-V-A1-IDX-MAX                   08254099
080500          OR                                                      08255099
080510       WS-BC16-VTS-MATCH-PROCESS-AR-L                             08256099
080520                                 (WS-CTN-STATUS-V-A1-IDX)(1:2)    08257099
080530                      =                                           08258099
080540       WS-CTNIN-CTN-STATUS                                        08259099
080550                                                                  08260099
080560         AND                                                      08261099
080570       WS-BC16-VTS-MATCH-PROCESS-AR-L                             08262099
080580                                 (WS-CTN-STATUS-V-A1-IDX)(3:2)    08263099
080590                      =                                           08264099
080600       MDNIN-MDN-STATUS                                           08265099
080610                                                                  08266099
080620     END-PERFORM                                                  08267099
080630                                                                  08268099
080640     IF  WS-CTN-STATUS-V-A1-IDX  >                                08269099
080650         WS-CTN-STATUS-V-A1-IDX-MAX                               08270099
080660         SET  WS-ERROR-FIELDS-FOUND    TO TRUE                    08271099
080670         MOVE LIT-STATUS-ERROR         TO WS-COMMENT              08272099
080680         MOVE SPACES                   TO WS-ADDTL-INFO           08273099
080690         MOVE 'BILL' TO WS-SYSTEM                                 08274099
080700         MOVE WS-SAVE-HDR-BILLER-ID  TO  WS-BILLER-ID             08275099
080710         PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT         08276099
080720         PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT         08277099
080730*  JA0312                                                         08278099
080740         MOVE   'ETNI'                     TO   WS-SYSTEM         08279099
080750         PERFORM 6010-MOVE-ETNI-TO-RPT     THRU 6010-EXIT         08280099
080760         PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT         08281099
080770         ADD   +1 TO WS-TOTL-ERROR-STATUS-INVALID                 08282099
080780         GO TO 2100-VTS-MATCH-EXIT                                08283099
080790     END-IF                                                       08284099
080800**   If UPDATE  AND  NGP  Change  Requested;                      08285099
080810**      Fail Transaction request & create Error Report            08286099
080820*                                                                 08287099
080830**  JA0410  /  JA0810  -  Removed  Comments                       08288099
080840     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        08289099
080850       IF  MDNIN-NGP  NOT  =  WS-CTNIN-NGP                        08290099
080860                                                                  08291099
080870         ADD  1  TO  WS-TOTL-NGP-BILLER-ERROR                     08292099
080880         SET  WS-ERROR-FIELDS-FOUND    TO TRUE                    08293099
080890         MOVE WS-CTNIN-NGP             TO                         08294099
080900                         LIT-NGP-BILLER-ERROR1(23:3)              08295099
080910         MOVE LIT-NGP-BILLER-ERROR1    TO WS-COMMENT              08296099
080920         MOVE SPACES                   TO WS-ADDTL-INFO           08297099
080930         MOVE 'BILL' TO WS-SYSTEM                                 08298099
080940         MOVE WS-SAVE-HDR-BILLER-ID  TO  WS-BILLER-ID             08299099
080950         PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT         08300099
080960         PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT         08301099
080970*   JA0211  -  Update  LRN-Updt-Req                               08302099
080980**       PERFORM 6800-INSERT-LRN-UPD-REQT  THRU 6800-EXIT         08303099
080990         GO TO 2100-VTS-ADDITIONAL-CHECKS                         08304099
081000       END-IF                                                     08305099
081010     END-IF                                                       08306099
081020     .                                                            08307099
081030 2100-VTS-TEST-RESELLER.                                          08308099
081040                                                                  08309099
081050*----if Biller is RSS, they don't supply a Product Type, so copy--08310099
081060*----the one from eTNI to the input Biller file. This way, they'll08311099
081070*----always be in sync--------------------------------------------08312099
081080**   JA0402E - Below  Cond                                        08313099
081090                                                                  08314099
081100     IF  WS-LEGIT-BILLER-ID-RESELLER                              08315099
081110        MOVE WS-CTNIN-PRODUCT-TYPE TO MDNIN-PRODUCT-TYPE          08316099
081120     END-IF                                                       08317099
081130                                                                  08318099
081140*----if Biller is RSS, do NOT compare their NGP to eTNI's to------08319099
081150*----determine if a recon is needed for this MDN. RSS doesn't-----08320099
081160*----use the NGP in any way. The easiest way to do this is to-----08321099
081170*----       move eTNI's NGP to the RSS file's NGP so they'll------08322099
081180*----always be equal and will pass right through all tests--------08323099
081190                                                                  08324099
081200     IF  WS-LEGIT-BILLER-ID-RESELLER                              08325099
081210        MOVE WS-CTNIN-NGP TO MDNIN-NGP                            08326099
081220     END-IF                                                       08327099
081230                                                                  08328099
081240*----if Biller's Prepaid-ind is space or low-values, it's empty.--08329099
081250*----In this case, add to an accum, but DO NOT reconcile this MDN-08330099
081260*----when Biller PrePaid-ind was blank and all other flds match---08331099
081270                                                                  08332099
081280     IF (MDNIN-PREPAID-IND = SPACE OR                             08333099
081290         MDNIN-PREPAID-IND = LOW-VALUES)                          08334099
081300     AND                                                          08335099
081310        ((MDNIN-MIN-NUM = WS-CTNIN-MIN-NUM-TEXT)                  08336099
081320          OR                                                      08337099
081330         (MDNIN-MIN-NUM           =                               08338099
081340            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08339099
081350             AND                                                  08340099
081360          WS-CTNIN-MIN-NUM-TEXT   =                               08341099
081370            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08342099
081380                                                                  08343099
081390        ((MDNIN-MDN-STATUS        = WS-CTNIN-CTN-STATUS)          08344099
081400          OR                                                      08345099
081410         (MDNIN-MDN-STATUS        =                               08346099
081420            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08347099
081430             AND                                                  08348099
081440          WS-CTNIN-CTN-STATUS     =                               08349099
081450            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08350099
081460                                                                  08351099
081470        ((MDNIN-NL                = WS-CTNIN-NL)                  08352099
081480          OR                                                      08353099
081490         (MDNIN-NL                =                               08354099
081500            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08355099
081510             AND                                                  08356099
081520          WS-CTNIN-NL             =                               08357099
081530            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08358099
081540                                                                  08359099
081550        ((MDNIN-NGP               = WS-CTNIN-NGP)                 08360099
081560          OR                                                      08361099
081570         (MDNIN-NGP               =                               08362099
081580            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08363099
081590             AND                                                  08364099
081600          WS-CTNIN-NGP            =                               08365099
081610            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08366099
081620                                                                  08367099
081630        ((MDNIN-PORT-IND           = WS-CTNIN-PORT-IND)           08368099
081640          OR                                                      08369099
081650         (MDNIN-PORT-IND           =                              08370099
081660            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08371099
081670             AND                                                  08372099
081680         WS-CTNIN-PORT-IND        =                               08373099
081690            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08374099
081700                                                                  08375099
081710        ((WS-SAVE-HDR-BILLER-ID   = WS-CTNIN-BILLER-ID)           08376099
081720          OR                                                      08377099
081730         (WS-SAVE-HDR-BILLER-ID   =                               08378099
081740            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08379099
081750             AND                                                  08380099
081760          WS-CTNIN-BILLER-ID      =                               08381099
081770            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)))     08382099
081780          ADD +1 TO WS-TOTL-PP-BLANK-MATCH-ALL                    08383099
081790          GO TO 2100-VTS-ADDITIONAL-CHECKS                        08384099
081800     END-IF                                                       08385099
081810                                                                  08386099
081820                                                                  08387099
081830*----see if the Port-Indicator is the only field that's different-08388099
081840*----If so, set a flag that's used later to prevent needless------08389099
081850*----updates of CTN-INV and CTN-INV-HISTORY and MIN-INV-----------08390099
081860                                                                  08391099
081870     IF ((MDNIN-MIN-NUM           = WS-CTNIN-MIN-NUM-TEXT)        08392099
081880          OR                                                      08393099
081890         (MDNIN-MIN-NUM           =                               08394099
081900            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08395099
081910             AND                                                  08396099
081920          WS-CTNIN-MIN-NUM-TEXT   =                               08397099
081930            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08398099
081940                                                                  08399099
081950        ((MDNIN-MDN-STATUS        = WS-CTNIN-CTN-STATUS)          08400099
081960          OR                                                      08401099
081970         (MDNIN-MDN-STATUS        =                               08402099
081980            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08403099
081990             AND                                                  08404099
082000          WS-CTNIN-CTN-STATUS     =                               08405099
082010            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08406099
082020                                                                  08407099
082030        ((MDNIN-NL                = WS-CTNIN-NL)                  08408099
082040          OR                                                      08409099
082050         (MDNIN-NL                =                               08410099
082060            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08411099
082070             AND                                                  08412099
082080          WS-CTNIN-NL             =                               08413099
082090            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08414099
082100                                                                  08415099
082110        ((MDNIN-NGP               = WS-CTNIN-NGP)                 08416099
082120          OR                                                      08417099
082130         (MDNIN-NGP               =                               08418099
082140            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08419099
082150             AND                                                  08420099
082160          WS-CTNIN-NGP            =                               08421099
082170            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08422099
082180                                                                  08423099
082190                                                                  08424099
082200*-----------------------------------------------------------------08425099
082210        (MDNIN-PORT-IND NOT = WS-CTNIN-PORT-IND)              AND 08426099
082220*-----------------------------------------------------------------08427099
082230                                                                  08428099
082240        ((WS-SAVE-HDR-BILLER-ID   = WS-CTNIN-BILLER-ID)           08429099
082250          OR                                                      08430099
082260         (WS-SAVE-HDR-BILLER-ID   =                               08431099
082270            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08432099
082280             AND                                                  08433099
082290          WS-CTNIN-BILLER-ID      =                               08434099
082300            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)))     08435099
082310          MOVE 'Y' TO PORT-IND-IS-THE-ONLY-CHANGE                 08436099
082320          ADD 1 TO PORT-INDS-DIFFERENT                            08437099
082330     END-IF                                                       08438099
082340                                                                  08439099
082350*----we know that the biller's prepaid-ind is NOT spaces nor is---08440099
082360*----it the only field different between eTNI & Biller.-----------08441099
082370*----See which ones ARE different---------------------------------08442099
082380                                                                  08443099
082390     IF ((MDNIN-MIN-NUM           = WS-CTNIN-MIN-NUM-TEXT)        08444099
082400          OR                                                      08445099
082410         (MDNIN-MIN-NUM           =                               08446099
082420            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08447099
082430             AND                                                  08448099
082440          WS-CTNIN-MIN-NUM-TEXT   =                               08449099
082450            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08450099
082460                                                                  08451099
082470        ((MDNIN-MDN-STATUS        = WS-CTNIN-CTN-STATUS)          08452099
082480          OR                                                      08453099
082490         (MDNIN-MDN-STATUS        =                               08454099
082500            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08455099
082510             AND                                                  08456099
082520          WS-CTNIN-CTN-STATUS     =                               08457099
082530            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08458099
082540                                                                  08459099
082550        ((MDNIN-NL                = WS-CTNIN-NL)                  08460099
082560          OR                                                      08461099
082570         (MDNIN-NL                =                               08462099
082580            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08463099
082590             AND                                                  08464099
082600          WS-CTNIN-NL             =                               08465099
082610            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08466099
082620                                                                  08467099
082630        ((MDNIN-NGP               = WS-CTNIN-NGP)                 08468099
082640          OR                                                      08469099
082650         (MDNIN-NGP               =                               08470099
082660            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08471099
082670             AND                                                  08472099
082680          WS-CTNIN-NGP            =                               08473099
082690            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08474099
082700                                                                  08475099
082710*--------added prepaid-ind as a compare field on 10/13/04---      08476099
082720        ((MDNIN-PREPAID-IND       = WS-CTNIN-PREPAID-IND)         08477099
082730          OR                                                      08478099
082740         (MDNIN-PREPAID-IND       =                               08479099
082750            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08480099
082760             AND                                                  08481099
082770          WS-CTNIN-PREPAID-IND    =                               08482099
082780            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08483099
082790*-----------------------------------------------------------------08484099
082800                                                                  08485099
082810                                                                  08486099
082820*--------added PORT-IND as a compare field on 10/15/04------      08487099
082830        ((MDNIN-PORT-IND          = WS-CTNIN-PORT-IND)            08488099
082840          OR                                                      08489099
082850         (MDNIN-PORT-IND          =                               08490099
082860            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08491099
082870             AND                                                  08492099
082880         WS-CTNIN-PORT-IND        =                               08493099
082890            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08494099
082900*-----------------------------------------------------------------08495099
082910                                                                  08496099
082920        ((WS-SAVE-HDR-BILLER-ID   = WS-CTNIN-BILLER-ID)           08497099
082930          OR                                                      08498099
082940         (WS-SAVE-HDR-BILLER-ID   =                               08499099
082950            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08500099
082960             AND                                                  08501099
082970          WS-CTNIN-BILLER-ID      =                               08502099
082980            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)))     08503099
082990*-----every field matched: nothing to reconcile!------------------08504099
083000          ADD +1 TO WS-TOTL-BILL-ETNI-MATCH-OK                    08505099
083010          GO TO 2100-VTS-ADDITIONAL-CHECKS                        08506099
083020     END-IF                                                       08507099
083030                                                                  08508099
083040*  " F o r   e f f i c i e n c y " -                              08509099
083050                                                                  08510099
083060*----if this is an MDN match, and only PORT-IND changed, but------08511099
083070*----PORT-IND change was disallowed, do not perform any updates---08512099
083080*----for this MDN.        exit the 2100- routine.-----------------08513099
083090*----This is for efficiency: prevents needless updates------------08514099
083100     IF PORT-IND-IS-THE-ONLY-CHANGE = 'Y' AND                     08515099
083110        ALLOW-PORT-IND-CHG NOT = 'Y'                              08516099
083120          MOVE ZERO TO SQLCODE                                    08517099
083130*---------dont report error if LAST-TRX-DATE with 5 days of curnt-08518099
083140          PERFORM 2101-HOW-CURR-IS-LAST-TRX-DATE THRU 2101-EXIT   08519099
083150          IF TRX-DATE-TOO-RECENT = 'Y'                            08520099
083160             GO TO 2100-VTS-ADDITIONAL-CHECKS                     08521099
083170          END-IF                                                  08522099
083180                                                                  08523099
083190          ADD 1 TO PORT-INDS-DIFF-BUT-DISALLOW                    08524099
083200          MOVE LIT-PORT-IND-CHANGE-ERROR TO WS-COMMENT            08525099
083210          MOVE WS-CTNIN-PORT-IND TO OLD-PORT-IND-KEPT-PORT        08526099
083220          MOVE LIT-OLD-PORT-KEPT TO WS-ADDTL-INFO                 08527099
083230          MOVE 'ETNI' TO WS-SYSTEM                                08528099
083240          PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT       08529099
083250          PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT       08530099
083260          GO TO 2100-VTS-ADDITIONAL-CHECKS                        08531099
083270     END-IF                                                       08532099
083280                                                                  08533099
083290* _______________________________________________________________ 08534099
083300* | At least 1 field was different, so continue on to reconcile | 08535099
083310* | Biller and eTNI records.                                    | 08536099
083320* |_____________________________________________________________| 08537099
083330                                                                  08538099
083340*----If the prepaid-ind was the ONLY field which was different----08539099
083350*----then set a flag used later for reporting purposes------------08540099
083360                                                                  08541099
083370     INITIALIZE RPT-MDNIN-PREPAID-IND RPT-CTNIN-PREPAID-IND       08542099
083380                ONLY-PREPAID-IND-CHANGED                          08543099
083390                                                                  08544099
083400     IF MDNIN-PREPAID-IND NOT = WS-CTNIN-PREPAID-IND              08545099
083410     AND                                                          08546099
083420        MDNIN-PORT-IND = WS-CTNIN-PORT-IND AND                    08547099
083430        MDNIN-MIN-NUM = WS-CTNIN-MIN-NUM-TEXT AND                 08548099
083440        MDNIN-MDN-STATUS = WS-CTNIN-CTN-STATUS AND                08549099
083450        MDNIN-NL = WS-CTNIN-NL AND                                08550099
083460        MDNIN-NGP = WS-CTNIN-NGP AND                              08551099
083470        WS-SAVE-HDR-BILLER-ID = WS-CTNIN-BILLER-ID                08552099
083480           MOVE MDNIN-PREPAID-IND TO RPT-MDNIN-PREPAID-IND        08553099
083490           MOVE WS-CTNIN-PREPAID-IND TO RPT-CTNIN-PREPAID-IND     08554099
083500           MOVE 'Y' TO ONLY-PREPAID-IND-CHANGED                   08555099
083510     END-IF                                                       08556099
083520*  JA1207A  -  Next  Cond. - NOT an ERROR, Just Bypass Cond.      08557099
083530***                                                               08558099
083540     IF  ONLY-PREPAID-IND-CHANGED     =  'Y'                      08559099
083550         AND  MDNIN-MDN-STATUS  OF  MDNIN-DETAIL-FIELDS  =  'AG'  08560099
083560         GO  TO  2100-VTS-ADDITIONAL-CHECKS                       08561099
083570     END-IF                                                       08562099
083580                                                                  08563099
083590*----sometimes, because of a transfer failure, an MDN will show---08564099
083600*----with one biller in the Biller's input file and a different---08565099
083610*----biller in the eTNI CTN Inventory table. (because Biller's----08566099
083620*----portion of the Xfer failed but the eTNI portion worked).-----08567099
083630*----When this is encountered, don't process this Biller record---08568099
083640*----and produce an error message that CTN belongs to another-----08569099
083650*----biller in eTNI-----------------------------------------------08570099
083660                                                                  08571099
083670*----Do NOT do this if currently in a "forced match" situation.---08572099
083680*----(only perform in regular Biller matches eTNI situations)-----08573099
083690                                                                  08574099
083700     IF FORCED-MDN-MATCH-FLAG NOT = 'Y' AND                       08575099
083710        WS-SAVE-HDR-BILLER-ID NOT = WS-CTNIN-BILLER-ID            08576099
083720           MOVE LIT-DUPE-BILLER-ID TO WS-COMMENT                  08577099
083730           STRING                                                 08578099
083740          'ETNI BILLER: '            DELIMITED BY SIZE            08579099
083750           WS-CTNIN-BILLER-ID        DELIMITED BY SIZE            08580099
083760           INTO WS-ADDTL-INFO                                     08581099
083770           END-STRING                                             08582099
083780**  JA1207F  - Below  Modified to report on Both Billing & eTNI   08583099
083790           MOVE 'BILL' TO WS-SYSTEM                               08584099
083800           PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT       08585099
083810           PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT            08586099
083820           MOVE 'ETNI' TO WS-SYSTEM                               08587099
083830           MOVE  MDNIN-MDN  TO  WS-MDN                            08588099
083840           PERFORM 7000-SELECT-CTN-INV       THRU 7000-EXIT       08589099
083850           PERFORM 7054-WRITE-ERROR-RPT      THRU 7054-EXIT       08590099
083860           GO TO 2100-VTS-ADDITIONAL-CHECKS                       08591099
083870     END-IF                                                       08592099
083880                                                                  08593099
083890*IR#071503 BEG KIN                                                08594099
083900* PROHIBIT RSS UPDATE PROCESS WHEN BILLER-ID EQUAL TO THE         08595099
083910*          NL FIRST CHARACTER FROM THE HEADER.....                08596099
083920*  JA0410  - Added  Perm Reserve  NL(2:1) = H..Below              08597099
083930                                                                  08598099
083940     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        08599099
083950*-------port-outs have spaces in NL, so only compare NLs 1st byte-08600099
083960*-------to Biller from Header if the NL is populated!-------------08601099
083970          IF MDNIN-NL OF WS-MDNIN-RECORD(1:1) NOT = SPACE AND     08602099
083980             MDNIN-NL OF WS-MDNIN-RECORD(1:1) NOT = LOW-VALUES AND08603099
083990             MDNIN-NL OF WS-MDNIN-RECORD(1:1) NOT =               08604099
084000                         WS-SAVE-HDR-BILLER-ID  AND               08605099
084010             MDNIN-NL OF WS-MDNIN-RECORD(2:1) NOT =  'H'          08606099
084020             ADD  +1 TO WS-TOTL-ERROR-RSS-BILL-NL-BYP             08607099
084030             MOVE MDNIN-NL OF WS-MDNIN-RECORD TO LIT-RSS-NL       08608099
084040             MOVE WS-SAVE-HDR-BILLER-ID TO LIT-RSS-BILLER         08609099
084050             MOVE LIT-RSS-NL-1ST-TO-BILL-ID TO WS-COMMENT         08610099
084060             INITIALIZE WS-ADDTL-INFO                             08611099
084070             PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT     08612099
084080             PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT     08613099
084090             GO TO 2100-VTS-ADDITIONAL-CHECKS                     08614099
084100          END-IF                                                  08615099
084110     END-IF                                                       08616099
084120*IR#071503 END KIN                                                08617099
084130     .                                                            08618099
084140 2100-VTS-CONTINUE.                                               08619099
084150                                                                  08620099
084160* PROCESS RECORD, ONE OF THE FIELDS ABOVE DIFFER                  08621099
084170     ADD    +1 TO WS-TOTL-BILL-ETNI-DIFF-CNT                      08622099
084180*----the input eTNI CTN-INV fields are considered the "old" ones--08623099
084190     MOVE    WS-CTNIN-BILLER-ID        TO WS-BILLER-ID            08624099
084200     MOVE    WS-CTNIN-MIN-NUM-TEXT     TO WS-OLD-MIN-NUM          08625099
084210     MOVE    WS-CTNIN-CTN-STATUS       TO WS-OLD-STATUS           08626099
084220     MOVE    WS-CTNIN-PRODUCT-TYPE     TO WS-OLD-PRODUCT-TYPE     08627099
084230     MOVE    WS-CTNIN-NL               TO WS-OLD-NL               08628099
084240     MOVE    WS-CTNIN-NGP              TO WS-OLD-NGP              08629099
084250     MOVE    WS-CTNIN-PORT-IND         TO WS-OLD-PORT-IND         08630099
084260*----the input Biller file fields are considered the "new" ones---08631099
084270     MOVE    MDNIN-MIN-NUM             TO WS-NEW-MIN-NUM          08632099
084280     MOVE    MDNIN-MDN-STATUS          TO WS-NEW-STATUS           08633099
084290     MOVE    MDNIN-PRODUCT-TYPE        TO WS-NEW-PRODUCT-TYPE     08634099
084300     MOVE    MDNIN-NL                  TO WS-NEW-NL               08635099
084310     MOVE    MDNIN-NGP                 TO WS-NEW-NGP              08636099
084320     MOVE    MDNIN-PORT-IND            TO WS-NEW-PORT-IND         08637099
084330     MOVE    MDNIN-LAST-TRX-CODE       TO WS-TRANS-CODE           08638099
084340                                                                  08639099
084350*----if Biller's Status different from eTNI's and eTNI's is "NH"--08640099
084360*----set a flag to later null out the eTNI ICC-ID column.---------08641099
084370*----(part of eTNI Assignment Synchronicity project)--------------08642099
084380     MOVE SPACE TO NULL-ICC-ID-FLAG                               08643099
084390     IF MDNIN-MDN-STATUS NOT = WS-CTNIN-CTN-STATUS AND            08644099
084400        WS-CTNIN-CTN-STATUS = 'NH'                                08645099
084410        MOVE 'Y' TO NULL-ICC-ID-FLAG                              08646099
084420     END-IF                                                       08647099
084430                                                                  08648099
084440*=================================================================08649099
084450* VALIDATE LOCAL BILLING SYSTEM FIELDS                            08650099
084460*=================================================================08651099
084470                                                                  08652099
084480*  here in 2100-MDN-MATCH, it is possible to have the Biller      08653099
084490*  update the eTNI PORT-IND under specfic circumstances as        08654099
084500*  determined above in 7200-CHECK-SPID-IN-LSMS, which sets        08655099
084510*  ALLOW-PORT-IND-CHG to either "Y" or "N".                       08656099
084520*  2110-VALIDATE-BILL-MDN-FIELDS, below,      uses that flag to   08657099
084530*  add to counters and set correct text in the detail line.       08658099
084540                                                                  08659099
084550     PERFORM 2110-VALIDATE-BILL-MDN-FIELDS THRU 2110-EXIT         08660099
084560                                                                  08661099
084570*----after above validation, if error found, write to error rpt---08662099
084580     IF WS-ERROR-FIELDS-FOUND                                     08663099
084590        PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT         08664099
084600        PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT         08665099
084610        GO TO 2100-VTS-ADDITIONAL-CHECKS                          08666099
084620     END-IF                                                       08667099
084630                                                                  08668099
084640*----No errors were found and at least 1 biller/etni field is-----08669099
084650*----different. Write to Recon report and update eTNI-------------08670099
084660                                                                  08671099
084670* REPORT LOCAL BILLING FIELDS                                     08672099
084680     MOVE   'BILL'                         TO   WS-SYSTEM         08673099
084690     MOVE SPACES                           TO   WS-COMMENT        08674099
084700                                                WS-ADDTL-INFO     08675099
084710     PERFORM 6000-MOVE-BILL-MDN-TO-RPT     THRU 6000-EXIT         08676099
084720     PERFORM 6400-WRITE-RECON-RPT          THRU 6400-EXIT         08677099
084730                                                                  08678099
084740* REPORT ETNI FIELDS                                              08679099
084750     MOVE   'ETNI'                         TO   WS-SYSTEM         08680099
084760*----if the Port-Ind changed and change was allowed, show it------08681099
084770     IF PORT-INDS-DONT-MATCH = 'Y' AND                            08682099
084780        ALLOW-PORT-IND-CHG = 'Y'                                  08683099
084790            MOVE HOLD-WS-COMMENT           TO   WS-COMMENT        08684099
084800            MOVE HOLD-WS-ADDTL-INFO        TO   WS-ADDTL-INFO     08685099
084810     ELSE                                                         08686099
084820        MOVE SPACES                        TO   WS-COMMENT        08687099
084830                                                WS-ADDTL-INFO     08688099
084840     END-IF                                                       08689099
084850     PERFORM 6010-MOVE-ETNI-TO-RPT         THRU 6010-EXIT         08690099
084860     PERFORM 6400-WRITE-RECON-RPT          THRU 6400-EXIT         08691099
084870                                                                  08692099
084880*-AGB 1/30/06. If prepaid-ind is the ONLY change and the MDN's----08693099
084890*-----new status (from Biller) is "AI"/"AG",      perform updates.08694099
084900***                                                               08695099
084910                                                                  08696099
084920**  JA1211 -  Comment  Out  below                                 08697099
084930**   IF ONLY-PREPAID-IND-CHANGED = 'Y' AND                        08698099
084940**     (MDNIN-MDN-STATUS NOT = 'AI' AND                           08699099
084950**      MDNIN-MDN-STATUS NOT = 'AG')                              08700099
084960**      GO TO 2100-VTS-ADDITIONAL-CHECKS                          08701099
084970**   END-IF                                                       08702099
084980                                                                  08703099
084990* UPDATE PROCESS - only if parm is "UPDATE" or "UPDDEL"           08704099
085000*                  or "UPDDNA                                     08705099
085010                                                                  08706099
085020     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        08707099
085030* CREATE CTN-INV-HIST ROW BEFORE DOING ANY UPDATE ON CTN-INV      08708099
085040        INITIALIZE USE-CTN-FIELDS-FOR-KEY                         08709099
085050        PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT               08710099
085060        IF WS-ERROR-FIELDS-FOUND                                  08711099
085070           GO TO 2100-VTS-ADDITIONAL-CHECKS                       08712099
085080        END-IF                                                    08713099
085090                                                                  08714099
085100*-------move Biller fields to CTN-INV DCLGEN for update below-----08715099
085110*-------(routine uses flag set in 2110-VALIDATE-BILL-MDN-FIELDS---08716099
085120*-------to determine if Biller Port-Ind should be move to eTNI)---08717099
085130        PERFORM 2140-MOVE-BILL-TO-ETNI-CTN    THRU 2140-EXIT      08718099
085140        IF WS-ERROR-FIELDS-FOUND                                  08719099
085150*          reset update/no-update min flag to original setting    08720099
085160           MOVE SAVE-IS-THIS-I2K-INPUT TO IS-THIS-I2K-INPUT       08721099
085170           MOVE   'ETNI'                      TO   WS-SYSTEM      08722099
085180           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      08723099
085190           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      08724099
085200           PERFORM 2105-REPORT-UPDATE-STATUS  THRU 2105-EXIT      08725099
085210           GO TO 2100-VTS-ADDITIONAL-CHECKS                       08726099
085220        END-IF                                                    08727099
085230                                                                  08728099
085240*       added next line on 3/26/04...                             08729099
085250        MOVE WS-CTNIN-CTN-TEXT(1:10) TO WS-MDN                    08730099
085260*agb**  MOVE WS-CTNIN-BILLER-ID TO WS-SAVE-HDR-BILLER-ID          08731099
085270        PERFORM 7010-UPDATE-CTN-INV THRU 7010-EXIT                08732099
085280*       reset update/no-update min flag to original setting       08733099
085290        MOVE SAVE-IS-THIS-I2K-INPUT TO IS-THIS-I2K-INPUT          08734099
085300                                                                  08735099
085310        PERFORM 2150-UPDATE-STATUS-COUNTERS   THRU 2150-EXIT      08736099
085320        IF WS-ERROR-FIELDS-FOUND                                  08737099
085330           MOVE   'BILL'                      TO   WS-SYSTEM      08738099
085340           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      08739099
085350           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      08740099
085360           PERFORM 2105-REPORT-UPDATE-STATUS  THRU 2105-EXIT      08741099
085370           GO TO 2100-VTS-ADDITIONAL-CHECKS                       08742099
085380        END-IF                                                    08743099
085390                                                                  08744099
085400                                                                  08745099
085410* REPORT PROCESS - only if parm is "REPORT"...                    08746099
085420*-------if parm is "REPORT", just write ETNI line to error file---08747099
085430*-------but DO NOT perform 7010-UPDATE-CTN-INV & other updates----08748099
085440     IF WS-PARM-REPORT                                            08749099
085450        PERFORM 2140-MOVE-BILL-TO-ETNI-CTN    THRU 2140-EXIT      08750099
085460*       reset update/no-update min flag to original setting       08751099
085470        MOVE SAVE-IS-THIS-I2K-INPUT TO IS-THIS-I2K-INPUT          08752099
085480        IF WS-ERROR-FIELDS-FOUND                                  08753099
085490           MOVE   'ETNI'                      TO   WS-SYSTEM      08754099
085500           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      08755099
085510           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      08756099
085520           PERFORM 2105-REPORT-UPDATE-STATUS  THRU 2105-EXIT      08757099
085530           GO TO 2100-VTS-ADDITIONAL-CHECKS                       08758099
085540        END-IF                                                    08759099
085550      END-IF                                                      08760099
085560                                                                  08761099
085570     PERFORM 2105-REPORT-UPDATE-STATUS THRU 2105-EXIT             08762099
085580*    reset update/no-update min flag to original setting          08763099
085590     MOVE SAVE-IS-THIS-I2K-INPUT TO IS-THIS-I2K-INPUT             08764099
085600                                                                  08765099
085610     .                                                            08766099
085620 2100-VTS-ADDITIONAL-CHECKS.                                      08767099
085630                                                                  08768099
085640**  JA1208A  -  Start                                             08769099
085650                                                                  08770099
085660     IF  WS-ERROR-FIELDS-FOUND                                    08771099
085670         GO TO 2100-VTS-MATCH-EXIT                                08772099
085680     END-IF                                                       08773099
085690                                                                  08774099
085700*---------------------------------------------------------------- 08775099
085710*  JA1109  -   4G  Processing  Area  -                            08776099
085720*---------------------------------------------------------------- 08777099
085730                                                                  08778099
085740**  Exit  Before  4G  Processing  Attempted, If  Errors           08779099
085750                                                                  08780099
085760     IF  WS-ERROR-FIELDS-FOUND                                    08781099
085770         GO TO 2100-VTS-MATCH-EXIT                                08782099
085780     END-IF                                                       08783099
085790                                                                  08784099
085800**  Both  Matching  'AI'  -  Attempt  CDVC,  If  required         08785099
085810                                                                  08786099
085820     IF  MDNIN-IMSI          >  ' '  OR                           08787099
085830         MDNIN-ICC-ID-4G     >  ' '  OR                           08788099
085840         WS-CTNIN-IMSI       >  ' '  OR                           08789099
085850         WS-CTNIN-ICC-ID-4G  >  ' '                               08790099
085860         INITIALIZE  WS-LTE-DATA-LAYER                            08791099
085870                     WS-4G-DETAIL-LINE                            08792099
085880                     DETAIL-LINE-1                                08793099
085890                     WS-4G-ERROR-SW                               08794099
085900                     DCLSIM-INV                                   08795099
085910                     DCLVORA-IMSI-INV                             08796099
085920                                                                  08797099
085930         IF  (MDNIN-MDN-STATUS           =  'AI'  AND             08798099
085940             WS-CTNIN-CTN-STATUS         =  'AI'  AND             08799099
085950            (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)) 08800099
085960             PERFORM  4G-1000-DETERMINE-CDVC  THRU  4G-1000-EXIT  08801099
085970            IF  WS-4G-ERROR-YES                                   08802099
085980               PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT 08803099
085990               PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT 08804099
086000               PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT 08805099
086010               PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT 08806099
086020               GO  TO  2100-VTS-MATCH-EXIT                        08807099
086030            END-IF                                                08808099
086040         END-IF                                                   08809099
086050                                                                  08810099
086060***  Was a CDVC  Generated  ?                                     08811099
086070                                                                  08812099
086080         IF  WS-4G-CDVC-YES                                       08813099
086090             PERFORM  4G-REPORT-BUILD THRU 4G-REPORT-BUILD-EXIT   08814099
086100             GO  TO  2100-VTS-MATCH-EXIT                          08815099
086110         END-IF                                                   08816099
086120                                                                  08817099
086130*  Determine if  High-Level  Error                                08818099
086140                                                                  08819099
086150         IF  MDNIN-ICC-ID-4G     =  ' '  AND                      08820099
086160             MDNIN-IMSI          =  ' '  AND                      08821099
086170             WS-CTNIN-ICC-ID-4G  >  SPACES                        08822099
086180             MOVE  LIT-BILL-ETNI-SIM-MISMATCH  TO  WS-COMMENT     08823099
086190             ADD  +1  TO  WS-T-BILL-ETNI-SIM-MISMATCH             08824099
086200             PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT   08825099
086210             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   08826099
086220             PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT   08827099
086230             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   08828099
086240             GO  TO  2100-VTS-MATCH-EXIT                          08829099
086250         END-IF                                                   08830099
086260*  Determine if  High-Level  Error                                08831099
086270                                                                  08832099
086280         IF  MDNIN-ICC-ID-4G     =  ' '  AND                      08833099
086290             MDNIN-IMSI          =  ' '  AND                      08834099
086300             WS-CTNIN-IMSI       >  SPACES                        08835099
086310             MOVE  LIT-BILL-ETNI-IMSI-MISMATCH  TO  WS-COMMENT    08836099
086320             ADD  +1  TO  WS-T-BILL-ETNI-IMSI-MISMATCH            08837099
086330             PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT   08838099
086340             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   08839099
086350             PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT   08840099
086360             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   08841099
086370             GO  TO  2100-VTS-MATCH-EXIT                          08842099
086380         END-IF                                                   08843099
086390                                                                  08844099
086400         PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT            08845099
086410         IF  WS-4G-ERROR-YES                                      08846099
086420             PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT   08847099
086430             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   08848099
086440             PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT   08849099
086450             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   08850099
086460             GO  TO  2100-VTS-MATCH-EXIT                          08851099
086470         END-IF                                                   08852099
086480                                                                  08853099
086490*  JA0310  -   4G Update                                          08854099
086500                                                                  08855099
086510         IF   WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA  08856099
086520              PERFORM  4G-UPDATE      THRU  4G-UPDATE-EXIT        08857099
086530         END-IF                                                   08858099
086540       END-IF                                                     08859099
086550     .                                                            08860099
086560 2100-VTS-MATCH-EXIT.  EXIT.                                      08861099
086570                                                                  08862099
086580                                                                  08863099
086590                                                                  08864099
086600 2100-5XX-MATCH.                                                  08865099
086610******************************************************************08866099
086620*                                                                 08867099
086630*     5XX  -  Match                                               08868099
086640*                                                                 08869099
086650******************************************************************08870099
086660**  LOOKUP  BYPASS,  IF  MAX  -OR-  IN  BYPASS  LIST;  BYPASS     08871099
086670*                                                                 08872099
086680**---------------------------------                               08873099
086690**  Layout:  of  Array                                            08874099
086700**    From_eTNI_Status  (1:2)                                     08875099
086710**    To_Bill_Status    (3:2)                                     08876099
086720**    Filler            (5:1)                                     08877099
086730**                                                                08878099
086740**    Reads  From / To                                            08879099
086750**                                                                08880099
086760**    Status  Code  Combinations  Allow  Processing  To  Continue 08881099
086770**---------------------------------                               08882099
086780                                                                  08883099
086790**  Bypass  Matching  5XX  Status  Codes  As  this is the Only    08884099
086800**    5XX  Updated  Column                                        08885099
086810                                                                  08886099
086820     IF  WS-CTNIN-CTN-STATUS  =  MDNIN-MDN-STATUS                 08887099
086830         GO  TO  2100-5XX-MATCH-EXIT                              08888099
086840     END-IF                                                       08889099
086850                                                                  08890099
086860     SET  WS-5XX-PROCESSED  TO  TRUE                              08891099
086870                                                                  08892099
086880     PERFORM  VARYING   WS-CTN-STATUS-5-A1-IDX                    08893099
086890              FROM  1  BY  1                                      08894099
086900              UNTIL  WS-CTN-STATUS-5-A1-IDX  >                    08895099
086910                     WS-CTN-STATUS-5-A1-IDX-MAX                   08896099
086920          OR                                                      08897099
086930       WS-BC16-5XX-MATCH-PROCESS-AR-L                             08898099
086940                                 (WS-CTN-STATUS-5-A1-IDX)(1:2)    08899099
086950                      =                                           08900099
086960       WS-CTNIN-CTN-STATUS                                        08901099
086970                                                                  08902099
086980         AND                                                      08903099
086990       WS-BC16-5XX-MATCH-PROCESS-AR-L                             08904099
087000                                 (WS-CTN-STATUS-5-A1-IDX)(3:2)    08905099
087010                      =                                           08906099
087020       MDNIN-MDN-STATUS                                           08907099
087030                                                                  08908099
087040     END-PERFORM                                                  08909099
087050                                                                  08910099
087060     IF  WS-CTN-STATUS-5-A1-IDX  >                                08911099
087070         WS-CTN-STATUS-5-A1-IDX-MAX                               08912099
087080         SET  WS-ERROR-FIELDS-FOUND    TO TRUE                    08913099
087090         MOVE LIT-STATUS-ERROR         TO WS-COMMENT              08914099
087100         MOVE SPACES                   TO WS-ADDTL-INFO           08915099
087110         MOVE 'BILL' TO WS-SYSTEM                                 08916099
087120         MOVE WS-SAVE-HDR-BILLER-ID  TO  WS-BILLER-ID             08917099
087130         PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT         08918099
087140         PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT         08919099
087150         MOVE   'ETNI'                     TO   WS-SYSTEM         08920099
087160         PERFORM 6010-MOVE-ETNI-TO-RPT     THRU 6010-EXIT         08921099
087170         PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT         08922099
087180         ADD   +1 TO WS-TOTL-ERROR-STATUS-INVALID                 08923099
087190         GO TO 2100-5XX-MATCH-EXIT                                08924099
087200     END-IF                                                       08925099
087210**   If UPDATE  AND  NGP  Change  Requested;                      08926099
087220**      Fail Transaction request & create Error Report            08927099
087230*                                                                 08928099
087240**  JA0410  /  JA0810  -  Removed  Comments                       08929099
087250     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        08930099
087260       IF  MDNIN-NGP  NOT  =  WS-CTNIN-NGP                        08931099
087270                                                                  08932099
087280         ADD  1  TO  WS-TOTL-NGP-BILLER-ERROR                     08933099
087290         SET  WS-ERROR-FIELDS-FOUND    TO TRUE                    08934099
087300         MOVE WS-CTNIN-NGP             TO                         08935099
087310                         LIT-NGP-BILLER-ERROR1(23:3)              08936099
087320         MOVE LIT-NGP-BILLER-ERROR1    TO WS-COMMENT              08937099
087330         MOVE SPACES                   TO WS-ADDTL-INFO           08938099
087340         MOVE 'BILL' TO WS-SYSTEM                                 08939099
087350         MOVE WS-SAVE-HDR-BILLER-ID  TO  WS-BILLER-ID             08940099
087360         PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT         08941099
087370         PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT         08942099
087380*   JA0211  -  Update  LRN-Updt-Req                               08943099
087390**       PERFORM 6800-INSERT-LRN-UPD-REQT  THRU 6800-EXIT         08944099
087400         GO TO 2100-5XX-ADDITIONAL-CHECKS                         08945099
087410       END-IF                                                     08946099
087420     END-IF                                                       08947099
087430     .                                                            08948099
087440 2100-5XX-TEST-RESELLER.                                          08949099
087450                                                                  08950099
087460*----if Biller is RSS, they don't supply a Product Type, so copy--08951099
087470*----the one from eTNI to the input Biller file. This way, they'll08952099
087480*----always be in sync--------------------------------------------08953099
087490**   JA0402E - Below  Cond                                        08954099
087500                                                                  08955099
087510     IF  WS-LEGIT-BILLER-ID-RESELLER                              08956099
087520        MOVE WS-CTNIN-PRODUCT-TYPE TO MDNIN-PRODUCT-TYPE          08957099
087530     END-IF                                                       08958099
087540                                                                  08959099
087550*----if Biller is RSS, do NOT compare their NGP to eTNI's to------08960099
087560*----determine if a recon is needed for this MDN. RSS doesn't-----08961099
087570*----use the NGP in any way. The easiest way to do this is to-----08962099
087580*----simply move eTNI's NGP to the RSS file's NGP so they'll------08963099
087590*----always be equal and will pass right through all tests--------08964099
087600                                                                  08965099
087610     IF  WS-LEGIT-BILLER-ID-RESELLER                              08966099
087620        MOVE WS-CTNIN-NGP TO MDNIN-NGP                            08967099
087630     END-IF                                                       08968099
087640                                                                  08969099
087650*----if Biller's Prepaid-ind is space or low-values, it's empty.--08970099
087660*----In this case, add to an accum, but DO NOT reconcile this MDN-08971099
087670*----when Biller PrePaid-ind was blank and all other flds match---08972099
087680                                                                  08973099
087690     IF (MDNIN-PREPAID-IND = SPACE OR                             08974099
087700         MDNIN-PREPAID-IND = LOW-VALUES)                          08975099
087710     AND                                                          08976099
087720        ((MDNIN-MIN-NUM = WS-CTNIN-MIN-NUM-TEXT)                  08977099
087730          OR                                                      08978099
087740         (MDNIN-MIN-NUM           =                               08979099
087750            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08980099
087760             AND                                                  08981099
087770          WS-CTNIN-MIN-NUM-TEXT   =                               08982099
087780            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08983099
087790                                                                  08984099
087800        ((MDNIN-MDN-STATUS        = WS-CTNIN-CTN-STATUS)          08985099
087810          OR                                                      08986099
087820         (MDNIN-MDN-STATUS        =                               08987099
087830            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08988099
087840             AND                                                  08989099
087850          WS-CTNIN-CTN-STATUS     =                               08990099
087860            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08991099
087870                                                                  08992099
087880        ((MDNIN-NL                = WS-CTNIN-NL)                  08993099
087890          OR                                                      08994099
087900         (MDNIN-NL                =                               08995099
087910            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       08996099
087920             AND                                                  08997099
087930          WS-CTNIN-NL             =                               08998099
087940            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 08999099
087950                                                                  09000099
087960        ((MDNIN-NGP               = WS-CTNIN-NGP)                 09001099
087970          OR                                                      09002099
087980         (MDNIN-NGP               =                               09003099
087990            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09004099
088000             AND                                                  09005099
088010          WS-CTNIN-NGP            =                               09006099
088020            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 09007099
088030                                                                  09008099
088040        ((MDNIN-PORT-IND           = WS-CTNIN-PORT-IND)           09009099
088050          OR                                                      09010099
088060         (MDNIN-PORT-IND           =                              09011099
088070            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09012099
088080             AND                                                  09013099
088090         WS-CTNIN-PORT-IND        =                               09014099
088100            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 09015099
088110                                                                  09016099
088120        ((WS-SAVE-HDR-BILLER-ID   = WS-CTNIN-BILLER-ID)           09017099
088130          OR                                                      09018099
088140         (WS-SAVE-HDR-BILLER-ID   =                               09019099
088150            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09020099
088160             AND                                                  09021099
088170          WS-CTNIN-BILLER-ID      =                               09022099
088180            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)))     09023099
088190          ADD +1 TO WS-TOTL-PP-BLANK-MATCH-ALL                    09024099
088200          GO TO 2100-5XX-ADDITIONAL-CHECKS                        09025099
088210     END-IF                                                       09026099
088220                                                                  09027099
088230                                                                  09028099
088240*----see if the Port-Indicator is the only field that's different-09029099
088250*----If so, set a flag that's used later to prevent needless------09030099
088260*----updates of CTN-INV and CTN-INV-HISTORY and MIN-INV-----------09031099
088270                                                                  09032099
088280     IF ((MDNIN-MIN-NUM           = WS-CTNIN-MIN-NUM-TEXT)        09033099
088290          OR                                                      09034099
088300         (MDNIN-MIN-NUM           =                               09035099
088310            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09036099
088320             AND                                                  09037099
088330          WS-CTNIN-MIN-NUM-TEXT   =                               09038099
088340            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 09039099
088350                                                                  09040099
088360        ((MDNIN-MDN-STATUS        = WS-CTNIN-CTN-STATUS)          09041099
088370          OR                                                      09042099
088380         (MDNIN-MDN-STATUS        =                               09043099
088390            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09044099
088400             AND                                                  09045099
088410          WS-CTNIN-CTN-STATUS     =                               09046099
088420            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 09047099
088430                                                                  09048099
088440        ((MDNIN-NL                = WS-CTNIN-NL)                  09049099
088450          OR                                                      09050099
088460         (MDNIN-NL                =                               09051099
088470            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09052099
088480             AND                                                  09053099
088490          WS-CTNIN-NL             =                               09054099
088500            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 09055099
088510                                                                  09056099
088520        ((MDNIN-NGP               = WS-CTNIN-NGP)                 09057099
088530          OR                                                      09058099
088540         (MDNIN-NGP               =                               09059099
088550            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09060099
088560             AND                                                  09061099
088570          WS-CTNIN-NGP            =                               09062099
088580            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 09063099
088590                                                                  09064099
088600                                                                  09065099
088610*-----------------------------------------------------------------09066099
088620        (MDNIN-PORT-IND NOT = WS-CTNIN-PORT-IND)              AND 09067099
088630*-----------------------------------------------------------------09068099
088640                                                                  09069099
088650        ((WS-SAVE-HDR-BILLER-ID   = WS-CTNIN-BILLER-ID)           09070099
088660          OR                                                      09071099
088670         (WS-SAVE-HDR-BILLER-ID   =                               09072099
088680            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09073099
088690             AND                                                  09074099
088700          WS-CTNIN-BILLER-ID      =                               09075099
088710            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)))     09076099
088720          MOVE 'Y' TO PORT-IND-IS-THE-ONLY-CHANGE                 09077099
088730          ADD 1 TO PORT-INDS-DIFFERENT                            09078099
088740     END-IF                                                       09079099
088750                                                                  09080099
088760*----we know that the biller's prepaid-ind is NOT spaces nor is---09081099
088770*----it the only field different between eTNI & Biller.-----------09082099
088780*----See which ones ARE different---------------------------------09083099
088790                                                                  09084099
088800     IF ((MDNIN-MIN-NUM           = WS-CTNIN-MIN-NUM-TEXT)        09085099
088810          OR                                                      09086099
088820         (MDNIN-MIN-NUM           =                               09087099
088830            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09088099
088840             AND                                                  09089099
088850          WS-CTNIN-MIN-NUM-TEXT   =                               09090099
088860            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 09091099
088870                                                                  09092099
088880        ((MDNIN-MDN-STATUS        = WS-CTNIN-CTN-STATUS)          09093099
088890          OR                                                      09094099
088900         (MDNIN-MDN-STATUS        =                               09095099
088910            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09096099
088920             AND                                                  09097099
088930          WS-CTNIN-CTN-STATUS     =                               09098099
088940            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 09099099
088950                                                                  09100099
088960        ((MDNIN-NL                = WS-CTNIN-NL)                  09101099
088970          OR                                                      09102099
088980         (MDNIN-NL                =                               09103099
088990            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09104099
089000             AND                                                  09105099
089010          WS-CTNIN-NL             =                               09106099
089020            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 09107099
089030                                                                  09108099
089040        ((MDNIN-NGP               = WS-CTNIN-NGP)                 09109099
089050          OR                                                      09110099
089060         (MDNIN-NGP               =                               09111099
089070            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09112099
089080             AND                                                  09113099
089090          WS-CTNIN-NGP            =                               09114099
089100            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 09115099
089110                                                                  09116099
089120*--------added prepaid-ind as a compare field on 10/13/04---      09117099
089130        ((MDNIN-PREPAID-IND       = WS-CTNIN-PREPAID-IND)         09118099
089140          OR                                                      09119099
089150         (MDNIN-PREPAID-IND       =                               09120099
089160            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09121099
089170             AND                                                  09122099
089180          WS-CTNIN-PREPAID-IND    =                               09123099
089190            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 09124099
089200*-----------------------------------------------------------------09125099
089210                                                                  09126099
089220                                                                  09127099
089230*--------added PORT-IND as a compare field on 10/15/04------      09128099
089240        ((MDNIN-PORT-IND          = WS-CTNIN-PORT-IND)            09129099
089250          OR                                                      09130099
089260         (MDNIN-PORT-IND          =                               09131099
089270            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09132099
089280             AND                                                  09133099
089290         WS-CTNIN-PORT-IND        =                               09134099
089300            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES))) AND 09135099
089310*-----------------------------------------------------------------09136099
089320                                                                  09137099
089330        ((WS-SAVE-HDR-BILLER-ID   = WS-CTNIN-BILLER-ID)           09138099
089340          OR                                                      09139099
089350         (WS-SAVE-HDR-BILLER-ID   =                               09140099
089360            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)       09141099
089370             AND                                                  09142099
089380          WS-CTNIN-BILLER-ID      =                               09143099
089390            (ZEROES OR SPACES OR LOW-VALUES OR HIGH-VALUES)))     09144099
089400*-----every field matched: nothing to reconcile!------------------09145099
089410          ADD +1 TO WS-TOTL-BILL-ETNI-MATCH-OK                    09146099
089420          GO TO 2100-5XX-ADDITIONAL-CHECKS                        09147099
089430     END-IF                                                       09148099
089440                                                                  09149099
089450*  " F o r   e f f i c i e n c y " -                              09150099
089460                                                                  09151099
089470*----if this is an MDN match, and only PORT-IND changed, but------09152099
089480*----PORT-IND change was disallowed, do not perform any updates---09153099
089490*----for this MDN.      exit the 2100-   routine.-----------------09154099
089500*----This is for efficiency: prevents needless updates------------09155099
089510     IF PORT-IND-IS-THE-ONLY-CHANGE = 'Y' AND                     09156099
089520        ALLOW-PORT-IND-CHG NOT = 'Y'                              09157099
089530          MOVE ZERO TO SQLCODE                                    09158099
089540*---------dont report error if LAST-TRX-DATE with 5 days of curnt-09159099
089550          PERFORM 2101-HOW-CURR-IS-LAST-TRX-DATE THRU 2101-EXIT   09160099
089560          IF TRX-DATE-TOO-RECENT = 'Y'                            09161099
089570             GO TO 2100-5XX-ADDITIONAL-CHECKS                     09162099
089580          END-IF                                                  09163099
089590                                                                  09164099
089600          ADD 1 TO PORT-INDS-DIFF-BUT-DISALLOW                    09165099
089610          MOVE LIT-PORT-IND-CHANGE-ERROR TO WS-COMMENT            09166099
089620          MOVE WS-CTNIN-PORT-IND TO OLD-PORT-IND-KEPT-PORT        09167099
089630          MOVE LIT-OLD-PORT-KEPT TO WS-ADDTL-INFO                 09168099
089640          MOVE 'ETNI' TO WS-SYSTEM                                09169099
089650          PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT       09170099
089660          PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT       09171099
089670          GO TO 2100-5XX-ADDITIONAL-CHECKS                        09172099
089680     END-IF                                                       09173099
089690                                                                  09174099
089700* _______________________________________________________________ 09175099
089710* | At least 1 field was different, so continue on to reconcile | 09176099
089720* | Biller and eTNI records.                                    | 09177099
089730* |_____________________________________________________________| 09178099
089740                                                                  09179099
089750*----If the prepaid-ind was the ONLY field which was different----09180099
089760*----then set a flag used later for reporting purposes------------09181099
089770                                                                  09182099
089780     INITIALIZE RPT-MDNIN-PREPAID-IND RPT-CTNIN-PREPAID-IND       09183099
089790                ONLY-PREPAID-IND-CHANGED                          09184099
089800                                                                  09185099
089810     IF MDNIN-PREPAID-IND NOT = WS-CTNIN-PREPAID-IND              09186099
089820     AND                                                          09187099
089830        MDNIN-PORT-IND = WS-CTNIN-PORT-IND AND                    09188099
089840        MDNIN-MIN-NUM = WS-CTNIN-MIN-NUM-TEXT AND                 09189099
089850        MDNIN-MDN-STATUS = WS-CTNIN-CTN-STATUS AND                09190099
089860        MDNIN-NL = WS-CTNIN-NL AND                                09191099
089870        MDNIN-NGP = WS-CTNIN-NGP AND                              09192099
089880        WS-SAVE-HDR-BILLER-ID = WS-CTNIN-BILLER-ID                09193099
089890           MOVE MDNIN-PREPAID-IND TO RPT-MDNIN-PREPAID-IND        09194099
089900           MOVE WS-CTNIN-PREPAID-IND TO RPT-CTNIN-PREPAID-IND     09195099
089910           MOVE 'Y' TO ONLY-PREPAID-IND-CHANGED                   09196099
089920     END-IF                                                       09197099
089930*  JA1207A  -  Next  Cond. - NOT an ERROR, Just Bypass Cond.      09198099
089940***                                                               09199099
089950     IF  ONLY-PREPAID-IND-CHANGED     =  'Y'                      09200099
089960         AND  MDNIN-MDN-STATUS  OF  MDNIN-DETAIL-FIELDS  =  'AG'  09201099
089970         GO  TO  2100-5XX-ADDITIONAL-CHECKS                       09202099
089980     END-IF                                                       09203099
089990                                                                  09204099
090000*----sometimes, because of a transfer failure, an MDN will show---09205099
090010*----with one biller in the Biller's input file and a different---09206099
090020*----biller in the eTNI CTN Inventory table. (because Biller's----09207099
090030*----portion of the Xfer failed but the eTNI portion worked).-----09208099
090040*----When this is encountered, don't process this Biller record---09209099
090050*----and produce an error message that CTN belongs to another-----09210099
090060*----biller in eTNI-----------------------------------------------09211099
090070                                                                  09212099
090080*----Do NOT do this if currently in a "forced match" situation.---09213099
090090*----(only perform in regular Biller matches eTNI situations)-----09214099
090100                                                                  09215099
090110     IF FORCED-MDN-MATCH-FLAG NOT = 'Y' AND                       09216099
090120        WS-SAVE-HDR-BILLER-ID NOT = WS-CTNIN-BILLER-ID            09217099
090130           MOVE LIT-DUPE-BILLER-ID TO WS-COMMENT                  09218099
090140           STRING                                                 09219099
090150          'ETNI BILLER: '            DELIMITED BY SIZE            09220099
090160           WS-CTNIN-BILLER-ID        DELIMITED BY SIZE            09221099
090170           INTO WS-ADDTL-INFO                                     09222099
090180           END-STRING                                             09223099
090190**  JA1207F  - Below  Modified to report on Both Billing & eTNI   09224099
090200           MOVE 'BILL' TO WS-SYSTEM                               09225099
090210           PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT       09226099
090220           PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT            09227099
090230           MOVE 'ETNI' TO WS-SYSTEM                               09228099
090240           MOVE  MDNIN-MDN  TO  WS-MDN                            09229099
090250           PERFORM 7000-SELECT-CTN-INV       THRU 7000-EXIT       09230099
090260           PERFORM 7054-WRITE-ERROR-RPT      THRU 7054-EXIT       09231099
090270           GO TO 2100-5XX-ADDITIONAL-CHECKS                       09232099
090280     END-IF                                                       09233099
090290                                                                  09234099
090300*IR#071503 BEG KIN                                                09235099
090310* PROHIBIT RSS UPDATE PROCESS WHEN BILLER-ID EQUAL TO THE         09236099
090320*          NL FIRST CHARACTER FROM THE HEADER.....                09237099
090330*  JA0410  - Added  Perm Reserve  NL(2:1) = H..Below              09238099
090340                                                                  09239099
090350     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        09240099
090360*-------port-outs have spaces in NL, so only compare NLs 1st byte-09241099
090370*-------to Biller from Header if the NL is populated!-------------09242099
090380          IF MDNIN-NL OF WS-MDNIN-RECORD(1:1) NOT = SPACE AND     09243099
090390             MDNIN-NL OF WS-MDNIN-RECORD(1:1) NOT = LOW-VALUES AND09244099
090400             MDNIN-NL OF WS-MDNIN-RECORD(1:1) NOT =               09245099
090410                         WS-SAVE-HDR-BILLER-ID  AND               09246099
090420             MDNIN-NL OF WS-MDNIN-RECORD(2:1) NOT =  'H'          09247099
090430             ADD  +1 TO WS-TOTL-ERROR-RSS-BILL-NL-BYP             09248099
090440             MOVE MDNIN-NL OF WS-MDNIN-RECORD TO LIT-RSS-NL       09249099
090450             MOVE WS-SAVE-HDR-BILLER-ID TO LIT-RSS-BILLER         09250099
090460             MOVE LIT-RSS-NL-1ST-TO-BILL-ID TO WS-COMMENT         09251099
090470             INITIALIZE WS-ADDTL-INFO                             09252099
090480             PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT     09253099
090490             PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT     09254099
090500             GO TO 2100-5XX-ADDITIONAL-CHECKS                     09255099
090510          END-IF                                                  09256099
090520     END-IF                                                       09257099
090530*IR#071503 END KIN                                                09258099
090540     .                                                            09259099
090550 2100-5XX-CONTINUE.                                               09260099
090560                                                                  09261099
090570* PROCESS RECORD, ONE OF THE FIELDS ABOVE DIFFER                  09262099
090580     ADD    +1 TO WS-TOTL-BILL-ETNI-DIFF-CNT                      09263099
090590*----the input eTNI CTN-INV fields are considered the "old" ones--09264099
090600     MOVE    WS-CTNIN-BILLER-ID        TO WS-BILLER-ID            09265099
090610     MOVE    WS-CTNIN-MIN-NUM-TEXT     TO WS-OLD-MIN-NUM          09266099
090620     MOVE    WS-CTNIN-CTN-STATUS       TO WS-OLD-STATUS           09267099
090630     MOVE    WS-CTNIN-PRODUCT-TYPE     TO WS-OLD-PRODUCT-TYPE     09268099
090640     MOVE    WS-CTNIN-NL               TO WS-OLD-NL               09269099
090650     MOVE    WS-CTNIN-NGP              TO WS-OLD-NGP              09270099
090660     MOVE    WS-CTNIN-PORT-IND         TO WS-OLD-PORT-IND         09271099
090670*----the input Biller file fields are considered the "new" ones---09272099
090680     MOVE    MDNIN-MIN-NUM             TO WS-NEW-MIN-NUM          09273099
090690     MOVE    MDNIN-MDN-STATUS          TO WS-NEW-STATUS           09274099
090700     MOVE    MDNIN-PRODUCT-TYPE        TO WS-NEW-PRODUCT-TYPE     09275099
090710     MOVE    MDNIN-NL                  TO WS-NEW-NL               09276099
090720     MOVE    MDNIN-NGP                 TO WS-NEW-NGP              09277099
090730     MOVE    MDNIN-PORT-IND            TO WS-NEW-PORT-IND         09278099
090740     MOVE    MDNIN-LAST-TRX-CODE       TO WS-TRANS-CODE           09279099
090750                                                                  09280099
090760*----if Biller's Status different from eTNI's and eTNI's is "NH"--09281099
090770*----set a flag to later null out the eTNI ICC-ID column.---------09282099
090780*----(part of eTNI Assignment Synchronicity project)--------------09283099
090790     MOVE SPACE TO NULL-ICC-ID-FLAG                               09284099
090800     IF MDNIN-MDN-STATUS NOT = WS-CTNIN-CTN-STATUS AND            09285099
090810        WS-CTNIN-CTN-STATUS = 'NH'                                09286099
090820        MOVE 'Y' TO NULL-ICC-ID-FLAG                              09287099
090830     END-IF                                                       09288099
090840                                                                  09289099
090850*=================================================================09290099
090860* VALIDATE LOCAL BILLING SYSTEM FIELDS                            09291099
090870*=================================================================09292099
090880                                                                  09293099
090890*  here in 2100-MDN-MATCH, it is possible to have the Biller      09294099
090900*  update the eTNI PORT-IND under specfic circumstances as        09295099
090910*  determined above in 7200-CHECK-SPID-IN-LSMS, which sets        09296099
090920*  ALLOW-PORT-IND-CHG to either "Y" or "N".                       09297099
090930*  2110-VALIDATE-BILL-MDN-FIELDS, below,      uses that flag to   09298099
090940*  add to counters and set correct text in the detail line.       09299099
090950                                                                  09300099
090960     PERFORM 2110-VALIDATE-BILL-MDN-FIELDS THRU 2110-EXIT         09301099
090970                                                                  09302099
090980*----after above validation, if error found, write to error rpt---09303099
090990     IF WS-ERROR-FIELDS-FOUND                                     09304099
091000        PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT         09305099
091010        PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT         09306099
091020        GO TO 2100-5XX-ADDITIONAL-CHECKS                          09307099
091030     END-IF                                                       09308099
091040                                                                  09309099
091050*----No errors were found and at least 1 biller/etni field is-----09310099
091060*----different. Write to Recon report and update eTNI-------------09311099
091070                                                                  09312099
091080* REPORT LOCAL BILLING FIELDS                                     09313099
091090     MOVE   'BILL'                         TO   WS-SYSTEM         09314099
091100     MOVE SPACES                           TO   WS-COMMENT        09315099
091110                                                WS-ADDTL-INFO     09316099
091120     PERFORM 6000-MOVE-BILL-MDN-TO-RPT     THRU 6000-EXIT         09317099
091130     PERFORM 6400-WRITE-RECON-RPT          THRU 6400-EXIT         09318099
091140                                                                  09319099
091150* REPORT ETNI FIELDS                                              09320099
091160     MOVE   'ETNI'                         TO   WS-SYSTEM         09321099
091170*----if the Port-Ind changed and change was allowed, show it------09322099
091180     IF PORT-INDS-DONT-MATCH = 'Y' AND                            09323099
091190        ALLOW-PORT-IND-CHG = 'Y'                                  09324099
091200            MOVE HOLD-WS-COMMENT           TO   WS-COMMENT        09325099
091210            MOVE HOLD-WS-ADDTL-INFO        TO   WS-ADDTL-INFO     09326099
091220     ELSE                                                         09327099
091230        MOVE SPACES                        TO   WS-COMMENT        09328099
091240                                                WS-ADDTL-INFO     09329099
091250     END-IF                                                       09330099
091260     PERFORM 6010-MOVE-ETNI-TO-RPT         THRU 6010-EXIT         09331099
091270     PERFORM 6400-WRITE-RECON-RPT          THRU 6400-EXIT         09332099
091280                                                                  09333099
091290*-AGB 1/30/06. If prepaid-ind is the ONLY change and the MDN's----09334099
091300*-----new status (from Biller) is "AI"/"AG",      perform updates.09335099
091310***                                                               09336099
091320                                                                  09337099
091330**  JA1211 -  Comment  Out  below                                 09338099
091340**   IF ONLY-PREPAID-IND-CHANGED = 'Y' AND                        09339099
091350**     (MDNIN-MDN-STATUS NOT = 'AI' AND                           09340099
091360**      MDNIN-MDN-STATUS NOT = 'AG')                              09341099
091370**      GO TO 2100-5XX-ADDITIONAL-CHECKS                          09342099
091380**   END-IF                                                       09343099
091390                                                                  09344099
091400* UPDATE PROCESS - only if parm is "UPDATE" or "UPDDEL"           09345099
091410*                  or "UPDDNA                                     09346099
091420                                                                  09347099
091430     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        09348099
091440* CREATE CTN-INV-HIST ROW BEFORE DOING ANY UPDATE ON CTN-INV      09349099
091450        INITIALIZE USE-CTN-FIELDS-FOR-KEY                         09350099
091460        PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT               09351099
091470        IF WS-ERROR-FIELDS-FOUND                                  09352099
091480           GO TO 2100-5XX-ADDITIONAL-CHECKS                       09353099
091490        END-IF                                                    09354099
091500                                                                  09355099
091510*-------move Biller fields to CTN-INV DCLGEN for update below-----09356099
091520*-------(routine uses flag set in 2110-VALIDATE-BILL-MDN-FIELDS---09357099
091530*-------to determine if Biller Port-Ind should be move to eTNI)---09358099
091540        PERFORM 2140-MOVE-BILL-TO-ETNI-CTN    THRU 2140-EXIT      09359099
091550        IF WS-ERROR-FIELDS-FOUND                                  09360099
091560*          reset update/no-update min flag to original setting    09361099
091570           MOVE SAVE-IS-THIS-I2K-INPUT TO IS-THIS-I2K-INPUT       09362099
091580           MOVE   'ETNI'                      TO   WS-SYSTEM      09363099
091590           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      09364099
091600           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      09365099
091610           PERFORM 2105-REPORT-UPDATE-STATUS  THRU 2105-EXIT      09366099
091620           GO TO 2100-5XX-ADDITIONAL-CHECKS                       09367099
091630        END-IF                                                    09368099
091640                                                                  09369099
091650*       added next line on 3/26/04...                             09370099
091660        MOVE WS-CTNIN-CTN-TEXT(1:10) TO WS-MDN                    09371099
091670*agb**  MOVE WS-CTNIN-BILLER-ID TO WS-SAVE-HDR-BILLER-ID          09372099
091680        PERFORM 7010-UPDATE-CTN-INV THRU 7010-EXIT                09373099
091690*       reset update/no-update min flag to original setting       09374099
091700        MOVE SAVE-IS-THIS-I2K-INPUT TO IS-THIS-I2K-INPUT          09375099
091710                                                                  09376099
091720        PERFORM 2150-UPDATE-STATUS-COUNTERS   THRU 2150-EXIT      09377099
091730        IF WS-ERROR-FIELDS-FOUND                                  09378099
091740           MOVE   'BILL'                      TO   WS-SYSTEM      09379099
091750           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      09380099
091760           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      09381099
091770           PERFORM 2105-REPORT-UPDATE-STATUS  THRU 2105-EXIT      09382099
091780           GO TO 2100-5XX-ADDITIONAL-CHECKS                       09383099
091790        END-IF                                                    09384099
091800                                                                  09385099
091810* REPORT PROCESS - only if parm is "REPORT"...                    09386099
091820*-------if parm is "REPORT", just write ETNI line to error file---09387099
091830*-------but DO NOT perform 7010-UPDATE-CTN-INV & other updates----09388099
091840     IF WS-PARM-REPORT                                            09389099
091850        PERFORM 2140-MOVE-BILL-TO-ETNI-CTN    THRU 2140-EXIT      09390099
091860*       reset update/no-update min flag to original setting       09391099
091870        MOVE SAVE-IS-THIS-I2K-INPUT TO IS-THIS-I2K-INPUT          09392099
091880        IF WS-ERROR-FIELDS-FOUND                                  09393099
091890           MOVE   'ETNI'                      TO   WS-SYSTEM      09394099
091900           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      09395099
091910           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      09396099
091920           PERFORM 2105-REPORT-UPDATE-STATUS  THRU 2105-EXIT      09397099
091930           GO TO 2100-5XX-ADDITIONAL-CHECKS                       09398099
091940        END-IF                                                    09399099
091950      END-IF                                                      09400099
091960                                                                  09401099
091970     PERFORM 2105-REPORT-UPDATE-STATUS THRU 2105-EXIT             09402099
091980*    reset update/no-update min flag to original setting          09403099
091990     MOVE SAVE-IS-THIS-I2K-INPUT TO IS-THIS-I2K-INPUT             09404099
092000                                                                  09405099
092010     .                                                            09406099
092020 2100-5XX-ADDITIONAL-CHECKS.                                      09407099
092030                                                                  09408099
092040**  JA1208A  -  Start                                             09409099
092050                                                                  09410099
092060     IF  WS-ERROR-FIELDS-FOUND                                    09411099
092070         GO TO 2100-5XX-MATCH-EXIT                                09412099
092080     END-IF                                                       09413099
092090                                                                  09414099
092100*---------------------------------------------------------------- 09415099
092110*  JA1109  -   4G  Processing  Area  -                            09416099
092120*---------------------------------------------------------------- 09417099
092130                                                                  09418099
092140**  Exit  Before  4G  Processing  Attempted, If  Errors           09419099
092150                                                                  09420099
092160     IF  WS-ERROR-FIELDS-FOUND                                    09421099
092170         GO TO 2100-5XX-MATCH-EXIT                                09422099
092180     END-IF                                                       09423099
092190                                                                  09424099
092200**  Both  Matching  'AI'  -  Attempt  CDVC,  If  required         09425099
092210                                                                  09426099
092220     IF  MDNIN-IMSI          >  ' '  OR                           09427099
092230         MDNIN-ICC-ID-4G     >  ' '  OR                           09428099
092240         WS-CTNIN-IMSI       >  ' '  OR                           09429099
092250         WS-CTNIN-ICC-ID-4G  >  ' '                               09430099
092260         INITIALIZE  WS-LTE-DATA-LAYER                            09431099
092270                     WS-4G-DETAIL-LINE                            09432099
092280                     DETAIL-LINE-1                                09433099
092290                     WS-4G-ERROR-SW                               09434099
092300                     DCLSIM-INV                                   09435099
092310                     DCLVORA-IMSI-INV                             09436099
092320                                                                  09437099
092330         IF  (MDNIN-MDN-STATUS           =  'AI'  AND             09438099
092340             WS-CTNIN-CTN-STATUS         =  'AI'  AND             09439099
092350            (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)) 09440099
092360             PERFORM  4G-1000-DETERMINE-CDVC  THRU  4G-1000-EXIT  09441099
092370            IF  WS-4G-ERROR-YES                                   09442099
092380               PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT 09443099
092390               PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT 09444099
092400               PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT 09445099
092410               PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT 09446099
092420               GO  TO  2100-5XX-MATCH-EXIT                        09447099
092430            END-IF                                                09448099
092440         END-IF                                                   09449099
092450                                                                  09450099
092460***  Was a CDVC  Generated  ?                                     09451099
092470                                                                  09452099
092480         IF  WS-4G-CDVC-YES                                       09453099
092490             PERFORM  4G-REPORT-BUILD THRU 4G-REPORT-BUILD-EXIT   09454099
092500             GO  TO  2100-5XX-MATCH-EXIT                          09455099
092510         END-IF                                                   09456099
092520                                                                  09457099
092530*  Determine if  High-Level  Error                                09458099
092540                                                                  09459099
092550         IF  MDNIN-ICC-ID-4G     =  ' '  AND                      09460099
092560             MDNIN-IMSI          =  ' '  AND                      09461099
092570             WS-CTNIN-ICC-ID-4G  >  SPACES                        09462099
092580             MOVE  LIT-BILL-ETNI-SIM-MISMATCH  TO  WS-COMMENT     09463099
092590             ADD  +1  TO  WS-T-BILL-ETNI-SIM-MISMATCH             09464099
092600             PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT   09465099
092610             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   09466099
092620             PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT   09467099
092630             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   09468099
092640             GO  TO  2100-5XX-MATCH-EXIT                          09469099
092650         END-IF                                                   09470099
092660*  Determine if  High-Level  Error                                09471099
092670                                                                  09472099
092680         IF  MDNIN-ICC-ID-4G     =  ' '  AND                      09473099
092690             MDNIN-IMSI          =  ' '  AND                      09474099
092700             WS-CTNIN-IMSI       >  SPACES                        09475099
092710             MOVE  LIT-BILL-ETNI-IMSI-MISMATCH  TO  WS-COMMENT    09476099
092720             ADD  +1  TO  WS-T-BILL-ETNI-IMSI-MISMATCH            09477099
092730             PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT   09478099
092740             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   09479099
092750             PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT   09480099
092760             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   09481099
092770             GO  TO  2100-5XX-MATCH-EXIT                          09482099
092780         END-IF                                                   09483099
092790                                                                  09484099
092800         PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT            09485099
092810         IF  WS-4G-ERROR-YES                                      09486099
092820             PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT   09487099
092830             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   09488099
092840             PERFORM  6010-MOVE-ETNI-TO-RPT     THRU  6010-EXIT   09489099
092850             PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT   09490099
092860             GO  TO  2100-5XX-MATCH-EXIT                          09491099
092870         END-IF                                                   09492099
092880                                                                  09493099
092890*  JA0310  -   4G Update                                          09494099
092900                                                                  09495099
092910         IF   WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA  09496099
092920              PERFORM  4G-UPDATE      THRU  4G-UPDATE-EXIT        09497099
092930         END-IF                                                   09498099
092940       END-IF                                                     09499099
092950     .                                                            09500099
092960 2100-5XX-MATCH-EXIT.  EXIT.                                      09501099
092970                                                                  09502099
092980                                                                  09503099
092990 2101-HOW-CURR-IS-LAST-TRX-DATE.                                  09504099
093000      INITIALIZE TRX-DATE-TOO-RECENT                              09505099
093010      MOVE WS-PORT-IND-DAYS-NUMERIC TO WS-PORT-IND-DAYS-NUM       09506099
093020                                                                  09507099
093030*-----don't do date comparison against "old" CTN-INV date, but----09508099
093040*-----rather against "new" date in Biller's file------------------09509099
093050                                                                  09510099
093060      IF MDNIN-LAST-TRX-DATE(1:4) NOT NUMERIC OR                  09511099
093070         MDNIN-LAST-TRX-DATE(5:2) NOT NUMERIC OR                  09512099
093080         MDNIN-LAST-TRX-DATE(7:2) NOT NUMERIC OR                  09513099
093090         WS-TIMESTAMP(1:4) NOT NUMERIC OR                         09514099
093100         WS-TIMESTAMP(6:2) NOT NUMERIC OR                         09515099
093110         WS-TIMESTAMP(9:2) NOT NUMERIC                            09516099
093120         GO TO 2101-EXIT                                          09517099
093130      END-IF                                                      09518099
093140                                                                  09519099
093150      MOVE MDNIN-LAST-TRX-DATE(1:4) TO WS-LAST-TRX-YYYY-NUM       09520099
093160      MOVE MDNIN-LAST-TRX-DATE(5:2) TO WS-LAST-TRX-MM-NUM         09521099
093170      MOVE MDNIN-LAST-TRX-DATE(7:2) TO WS-LAST-TRX-DD-NUM         09522099
093180      COMPUTE WS-MDNIN-TRX-DAYS =                                 09523099
093190             (WS-LAST-TRX-YYYY-NUM * 365) +                       09524099
093200             (WS-LAST-TRX-MM-NUM * 31)  +                         09525099
093210              WS-LAST-TRX-DD-NUM                                  09526099
093220                                                                  09527099
093230      MOVE WS-TIMESTAMP(1:4) TO WS-TIMESTAMP-YYYY-NUM             09528099
093240      MOVE WS-TIMESTAMP(6:2) TO WS-TIMESTAMP-MM-NUM               09529099
093250      MOVE WS-TIMESTAMP(9:2) TO WS-TIMESTAMP-DD-NUM               09530099
093260      COMPUTE WS-TIMESTAMP-DAYS =                                 09531099
093270             (WS-TIMESTAMP-YYYY-NUM * 365) +                      09532099
093280             (WS-TIMESTAMP-MM-NUM * 31) +                         09533099
093290              WS-TIMESTAMP-DD-NUM                                 09534099
093300                                                                  09535099
093310      IF WS-TIMESTAMP-DAYS -                                      09536099
093320         WS-MDNIN-TRX-DAYS < WS-PORT-IND-DAYS-NUM                 09537099
093330         MOVE 'Y' TO TRX-DATE-TOO-RECENT                          09538099
093340      END-IF.                                                     09539099
093350 2101-EXIT.                                                       09540099
093360      EXIT.                                                       09541099
093370                                                                  09542099
093380 2102-CREATE-CTN-HIST.                                            09543099
093390******************************************************************09544099
093400*                                                                 09545099
093410*   PARAGRAPH NAME:  2102-CREATE-CTN-HIST                         09546099
093420*                                                                 09547099
093430*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   09548099
093440*             HIST                                                09549099
093450*                                                                 09550099
093460******************************************************************09551099
093470     MOVE '2102-CREATE-CTN-HIST         '   TO WS-CURR-PARA       09552099
093480                                                                  09553099
093490* RETRIEVE CTN-INV                                                09554099
093500                                                                  09555099
093510*----depending on where this rtn is called from, we want to use---09556099
093520*----search keys coming from either the CTN-INV or the Biller file09557099
093530                                                                  09558099
093540     IF USE-CTN-FIELDS-FOR-KEY = 'Y'                              09559099
093550        INITIALIZE USE-CTN-FIELDS-FOR-KEY                         09560099
093560        MOVE WS-CTNIN-CTN-TEXT(1:10) TO WS-MDN                    09561099
093570     ELSE                                                         09562099
093580        MOVE MDNIN-MDN             TO   WS-MDN                    09563099
093590        MOVE MDNIN-PRODUCT-TYPE    TO   WS-PRODUCT-TYPE           09564099
093600     END-IF                                                       09565099
093610                                                                  09566099
093620     PERFORM 7000-SELECT-CTN-INV THRU 7000-EXIT                   09567099
093630                                                                  09568099
093640     IF SQL-ROW-NOT-FOUND                                         09569099
093650        MOVE 'N' TO WS-ERROR-ALREADY-REPORTED                     09570099
093660        ADD +1 TO WS-TOTL-ERROR-CTNINV-NOTFND                     09571099
093670        SET  WS-ERROR-FIELDS-FOUND TO   TRUE                      09572099
093680        MOVE LIT-CTN-INV-ERROR     TO   WS-COMMENT                09573099
093690        MOVE WS-MDN                TO   WS-ADDTL-INFO (1:10)      09574099
093700        MOVE WS-PRODUCT-TYPE       TO   WS-ADDTL-INFO (12:1)      09575099
093710        GO TO 2102-EXIT                                           09576099
093720     END-IF                                                       09577099
093730                                                                  09578099
093740* C R E A T E   C T N - I N V - H I S T O R Y   R E C O R D       09579099
093750                                                                  09580099
093760*----this can go one of two ways. If this is just a "straight"----09581099
093770*----History insert (in other words, an exact copy of the current-09582099
093780*----CTN-INV row for CTN),      issue a call to ETNDC15 to--------09583099
093790*----perform this task. It reads current row and inserts it to----09584099
093800*----History.-----------------------------------------------------09585099
093810                                                                  09586099
093820     IF CREATE-UNLOAD-HISTORY-FLAG NOT = 'Y' AND                  09587099
093830        NH-AND-PENDDASG-R-FLAG NOT = 'Y'                          09588099
093840        PERFORM 2103-CALL-ETNDC15-HIST-INSERT THRU 2103-EXIT      09589099
093850        GO TO 2102-EXIT                                           09590099
093860     END-IF                                                       09591099
093870                                                                  09592099
093880*----Otherwise, this is an "unload" History row,      we need to--09593099
093890*----perform the insert locally because custom values are moved to09594099
093900*----specific columns in History which do not exist in the current09595099
093910*----CTN-INV row.-------------------------------------------------09596099
093920                                                                  09597099
093930     IF CREATE-UNLOAD-HISTORY-FLAG = 'Y' OR                       09598099
093940        NH-AND-PENDDASG-R-FLAG = 'Y'                              09599099
093950        PERFORM 2320-POPULATE-CTN-HIST THRU 2320-EXIT             09600099
093960        PERFORM 7100-INSERT-CTN-HIST THRU 7100-EXIT               09601099
093970        PERFORM 7120-RETRY-UP-TO-10-TIMES THRU 7120-EXIT          09602099
093980        IF SQL-DUP-INSERT                                         09603099
093990           SET WS-ERROR-FIELDS-FOUND TO TRUE                      09604099
094000           PERFORM 6030-INIT-DETAIL-LINE THRU 6030-EXIT           09605099
094010           PERFORM 6400-WRITE-RECON-RPT THRU 6400-EXIT            09606099
094020           MOVE 'ETNI' TO WS-SYSTEM                               09607099
094030           MOVE LIT-CTN-HIST-INSERT-ERROR TO WS-COMMENT           09608099
094040           MOVE CTN-TEXT OF DCLCTN-INV-HISTORY TO                 09609099
094050                WS-ADDTL-INFO (1:10)                              09610099
094060           MOVE PRODUCT-TYPE OF DCLCTN-INV-HISTORY TO             09611099
094070                WS-ADDTL-INFO (12:1)                              09612099
094080           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           09613099
094090           PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT            09614099
094100        END-IF                                                    09615099
094110     END-IF                                                       09616099
094120     .                                                            09617099
094130 2102-EXIT.                                                       09618099
094140     EXIT.                                                        09619099
094150                                                                  09620099
094160                                                                  09621099
094170 2103-CALL-ETNDC15-HIST-INSERT.                                   09622099
094180*-----if this is an MDN match, and only PORT-IND changed, but-----09623099
094190*-----PORT-IND change was disallowed, do not update history.------09624099
094200*-----This is for efficiency: prevents needless updates-----------09625099
                                                                        09626099
      *  JA0912  -  RSS  Change,  Force  History  For  Prepaid  Only    09627099
           IF  WS-RSS                                                   09628099
               IF  ONLY-PREPAID-IND-CHANGED  =  'Y'                     09629099
                  IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA 09630099
                     GO  TO  2103-CALL-ETNDC15-HIST-INSERT5             09631099
                  END-IF                                                09632099
               END-IF                                                   09633099
           END-IF                                                       09634099
                                                                        09635099
094210      IF MDN-MATCH-FLAG = 'Y' AND                                 09636099
094220         PORT-IND-IS-THE-ONLY-CHANGE = 'Y' AND                    09637099
094230         ALLOW-PORT-IND-CHG NOT = 'Y'                             09638099
094240         MOVE ZERO TO SQLCODE                                     09639099
094250         GO TO 2103-EXIT                                          09640099
094260      END-IF                                                      09641099
094270     .                                                            09642099
094270 2103-CALL-ETNDC15-HIST-INSERT5.                                  09643099
094270                                                                  09644099
094280*     (pass ETNDC15 the current CTN)                              09645099
094290      MOVE CTN-TEXT OF DCLCTN-INV(1:CTN-LEN OF DCLCTN-INV) TO     09646099
094300           MDN OF IN-CRITERIA OF WS-HISTORY-COMMAREA              09647099
094310*     (pass ETNDC15 the calling program-id)                       09648099
094320      MOVE 'ETNBC16' TO OPERATOR-ID OF INPUT-AREA OF              09649099
094330            WS-HISTORY-COMMAREA                                   09650099
094340*     (ask it to execute function "create history from ctn-inv")  09651099
094350      SET ACT-CREATE-HISTORY IN WS-HISTORY-COMMAREA TO TRUE       09652099
094360      MOVE 'ETNDC15' TO WS-CALLED-PGM                             09653099
094370*     (call it and hope for the best)                             09654099
094380      CALL WS-CALLED-PGM USING WS-HISTORY-COMMAREA                09655099
094390      MOVE RETURN-SQLCODE IN WS-HISTORY-COMMAREA TO WS-SQLCODE    09656099
094400      MOVE RETURN-SQLCODE IN WS-HISTORY-COMMAREA TO               09657099
094410           SQL-STATUS-CODE                                        09658099
094420      MOVE WS-SQLCODE TO WS-SQLCODE-DS                            09659099
094430      IF NOT SQL-SUCCESS                                          09660099
094440         ADD 1 TO WS-TOTL-BAD-CALLS-TO-ETNDC15                    09661099
094450         SET WS-ERROR-FIELDS-FOUND TO TRUE                        09662099
094460         PERFORM 6030-INIT-DETAIL-LINE THRU 6030-EXIT             09663099
094470         PERFORM 6400-WRITE-RECON-RPT THRU 6400-EXIT              09664099
094480         MOVE 'ETNI' TO WS-SYSTEM                                 09665099
094490*--------pass up message from ETNDC15-----------------------------09666099
094500*        MOVE SQL-DESC OF SQL-ERR-DESC TO WS-COMMENT              09667099
094510*--------or issue local message from ETNBC16----------------------09668099
094520         MOVE LIT-CTN-HIST-ETNDC15-ERROR TO WS-COMMENT            09669099
094530         MOVE WS-SQLCODE-DS to WS-ADDTL-INFO                      09670099
094540         PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT             09671099
094550         PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT              09672099
094560      END-IF.                                                     09673099
094570 2103-EXIT.                                                       09674099
094580      EXIT.                                                       09675099
094590                                                                  09676099
094600                                                                  09677099
094610 2104-CHK-IF-COMINGLED.                                           09678099
094620******************************************************************09679099
094630*                                                                 09680099
094640*   PARAGRAPH NAME:  2104-CHK-IF-COMINGLED                        09681099
094650*                                                                 09682099
094660*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   09683099
094670*             EDITING                                             09684099
094680*                                                                 09685099
094690******************************************************************09686099
094700     MOVE '2104-CHK-IF-COMINGLED        '   TO WS-CURR-PARA       09687099
094710                                                                  09688099
094720     PERFORM  7A00-SEL-TNI-NPANXX-MDN THRU 7A00-EXIT              09689099
094730     .                                                            09690099
094740                                                                  09691099
094750 2104-EXIT.                                                       09692099
094760     EXIT.                                                        09693099
094770                                                                  09694099
094780 2105-REPORT-UPDATE-STATUS.                                       09695099
094790******************************************************************09696099
094800*                                                                 09697099
094810*   PARAGRAPH NAME:  2105-REPORT-UPDATE-STATUS                    09698099
094820*                                                                 09699099
094830*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   09700099
094840*             EDITING                                             09701099
094850*                                                                 09702099
094860******************************************************************09703099
094870     MOVE '2105-REPORT-UPDATE-STATUS    '   TO WS-CURR-PARA       09704099
094880                                                                  09705099
094890     PERFORM 6020-MOVE-ETNI-TO-RPT-NEW     THRU 6020-EXIT         09706099
094900                                                                  09707099
094910     IF WS-ERROR-FIELDS-FOUND                                     09708099
094920        MOVE LIT-UPDATE-ERROR              TO   WS-COMMENT        09709099
094930     ELSE                                                         09710099
094940        MOVE 'ETNI'                        TO   WS-SYSTEM         09711099
094950        MOVE LIT-UPDATED-COMMENT           TO   WS-COMMENT        09712099
094960        MOVE SPACES                        TO   WS-ADDTL-INFO     09713099
094970     END-IF                                                       09714099
094980                                                                  09715099
094990*----if no errors occured and ONLY the PrePaid-Ind was updated----09716099
095000*----display a MSG to that effect & show Old and New PP Inds------09717099
095010                                                                  09718099
095020*  JA1207A  -  Next  Cond.                                        09719099
095030                                                                  09720099
095040     IF  NOT  WS-ERROR-FIELDS-FOUND  AND                          09721099
095050         ONLY-PREPAID-IND-CHANGED     =  'Y'  AND                 09722099
095060         CTN-STATUS   OF DCLCTN-INV   =  'AG'                     09723099
095070         GO  TO  2105-EXIT                                        09724099
095080     END-IF                                                       09725099
095090                                                                  09726099
095100                                                                  09727099
095110     IF NOT WS-ERROR-FIELDS-FOUND AND                             09728099
095120        ONLY-PREPAID-IND-CHANGED = 'Y'                            09729099
095130             MOVE 'ETNI'                   TO   WS-SYSTEM         09730099
095140             MOVE LIT-PREPAID-IND-UPDATED  TO   WS-COMMENT        09731099
095150             MOVE RPT-CTNIN-PREPAID-IND    TO LIT-ETNI-FROM-PP-IND09732099
095160             MOVE RPT-MDNIN-PREPAID-IND    TO LIT-ETNI-TO-PP-IND  09733099
095170             MOVE LIT-ETNI-TO-FROM-PP-IND  TO   WS-ADDTL-INFO     09734099
095180     END-IF                                                       09735099
095190                                                                  09736099
095200     PERFORM 6020-MOVE-ETNI-TO-RPT-NEW     THRU 6020-EXIT         09737099
095210     PERFORM 6400-WRITE-RECON-RPT          THRU 6400-EXIT         09738099
095220     PERFORM 6300-PRINT-BLANK-LINE         THRU 6300-EXIT         09739099
095230     .                                                            09740099
095240 2105-EXIT.                                                       09741099
095250     EXIT.                                                        09742099
095260                                                                  09743099
095270 2110-VALIDATE-BILL-MDN-FIELDS.                                   09744099
095280******************************************************************09745099
095290*                                                                 09746099
095300*   PARAGRAPH NAME:  2110-VALIDATE-BILL-MDN-FIELDS                09747099
095310*                                                                 09748099
095320*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   09749099
095330*             EDITING                                             09750099
095340*                                                                 09751099
095350******************************************************************09752099
095360     MOVE '2110-VALIDATE-BILL-MDN-FIELDS'   TO WS-CURR-PARA       09753099
095370                                                                  09754099
095380     MOVE  SPACES TO WS-ERROR-FIELDS-SW                           09755099
095390                     WS-COMMENT                                   09756099
095400                     WS-ADDTL-INFO                                09757099
095410                     HOLD-WS-COMMENT                              09758099
095420                     HOLD-WS-ADDTL-INFO                           09759099
095430                                                                  09760099
095440     MOVE  'BILL' TO WS-SYSTEM                                    09761099
095450                                                                  09762099
095460* BILLER ID VALIDATION                                            09763099
095470* (its OK to have mismatched Biller if in FORCED Match mode)      09764099
095480     IF WS-BILLER-ID NOT = WS-SAVE-HDR-BILLER-ID AND              09765099
095490        FORCED-MDN-MATCH-FLAG NOT = 'Y'                           09766099
095500        ADD     +1 TO WS-TOTL-ERROR-BILLER-NOTMTCH                09767099
095510        MOVE   'ETNI'                       TO   WS-SYSTEM        09768099
095520        SET     WS-ERROR-FIELDS-FOUND       TO   TRUE             09769099
095530        MOVE    LIT-BILLER-ERROR            TO   WS-COMMENT       09770099
095540        MOVE    WS-BILLER-ID                TO   WS-ADDTL-INFO    09771099
095550        GO TO 2110-EXIT                                           09772099
095560     END-IF                                                       09773099
095570                                                                  09774099
095580* MDN NPA/NXX VALIDATION                                          09775099
095590     MOVE    MDNIN-MDN         TO   WS-PHONE-NUM                  09776099
095600     MOVE    WS-NPA-NUM        TO   WS-NPA-CMP                    09777099
095610     MOVE    WS-NXX-NUM        TO   WS-NXX-CMP                    09778099
095620                                                                  09779099
095630* LAST TRANSACTION DATE VALIDATION                                09780099
095640     MOVE    MDNIN-LAST-TRX-DATE   TO WS-INP-DATE                 09781099
095650     PERFORM 2120-VALIDATE-DATE  THRU 2120-EXIT                   09782099
095660     IF WS-DATE-INVALID                                           09783099
095670        ADD     +1 TO WS-TOTL-ERROR-DATE-INVALID                  09784099
095680        SET     WS-ERROR-FIELDS-FOUND       TO   TRUE             09785099
095690        MOVE    LIT-TRANS-DATE-ERROR        TO   WS-COMMENT       09786099
095700        MOVE    WS-INP-DATE                 TO   WS-ADDTL-INFO    09787099
095710        GO TO 2110-EXIT                                           09788099
095720     END-IF                                                       09789099
095730                                                                  09790099
095740* STATUS VALIDATION                                               09791099
095750     MOVE WS-NEW-STATUS TO WS-VALID-MDN-STATUS                    09792099
095760     IF NOT VALID-MDN-STATUS                                      09793099
095770        ADD   +1 TO WS-TOTL-ERROR-STATUS-INVALID                  09794099
095780        SET   WS-ERROR-FIELDS-FOUND         TO   TRUE             09795099
095790        MOVE  LIT-STATUS-ERROR              TO   WS-COMMENT       09796099
095800        MOVE  WS-NEW-STATUS                 TO   WS-ADDTL-INFO    09797099
095810        GO TO 2110-EXIT                                           09798099
095820     END-IF                                                       09799099
095830                                                                  09800099
095840* LAST TRANSACTION CODE VALIDATION                                09801099
095850     IF   WS-TRANS-CODE = SPACES  OR                              09802099
095860          WS-TRANS-CODE = 'CNV'                                   09803099
095870          PERFORM 2130-DET-TRAN-CODE        THRU 2130-EXIT        09804099
095880     ELSE                                                         09805099
095890          CONTINUE                                                09806099
095900     END-IF                                                       09807099
095910     MOVE ZEROES                            TO   WS-EXIST-FLAG    09808099
095920     PERFORM 7900-SELECT-TRX-CODES          THRU 7900-EXIT        09809099
095930     IF SQL-ROW-NOT-FOUND                                         09810099
095940        ADD   +1 TO WS-TOTL-ERROR-TRX-CODE-NOTFND                 09811099
095950        SET   WS-ERROR-FIELDS-FOUND         TO   TRUE             09812099
095960        MOVE  LIT-TRANS-CODE-ERROR          TO   WS-COMMENT       09813099
095970        MOVE  WS-TRANS-CODE                 TO   WS-ADDTL-INFO    09814099
095980        GO TO 2110-EXIT                                           09815099
095990     END-IF                                                       09816099
096000     IF (WS-OLD-STATUS = WS-NEW-STATUS) OR                        09817099
096010        (WS-REC-BILL-NOT-IN-ETNI)                                 09818099
096020        CONTINUE                                                  09819099
096030     ELSE                                                         09820099
096040        MOVE ZEROES                         TO   WS-EXIST-FLAG    09821099
096050        PERFORM 7910-SELECT-TRX-VALID-STS   THRU 7910-EXIT        09822099
096060        IF SQL-ROW-NOT-FOUND                                      09823099
096070           MOVE  'CNV'                   TO   WS-TRANS-CODE       09824099
096080        END-IF                                                    09825099
096090     END-IF                                                       09826099
096100                                                                  09827099
096110* NUMBER LOCATION VALIDATION  -                                   09828099
096100                                                                  09829099
096120*----if the Biller Status that's going to update eTNI status is---09830099
096130*----either NA or NH,      skip the Number Location select--------09831099
096140     IF WS-NEW-STATUS        = 'NA' OR 'NH'  OR                   09832099
096141        WS-CTNIN-CTN-STATUS  = 'NA' OR 'NH'                       09833099
096142        CONTINUE                                                  09834099
096143     ELSE                                                         09835099
096144        MOVE    MDNIN-NL                       TO   WS-NL         09836099
096145*  JA0312A  -  Prioritize  CTN  NL  over  MDNIN-NL                09837099
096146        IF  MDN-MATCH-FLAG  =  'Y'  OR                            09838099
096147            MDN-NOT-IN-BILL-FLAG  =  'Y'                          09839099
096148            MOVE  WS-CTNIN-NL  TO  WS-NL                          09840099
096149        END-IF                                                    09841099
      * JA1012  -  Minimize  NL  Access,  If  Same                      09842099
096144        IF  WS-NL  NOT  =  WS-NL-SAVED                            09843099
096150            PERFORM 7400-SELECT-NUMBER-LOCATION    THRU 7400-EXIT 09844099
096160          IF SQL-ROW-NOT-FOUND                                    09845099
096144             MOVE    SPACES                      TO   WS-NL-SAVED 09846099
096170             ADD     +1 TO WS-TOTL-ERROR-NUMLOC-NOTFND            09847099
096180             SET     WS-ERROR-FIELDS-FOUND       TO   TRUE        09848099
096190             MOVE    LIT-NL-ERROR                TO   WS-COMMENT  09849099
096200             MOVE    WS-NL                     TO   WS-ADDTL-INFO 09850099
096210             GO  TO  2110-EXIT                                    09851099
096220          END-IF                                                  09852099
096230        END-IF                                                    09853099
096230     END-IF                                                       09854099
096240                                                                  09855099
096250* JA1012  -                                                       09856099
096144     MOVE  WS-NL  TO   WS-NL-SAVED                                09857099
096240                                                                  09858099
096250* NUMBER GROUP VALIDATION                                         09859099
096260     MOVE    MDNIN-NGP                      TO   WS-NGP           09860099
096270     PERFORM 7300-SELECT-NUMBER-GROUP       THRU 7300-EXIT        09861099
096280     IF SQL-ROW-NOT-FOUND                                         09862099
096290        ADD     +1 TO WS-TOTL-ERROR-NUMGRP-NOTFND                 09863099
096300        SET     WS-ERROR-FIELDS-FOUND       TO   TRUE             09864099
096310        MOVE    LIT-NGP-ERROR            TO   WS-COMMENT          09865099
096320        MOVE    WS-NGP                   TO   LIT-NGP-ERROR(23:3) 09866099
096330        GO TO 2110-EXIT                                           09867099
096340     END-IF                                                       09868099
096350                                                                  09869099
096360                                                                  09870099
096370* NUMBER GROUP COUNTERS VALIDATION                                09871099
096380     IF (WS-OLD-STATUS = 'NA' OR 'NH') OR                         09872099
096390        (WS-NEW-STATUS = 'NA' OR 'NH')                            09873099
096400        IF WS-OLD-STATUS = 'NA' OR 'NH'                           09874099
096410           MOVE    WS-OLD-NGP               TO   WS-NGP           09875099
096420           MOVE    WS-OLD-PRODUCT-TYPE      TO   WS-PRODUCT-TYPE  09876099
096430           PERFORM 7700-SELECT-NGP-COUNTERS THRU 7700-EXIT        09877099
096440           IF SQL-ROW-NOT-FOUND                                   09878099
096450              ADD  +1                       TO                    09879099
096460                   WS-TOTL-ERROR-NGPCNT-NOTFND                    09880099
096470              SET  WS-ERROR-FIELDS-FOUND    TO   TRUE             09881099
096480              MOVE LIT-STATUS-NGP-COUNTER-ERROR                   09882099
096490                                            TO   WS-COMMENT       09883099
096500              MOVE WS-NGP              TO   WS-ADDTL-INFO (1:3)   09884099
096510              MOVE WS-PRODUCT-TYPE     TO   WS-ADDTL-INFO (5:1)   09885099
096520              MOVE WS-OLD-STATUS       TO   WS-ADDTL-INFO (7:2)   09886099
096530              MOVE WS-NEW-STATUS       TO   WS-ADDTL-INFO (10:2)  09887099
096540              GO TO 2110-EXIT                                     09888099
096550           END-IF                                                 09889099
096560        END-IF                                                    09890099
096570                                                                  09891099
096580        IF WS-NEW-STATUS = 'NA' OR 'NH'                           09892099
096590           MOVE    WS-NEW-NGP               TO   WS-NGP           09893099
096600           MOVE    WS-NEW-PRODUCT-TYPE      TO   WS-PRODUCT-TYPE  09894099
096610           PERFORM 7700-SELECT-NGP-COUNTERS THRU 7700-EXIT        09895099
096620           IF SQL-ROW-NOT-FOUND                                   09896099
096630              ADD  +1                       TO                    09897099
096640                   WS-TOTL-ERROR-NGPCNT-NOTFND                    09898099
096650              SET  WS-ERROR-FIELDS-FOUND    TO   TRUE             09899099
096660              MOVE LIT-STATUS-NGP-COUNTER-ERROR                   09900099
096670                                            TO   WS-COMMENT       09901099
096680              MOVE WS-NGP              TO   WS-ADDTL-INFO (1:3)   09902099
096690              MOVE WS-PRODUCT-TYPE     TO   WS-ADDTL-INFO (5:1)   09903099
096700              MOVE WS-OLD-STATUS       TO   WS-ADDTL-INFO (7:2)   09904099
096710              MOVE WS-NEW-STATUS       TO   WS-ADDTL-INFO (10:2)  09905099
096720              GO TO 2110-EXIT                                     09906099
096730           END-IF                                                 09907099
096740        END-IF                                                    09908099
096750                                                                  09909099
096760     END-IF                                                       09910099
096770                                                                  09911099
096780* VALIDATE HOLD-REASON                                            09912099
096790*** #140804 LMS 05/21/2003 BEGIN                                  09913099
096800     MOVE MDNIN-HOLD-REASON TO VV-HOLD-REASON                     09914099
096810*** #140804 LMS 05/21/2003 END                                    09915099
096820     IF WS-NEW-STATUS = 'NH' AND NOT VALID-HOLD-REASON            09916099
096830        ADD   +1 TO WS-TOTL-ERROR-HOLD-REASON                     09917099
096840        SET   WS-ERROR-FIELDS-FOUND         TO   TRUE             09918099
096850        MOVE  LIT-HOLD-REASON-ERROR         TO   WS-COMMENT       09919099
096860        MOVE  WS-NEW-STATUS            TO   WS-ADDTL-INFO (1:2)   09920099
096870        MOVE  MDNIN-HOLD-REASON        TO   WS-ADDTL-INFO (4: )   09921099
096880        GO TO 2110-EXIT                                           09922099
096890     END-IF                                                       09923099
096900                                                                  09924099
096910* VALIDATE MIN-NUM                                                09925099
096920                                                                  09926099
096930*----if Biller and eTNI CTN match is in effect and the input------09927099
096940*----file is from I2K (no MIN num updates allowed), bypass tests--09928099
096950     IF MDN-MATCH-FLAG = 'Y' AND                                  09929099
096960        SAVE-IS-THIS-I2K-INPUT = 'Y'                              09930099
096970        GO TO 2110-VALIDATE-PORT-IND                              09931099
096980     END-IF                                                       09932099
096990                                                                  09933099
      *  JA1211  -  Bypass for VTS Processing                           09934099
097010                                                                  09935099
097020     IF  VTS-MDN                                                  09936099
097030         MOVE  'RE'  TO  MDNIN-PORT-IND                           09937099
097040         MOVE  WS-OLD-PORT-IND  TO  WS-NEW-PORT-IND               09938099
097050         GO TO 2110-VALIDATE-PORT-IND                             09939099
097060     END-IF                                                       09940099
097070                                                                  09941099
      *  JA0412  -  Bypass for 5XX Processing                           09942099
097010                                                                  09943099
097020     IF  5XX-MDN                                                  09944099
097050         GO TO 2110-VALIDATE-PORT-IND                             09945099
097060     END-IF                                                       09946099
097070                                                                  09947099
      *  JA0612  -  Vision B_to_B                                       09948099
097010                                                                  09949099
097020**   IF  WS-VISION-B2B                                            09950099
097030**       MOVE  'RE'  TO  MDNIN-PORT-IND                           09951099
097040**       MOVE  WS-OLD-PORT-IND  TO  WS-NEW-PORT-IND               09952099
097050**       GO TO 2110-VALIDATE-PORT-IND                             09953099
097060**   END-IF                                                       09954099
097070                                                                  09955099
097080*----if the Biller Status that's going to update eTNI status is---09956099
097090*----either NA or NH,      move Low-Values/nulls to MIN-NUM of----09957099
097100*----CTN-INV (unpairs MIN on CTN-INV)-----------------------------09958099
097110     IF WS-NEW-STATUS = 'NA' OR 'NH'                              09959099
097120        MOVE -1         TO MIN-NUM-NI                             09960099
097130        MOVE LOW-VALUES TO MIN-NUM-TEXT OF DCLCTN-INV             09961099
097140     ELSE                                                         09962099
097150*-------otherwise, see if the new MIN-NUM from Biller already-----09963099
097160*-------exists in MIN-INV table.----------------------------------09964099
097170        MOVE ZEROES                  TO WS-EXIST-FLAG             09965099
097180        MOVE WS-NEW-MIN-NUM          TO WS-TEMP-MIN-NUM-TEXT      09966099
097190        UNSTRING WS-TEMP-MIN-NUM-TEXT                             09967099
097200                 DELIMITED BY SPACE                               09968099
097210                 INTO         MIN-NUM-TEXT OF DCLMIN-INV          09969099
097220                 DELIMITER IN WS-DELIMITER                        09970099
097230                 COUNT     IN MIN-NUM-LEN  OF DCLMIN-INV          09971099
097240        END-UNSTRING                                              09972099
097250        PERFORM 7800-SELECT-MIN-INV THRU 7800-EXIT                09973099
097260                                                                  09974099
097270*-------if the new MIN-NUM from Biller is not found in MIN-INV----09975099
097280*-------table, it's an error. (Biller specifying an unknown MIN)--09976099
097290                                                                  09977099
097300        IF SQL-ROW-NOT-FOUND                                      09978099
097310           ADD   +1 TO WS-TOTL-ERROR-MIN-NUM-NOTFND               09979099
097320           SET   WS-ERROR-FIELDS-FOUND  TO   TRUE                 09980099
097330           MOVE  LIT-MIN-NUM-NOTFND     TO   WS-COMMENT           09981099
097340           MOVE  WS-TEMP-MIN-NUM-TEXT   TO   WS-ADDTL-INFO (1:10) 09982099
097350*  JA1011                                                         09983099
097360           IF  MDN-NOT-IN-ETNI-FLAG  =  'Y'  AND                  09984099
097370               MDNIN-MDN-STATUS      =  'AR'                      09985099
097380               MOVE  'Not in eTNI       '   TO   WS-COMMENT       09986099
097390               MOVE  SPACES     TO   WS-ADDTL-INFO (1:10)         09987099
097400           END-IF                                                 09988099
097410           GO TO 2110-EXIT                                        09989099
097420        END-IF                                                    09990099
097430                                                                  09991099
097440*-------if the new MIN-NUM from Biller exists in MIN-INV table,---09992099
097450*-------and its the SAME as existing CTN-INV MIN-NUM,      just---09993099
097460*-------go to validation of PORT-IND. ----------------------------09994099
097470                                                                  09995099
097480**                                                                09996099
097490** JA0320  - Modified to check:  WS-CTN-INV-MIN-COUNT  - below    09997099
097500**                                                                09998099
097510* AGB 3/21/06                                                     09999099
097520        IF WS-OLD-MIN-NUM = WS-NEW-MIN-NUM                        10000099
097530           CONTINUE                                               10001099
097540                                                                  10002099
097550*-------if, however, the new MIN-NUM is different from the--------10003099
097560*-------existing CTN-INV MIN-NUM, check the CTN-INV table to see--10004099
097570*-------if this MIN-NUM already exists. If it does, its an error--10005099
097580        ELSE                                                      10006099
097590           PERFORM 7805-SELECT-MIN-IN-CTN THRU 7805-EXIT          10007099
097600           IF WS-CTN-INV-MIN-COUNT > +0                           10008099
097610              ADD   +1 TO WS-TOTL-ERROR-MIN-NUM-IN-CTN            10009099
097620              SET   WS-ERROR-FIELDS-FOUND TO TRUE                 10010099
097630              MOVE  LIT-MIN-NUM-IN-CTN    TO WS-COMMENT           10011099
097640              MOVE  WS-TEMP-MIN-NUM-TEXT  TO WS-ADDTL-INFO (1:10) 10012099
097650              GO TO 2110-EXIT                                     10013099
097660           END-IF                                                 10014099
097670     END-IF.                                                      10015099
097680                                                                  10016099
097690*----2/10/04: BACK TO NOT LETTING BILLER CHANGE ETNI PORT-IND.----10017099
097700*-------------IF PORT-INDS DON'T MATCH, WRITE ERROR RPT LINE------10018099
097710*-------------HOWEVER, DON'T SET REGULAR ERROR FLAG EITHER!-------10019099
097720*-------------IF ANY OTHER FIELDS DIDN'T MATCH, WE DO WANT TO-----10020099
097730*-------------UPDATE ETNI WITH BILLER'S DATA----------------------10021099
097740                                                                  10022099
097750** PREVENT PORT IND CHANGE                                        10023099
097760*----additional test: if this CTN was found in the LSMS table-----10024099
097770*----with a VZW spid,      allow the port-ind change!------------ 10025099
097780*----If found with a non-VZW spid, disallow the port-ind change.--10026099
097790*----Add to allow/disallow counters below-------------------------10027099
097800                                                                  10028099
097810 2110-VALIDATE-PORT-IND.                                          10029099
097820     INITIALIZE PORT-INDS-DONT-MATCH                              10030099
097830                                                                  10031099
097840     IF WS-NEW-PORT-IND NOT = WS-OLD-PORT-IND AND                 10032099
097850        ALLOW-PORT-IND-CHG = 'Y'                                  10033099
097860        ADD 1 TO WS-TOTL-ERROR-PORT-IND-CHANGED                   10034099
097870        END-IF                                                    10035099
097880                                                                  10036099
097890     IF WS-NEW-PORT-IND NOT = WS-OLD-PORT-IND AND                 10037099
097900        ALLOW-PORT-IND-CHG = 'Y'                                  10038099
097910        ADD 1 TO WS-TOTL-ERROR-PORT-IND-NOT-CHG                   10039099
097920     END-IF                                                       10040099
097930                                                                  10041099
097940*----in this case, allow the update of eTNI's Port-Ind------------10042099
097950     IF WS-NEW-PORT-IND = 'PI' AND WS-OLD-PORT-IND = 'RE' AND     10043099
097960        WS-NEW-STATUS = 'AI' AND WS-OLD-STATUS = 'NH' AND         10044099
097970       (MDNIN-HOLD-REASON(1:6) = SPACE OR                         10045099
097980        MDNIN-HOLD-REASON(1:6) = LOW-VALUES)  AND                 10046099
097990        WS-CTNIN-HOLD-REASON(1:6) = 'DONATE'                      10047099
098000        MOVE 'Y' TO PORT-INDS-DONT-MATCH                          10048099
098010*       it may not have a VZW Spid, but pgm needs this set to 'Y' 10049099
098020*       to update Port-Ind later on.                              10050099
098030        MOVE 'Y' TO ALLOW-PORT-IND-CHG                            10051099
098040        MOVE LIT-PORT-IND-CHANGE-ALLOW TO HOLD-WS-COMMENT         10052099
098050        MOVE WS-OLD-PORT-IND TO OLD-PORT-IND-CHANGED              10053099
098060        MOVE WS-NEW-PORT-IND TO NEW-PORT-IND-CHANGED              10054099
098070        MOVE LIT-OLD-PORT-CHANGED TO HOLD-WS-ADDTL-INFO           10055099
098080        GO TO 2110-EXIT                                           10056099
098090     END-IF                                                       10057099
098100                                                                  10058099
098110*----in this case, we also allow a Port-Ind update----------------10059099
098120     IF WS-NEW-PORT-IND NOT = WS-OLD-PORT-IND AND                 10060099
098130        ALLOW-PORT-IND-CHG = 'Y'                                  10061099
098140        MOVE 'Y' TO PORT-INDS-DONT-MATCH                          10062099
098150        MOVE LIT-PORT-IND-CHANGE-ALLOW TO HOLD-WS-COMMENT         10063099
098160        MOVE WS-OLD-PORT-IND TO OLD-PORT-IND-CHANGED              10064099
098170        MOVE WS-NEW-PORT-IND TO NEW-PORT-IND-CHANGED              10065099
098180        MOVE LIT-OLD-PORT-CHANGED TO HOLD-WS-ADDTL-INFO           10066099
098190        GO TO 2110-EXIT                                           10067099
098200     END-IF                                                       10068099
098210                                                                  10069099
098220*----if this routine is being exected from 2200-MDN-NOT-IN-ETNI---10070099
098230*----(MDN in Biller, but not in eTNI), do not print Port-Ind------10071099
098240*----changed message because there was no Port-Ind change!)-------10072099
098250                                                                  10073099
098260     IF MDN-NOT-IN-ETNI-FLAG = 'Y'                                10074099
098270        GO TO 2110-EXIT                                           10075099
098280     END-IF                                                       10076099
098290                                                                  10077099
098300*  JA1211  -  below                                               10078099
098310     IF VTS-MDN                                                   10079099
098320        GO TO 2110-EXIT                                           10080099
098330     END-IF                                                       10081099
098340                                                                  10082099
098350*----in this case, we DO NOT allow a Port-Ind update--------------10083099
098360*----(report it as such to error file)----------------------------10084099
098370*                                                                 10085099
098380*----11/17/04: to prevent being flooded by these messages, do not-10086099
098390*----issue them if the Port-Ind was the ONLY change between Biller10087099
098400*----and eTNI and it was a DISALLOWED change at that!-------------10088099
098410                                                                  10089099
098420     IF WS-NEW-PORT-IND NOT = WS-OLD-PORT-IND AND                 10090099
098430        PORT-IND-IS-THE-ONLY-CHANGE NOT = 'Y' AND                 10091099
098440        ALLOW-PORT-IND-CHG NOT = 'Y' AND                          10092099
098450        WS-OLD-PORT-IND NOT = SPACE AND                           10093099
098460        WS-OLD-PORT-IND NOT = LOW-VALUES                          10094099
098470*-------dont report error if LAST-TRX-DATE within X number of days10095099
098480           PERFORM 2101-HOW-CURR-IS-LAST-TRX-DATE THRU 2101-EXIT  10096099
098490           IF TRX-DATE-TOO-RECENT = 'Y'                           10097099
098500               GO TO 2110-EXIT                                    10098099
098510           END-IF                                                 10099099
098520                                                                  10100099
098530           MOVE 'Y' TO PORT-INDS-DONT-MATCH                       10101099
098540           MOVE LIT-PORT-IND-CHANGE-ERROR TO WS-COMMENT           10102099
098550           MOVE WS-OLD-PORT-IND TO OLD-PORT-IND-KEPT-PORT         10103099
098560           MOVE LIT-OLD-PORT-KEPT TO WS-ADDTL-INFO                10104099
098570           MOVE 'ETNI' TO WS-SYSTEM                               10105099
098580           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      10106099
098590           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      10107099
098600           GO TO 2110-EXIT                                        10108099
098610     END-IF                                                       10109099
098620     .                                                            10110099
098630 2110-EXIT.                                                       10111099
098640*  JA1211  -                                                      10112099
098650      IF  MDN-NOT-IN-ETNI-FLAG = 'Y'                              10113099
098660          MOVE ' Not in eTNI '  TO   WS-COMMENT                   10114099
098670      END-IF                                                      10115099
098680     .                                                            10116099
098690 2110-EXIT-10.                                                    10117099
098700      EXIT.                                                       10118099
098710                                                                  10119099
098720 2120-VALIDATE-DATE.                                              10120099
098730******************************************************************10121099
098740*                                                                 10122099
098750*   PARAGRAPH NAME:  2120-VALIDATE-DATE                           10123099
098760*                                                                 10124099
098770*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   10125099
098780*             DATE                                                10126099
098790*                                                                 10127099
098800******************************************************************10128099
098810     MOVE '2120-VALIDATE-DATE' TO WS-CURR-PARA                    10129099
098820                                                                  10130099
098830     SET WS-DATE-VALID TO TRUE                                    10131099
098840                                                                  10132099
098850     IF MDNIN-LAST-TRX-DATE NOT NUMERIC   OR                      10133099
098860        MDNIN-LAST-TRX-DATE = ZERO        OR                      10134099
098870        MDNIN-LAST-TRX-DATE = SPACES      OR                      10135099
098880        MDNIN-LAST-TRX-DATE = LOW-VALUES  OR                      10136099
098890        MDNIN-LAST-TRX-DATE = HIGH-VALUES OR                      10137099
098900        MDNIN-LAST-TRX-DATE (05:2) > 12   OR                      10138099
098910        MDNIN-LAST-TRX-DATE (07:2) > 31   OR                      10139099
098920        MDNIN-LAST-TRX-DATE (09:2) > 24   OR                      10140099
098930        MDNIN-LAST-TRX-DATE (11:2) > 60   OR                      10141099
098940        MDNIN-LAST-TRX-DATE (13:2) > 60                           10142099
098950        SET WS-DATE-INVALID TO TRUE                               10143099
098960     END-IF                                                       10144099
098970                                                                  10145099
098980     IF WS-DATE-VALID                                             10146099
098990        MOVE   SPACES TO WS-LEAP-YEAR-SW                          10147099
099000        MOVE   MDNIN-LAST-TRX-DATE (1:4) TO WS-TEMP-CCYY          10148099
099010        DIVIDE WS-TEMP-CCYY BY 4                                  10149099
099020               GIVING    WS-LEAP-YEAR                             10150099
099030               REMAINDER WS-REMAINDER                             10151099
099040        IF WS-REMAINDER   = 0                                     10152099
099050           SET LEAP-YEAR     TO TRUE                              10153099
099060        ELSE                                                      10154099
099070           SET NOT-LEAP-YEAR TO TRUE                              10155099
099080     END-IF                                                       10156099
099090                                                                  10157099
099100        EVALUATE TRUE                                             10158099
099110            WHEN MDNIN-LAST-TRX-DATE (5:2) =                      10159099
099120                 1 OR 3 OR 5 OR 7 OR 8 OR 10 OR 12                10160099
099130                 IF MDNIN-LAST-TRX-DATE (7:2) > 31                10161099
099140                    SET WS-DATE-INVALID TO TRUE                   10162099
099150                 END-IF                                           10163099
099160            WHEN MDNIN-LAST-TRX-DATE (5:2) =                      10164099
099170                 4 OR 6 OR 9 OR 11                                10165099
099180                 IF MDNIN-LAST-TRX-DATE (7:2) > 30                10166099
099190                    SET WS-DATE-INVALID TO TRUE                   10167099
099200                 END-IF                                           10168099
099210            WHEN MDNIN-LAST-TRX-DATE (5:2) = 2                    10169099
099220                 IF (LEAP-YEAR     AND                            10170099
099230                     MDNIN-LAST-TRX-DATE (7:2) > 29) OR           10171099
099240                    (NOT-LEAP-YEAR AND                            10172099
099250                     MDNIN-LAST-TRX-DATE (7:2) > 28)              10173099
099260                    SET WS-DATE-INVALID TO TRUE                   10174099
099270                 END-IF                                           10175099
099280        END-EVALUATE                                              10176099
099290     END-IF                                                       10177099
099300                                                                  10178099
099310     .                                                            10179099
099320 2120-EXIT.                                                       10180099
099330     EXIT.                                                        10181099
099340                                                                  10182099
099350 2130-DET-TRAN-CODE.                                              10183099
099360******************************************************************10184099
099370*                                                                 10185099
099380*   PARAGRAPH NAME:  2130-DET-TRAN-CODE                           10186099
099390*                                                                 10187099
099400*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   10188099
099410*             TRANSACTION CODE                                    10189099
099420*                                                                 10190099
099430******************************************************************10191099
099440     MOVE '2130-DET-TRAN-CODE' TO WS-CURR-PARA                    10192099
099450                                                                  10193099
099460* STATUS CHANGE                                                   10194099
099470     EVALUATE TRUE                                                10195099
099480         WHEN WS-OLD-STATUS = 'NA' AND WS-NEW-STATUS = 'NH'       10196099
099490              MOVE 'HLD'           TO  WS-TRANS-CODE              10197099
099500         WHEN WS-OLD-STATUS = 'NH' AND WS-NEW-STATUS = 'NA'       10198099
099510              MOVE 'RHN'           TO  WS-TRANS-CODE              10199099
099520         WHEN WS-OLD-STATUS = 'NH' AND WS-NEW-STATUS = 'AA'       10200099
099530              MOVE 'RHA'           TO  WS-TRANS-CODE              10201099
099540         WHEN WS-OLD-STATUS = 'AA' AND WS-NEW-STATUS = 'AR'       10202099
099550         WHEN WS-OLD-STATUS = 'PO' AND WS-NEW-STATUS = 'AR'       10203099
099560              MOVE 'RSV'           TO  WS-TRANS-CODE              10204099
099570**  JA0507  -  BELOW  4  LINES                                    10205099
099580         WHEN WS-OLD-STATUS = 'AA' AND WS-NEW-STATUS = 'PA'       10206099
099590              MOVE 'GMN'           TO  WS-TRANS-CODE              10207099
099600         WHEN WS-OLD-STATUS = 'PA' AND WS-NEW-STATUS = 'AA'       10208099
099610              MOVE 'RMN'           TO  WS-TRANS-CODE              10209099
099620         WHEN WS-OLD-STATUS = 'AR' AND WS-NEW-STATUS = 'AA'       10210099
099630              MOVE 'RRS'           TO  WS-TRANS-CODE              10211099
099640         WHEN WS-OLD-STATUS = 'AA' AND WS-NEW-STATUS = 'AI'       10212099
099650         WHEN WS-OLD-STATUS = 'AR' AND WS-NEW-STATUS = 'AI'       10213099
099660         WHEN WS-OLD-STATUS = 'PO' AND WS-NEW-STATUS = 'AI'       10214099
099670         WHEN WS-OLD-STATUS = 'PA' AND WS-NEW-STATUS = 'AI'       10215099
099680**  JA0507  -  ABOVE  1  LINE                                     10216099
099690              MOVE 'ACT'           TO  WS-TRANS-CODE              10217099
099700         WHEN WS-OLD-STATUS = 'AI' AND WS-NEW-STATUS = 'AG'       10218099
099710              MOVE 'DAC'           TO  WS-TRANS-CODE              10219099
099720         WHEN WS-OLD-STATUS = 'AA' AND WS-NEW-STATUS = 'NA'       10220099
099730              MOVE 'DAS'           TO  WS-TRANS-CODE              10221099
099740         WHEN WS-OLD-STATUS = 'AG' AND WS-NEW-STATUS = 'AI'       10222099
099750              MOVE 'RSM'           TO  WS-TRANS-CODE              10223099
099760         WHEN WS-OLD-STATUS = 'AG' AND WS-NEW-STATUS = 'AA'       10224099
099770              MOVE 'OGI'           TO  WS-TRANS-CODE              10225099
099780         WHEN WS-OLD-STATUS = 'AG' AND WS-NEW-STATUS = 'NA'       10226099
099790              MOVE 'OGO'           TO  WS-TRANS-CODE              10227099
099800         WHEN WS-OLD-STATUS = 'NA' AND WS-NEW-STATUS = 'AA'       10228099
099810              MOVE 'MAS'           TO  WS-TRANS-CODE              10229099
099820         WHEN WS-OLD-STATUS = 'AG' AND WS-NEW-STATUS = 'PO'       10230099
099830              MOVE 'PTO'           TO  WS-TRANS-CODE              10231099
099840         WHEN OTHER                                               10232099
099850              MOVE SPACES          TO  WS-TRANS-CODE              10233099
099860     END-EVALUATE                                                 10234099
099870                                                                  10235099
099880     IF WS-TRANS-CODE > SPACES                                    10236099
099890        GO TO 2130-EXIT                                           10237099
099900     END-IF                                                       10238099
099910                                                                  10239099
099920* NA/NH CHECK                                                     10240099
099930     EVALUATE TRUE                                                10241099
099940         WHEN WS-NEW-STATUS = 'NA'                                10242099
099950              MOVE 'DAS' TO  WS-TRANS-CODE                        10243099
099960              GO TO 2130-EXIT                                     10244099
099970         WHEN WS-NEW-STATUS = 'NH'                                10245099
099980              MOVE 'HLD' TO  WS-TRANS-CODE                        10246099
099990              GO TO 2130-EXIT                                     10247099
100000         WHEN OTHER                                               10248099
100010              MOVE SPACES          TO  WS-TRANS-CODE              10249099
100020     END-EVALUATE                                                 10250099
100030                                                                  10251099
100040* BILL NOT IN ETNI CHECK                                          10252099
100050     IF WS-REC-BILL-NOT-IN-ETNI                                   10253099
100060        MOVE 'CNV' TO  WS-TRANS-CODE                              10254099
100070        GO TO 2130-EXIT                                           10255099
100080     END-IF                                                       10256099
100090                                                                  10257099
100100* MIN CHANGE                                                      10258099
100110     IF WS-NEW-MIN-NUM NOT = WS-OLD-MIN-NUM                       10259099
100120        MOVE 'CHM' TO WS-TRANS-CODE                               10260099
100130        GO TO 2130-EXIT                                           10261099
100140     END-IF                                                       10262099
100150                                                                  10263099
100160* NUMBER LOCATION CHANGE                                          10264099
100170     IF WS-NEW-NL      NOT = WS-OLD-NL                            10265099
100180        MOVE 'CNL' TO WS-TRANS-CODE                               10266099
100190        GO TO 2130-EXIT                                           10267099
100200     END-IF                                                       10268099
100210                                                                  10269099
100220* CTN DATA - NUMBER GROUP CHANGE                                  10270099
100230     IF WS-NEW-NGP     NOT = WS-OLD-NGP                           10271099
100240        MOVE 'CCD' TO WS-TRANS-CODE                               10272099
100250        GO TO 2130-EXIT                                           10273099
100260     END-IF                                                       10274099
100270                                                                  10275099
100280*----3/18/03: Biller can no longer change eTNI Port-IND, so if----10276099
100290*----they are different, treat this as an error in 2110-rtn-------10277099
100300*----before we even get to here-----------------------------------10278099
100310                                                                  10279099
100320* STATUS CHECK                                                    10280099
100330     IF WS-OLD-STATUS = WS-NEW-STATUS                             10281099
100340        MOVE 'RAS' TO  WS-TRANS-CODE                              10282099
100350        GO TO 2130-EXIT                                           10283099
100360     END-IF                                                       10284099
100370                                                                  10285099
100380* DEFAULT TRANS CODES                                             10286099
100390     EVALUATE TRUE                                                10287099
100400         WHEN WS-NEW-STATUS = 'NA'                                10288099
100410              MOVE 'LOD'           TO  WS-TRANS-CODE              10289099
100420         WHEN WS-NEW-STATUS = 'NH'                                10290099
100430              MOVE 'HLD'           TO  WS-TRANS-CODE              10291099
100440         WHEN WS-NEW-STATUS = 'AA'                                10292099
100450              MOVE 'MAS'           TO  WS-TRANS-CODE              10293099
100460         WHEN WS-NEW-STATUS = 'AR'                                10294099
100470              MOVE 'RSV'           TO  WS-TRANS-CODE              10295099
100480         WHEN WS-NEW-STATUS = 'AI'                                10296099
100490              MOVE 'ACT'           TO  WS-TRANS-CODE              10297099
100500         WHEN WS-NEW-STATUS = 'AG'                                10298099
100510              MOVE 'DAC'           TO  WS-TRANS-CODE              10299099
100520         WHEN WS-NEW-STATUS = 'PO'                                10300099
100530              MOVE 'DAC'           TO  WS-TRANS-CODE              10301099
100540         WHEN WS-NEW-STATUS = 'AT'                                10302099
100550              MOVE 'SPL'           TO  WS-TRANS-CODE              10303099
100560         WHEN OTHER                                               10304099
100570              MOVE 'CNV'           TO  WS-TRANS-CODE              10305099
100580     END-EVALUATE                                                 10306099
100590                                                                  10307099
100600     .                                                            10308099
100610 2130-EXIT.                                                       10309099
100620     EXIT.                                                        10310099
100630                                                                  10311099
100640 2140-MOVE-BILL-TO-ETNI-CTN.                                      10312099
100650******************************************************************10313099
100660*                                                                 10314099
100670*   PARAGRAPH NAME:  2140-MOVE-BILL-TO-ETNI-CTN                   10315099
100680*                                                                 10316099
100690*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   10317099
100700*             MOVE                                                10318099
100710*                                                                 10319099
100720******************************************************************10320099
100730     MOVE '2140-MOVE-BILL-TO-ETNI-CTN' TO WS-CURR-PARA            10321099
100740                                                                  10322099
100750     MOVE  SPACES TO WS-ERROR-FIELDS-SW                           10323099
100760                     WS-COMMENT                                   10324099
100770                     WS-ADDTL-INFO                                10325099
100780                                                                  10326099
100790* RETRIEVE CTN-INV RECORD                                         10327099
100800     MOVE     MDNIN-MDN             TO   WS-MDN                   10328099
100810     MOVE     MDNIN-PRODUCT-TYPE    TO   WS-PRODUCT-TYPE          10329099
100820     PERFORM  7000-SELECT-CTN-INV   THRU 7000-EXIT                10330099
100830                                                                  10331099
100840     IF SQL-ROW-NOT-FOUND                                         10332099
100850        ADD     +1 TO WS-TOTL-ERROR-CTNINV-NOTFND                 10333099
100860        SET   WS-ERROR-FIELDS-FOUND TO   TRUE                     10334099
100870        MOVE  LIT-CTN-INV-ERROR     TO   WS-COMMENT               10335099
100880        MOVE  WS-MDN                TO   WS-ADDTL-INFO (1:10)     10336099
100890        MOVE  WS-PRODUCT-TYPE       TO   WS-ADDTL-INFO (12:1)     10337099
100900        GO TO 2140-EXIT                                           10338099
100910     END-IF                                                       10339099
100920                                                                  10340099
100930* SET UPDATE INFO                                                 10341099
100940*----AGB 10/17/05---To insert into History the same way that------10342099
100950*----datalayer ETNDC15 does, use SYS-UPDATE-DATE from CTN-INV-----10343099
100960**   MOVE WS-TIMESTAMP         TO SYS-UPDATE-DATE OF DCLCTN-INV   10344099
100970     MOVE SYS-UPDATE-DATE      OF DCLCTN-INV TO                   10345099
100980          SYS-UPDATE-DATE      OF DCLCTN-INV-HISTORY              10346099
100990                                                                  10347099
101000     MOVE LIT-OPERATOR-ID      TO OPERATOR-ID     OF DCLCTN-INV   10348099
101010                                                                  10349099
101020     MOVE WS-SAVE-HDR-BILLER-ID   TO BILLER-ID    OF DCLCTN-INV   10350099
101030                                                                  10351099
101040     INITIALIZE CTN OF DCLCTN-INV                                 10352099
101050     UNSTRING MDNIN-MDN                                           10353099
101060        DELIMITED BY WS-DELIMITER                                 10354099
101070           INTO         CTN-TEXT OF DCLCTN-INV                    10355099
101080           DELIMITER IN WS-DELIMITER-VALUE                        10356099
101090           COUNT     IN CTN-LEN OF DCLCTN-INV                     10357099
101100     END-UNSTRING                                                 10358099
101110                                                                  10359099
101120*-------new tests on PrePaid Ind 9/28/04--------------------------10360099
101130                                                                  10361099
101140*    0) As a default, keep existing CTN-INV Prepaid Ind.          10362099
101150        MOVE WS-CTNIN-PREPAID-IND TO PREPAID-IND OF DCLCTN-INV    10363099
101160                                                                  10364099
101170*    1) changing CTN-INV to AI or AG Status? If Biller file       10365099
101180*       Prepaid Ind is Y or N, move it to CTN-INV                 10366099
101190                                                                  10367099
101200     IF (MDNIN-MDN-STATUS = 'AI' OR MDNIN-MDN-STATUS = 'AG')      10368099
101210         AND                                                      10369099
101220        (MDNIN-PREPAID-IND = 'Y' OR MDNIN-PREPAID-IND = 'N'       10370099
101230                                 OR MDNIN-PREPAID-IND = 'X')      10371099
101240         MOVE MDNIN-PREPAID-IND TO PREPAID-IND OF DCLCTN-INV      10372099
101250         GO TO 2140-MOVE-BILL-TO-ETNI-CONTINU                     10373099
101260         END-IF                                                   10374099
101270                                                                  10375099
101280*    2) changing CTN-INV FROM AI or AG Status to something else?  10376099
101290*       Set Prepaid Ind to space.                                 10377099
101300                                                                  10378099
101310        IF (WS-CTNIN-CTN-STATUS = 'AI' OR                         10379099
101320            WS-CTNIN-CTN-STATUS = 'AG')                           10380099
101330        AND                                                       10381099
101340           (MDNIN-MDN-STATUS NOT = 'AI' AND                       10382099
101350            MDNIN-MDN-STATUS NOT = 'AG')                          10383099
101360            MOVE SPACE TO PREPAID-IND OF DCLCTN-INV               10384099
101370            GO TO 2140-MOVE-BILL-TO-ETNI-CONTINU                  10385099
101380            END-IF                                                10386099
101390                                                                  10387099
101400*    3) Same Status in Biller and eTNI?                           10388099
101410*       Biller Status is AI or AG?                                10389099
101420*       Biller Prepaid Indicator is Y or N?                       10390099
101430*            update CTN-INV Prepaid Ind from Biller!              10391099
101440                                                                  10392099
101450**  JA1207B - ADDED  Prepaid Ind = X, below                       10393099
101460                                                                  10394099
101470        IF WS-CTNIN-CTN-STATUS = MDNIN-MDN-STATUS                 10395099
101480        AND                                                       10396099
101490          (MDNIN-MDN-STATUS = 'AI' OR MDNIN-MDN-STATUS = 'AG')    10397099
101500        AND                                                       10398099
101510          (MDNIN-PREPAID-IND = 'Y' OR MDNIN-PREPAID-IND = 'N'     10399099
101520                                   OR MDNIN-PREPAID-IND = 'X')    10400099
101530           MOVE MDNIN-PREPAID-IND TO PREPAID-IND OF DCLCTN-INV    10401099
101540           GO TO 2140-MOVE-BILL-TO-ETNI-CONTINU                   10402099
101550           END-IF                                                 10403099
101560                                                                  10404099
101570*    4) Same Status in Biller and eTNI?                           10405099
101580*       Biller Status is NOT AI or AG or AT?                      10406099
101590*            update CTN-INV Prepaid Ind to space unless           10407099
101600*       the CTN-INV Prepaid Ind is already AT                     10408099
101610                                                                  10409099
101620        IF WS-CTNIN-CTN-STATUS = MDNIN-MDN-STATUS                 10410099
101630        AND                                                       10411099
101640          (MDNIN-MDN-STATUS NOT = 'AI' AND                        10412099
101650           MDNIN-MDN-STATUS NOT = 'AG' AND                        10413099
101660           MDNIN-MDN-STATUS NOT = 'AT')                           10414099
101670*          CTN-INV Status not AT, space out Prepaid Ind           10415099
101680           IF WS-CTNIN-CTN-STATUS NOT = 'AT'                      10416099
101690              MOVE SPACE TO PREPAID-IND OF DCLCTN-INV             10417099
101700              GO TO 2140-MOVE-BILL-TO-ETNI-CONTINU                10418099
101710              END-IF                                              10419099
101720*          CTN-INV Status is AT, keep existing CTN-INV prepaid ind10420099
101730           IF WS-CTNIN-CTN-STATUS = 'AT'                          10421099
101740              MOVE WS-CTNIN-PREPAID-IND TO                        10422099
101750                   PREPAID-IND OF DCLCTN-INV                      10423099
101760              GO TO 2140-MOVE-BILL-TO-ETNI-CONTINU                10424099
101770              END-IF                                              10425099
101780        END-IF.                                                   10426099
101790                                                                  10427099
101800 2140-MOVE-BILL-TO-ETNI-CONTINU.                                  10428099
101810*----various Biller fields are moved to eTNI CTN-INV host vars----10429099
101820     MOVE MDNIN-PRODUCT-TYPE      TO PRODUCT-TYPE  OF DCLCTN-INV  10430099
101830                                                                  10431099
101840     MOVE WS-BILL-LAST-TRX-DATE-1 TO LAST-TRX-DATE OF DCLCTN-INV  10432099
101850                                                                  10433099
101860     MOVE WS-TRANS-CODE           TO LAST-TRX-CODE OF DCLCTN-INV  10434099
101870     MOVE MDNIN-MDN-STATUS        TO CTN-STATUS    OF DCLCTN-INV  10435099
101880     MOVE MDNIN-USER-ID           OF MDNIN-DETAIL-FIELDS          10436099
101890                                  TO LAST-TRX-UID  OF DCLCTN-INV  10437099
101900                                                                  10438099
101910*** SPACE OUT NL FOR 'NA' RECORD                                  10439099
101920**(JK1008C) NL should be NULL not Spaces.  Per Sue B. 10/14/2008. 10440099
101930     IF MDNIN-MDN-STATUS = 'NA'                                   10441099
101940        MOVE LOW-VALUES         TO NL            OF DCLCTN-INV    10442099
101950        ELSE                                                      10443099
101960        MOVE MDNIN-NL           TO NL            OF DCLCTN-INV    10444099
101970     END-IF                                                       10445099
101980                                                                  10446099
101990     MOVE MDNIN-NGP               TO NGP           OF DCLCTN-INV  10447099
102000*ir071503 - alway zero, but in the near future, this position     10448099
102010*ir071503 - will be replaced by biller-id, prepaid-ind and filler 10449099
102020*ir071503 - for a length of 3 bytes                               10450099
102030     MOVE ZERO                    TO CONV-RUN-NO   OF DCLCTN-INV  10451099
102040*** #140804 LMS 05/21/2003 BEGIN                                  10452099
102050     IF ((WS-NEW-STATUS NOT = 'NH')                               10453099
102060         AND (MDNIN-HOLD-REASON NOT = SPACES))                    10454099
102070             MOVE SPACES                  TO MDNIN-HOLD-REASON    10455099
102080     END-IF                                                       10456099
102090*** #140804 LMS 05/21/2003 END                                    10457099
102100     MOVE MDNIN-HOLD-REASON       TO HOLD-REASON   OF DCLCTN-INV  10458099
102110                                                                  10459099
102120*-----even though we no longer allow I2K to update eTNI mins------10460099
102130*-----this is the one case where we still do.---------------------10461099
102140*-----When I2K status is "NA" or "NH", null out eTNI min and------10462099
102150*-----temporarily switch off IS-THIS-I2K-INPUT flag. This flag----10463099
102160*-----is later reset to original value after 7010-UPDATE-CTN-INV--10464099
102170                                                                  10465099
102180     INITIALIZE MIN-NUM OF DCLCTN-INV                             10466099
102190     IF   MDNIN-MDN-STATUS = 'NA' OR 'NH'                         10467099
102200          MOVE SPACE TO IS-THIS-I2K-INPUT                         10468099
102210          MOVE -1 TO MIN-NUM-NI         OF DCLCTN-INV-NULL-INDS   10469099
102220          MOVE LOW-VALUES TO MIN-NUM-TEXT OF DCLCTN-INV           10470099
102230     ELSE                                                         10471099
102240          MOVE       MDNIN-MIN-NUM TO WS-TEMP-MIN-NUM             10472099
102250          UNSTRING   WS-TEMP-MIN-NUM-TEXT                         10473099
102260                     DELIMITED BY WS-DELIMITER                    10474099
102270                     INTO         MIN-NUM-TEXT OF DCLCTN-INV      10475099
102280                     DELIMITER IN WS-DELIMITER-VALUE              10476099
102290                     COUNT     IN MIN-NUM-LEN OF DCLCTN-INV       10477099
102300          END-UNSTRING                                            10478099
102310     END-IF                                                       10479099
102320                                                                  10480099
102330*----if we determined earlier that in this case the Biller is-----10481099
102340*----allowed to overlay the CTN-INV Port-Ind, do so here.---------10482099
102350     IF ALLOW-PORT-IND-CHG = 'Y'                                  10483099
102360        MOVE MDNIN-PORT-IND TO PORT-IND OF DCLCTN-INV             10484099
102370     END-IF                                                       10485099
102380                                                                  10486099
102390     PERFORM 2145-SET-CTNINV-NULL-INDS THRU 2145-EXIT             10487099
102400     .                                                            10488099
102410 2140-EXIT.                                                       10489099
102420     EXIT.                                                        10490099
102430                                                                  10491099
102440*-----go thru every nullable column in CTN-INV and set Null-Ind---10492099
102450*-----based on the value of its associated column-----------------10493099
102460                                                                  10494099
102470 2145-SET-CTNINV-NULL-INDS.                                       10495099
102480******************************************************************10496099
102490*                                                                 10497099
102500*   PARAGRAPH NAME:  2145-SET-CTNINV-NULL-INDS                    10498099
102510*                                                                 10499099
102520*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   10500099
102530*             NULLS                                               10501099
102540*                                                                 10502099
102550******************************************************************10503099
102560     MOVE '2145-ctninv-null-inds      ' TO WS-CURR-PARA           10504099
102570      IF SYS-UPDATE-DATE OF DCLCTN-INV = SPACES OR LOW-VALUES     10505099
102580         MOVE -1 TO SYS-UPDATE-DATE-NI OF DCLCTN-INV-NULL-INDS    10506099
102590      ELSE                                                        10507099
102600         MOVE  0 TO SYS-UPDATE-DATE-NI OF DCLCTN-INV-NULL-INDS    10508099
102610         END-IF                                                   10509099
102620                                                                  10510099
102630      IF OPERATOR-ID OF DCLCTN-INV = SPACES OR LOW-VALUES         10511099
102640         MOVE -1 TO OPERATOR-ID-NI OF DCLCTN-INV-NULL-INDS        10512099
102650      ELSE                                                        10513099
102660         MOVE  0 TO OPERATOR-ID-NI OF DCLCTN-INV-NULL-INDS        10514099
102670         END-IF                                                   10515099
102680                                                                  10516099
102690      IF APPLICATION-ID  OF DCLCTN-INV = SPACES OR LOW-VALUES     10517099
102700         MOVE -1 TO APPLICATION-ID-NI  OF DCLCTN-INV-NULL-INDS    10518099
102710      ELSE                                                        10519099
102720         MOVE  0 TO APPLICATION-ID-NI  OF DCLCTN-INV-NULL-INDS    10520099
102730         END-IF                                                   10521099
102740                                                                  10522099
102750      IF DL-UPDATE-STAMP OF DCLCTN-INV =  ZEROES                  10523099
102760         MOVE -1 TO DL-UPDATE-STAMP-NI OF DCLCTN-INV-NULL-INDS    10524099
102770      ELSE                                                        10525099
102780         MOVE  0 TO DL-UPDATE-STAMP-NI OF DCLCTN-INV-NULL-INDS    10526099
102790      END-IF                                                      10527099
102800                                                                  10528099
102810      IF NL OF DCLCTN-INV = SPACES OR LOW-VALUES                  10529099
102820         MOVE -1 TO NL-NI              OF DCLCTN-INV-NULL-INDS    10530099
102830      ELSE                                                        10531099
102840         MOVE  0 TO NL-NI              OF DCLCTN-INV-NULL-INDS    10532099
102850      END-IF                                                      10533099
102860                                                                  10534099
102870      IF CONV-RUN-NO OF DCLCTN-INV = ZERO                         10535099
102880         MOVE -1 TO CONV-RUN-NO-NI     OF DCLCTN-INV-NULL-INDS    10536099
102890      ELSE                                                        10537099
102900         MOVE  0 TO CONV-RUN-NO-NI     OF DCLCTN-INV-NULL-INDS    10538099
102910      END-IF                                                      10539099
102920                                                                  10540099
102930      IF SPECIAL-TRX-DATE OF DCLCTN-INV = SPACES OR LOW-VALUES    10541099
102940         MOVE -1 TO SPECIAL-TRX-DATE-NI OF DCLCTN-INV-NULL-INDS   10542099
102950      ELSE                                                        10543099
102960         MOVE  0 TO SPECIAL-TRX-DATE-NI OF DCLCTN-INV-NULL-INDS   10544099
102970      END-IF                                                      10545099
102980                                                                  10546099
102990      IF RUN-ID OF DCLCTN-INV = ZERO                              10547099
103000         MOVE -1 TO RUN-ID-NI OF DCLCTN-INV-NULL-INDS             10548099
103010      ELSE                                                        10549099
103020         MOVE  0 TO RUN-ID-NI OF DCLCTN-INV-NULL-INDS             10550099
103030      END-IF                                                      10551099
103040                                                                  10552099
103050      IF HOLD-REASON OF DCLCTN-INV = SPACE OR LOW-VALUES          10553099
103060         MOVE -1 TO HOLD-REASON-NI     OF DCLCTN-INV-NULL-INDS    10554099
103070      ELSE                                                        10555099
103080         MOVE  0 TO HOLD-REASON-NI     OF DCLCTN-INV-NULL-INDS    10556099
103090      END-IF                                                      10557099
103100                                                                  10558099
103110      IF ICC-ID OF DCLCTN-INV = SPACE OR LOW-VALUES               10559099
103120         MOVE -1 TO ICC-ID-NI          OF DCLCTN-INV-NULL-INDS    10560099
103130      ELSE                                                        10561099
103140         MOVE  0 TO ICC-ID-NI          OF DCLCTN-INV-NULL-INDS    10562099
103150      END-IF                                                      10563099
103160                                                                  10564099
103170*  JA0711  -  Force  ICC-ID  to  Nulls, If  Conditions  Apply     10565099
103180                                                                  10566099
103190      IF  WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA      10567099
103200         IF  MDN-MATCH-FLAG  =  'Y'                               10568099
103210            IF  MDNIN-MDN-STATUS(1:1)    =  'A'                   10569099
103220                IF  WS-CTNIN-CTN-STATUS  =  'NH'                  10570099
103230                    IF ICC-ID-TEXT  OF DCLCTN-INV  >  SPACE       10571099
103240                       MOVE  LOW-VALUES  TO  ICC-ID OF DCLCTN-INV 10572099
103250                       MOVE -1 TO ICC-ID-NI                       10573099
103260                                         OF  DCLCTN-INV-NULL-INDS 10574099
103270                    END-IF                                        10575099
103280                END-IF                                            10576099
103290            END-IF                                                10577099
103300         END-IF                                                   10578099
103310      END-IF                                                      10579099
103320                                                                  10580099
103330      IF PORT-IND OF DCLCTN-INV = SPACE OR LOW-VALUES             10581099
103340         MOVE -1 TO PORT-IND-NI        OF DCLCTN-INV-NULL-INDS    10582099
103350      ELSE                                                        10583099
103360         MOVE  0 TO PORT-IND-NI        OF DCLCTN-INV-NULL-INDS    10584099
103370      END-IF                                                      10585099
103380                                                                  10586099
103390      IF MIN-NUM-TEXT OF DCLCTN-INV =  SPACE OR LOW-VALUES        10587099
103400         MOVE -1 TO MIN-NUM-NI         OF DCLCTN-INV-NULL-INDS    10588099
103410      ELSE                                                        10589099
103420         MOVE  0 TO MIN-NUM-NI         OF DCLCTN-INV-NULL-INDS    10590099
103430      END-IF                                                      10591099
103440                                                                  10592099
103450      IF BILLER-ID OF DCLCTN-INV = SPACE OR LOW-VALUES            10593099
103460         MOVE -1 TO BILLER-ID-NI       OF DCLCTN-INV-NULL-INDS    10594099
103470      ELSE                                                        10595099
103480         MOVE  0 TO BILLER-ID-NI       OF DCLCTN-INV-NULL-INDS    10596099
103490      END-IF                                                      10597099
103500                                                                  10598099
103510*-----always make new prepaid-ind NOT null (even if empty)--------10599099
103520      MOVE 0 TO PREPAID-IND-NI OF DCLCTN-INV-NULL-INDS.           10600099
103530 2145-EXIT.                                                       10601099
103540      EXIT.                                                       10602099
103550                                                                  10603099
103560 2150-UPDATE-STATUS-COUNTERS.                                     10604099
103570******************************************************************10605099
103580*                                                                 10606099
103590*   PARAGRAPH NAME:  2150-UPDATE-STATUS-COUNTERS                  10607099
103600*                                                                 10608099
103610*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   10609099
103620*             STATUS COUNTERS                                     10610099
103630*                                                                 10611099
103640******************************************************************10612099
103650     MOVE '2150-UPDATE-STATUS-COUNTERS' TO WS-CURR-PARA           10613099
103660                                                                  10614099
103670*----if this is an MDN match, and only PORT-IND changed, but------10615099
103680*----PORT-IND change was disallowed, do not update Status Counts--10616099
103690*----This is for efficiency: prevents needless updates------------10617099
103700     IF PORT-IND-IS-THE-ONLY-CHANGE = 'Y' AND                     10618099
103710        ALLOW-PORT-IND-CHG NOT = 'Y'                              10619099
103720        MOVE ZERO TO SQLCODE                                      10620099
103730        GO TO 2150-EXIT                                           10621099
103740     END-IF                                                       10622099
                                                                        10623099
103750*                                                                 10624099
103760* counters are updated only if status changes to/from NA,NH,AA    10625099
103770     IF (WS-OLD-STATUS = 'NA' OR 'NH' OR 'AA')  OR                10626099
103780        (WS-NEW-STATUS = 'NA' OR 'NH' OR 'AA')                    10627099
103790        CONTINUE                                                  10628099
103800     ELSE                                                         10629099
103810        GO TO 2150-EXIT                                           10630099
103820     END-IF                                                       10631099
103830                                                                  10632099
103840     IF WS-OLD-STATUS = WS-NEW-STATUS                             10633099
103850        GO TO 2150-EXIT                                           10634099
103860     END-IF                                                       10635099
103870                                                                  10636099
103880     IF WS-OLD-STATUS = 'NA' OR 'NH'                              10637099
103890        MOVE    WS-OLD-NGP               TO   WS-NGP              10638099
103900        MOVE    WS-OLD-PRODUCT-TYPE      TO   WS-PRODUCT-TYPE     10639099
103910        PERFORM 7700-SELECT-NGP-COUNTERS THRU 7700-EXIT           10640099
103920        IF SQL-ROW-NOT-FOUND                                      10641099
103930           ADD +1 TO WS-TOTL-ERROR-NGPCNT-NOTFND                  10642099
103940           MOVE LIT-STATUS-NGP-COUNTER-ERROR TO WS-COMMENT        10643099
103950           MOVE WS-NGP                  TO   WS-ADDTL-INFO (1:3)  10644099
103960           MOVE WS-PRODUCT-TYPE         TO   WS-ADDTL-INFO (5:1)  10645099
103970           MOVE WS-OLD-STATUS           TO   WS-ADDTL-INFO (7:2)  10646099
103980           MOVE WS-NEW-STATUS           TO   WS-ADDTL-INFO (10:2) 10647099
103990           SET  WS-ERROR-FIELDS-FOUND        TO TRUE              10648099
104000           GO TO 2150-EXIT                                        10649099
104010        END-IF                                                    10650099
104020        PERFORM 2160-PROCESS-OLD-STATUS-NA-NH                     10651099
104030     END-IF                                                       10652099
104040                                                                  10653099
104050     IF WS-NEW-STATUS = 'NA' OR 'NH'                              10654099
104060        MOVE    WS-NEW-NGP               TO   WS-NGP              10655099
104070        MOVE    WS-NEW-PRODUCT-TYPE      TO   WS-PRODUCT-TYPE     10656099
104080        PERFORM 7700-SELECT-NGP-COUNTERS THRU 7700-EXIT           10657099
104090        IF SQL-ROW-NOT-FOUND                                      10658099
104100           ADD +1 TO WS-TOTL-ERROR-NGPCNT-NOTFND                  10659099
104110           MOVE LIT-STATUS-NGP-COUNTER-ERROR TO WS-COMMENT        10660099
104120           MOVE WS-NGP                  TO   WS-ADDTL-INFO (1:3)  10661099
104130           MOVE WS-PRODUCT-TYPE         TO   WS-ADDTL-INFO (5:1)  10662099
104140           MOVE WS-OLD-STATUS           TO   WS-ADDTL-INFO (7:2)  10663099
104150           MOVE WS-NEW-STATUS           TO   WS-ADDTL-INFO (10:2) 10664099
104160           SET  WS-ERROR-FIELDS-FOUND        TO TRUE              10665099
104170           GO TO 2150-EXIT                                        10666099
104180        END-IF                                                    10667099
104190        PERFORM 2165-PROCESS-NEW-STATUS-NA-NH                     10668099
104200     END-IF                                                       10669099
104210                                                                  10670099
104220     IF WS-OLD-STATUS = 'AA'                                      10671099
104230        MOVE WS-OLD-NL            TO WS-NL                        10672099
104240        MOVE WS-OLD-NGP           TO WS-NGP                       10673099
104250        MOVE WS-OLD-PRODUCT-TYPE  TO WS-PRODUCT-TYPE              10674099
104260        PERFORM 7510-SELECT-NGP-NL-ASSIGNMENT THRU 7510-EXIT      10675099
104270                                                                  10676099
104280        PERFORM 2170-PROCESS-OLD-STATUS-AA                        10677099
104290     END-IF                                                       10678099
104300                                                                  10679099
104310     IF WS-NEW-STATUS = 'AA'                                      10680099
104320        MOVE WS-NEW-NL            TO WS-NL                        10681099
104330        MOVE WS-NEW-NGP           TO WS-NGP                       10682099
104340        MOVE WS-NEW-PRODUCT-TYPE  TO WS-PRODUCT-TYPE              10683099
104350        PERFORM 7510-SELECT-NGP-NL-ASSIGNMENT THRU 7510-EXIT      10684099
104360                                                                  10685099
104370        PERFORM 2175-PROCESS-NEW-STATUS-AA                        10686099
104380     END-IF                                                       10687099
104390                                                                  10688099
104400**  JA1207A - Start                                               10689099
104410                                                                  10690099
104420     IF  WS-OLD-STATUS  =  'NH'  OR                               10691099
104430         WS-NEW-STATUS  =  'NH'                                   10692099
104440         CONTINUE                                                 10693099
104450        ELSE                                                      10694099
104460         PERFORM 2175A-STORE-NGP-NL  THRU  2175A-EXIT             10695099
104470     END-IF                                                       10696099
104480                                                                  10697099
104490**  JA1207A - End                                                 10698099
104500     .                                                            10699099
104510 2150-EXIT.                                                       10700099
104520     EXIT.                                                        10701099
104530                                                                  10702099
104540 2160-PROCESS-OLD-STATUS-NA-NH.                                   10703099
104550******************************************************************10704099
104560*                                                                 10705099
104570*   PARAGRAPH NAME:  2160-PROCESS-OLD-STATUS-NA-NH                10706099
104580*                                                                 10707099
104590*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   10708099
104600*             OLD STATUS NA NH                                    10709099
104610*                                                                 10710099
104620******************************************************************10711099
104630     MOVE '2160-PROCESS-OLD-STATUS-NA-NH' TO WS-CURR-PARA         10712099
104640                                                                  10713099
104650     MOVE UNASG-PROD-QTY OF DCLNGP-COUNTERS TO WS-QTY             10714099
104660     MOVE UNASG-HOLD-QTY OF DCLNGP-COUNTERS TO WS-QTY1            10715099
104670                                                                  10716099
104680     IF WS-OLD-STATUS   = 'NA'  AND                               10717099
104690        WS-QTY > 0                                                10718099
104700        COMPUTE WS-QTY  = WS-QTY  - 1                             10719099
104710     END-IF                                                       10720099
104720                                                                  10721099
104730     IF WS-OLD-STATUS   = 'NH'  AND                               10722099
104740        WS-QTY1 > 0                                               10723099
104750        COMPUTE WS-QTY1 = WS-QTY1 - 1                             10724099
104760     END-IF                                                       10725099
104770                                                                  10726099
104780     PERFORM 7710-UPDATE-NGP-COUNTERS THRU 7710-EXIT              10727099
104790                                                                  10728099
104800     .                                                            10729099
104810 2160-EXIT.                                                       10730099
104820     EXIT.                                                        10731099
104830                                                                  10732099
104840 2165-PROCESS-NEW-STATUS-NA-NH.                                   10733099
104850******************************************************************10734099
104860*                                                                 10735099
104870*   PARAGRAPH NAME:  2165-PROCESS-NEW-STATUS-NA-NH                10736099
104880*                                                                 10737099
104890*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   10738099
104900*             NEW STATUS NA NH                                    10739099
104910*                                                                 10740099
104920******************************************************************10741099
104930     MOVE '2165-PROCESS-NEW-STATUS-NA-NH' TO WS-CURR-PARA         10742099
104940                                                                  10743099
104950     MOVE UNASG-PROD-QTY OF DCLNGP-COUNTERS TO WS-QTY             10744099
104960     MOVE UNASG-HOLD-QTY OF DCLNGP-COUNTERS TO WS-QTY1            10745099
104970                                                                  10746099
104980**  JA0320  -   Changed  Code  to  Allow  Zero  in  Counters      10747099
104990**                       From:  WS-QTY*  >  0                     10748099
105000**                         To:  WS-QTY*  > -1  -  below           10749099
105010                                                                  10750099
105020     IF WS-NEW-STATUS   = 'NA' AND                                10751099
105030        WS-QTY > -1                                               10752099
105040        COMPUTE WS-QTY  = WS-QTY  + 1                             10753099
105050     END-IF                                                       10754099
105060                                                                  10755099
105070     IF WS-NEW-STATUS   = 'NH' AND                                10756099
105080        WS-QTY1 > -1                                              10757099
105090        COMPUTE WS-QTY1 = WS-QTY1 + 1                             10758099
105100     END-IF                                                       10759099
105110                                                                  10760099
105120     PERFORM 7710-UPDATE-NGP-COUNTERS THRU 7710-EXIT              10761099
105130                                                                  10762099
105140     .                                                            10763099
105150 2165-EXIT.                                                       10764099
105160     EXIT.                                                        10765099
105170                                                                  10766099
105180 2170-PROCESS-OLD-STATUS-AA.                                      10767099
105190******************************************************************10768099
105200*                                                                 10769099
105210*   PARAGRAPH NAME:  2170-PROCESS-OLD-STATUS-AA                   10770099
105220*                                                                 10771099
105230*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   10772099
105240*             OLD STATUS AA                                       10773099
105250*                                                                 10774099
105260******************************************************************10775099
105270     MOVE '2170-PROCESS-OLD-STATUS-AA' TO WS-CURR-PARA            10776099
105280     MOVE AA-STS-CNT OF DCLNGP-NL-ASSIGNMENT TO WS-QTY            10777099
105290                                                                  10778099
105300     IF WS-OLD-STATUS = 'AA' AND                                  10779099
105310        WS-QTY > 0                                                10780099
105320        COMPUTE WS-QTY = WS-QTY - 1                               10781099
105330     END-IF                                                       10782099
105340                                                                  10783099
105350     PERFORM 7520-UPDATE-NGP-NL-ASSIGNMENT THRU 7520-EXIT         10784099
105360     .                                                            10785099
105370 2170-EXIT.                                                       10786099
105380     EXIT.                                                        10787099
105390                                                                  10788099
105400 2175-PROCESS-NEW-STATUS-AA.                                      10789099
105410******************************************************************10790099
105420*                                                                 10791099
105430*   PARAGRAPH NAME:  2175-PROCESS-NEW-STATUS-AA                   10792099
105440*                                                                 10793099
105450*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   10794099
105460*             NEW STATUS AA                                       10795099
105470*                                                                 10796099
105480******************************************************************10797099
105490     MOVE '2175-PROCESS-NEW-STATUS-AA' TO WS-CURR-PARA            10798099
105500     MOVE AA-STS-CNT OF DCLNGP-NL-ASSIGNMENT TO WS-QTY            10799099
105510                                                                  10800099
105520     IF WS-NEW-STATUS = 'AA' AND                                  10801099
105530        WS-QTY > 0                                                10802099
105540        COMPUTE WS-QTY = WS-QTY + 1                               10803099
105550     END-IF                                                       10804099
105560                                                                  10805099
105570     PERFORM 7520-UPDATE-NGP-NL-ASSIGNMENT THRU 7520-EXIT         10806099
105580     .                                                            10807099
105590 2175-EXIT.                                                       10808099
105600     EXIT.                                                        10809099
105610                                                                  10810099
105620 2175A-STORE-NGP-NL.                                              10811099
105630***************************************************************** 10812099
105640**                                                                10813099
105650**   Lookup  NGP,  NL  Just  Processed  in  Array                 10814099
105660**      If  Found,  Exit                                          10815099
105670**      If  Not Found,  Store                                     10816099
105680**                                                                10817099
105690***************************************************************** 10818099
105700                                                                  10819099
105710     PERFORM  VARYING  WS-NGP-NL-A-IDX  FROM  +1  BY  +1          10820099
105720              UNTIL    WS-NGP-ENTRY (WS-NGP-NL-A-IDX)  =          10821099
105730                       SPACES                                     10822099
105740              OR       WS-NGP-ENTRY (WS-NGP-NL-A-IDX)  =          10823099
105750                       WS-NGP-CURRENT                             10824099
105760              OR       WS-NGP-NL-A-IDX  >  WS-NGP-NL-A-IDX-MAX    10825099
105770                                                                  10826099
105780     END-PERFORM                                                  10827099
105790                                                                  10828099
105800     IF  WS-NGP-NL-A-IDX  >  WS-NGP-NL-A-IDX-MAX                  10829099
105810         DISPLAY  '**-------------------------------------**'     10830099
105820         DISPLAY  '* * WS-NGP-NL-AREA * * EXCEEDED 5000  * * '    10831099
105830         DISPLAY  '* * WS-NGP-NL-AREA * * EXPAND  ARRAY  * * '    10832099
105840         DISPLAY  '**-------------------------------------**'     10833099
105850         MOVE 4   TO WS-RETURN-CODE                               10834099
105860         GO  TO  2175A-EXIT                                       10835099
105870     END-IF                                                       10836099
105880                                                                  10837099
105890     IF  WS-NGP-ENTRY (WS-NGP-NL-A-IDX)      =  WS-NGP-CURRENT    10838099
105900         AND  WS-NL-ENTRY (WS-NGP-NL-A-IDX)  =  WS-NL-CURRENT     10839099
105910         AND  WS-PRODUCT-ENTRY (WS-NGP-NL-A-IDX)  =               10840099
105920              WS-PRODUCT-CURRENT                                  10841099
105930         GO  TO  2175A-EXIT                                       10842099
105940     END-IF                                                       10843099
105950                                                                  10844099
105960**  STORE  New  Data                                              10845099
105970                                                                  10846099
105980     MOVE  WS-NGP-CURRENT  TO  WS-NGP-ENTRY (WS-NGP-NL-A-IDX)     10847099
105990     MOVE  WS-NL-CURRENT   TO  WS-NL-ENTRY (WS-NGP-NL-A-IDX)      10848099
106000     MOVE  WS-PRODUCT-CURRENT  TO                                 10849099
106010                             WS-PRODUCT-ENTRY (WS-NGP-NL-A-IDX)   10850099
106020                                                                  10851099
106030     MOVE  SPACES  TO   WS-NGP-CURRENT                            10852099
106040                        WS-NL-CURRENT                             10853099
106050                        WS-PRODUCT-CURRENT                        10854099
106060     .                                                            10855099
106070 2175A-EXIT.                                                      10856099
106080     EXIT.                                                        10857099
106090                                                                  10858099
106100*-----the routine below updates MIN-INV when processing-----------10859099
106110*-----matching Biller MDN and eTNI CTNs in 2100-MDN-MATCH---------10860099
106120                                                                  10861099
106130 2180-UPDATE-MIN-INV-STATUS.                                      10862099
106140******************************************************************10863099
106150*                                                                 10864099
106160*   PARAGRAPH NAME:  2180-UPDATE-MIN-INV-STATUS                   10865099
106170*                                                                 10866099
106180*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   10867099
106190*             MIN STATUS                                          10868099
106200*                                                                 10869099
106210******************************************************************10870099
106220     MOVE '2180-UPDATE-MIN-INV-STATUS' TO WS-CURR-PARA            10871099
106230                                                                  10872099
106240*----if this is an MDN match, and only PORT-IND changed, but------10873099
106250*----PORT-IND change was disallowed, do not update MIN-INV.-------10874099
106260*----This is for efficiency: prevents needless updates------------10875099
106270     IF PORT-IND-IS-THE-ONLY-CHANGE = 'Y' AND                     10876099
106280        ALLOW-PORT-IND-CHG NOT = 'Y'                              10877099
106290        MOVE ZERO TO SQLCODE                                      10878099
106300        GO TO 2180-EXIT                                           10879099
106310        END-IF                                                    10880099
106320                                                                  10881099
106330* SELECT RECORDS TO BE UPDATED                                    10882099
106340                                                                  10883099
106350*---if the new STATUS from Biller and old eTNI PORT-IND from------10884099
106360*---eTNI's CTN-INV table is one of the combinations below,--------10885099
106370*---perform updates to MIN-INV status-----------------------------10886099
106380                                                                  10887099
106390        IF (WS-NEW-STATUS   = 'NA' OR 'NH')                       10888099
106400        OR ((WS-NEW-STATUS   = 'AI' OR 'AG' OR 'AR') AND          10889099
106410            (WS-OLD-PORT-IND = 'RE' OR 'PI' OR 'PO'))             10890099
106420        OR ((WS-NEW-STATUS   = 'AA')                 AND          10891099
106430            (WS-OLD-PORT-IND = 'RE'))                             10892099
106440        OR  (WS-NEW-STATUS   = 'PA')                              10893099
106450**  JA0507  -  ABOVE  1  LINE  ADDED  'PA'                        10894099
106460        CONTINUE                                                  10895099
106470     ELSE                                                         10896099
106480        GO TO 2180-EXIT                                           10897099
106490        END-IF                                                    10898099
106500                                                                  10899099
106510* UPDATE OLD MIN NUMBER STATUS                                    10900099
106520                                                                  10901099
106530*----below the status of the original MIN-NUM from eTNI is updated10902099
106540                                                                  10903099
106550     MOVE    WS-OLD-MIN-NUM            TO   WS-TEMP-MIN-NUM-TEXT  10904099
106560                                                                  10905099
106570*  JA0212  -   Removed                                            10906099
106580*  JA0112  -   Make  "old"  Update  Conditional                   10907099
106590                                                                  10908099
106600*****IF  WS-OLD-MIN-NUM  NOT  =  WS-NEW-MIN-NUM                   10909099
106610                                                                  10910099
106620     PERFORM 2185-UPD-OLD-MIN-NUM-STAT THRU 2185-EXIT             10911099
106630                                                                  10912099
106640*****END-IF                                                       10913099
106650                                                                  10914099
106660* UPDATE NEW MIN NUMBER STATUS                                    10915099
106670                                                                  10916099
106680*----Here, the status of the new MIN-NUM from Biller is updated---10917099
106690*----to either 'AA' or 'AI' or 'AM' depending on new Status from--10918099
106700*----Biller and/or new PORT-IND from Biller.----------------------10919099
106710*----First, the logic attempts to find the new MIN-NUM in the-----10920099
106720*----MIN-INV table and if can't do so, produces an error message--10921099
106730                                                                  10922099
106740     MOVE    WS-NEW-MIN-NUM            TO   WS-TEMP-MIN-NUM-TEXT  10923099
106750     PERFORM 2190-UPD-NEW-MIN-NUM-STAT THRU 2190-EXIT             10924099
106760     .                                                            10925099
106770 2180-EXIT.                                                       10926099
106780     EXIT.                                                        10927099
106790                                                                  10928099
106800*----below is a special version of 2180-UPDATE-MIN-INV-STATUS-----10929099
106810*----that's used ONLY when MDN exists in Biller and not in eTNI---10930099
106820*----It assumes eTNI fields are spaces and doesn't test them.-----10931099
106830                                                                  10932099
106840 2183-UPDATE-MIN-INV-STATUS.                                      10933099
106850      MOVE '2183-UPDATE-MIN-INV-STATUS' TO WS-CURR-PARA           10934099
106860                                                                  10935099
106870* SELECT RECORDS TO BE UPDATED                                    10936099
106880                                                                  10937099
106890*---if the new STATUS from Biller and old eTNI PORT-IND from------10938099
106900*---eTNI's CTN-INV table is one of the combinations below,--------10939099
106910*---perform updates to MIN-INV status-----------------------------10940099
106920                                                                  10941099
106930     IF WS-NEW-STATUS = 'NA' OR 'NH' OR 'AI' OR 'AG' OR           10942099
106940                        'AR' OR 'AA' OR 'AT' OR 'PA'              10943099
106950**  JA0507  -  ABOVE  1  LINE  ADDED  'PA'                        10944099
106960        CONTINUE                                                  10945099
106970     ELSE                                                         10946099
106980        GO TO 2183-EXIT                                           10947099
106990     END-IF                                                       10948099
107000                                                                  10949099
107010*----Do a search of CTN-INV to see if any rows contain the MIN----10950099
107020*----coming from input Biller File, but assigned to different CTN.10951099
107030*----If so,      do not update the status of MIN-NUM.-------------10952099
107040*----Implies that more than one CTN-INV CTN is assigned this MIN--10953099
107050*----and that's an error condition.-------------------------------10954099
107060*----Load DCLGEN search MIN/CTN with Biller file MIN and MDN.-----10955099
107070     MOVE 10 TO MIN-NUM-LEN OF DCLCTN-INV                         10956099
107080     MOVE MDNIN-MIN-NUM TO MIN-NUM-TEXT OF DCLCTN-INV             10957099
107090     MOVE 10 TO CTN-LEN OF DCLCTN-INV                             10958099
107100     MOVE MDNIN-MDN TO CTN-TEXT OF DCLCTN-INV                     10959099
107110     INITIALIZE WS-CTN-W-DUPE-MIN                                 10960099
107120     PERFORM 7007-SELECT-CTN-INV-MIN THRU 7007-EXIT               10961099
107130     IF SHOULD-MIN-STATUS-BE-UPDATED NOT = 'Y'                    10962099
107140        GO TO 2183-EXIT                                           10963099
107150     END-IF                                                       10964099
107160                                                                  10965099
107170* UPDATE NEW MIN NUMBER STATUS                                    10966099
107180                                                                  10967099
107190*----Here, the status of the new MIN-NUM from Biller is updated---10968099
107200*----to either 'AA' or 'AI' or 'AM' depending on new Status from--10969099
107210*----Biller.------------------------------------------------------10970099
107220*----First, the logic attempts to find the new MIN-NUM in the-----10971099
107230*----MIN-INV table and if can't do so, produces an error message--10972099
107240                                                                  10973099
107250     MOVE    WS-NEW-MIN-NUM            TO   WS-TEMP-MIN-NUM-TEXT  10974099
107260     PERFORM 2190-UPD-NEW-MIN-NUM-STAT THRU 2190-EXIT             10975099
107270     .                                                            10976099
107280 2183-EXIT.                                                       10977099
107290     EXIT.                                                        10978099
107300                                                                  10979099
107310*-----below is the logic used to update the MIN-INV file when-----10980099
107320*-----program is executing the 2300-MDN-NOT-IN-BILL routine-------10981099
107330*-----(CTN in eTNI, but not in Biller file)-----------------------10982099
107340                                                                  10983099
107350 2184-UPDATE-MIN-STATUS.                                          10984099
107360      MOVE '2184-UPDATE-MIN-STATUS' TO WS-CURR-PARA               10985099
107370*----Do a search of CTN-INV to see if any other CTNs contain the--10986099
107380*----MIN from input eTNI File, but assigned to different CTN.-----10987099
107390*----If so,      do not update the status of MIN-NUM.-------------10988099
107400*----Implies that more than one CTN-INV CTN is assigned this MIN--10989099
107410*----and that's an error condition.-------------------------------10990099
107420*----Load DCLGEN search MIN/CTN with eTNI file MIN and MDN.-------10991099
107430      MOVE 10 TO MIN-NUM-LEN OF DCLCTN-INV                        10992099
107440      MOVE WS-CTNIN-MIN-NUM-TEXT TO MIN-NUM-TEXT OF DCLCTN-INV    10993099
107450      MOVE 10 TO CTN-LEN OF DCLCTN-INV                            10994099
107460      MOVE WS-CTNIN-CTN-TEXT TO CTN-TEXT OF DCLCTN-INV            10995099
107470      INITIALIZE WS-CTN-W-DUPE-MIN                                10996099
107480      PERFORM 7007-SELECT-CTN-INV-MIN THRU 7007-EXIT              10997099
107490      IF SHOULD-MIN-STATUS-BE-UPDATED NOT = 'Y'                   10998099
107500         GO TO 2184-EXIT                                          10999099
107510      END-IF                                                      11000099
107520                                                                  11001099
107530       UNSTRING WS-CTNIN-MIN-NUM-TEXT                             11002099
107540                DELIMITED BY SPACE                                11003099
107550                INTO         MIN-NUM-TEXT OF DCLMIN-INV           11004099
107560                DELIMITER IN WS-DELIMITER                         11005099
107570                COUNT     IN MIN-NUM-LEN  OF DCLMIN-INV           11006099
107580       END-UNSTRING                                               11007099
107590                                                                  11008099
107600       MOVE WS-TIMESTAMP TO SYS-UPDATE-DATE OF DCLMIN-INV         11009099
107610       MOVE LIT-OPERATOR-ID TO OPERATOR-ID OF DCLMIN-INV          11010099
107620                                                                  11011099
107630       IF SYS-UPDATE-DATE OF DCLMIN-INV = SPACE OR LOW-VALUES     11012099
107640          MOVE -1 TO SYS-UPDATE-DATE-NI OF DCLMIN-INV-NULL-INDS   11013099
107650       ELSE                                                       11014099
107660         MOVE  0 TO SYS-UPDATE-DATE-NI OF DCLMIN-INV-NULL-INDS    11015099
107670       END-IF                                                     11016099
107680                                                                  11017099
107690      IF OPERATOR-ID OF DCLMIN-INV = SPACE OR LOW-VALUES          11018099
107700         MOVE -1 TO OPERATOR-ID-NI OF DCLMIN-INV-NULL-INDS        11019099
107710       ELSE                                                       11020099
107720         MOVE  0 TO OPERATOR-ID-NI OF DCLMIN-INV-NULL-INDS        11021099
107730      END-IF                                                      11022099
107740                                                                  11023099
107750      MOVE MODIFIED-MIN-STATUS TO MIN-STATUS OF DCLMIN-INV        11024099
107760                                                                  11025099
107770      EXEC SQL                                                    11026099
107780           UPDATE MIN_INV                                         11027099
107790           SET MIN_STATUS = :DCLMIN-INV.MIN-STATUS,               11028099
107800               SYS_UPDATE_DATE = :WS-TIMESTAMP                    11029099
107810                        :DCLMIN-INV-NULL-INDS.SYS-UPDATE-DATE-NI, 11030099
107820               OPERATOR_ID     = :DCLMIN-INV.OPERATOR-ID          11031099
107830                        :DCLMIN-INV-NULL-INDS.OPERATOR-ID-NI      11032099
107840           WHERE                                                  11033099
107850               MIN_NUM = :DCLMIN-INV.MIN-NUM                      11034099
107860           END-EXEC                                               11035099
107870                                                                  11036099
107880     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    11037099
107890                                                                  11038099
107900     IF SQL-SUCCESS                                               11039099
107910        ADD +1 TO WS-TOTL-ETNI-MININV-UPD-ST-CNT                  11040099
107920        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          11041099
107930     ELSE                                                         11042099
107940        IF SQL-ROW-NOT-FOUND                                      11043099
107950           CONTINUE                                               11044099
107960        ELSE                                                      11045099
107970           PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT            11046099
107980           MOVE    SQLCODE TO WS-ABEND-CODE                       11047099
107990           STRING 'FATAL SQL ERROR!!!  SQLCODE: '                 11048099
108000                   WS-ABEND-CODE                                  11049099
108010                   DELIMITED BY SIZE                              11050099
108020                   INTO WS-ABEND-TEXT                             11051099
108030           END-STRING                                             11052099
108040           PERFORM 9000-ABORT           THRU 9000-EXIT            11053099
108050        END-IF                                                    11054099
108060      END-IF                                                      11055099
108070     .                                                            11056099
108080 2184-EXIT.                                                       11057099
108090      EXIT.                                                       11058099
108100                                                                  11059099
108110*   _________________________________________________________     11060099
108120*   |  UPDATE MIN-INV STATUS FOR O*L*D MIN NUM (eTNI's MIN) |     11061099
108130*   |  (when there's a match on Biller/eTNI CTN)            |     11062099
108140*   |_______________________________________________________|     11063099
108150                                                                  11064099
108160 2185-UPD-OLD-MIN-NUM-STAT.                                       11065099
108170******************************************************************11066099
108180*                                                                 11067099
108190*   PARAGRAPH NAME:  2185-UPD-OLD-MIN-NUM-STAT                    11068099
108200*                                                                 11069099
108210*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   11070099
108220*             OLD MIN                                             11071099
108230*                                                                 11072099
108240******************************************************************11073099
108250     MOVE '2185-UPD-OLD-MIN-NUM-STAT' TO WS-CURR-PARA             11074099
108260                                                                  11075099
108270     IF (WS-TEMP-MIN-NUM      = SPACES OR LOW-VALUES OR           11076099
108280                                ZEROES OR HIGH-VALUES)            11077099
108290         OR                                                       11078099
108300        (WS-TEMP-MIN-NUM-TEXT = SPACES OR LOW-VALUES OR           11079099
108310                                ZEROES OR HIGH-VALUES)            11080099
108320         GO TO 2185-EXIT                                          11081099
108330     END-IF                                                       11082099
108340                                                                  11083099
108350* CHECK MIN NUMBER EXISTENCE IN CTN-INV                           11084099
108360     UNSTRING WS-TEMP-MIN-NUM-TEXT                                11085099
108370              DELIMITED BY SPACE                                  11086099
108380              INTO         MIN-NUM-TEXT OF DCLCTN-INV             11087099
108390              DELIMITER IN WS-DELIMITER                           11088099
108400              COUNT     IN MIN-NUM-LEN  OF DCLCTN-INV             11089099
108410     END-UNSTRING                                                 11090099
108420     MOVE    ZEROES                  TO   WS-EXIST-FLAG           11091099
108430                                                                  11092099
108440*----Do a read against CTN-INV searching by old MIN.------------- 11093099
108450*----We need to get the STATUS of this CTN to determine what------11094099
108460*----status to apply to the old MIN.------------------------------11095099
108470*----If no such CTN-INV row found, set STATUS to NF (not found)---11096099
108480                                                                  11097099
108490*  JA0112  -   Added  Below  OR                                   11098099
108500                                                                  11099099
108510     PERFORM 7006-SELECT-CTN-INV-MIN THRU 7006-EXIT               11100099
108520                                                                  11101099
108530     IF SQL-ROW-NOT-FOUND                                         11102099
108540        OR  WS-CHECK-OLD-CTN-STATUS  =  SPACES                    11103099
108550        MOVE 'NF' TO WS-CHECK-OLD-CTN-STATUS                      11104099
108560                     WS-CHECK-OLD-PORT-IND                        11105099
108570     END-IF                                                       11106099
108580                                                                  11107099
108590*  JA0112  -   Below  Dup-Select                                  11108099
108600                                                                  11109099
108610     IF SQL-DUP-SELECT                                            11110099
108620        MOVE 'AR' TO WS-CHECK-OLD-CTN-STATUS                      11111099
108630     END-IF                                                       11112099
108640                                                                  11113099
108650* RETRIEVE MIN NUMBER FROM MIN-INV                                11114099
108660*----using MIN from CTN-INV input file, find in MIN-INV-----------11115099
108670     UNSTRING WS-TEMP-MIN-NUM-TEXT                                11116099
108680              DELIMITED BY SPACE                                  11117099
108690              INTO         MIN-NUM-TEXT OF DCLMIN-INV             11118099
108700              DELIMITER IN WS-DELIMITER                           11119099
108710              COUNT     IN MIN-NUM-LEN  OF DCLMIN-INV             11120099
108720     END-UNSTRING                                                 11121099
108730     PERFORM 7810-SELECT-MIN-INV THRU 7810-EXIT                   11122099
108740                                                                  11123099
108750*----not found in MIN-INV? Print an error message and exit--------11124099
108760     IF SQL-ROW-NOT-FOUND                                         11125099
108770        ADD   +1 TO WS-TOTL-ERROR-MIN-NUM-NOTFND-S                11126099
108780        SET   WS-ERROR-FIELDS-FOUND  TO   TRUE                    11127099
108790        MOVE  LIT-MIN-NUM-NOTFND-S   TO   WS-COMMENT              11128099
108800        MOVE  WS-TEMP-MIN-NUM-TEXT   TO   WS-ADDTL-INFO (1:10)    11129099
108810        GO TO 2185-EXIT                                           11130099
108820     END-IF                                                       11131099
108830                                                                  11132099
108840* UPDATE MIN STATUS                                               11133099
108850     MOVE WS-TIMESTAMP    TO SYS-UPDATE-DATE                      11134099
108860                          OF DCLMIN-INV                           11135099
108870                             LAST-TRX-DATE                        11136099
108880                          OF DCLMIN-INV                           11137099
108890     MOVE LIT-OPERATOR-ID TO OPERATOR-ID                          11138099
108900                          OF DCLMIN-INV                           11139099
108910                             LAST-TRX-UID                         11140099
108920                          OF DCLMIN-INV                           11141099
108930                                                                  11142099
108940     MOVE 'CNV'           TO LAST-TRX-CODE                        11143099
108950                          OF DCLMIN-INV                           11144099
108960***FIX0928                                                        11145099
108970**   MOVE 'AP'            TO MIN-STATUS                           11146099
108980                                                                  11147099
108990*----based on status of eTNI CTN, change its MIN status-----------11148099
109000                                                                  11149099
109010*  JA0212 -  Removed:                                             11150099
109020*  JA0112 -  Old  Status,  is  From  CTNIN  File                  11151099
109030                                                                  11152099
109040*****MOVE  WS-CTNIN-CTN-STATUS  TO  WS-CHECK-OLD-CTN-STATUS       11153099
109050                                                                  11154099
109060     IF WS-CHECK-OLD-CTN-STATUS = 'AI'  OR  'NF'                  11155099
109070        MOVE 'AP' TO MIN-STATUS OF DCLMIN-INV                     11156099
109080     END-IF                                                       11157099
109090     IF WS-CHECK-OLD-CTN-STATUS = 'AG' OR 'AR' OR 'AT'            11158099
109100        MOVE 'AI' TO MIN-STATUS OF DCLMIN-INV                     11159099
109110     END-IF                                                       11160099
109120     IF WS-CHECK-OLD-CTN-STATUS = 'AA'  OR  'PA'                  11161099
109130**  JA0507 - above 1 line: added "PA"                             11162099
109140        MOVE 'AM' TO MIN-STATUS OF DCLMIN-INV                     11163099
109150     END-IF                                                       11164099
109160***  IF WS-CHECK-OLD-CTN-STATUS = 'NA' OR 'NH'  OR 'NF'           11165099
109170                                                                  11166099
109180     IF WS-CHECK-OLD-CTN-STATUS = 'NA' OR 'NH'                    11167099
109190        MOVE 'AA' TO MIN-STATUS OF DCLMIN-INV                     11168099
109200     END-IF                                                       11169099
109210                                                                  11170099
109220*  JA1211 -  Old  'AI'  will become 'AP' Min's  - Commented  Out  11171099
109230*----added 4/20/04: AGB----------------------                     11172099
109240**   IF WS-CHECK-OLD-CTN-STATUS = 'AI' AND                        11173099
109250**      WS-CHECK-OLD-PORT-IND = 'PI'                              11174099
109260**      MOVE 'AP' TO MIN-STATUS OF DCLMIN-INV                     11175099
109270**   END-IF                                                       11176099
109280                                                                  11177099
109290     PERFORM 7820-UPDATE-MIN-INV THRU 7820-EXIT                   11178099
109300     .                                                            11179099
109310 2185-EXIT.                                                       11180099
109320     EXIT.                                                        11181099
109330                                                                  11182099
109340*   ___________________________________________________________   11183099
109350*   |  UPDATE MIN-INV STATUS FOR N*E*W MIN NUM (Biller's MIN) |   11184099
109360*   |  (when there's a match on Biller/eTNI CTN)              |   11185099
109370*   |_________________________________________________________|   11186099
109380                                                                  11187099
109390 2190-UPD-NEW-MIN-NUM-STAT.                                       11188099
109400******************************************************************11189099
109410*                                                                 11190099
109420*   PARAGRAPH NAME:  2190-UPD-NEW-MIN-NUM-STAT                    11191099
109430*                                                                 11192099
109440*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   11193099
109450*             NEW MIN                                             11194099
109460*                                                                 11195099
109470******************************************************************11196099
109480     MOVE '2190-UPD-NEW-MIN-NUM-STAT' TO WS-CURR-PARA             11197099
109490     IF (WS-TEMP-MIN-NUM      = SPACES OR LOW-VALUES OR           11198099
109500                                ZEROES OR HIGH-VALUES)            11199099
109510         OR                                                       11200099
109520        (WS-TEMP-MIN-NUM-TEXT = SPACES OR LOW-VALUES OR           11201099
109530                                ZEROES OR HIGH-VALUES)            11202099
109540        GO TO 2190-EXIT                                           11203099
109550     END-IF                                                       11204099
109560                                                                  11205099
109570* RETRIEVE MIN NUMBER FROM MIN-INV                                11206099
109580*----using MIN from CTN-INV input file, find in MIN-INV-----------11207099
109590     UNSTRING WS-TEMP-MIN-NUM-TEXT                                11208099
109600              DELIMITED BY SPACE                                  11209099
109610              INTO         MIN-NUM-TEXT OF DCLMIN-INV             11210099
109620              DELIMITER IN WS-DELIMITER                           11211099
109630              COUNT     IN MIN-NUM-LEN  OF DCLMIN-INV             11212099
109640     END-UNSTRING                                                 11213099
109650     PERFORM 7810-SELECT-MIN-INV THRU 7810-EXIT                   11214099
109660*----not found in MIN-INV? Print an error message and exit--------11215099
109670     IF SQL-ROW-NOT-FOUND                                         11216099
109680        ADD   +1 TO WS-TOTL-ERROR-MIN-NUM-NOTFND-S                11217099
109690        SET   WS-ERROR-FIELDS-FOUND  TO   TRUE                    11218099
109700        MOVE  LIT-MIN-NUM-NOTFND-S   TO   WS-COMMENT              11219099
109710        MOVE  WS-TEMP-MIN-NUM-TEXT   TO   WS-ADDTL-INFO (1:10)    11220099
109720        GO TO 2190-EXIT                                           11221099
109730     END-IF                                                       11222099
109740                                                                  11223099
109750* UPDATE MIN STATUS                                               11224099
109760     MOVE WS-TIMESTAMP    TO SYS-UPDATE-DATE                      11225099
109770                          OF DCLMIN-INV                           11226099
109780                             LAST-TRX-DATE                        11227099
109790                          OF DCLMIN-INV                           11228099
109800     MOVE LIT-OPERATOR-ID TO OPERATOR-ID                          11229099
109810                          OF DCLMIN-INV                           11230099
109820                             LAST-TRX-UID                         11231099
109830                          OF DCLMIN-INV                           11232099
109840     EVALUATE WS-NEW-STATUS                                       11233099
109850         WHEN 'NA'                                                11234099
109860         WHEN 'NH'                                                11235099
109870              MOVE 'AA' TO MIN-STATUS                             11236099
109880                        OF DCLMIN-INV                             11237099
109890         WHEN 'AI'                                                11238099
109900         WHEN 'AG'                                                11239099
109910         WHEN 'AR'                                                11240099
109920         WHEN 'AT'                                                11241099
109930*-------------commented out references to Port-IND 1/30/04------- 11242099
109940*********     IF WS-OLD-PORT-IND = 'RE'                           11243099
109950              MOVE 'AI' TO MIN-STATUS OF DCLMIN-INV               11244099
109960*********     ELSE                                                11245099
109970*********        GO TO 2190-EXIT                                  11246099
109980*********     END-IF                                              11247099
109990         WHEN 'AA'                                                11248099
110000         WHEN 'PA'                                                11249099
110010**  JA0507  -  ABOVE  1  LINE  ADDED  'PA'                        11250099
110020*********     IF WS-OLD-PORT-IND = 'RE'                           11251099
110030              MOVE 'AM' TO MIN-STATUS OF DCLMIN-INV               11252099
110040         WHEN OTHER                                               11253099
110050              GO TO 2190-EXIT                                     11254099
110060     END-EVALUATE                                                 11255099
110070                                                                  11256099
110080     PERFORM 7820-UPDATE-MIN-INV THRU 7820-EXIT                   11257099
110090                                                                  11258099
110100     .                                                            11259099
110110 2190-EXIT.                                                       11260099
110120     EXIT.                                                        11261099
110130                                                                  11262099
110140 2200-MDN-NOT-IN-ETNI.                                            11263099
110150******************************************************************11264099
110160*                                                                 11265099
110170*   PARAGRAPH NAME:  2200-MDN-NOT-IN-ETNI                         11266099
110180*                                                                 11267099
110190*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO  Process          11268099
110200*                                                MDNIN (BILL)     11269099
110210******************************************************************11270099
110220     INITIALIZE CTN-HAS-VZW-SPID  ALLOW-PORT-IND-CHG              11271099
110230                GATEWAY-INTRASERV-PORT                            11272099
110240                PORT-IND-IS-THE-ONLY-CHANGE                       11273099
110250                WS-OWNERSHIP-VARIABLES                            11274099
110260                NH-AND-PENDDASG-R-FLAG                            11275099
110270                NH-AND-OTHER-PENDING-FLAG                         11276099
110280                MDN-NOT-IN-BILL-FLAG                              11277099
110290                WS-4G-DETAIL-LINE                                 11278099
110300*  JA0612  -                                                      11279099
110310                    MODIFIED-MIN-STATUS                           11280099
066060*  JA0912  -                                                      11281099
066070                    WS-NEW-STATUS                                 11282099
066070                    WS-OLD-STATUS                                 11283099
110320                                                                  11284099
110330     MOVE '2200-MDN-NOT-IN-ETNI' TO WS-CURR-PARA                  11285099
110340     MOVE 'Y' TO MDN-NOT-IN-ETNI-FLAG                             11286099
110350                                                                  11287099
110360*BYPASS MDN TRAILER RECORD                                        11288099
110370     IF WS-MDNIN-TRAILER                                          11289099
110380        DISPLAY ' '                                               11290099
110390        DISPLAY 'LOCAL BILLING SYSTEM MDN FILE TRAILER: '         11291099
110400        DISPLAY '   RECORD COUNT: ' MDNIN-RECORD-COUNT            11292099
110410        GO TO 2200-EXIT                                           11293099
110420     END-IF                                                       11294099
110430                                                                  11295099
110440*PROCESS RECORD                                                   11296099
110450     ADD     +1 TO WS-TOTL-BILL-NOT-IN-ETNI-CNT                   11297099
110460     SET           WS-REC-BILL-NOT-IN-ETNI TO TRUE                11298099
110470                                                                  11299099
110480     MOVE  SPACES TO WS-ERROR-FIELDS-SW                           11300099
110490                     WS-COMMENT                                   11301099
110500                     WS-ADDTL-INFO                                11302099
110510* BYPASS NEW TRANSACTIONS                                         11303099
110520                                                                  11304099
110530*----AGB 5/08/06--------------------------------------------------11305099
110540     IF MDNIN-LAST-TRX-DATE > WS-HDR-DATE-TIME-MINUS-1DAY         11306099
110550        ADD +1 TO WS-TOTL-BILL-NOT-IN-ETNI-NEW                    11307099
110560        MOVE '003' TO WS-ERROR4-REASON                            11308099
110570        PERFORM 8878-WRITE-NOT-PROCESSED-FILE THRU 8878-EXIT      11309099
110580        GO TO 2200-EXIT                                           11310099
110590     END-IF                                                       11311099
110600                                                                  11312099
110610                                                                  11313099
110620* BYPASS  Recently  Updated   CTN-INV  Rows                       11314099
110630                                                                  11315099
110640**  JA0602  -  Below  Code  Upto  Cond.  Check                    11316099
110650                                                                  11317099
110660     MOVE  WS-MATCH-KEY-BILL(1:10)  TO  WS-CTN-CHECK              11318099
110670                                                                  11319099
110680     INITIALIZE  WS-CTN-INV-NEW-COUNT                             11320099
110690                                                                  11321099
110700     PERFORM  7091-CHECK-CTN-INV  THRU  7091-EXIT                 11322099
110710                                                                  11323099
110720     IF  WS-CTN-INV-NEW-COUNT  >  0                               11324099
110730         GO  TO  2200-EXIT                                        11325099
110740     END-IF                                                       11326099
110750                                                                  11327099
110760* JA1011  -  VTS  Processing                                      11328099
110770                                                                  11329099
110780     SET  NOT-VTS-MDN  TO  TRUE                                   11330099
110790     SET  WS-VTS-PROCESSED-NOT  TO  TRUE                          11331099
110800     PERFORM  WITH  TEST  BEFORE                                  11332099
110810              VARYING  WS-SUB-VTS-NL FROM +1 BY  +1               11333099
110820                 UNTIL  VTS-MDN                                   11334099
110830                 OR                                               11335099
110840                 WS-SUB-VTS-NL      >   WS-SUB-VTS-NL-MAX         11336099
110850        IF  WS-VTS-NL  (WS-SUB-VTS-NL) =  MDNIN-NL                11337099
110860            SET  VTS-MDN  TO  TRUE                                11338099
110870        END-IF                                                    11339099
110880     END-PERFORM                                                  11340099
110890                                                                  11341099
110900     IF  VTS-MDN                                                  11342099
110910         MOVE  MDNIN-MDN(1:10)  TO  MDNIN-MIN-NUM                 11343099
110920         PERFORM  2200-VTS-NIE    THRU  2200-VTS-NIE-EXIT         11344099
110930         GO  TO   2200-EXIT                                       11345099
110940     END-IF                                                       11346099
110950                                                                  11347099
110960* JA0412  -  5XX  Processing                                      11348099
110970                                                                  11349099
110980     SET  NOT-5XX-MDN  TO  TRUE                                   11350099
110990     SET  WS-5XX-PROCESSED-NOT  TO  TRUE                          11351099
111000     PERFORM  WITH  TEST  BEFORE                                  11352099
111010              VARYING  WS-SUB-5XX-NL FROM +1 BY  +1               11353099
111020                 UNTIL  5XX-MDN                                   11354099
111030                 OR                                               11355099
111040                 WS-SUB-5XX-NL      >   WS-SUB-5XX-NL-MAX         11356099
111050        IF  WS-5XX-NL  (WS-SUB-5XX-NL) =  MDNIN-NL                11357099
111060            SET  5XX-MDN  TO  TRUE                                11358099
111070        END-IF                                                    11359099
111080     END-PERFORM                                                  11360099
111090                                                                  11361099
111100     IF  5XX-MDN                                                  11362099
111110         MOVE  MDNIN-MDN(1:10)  TO  MDNIN-MIN-NUM                 11363099
111120         PERFORM  2200-5XX-NIE    THRU  2200-5XX-NIE-EXIT         11364099
111130         GO  TO   2200-EXIT                                       11365099
111140     END-IF                                                       11366099
111150                                                                  11367099
111160**   JA0809  - Start  -                                           11368099
111170                                                                  11369099
111180**--------------------------------------------------------------- 11370099
111190**  VISION  Transaction, Update Mode  &  Matching  CTN-Status     11371099
111200**          then,  Error  Out  Transaction                        11372099
111210**--------------------------------------------------------------- 11373099
111220                                                                  11374099
111230     IF  WS-VISION  AND                                           11375099
111240         WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA       11376099
111250                                                                  11377099
111260**  LOOKUP  BYPASS,  IF  MAX  -OR-  IN  BYPASS  LIST;  BYPASS     11378099
111270                                                                  11379099
111280        PERFORM  VARYING   WS-CTN-STATUS-V-A-IDX                  11380099
111290                   FROM  1  BY  1                                 11381099
111300                   UNTIL  WS-CTN-STATUS-V-A-IDX  >                11382099
111310                          WS-CTN-STATUS-V-A-IDX-MAX               11383099
111320          OR                                                      11384099
111330                                                                  11385099
111340          WS-ETNBC16-V-BILL-ARAY-F-T(WS-CTN-STATUS-V-A-IDX)(3:2)  11386099
111350                       =                                          11387099
111360          MDNIN-MDN-STATUS                                        11388099
111370                                                                  11389099
111380        END-PERFORM                                               11390099
111390                                                                  11391099
111400          IF  WS-CTN-STATUS-V-A-IDX  >                            11392099
111410              WS-CTN-STATUS-V-A-IDX-MAX                           11393099
111420              CONTINUE                                            11394099
111430             ELSE                                                 11395099
111440                                                                  11396099
111450**  Determine,  If  this  is  a  Error  Candidate  -              11397099
111460                                                                  11398099
111470             PERFORM 7050-GET-CTN-INV-BILLER THRU 7050-EXIT       11399099
111480                                                                  11400099
111490        IF  SQLCODE  =  0                                         11401099
111500                                                                  11402099
111510         IF  SEARCH-BILLER-ID-NI  =  0                            11403099
111520           IF  SEARCH-BILLER-ID  NOT  =  WS-CHECK-BILLER-ID       11404099
111530              IF  SEARCH-CTN-STATUS   =                           11405099
111540                  WS-ETNBC16-V-BILL-ARAY-F-T                      11406099
111550                                      (WS-CTN-STATUS-V-A-IDX)(1:2)11407099
111560                                                                  11408099
111570                  MOVE  WS-ETNBC16-V-BILL-ARAY-F-T                11409099
111580                                (WS-CTN-STATUS-V-A-IDX)(1:4)  TO  11410099
111590                        LIT-V-TO-V-STATUS-ERROR(19:4)             11411099
111600                                                                  11412099
111610                  MOVE  '-'  TO   LIT-V-TO-V-STATUS-ERROR(24:1)   11413099
111620                  MOVE  SEARCH-BILLER-ID                          11414099
111630                             TO   LIT-V-TO-V-STATUS-ERROR(25:1)   11415099
111640                                                                  11416099
111650                  SET  WS-ERROR-FIELDS-FOUND    TO TRUE           11417099
111660                  MOVE LIT-V-TO-V-STATUS-ERROR  TO WS-COMMENT     11418099
111670                  MOVE ' Not in eTNI '          TO WS-ADDTL-INFO  11419099
111680                  MOVE 'BILL' TO WS-SYSTEM                        11420099
111690                  MOVE WS-SAVE-HDR-BILLER-ID  TO  WS-BILLER-ID    11421099
111700                  PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT11422099
111710                  PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT11423099
111720                                                                  11424099
111730                   IF  WS-4G-DETAIL-LINE  >  ' '                  11425099
111740                       MOVE  WS-4G-DETAIL-LINE  TO  DETAIL-LINE-1 11426099
111750                       PERFORM  6500-WRITE-ERROR-RPT              11427099
111760                                            THRU  6500-EXIT       11428099
111770                   END-IF                                         11429099
111780                                                                  11430099
111790                  GO TO 2200-EXIT                                 11431099
111800              END-IF                                              11432099
111810           END-IF                                                 11433099
111820          END-IF                                                  11434099
111830        END-IF                                                    11435099
111840       END-IF                                                     11436099
111850                                                                  11437099
111860     END-IF                                                       11438099
111870                                                                  11439099
111880*---New Logic 11/23/04: To prevent adding back Biller record------11440099
111890*---which has just been offloaded to eTNI History by pgm ETNSC21--11441099
111900*---(Override Aging), for every "In Biller/not in eTNI" MDN being-11442099
111910*---processed, need to check CTN-INV-HISTORY's most recent row----11443099
111920*---for this MDN. If its LAST-TRX-DATE is within 24 hours of the--11444099
111930*---Biller's Header Date, do NOT process this Biller's MDN. We----11445099
111940*---do NOT want it to be re-added back to eTNI's CTN-INV!---------11446099
111950     MOVE WS-MATCH-KEY-BILL(1:10) TO WS-MDN-HISTORY               11447099
111960     PERFORM 7090-CHECK-FOR-OVRRIDE-AGING THRU 7090-EXIT          11448099
111970     IF IS-THIS-RECENT-HISTORY = 'Y'                              11449099
111980        GO TO 2200-EXIT                                           11450099
111990     END-IF                                                       11451099
112000                                                                  11452099
112010* -------------------------------------------------------------*  11453099
112020*IR#071503 BEG KIN                                                11454099
112030* PROHIBIT RSS UPDATE PROCESS WHEN BILLER-ID EQUAL TO THE         11455099
112040*          NL FIRST CHARACTER FROM THE HEADER.....                11456099
112050*  JA0410  - Added  Perm Reserve  NL(2:1) = H..Below              11457099
112060                                                                  11458099
112070     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        11459099
112080*-------port-outs have spaces in NL, so only compare NLs 1st byte-11460099
112090*-------to Biller from Header if the NL is populated!-------------11461099
112100        IF MDNIN-NL OF WS-MDNIN-RECORD(1:1) NOT = SPACE AND       11462099
112110           MDNIN-NL OF WS-MDNIN-RECORD(1:1) NOT = LOW-VALUES AND  11463099
112120           MDNIN-NL OF WS-MDNIN-RECORD(1:1) NOT =                 11464099
112130                       WS-SAVE-HDR-BILLER-ID  AND                 11465099
112140           MDNIN-NL OF WS-MDNIN-RECORD(2:1) NOT =  'H'            11466099
112150           ADD  +1 TO WS-TOTL-ERROR-RSS-BILL-NL-BYP               11467099
112160           MOVE MDNIN-NL OF WS-MDNIN-RECORD TO LIT-RSS-NL         11468099
112170           MOVE WS-SAVE-HDR-BILLER-ID TO LIT-RSS-BILLER           11469099
112180           MOVE LIT-RSS-NL-1ST-TO-BILL-ID TO WS-COMMENT           11470099
112190**         INITIALIZE WS-ADDTL-INFO                               11471099
112200           MOVE ' Not in eTNI '          TO WS-ADDTL-INFO         11472099
112210           PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT       11473099
112220           PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT       11474099
112230                                                                  11475099
112240            IF  WS-4G-DETAIL-LINE  >  ' '                         11476099
112250                MOVE  WS-4G-DETAIL-LINE  TO  DETAIL-LINE-1        11477099
112260                PERFORM  6500-WRITE-ERROR-RPT  THRU  6500-EXIT    11478099
112270            END-IF                                                11479099
112280                                                                  11480099
112290           GO TO 2200-EXIT                                        11481099
112300           END-IF                                                 11482099
112310      END-IF                                                      11483099
112320*IR#071503 END KIN                                                11484099
112330                                                                  11485099
112340* PROCESS RECORD                                                  11486099
112350     ADD +1 TO WS-TOTL-BILL-NOT-IN-ETNI-PROC                      11487099
112360                                                                  11488099
112370* REFORMAT BILL LAST TRANSACTION DATE                             11489099
112380     PERFORM 2020-CONVERT-BILL-DATE THRU 2020-EXIT                11490099
112390                                                                  11491099
112400*----The input eTNI CTN-INV fields are considered the "old" ones.-11492099
112410*----In this case spaces, because eTNI's CTN was not found--------11493099
112420     MOVE    WS-SAVE-HDR-BILLER-ID     TO WS-BILLER-ID            11494099
112430     MOVE    SPACES                    TO WS-OLD-MIN-NUM          11495099
112440                                          WS-OLD-STATUS           11496099
112450                                          WS-OLD-PRODUCT-TYPE     11497099
112460                                          WS-OLD-NL               11498099
112470                                          WS-OLD-NGP              11499099
112480                                          WS-OLD-PORT-IND         11500099
112490                                                                  11501099
112500*----the input Biller file fields are considered the "new" ones---11502099
112510     MOVE    MDNIN-MIN-NUM             TO WS-NEW-MIN-NUM          11503099
112520     MOVE    MDNIN-MDN-STATUS          TO WS-NEW-STATUS           11504099
112530     MOVE    MDNIN-PRODUCT-TYPE        TO WS-NEW-PRODUCT-TYPE     11505099
112540     MOVE    MDNIN-NL                  TO WS-NEW-NL               11506099
112550     MOVE    MDNIN-NGP                 TO WS-NEW-NGP              11507099
112560     MOVE    MDNIN-PORT-IND            TO WS-NEW-PORT-IND         11508099
112570     MOVE    MDNIN-LAST-TRX-CODE       TO WS-TRANS-CODE           11509099
112580                                                                  11510099
112590*----The biller RSS provides a Product Type, but it is often------11511099
112600*----inaccurate. To find the correct one for this MDN, do a search11512099
112610*----in MARKET-NPA-NXX-LR table. If not found there we assume that11513099
112620*----this MDN is a Port-In and just use the Product Type contained11514099
112630*----in the Biller's input file-----------------------------------11515099
112640                                                                  11516099
112650**   JA0402E - Below  Cond                                        11517099
112660*****IF WS-SAVE-HDR-BILLER-ID = 'R'                               11518099
112670                                                                  11519099
112680     IF  WS-LEGIT-BILLER-ID-RESELLER                              11520099
112690        PERFORM 7008-GET-PRODTYPE-FROM-MARKET THRU 7008-EXIT      11521099
112700        MOVE PRODUCT-TYPE OF DCLMARKET-NPA-NXX-LR TO              11522099
112710             MDNIN-PRODUCT-TYPE  WS-NEW-PRODUCT-TYPE              11523099
112720     END-IF                                                       11524099
112730                                                                  11525099
112740                                                                  11526099
112750**  JA0602  - START                                               11527099
112760**                                                                11528099
112770**       VISION  Transactions  will possibly be "HUB" type        11529099
112780**                                                                11530099
112790****                                                              11531099
112800**                                                                11532099
112810     IF  WS-VISION                                                11533099
112820       IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA      11534099
112830**       PERFORM  7036-IS-IT-A-BILLING-HUB    THRU  7036-EXIT     11535099
112840                                                                  11536099
112850           IF  WS-ERROR-FIELDS-FOUND                              11537099
112860              GO  TO  2200-EXIT                                   11538099
112870           END-IF                                                 11539099
112880                                                                  11540099
112890         IF  WS-HUB-BILL                                          11541099
112900                                                                  11542099
112910**  LOOKUP  BYPASS,  IF  MAX  -OR-  IN  BYPASS  LIST;  BYPASS     11543099
112920                                                                  11544099
112930             PERFORM  VARYING   WS-CTN-STATUS-B-A-IDX             11545099
112940                      FROM  1  BY  1                              11546099
112950                      UNTIL  WS-CTN-STATUS-B-A-IDX  >             11547099
112960                             WS-CTN-STATUS-B-A-IDX-MAX            11548099
112970            OR                                                    11549099
112980            WS-ETNBC16-NOT-IN-ETNI-ARRAY-L                        11550099
112990                                          (WS-CTN-STATUS-B-A-IDX) 11551099
113000                       =                                          11552099
113010            MDNIN-MDN-STATUS                                      11553099
113020                                                                  11554099
113030            END-PERFORM                                           11555099
113040                                                                  11556099
113050         END-IF                                                   11557099
113060       END-IF                                                     11558099
113070     END-IF                                                       11559099
113080**                                                                11560099
113090     IF  WS-VISION                                                11561099
113100       IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA      11562099
113110         IF  WS-HUB-BILL                                          11563099
113120             IF  MDNIN-MDN-STATUS    =                            11564099
113130                 WS-ETNBC16-NOT-IN-ETNI-ARRAY-L                   11565099
113140                        (WS-CTN-STATUS-B-A-IDX)                   11566099
113150****                                                              11567099
113160****  BYPASS  MATCHING  MDNIN-MDN-STATUS                          11568099
113170****                                                              11569099
113180                GO TO 2200-CONTINUE                               11570099
113190                                                                  11571099
113200                 ELSE                                             11572099
113210**                                                                11573099
113220               IF  MDNIN-PORT-IND  =  'PI'                        11574099
113230                                                                  11575099
113240                 PERFORM  11000-ATTEMPT-ADD-TO-ETNI   THRU        11576099
113250                          11000-EXIT                              11577099
113260                                                                  11578099
113270               IF  NOT  WS-ERROR-FIELDS-FOUND                     11579099
113280                 PERFORM  6000-MOVE-BILL-TO-RPT-HUB   THRU        11580099
113290                          6000-EXIT-HUB                           11581099
113300                 PERFORM  6401-WRITE-RECON-RPT-HUB    THRU        11582099
113310                          6401-EXIT                               11583099
113320                 PERFORM  6011-MOVE-ETNI-TO-RPT-FROM-CTN  THRU    11584099
113330                          6011-EXIT                               11585099
113340                 PERFORM  6401-WRITE-RECON-RPT-HUB    THRU        11586099
113350                          6401-EXIT                               11587099
113360                 GO  TO   2200-CONTINUE                           11588099
113370                ELSE                                              11589099
113380                 GO  TO   2200-CONTINUE                           11590099
113390               END-IF                                             11591099
113400                                                                  11592099
113410                ELSE                                              11593099
113420                                                                  11594099
113430                 ADD  1  TO  WS-TOTL-NOT-IN-ETNI                  11595099
113440                 MOVE  LIT-NOT-IN-ETNI  TO  WS-COMMENT            11596099
113450                 MOVE 'BILL' TO WS-SYSTEM                         11597099
113460                 PERFORM  6000-MOVE-BILL-TO-RPT-HUB  THRU         11598099
113470                          6000-EXIT-HUB                           11599099
113480                 PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU         11600099
113490                          6510-EXIT                               11601099
113500                 PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT11602099
113510                 PERFORM  6500-WRITE-ERROR-RPT THRU 6500-EXIT     11603099
113520                                                                  11604099
113530                 IF  WS-4G-DETAIL-LINE  >  ' '                    11605099
113540                     MOVE  WS-4G-DETAIL-LINE  TO  DETAIL-LINE-1   11606099
113550                     PERFORM  6500-WRITE-ERROR-RPT                11607099
113560                                                  THRU  6500-EXIT 11608099
113570                 END-IF                                           11609099
113580                                                                  11610099
113590                 GO  TO   2200-EXIT                               11611099
113600                 END-IF                                           11612099
113610             END-IF                                               11613099
113620         END-IF                                                   11614099
113630       END-IF                                                     11615099
113640     END-IF                                                       11616099
113650                                                                  11617099
113660**  JA1011                                                        11618099
113670                                                                  11619099
113680     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        11620099
113690        IF  WS-LEGIT-BILLER-ID-RESELLER                           11621099
113700            PERFORM  7000-SELECT-CTN-INV  THRU  7000-EXIT         11622099
113710            IF  SQLCODE  =  +0  AND                               11623099
113720                CTN-STATUS  OF  DCLCTN-INV  =  'NH'               11624099
113730                ADD     +1 TO WS-TOTL-BILL-ETNI-MATCH-NH          11625099
113740                MOVE    'BILL'                     TO WS-SYSTEM   11626099
113750                MOVE    LIT-BILL-ETNINH-ERROR      TO WS-COMMENT  11627099
113760                MOVE ' Not in eTNI '            TO WS-ADDTL-INFO  11628099
113770                PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT  11629099
113780                PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT       11630099
113790                GO  TO  2200-EXIT                                 11631099
113800            END-IF                                                11632099
113810        END-IF                                                    11633099
113820     END-IF                                                       11634099
113830                                                                  11635099
113840**                                                                11636099
113850**  JA1011   -  END                                               11637099
113860**                                                                11638099
113870                                                                  11639099
113880**  JA0312A  -  New  Edit                                         11640099
113890**                                                                11641099
113900**   Biller  ID   Swap  For  VISION  (V to V)                     11642099
113910**                                                                11643099
113920     IF MDNIN-NL NOT = SPACE AND MDNIN-NL NOT = LOW-VALUES        11644099
113930        PERFORM 7050-GET-CTN-INV-BILLER THRU 7050-EXIT            11645099
113940                                                                  11646099
113950        IF SEARCH-BILLER-ID NOT = SPACE AND                       11647099
113960           SEARCH-BILLER-ID NOT = MDNIN-NL(1:1)                   11648099
113970         IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA    11649099
113980           MOVE  SEARCH-BILLER-ID  TO  WS-RESELLER-FLAG           11650099
113990           IF WS-VISION  AND                                      11651099
114000                               NOT    WS-RESELLER-TRUE  AND       11652099
114010              SEARCH-BILLER-ID NOT =  WS-WHICH-BILLER-ID          11653099
114020**  JA0312A  -                                                    11654099
114030            IF  SEARCH-NL(2:1)  =  'H'                            11655099
114040             MOVE    'BILL'                     TO WS-SYSTEM      11656099
114050             MOVE    ' V to V-ERR, Failed *'  TO  WS-COMMENT      11657099
114060                MOVE SPACES                     TO WS-ADDTL-INFO  11658099
114070                MOVE 'CTN:'            TO WS-ADDTL-INFO(1:4)      11659099
114080                MOVE SEARCH-BILLER-ID  TO WS-ADDTL-INFO(6:1)      11660099
114090                MOVE SEARCH-NL   TO WS-ADDTL-INFO(8:5)            11661099
114100                PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT  11662099
114110                PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT       11663099
114120              GO  TO  2200-EXIT                                   11664099
114130            END-IF                                                11665099
114140          END-IF                                                  11666099
114150        END-IF                                                    11667099
114160      END-IF                                                      11668099
114170     END-IF                                                       11669099
114180                                                                  11670099
114190**  JA0312A  -  New  Edit                                         11671099
057270*   JA1012  -  Below  Comment  VRTEL                              11672099
114180                                                                  11673099
114200     IF MDNIN-NL NOT = SPACE AND MDNIN-NL NOT = LOW-VALUES        11674099
114210        PERFORM 7050-GET-CTN-INV-BILLER THRU 7050-EXIT            11675099
114220                                                                  11676099
114230        IF SEARCH-BILLER-ID NOT = SPACE AND                       11677099
114240           SEARCH-BILLER-ID NOT = MDNIN-NL(1:1)                   11678099
114250         IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA    11679099
114260           MOVE  SEARCH-BILLER-ID  TO  WS-RESELLER-FLAG           11680099
114270           IF WS-VISION  AND   NOT    WS-RESELLER-TRUE  AND       11681099
114280              SEARCH-BILLER-ID NOT =  WS-WHICH-BILLER-ID          11682099
114290           IF  SEARCH-NL(2:4)      =  'RTEL'                      11683099
114290******     IF  SEARCH-NL           =  'VRTEL'                     11684099
114300            MOVE    'BILL'                     TO WS-SYSTEM       11685099
114310            MOVE    ' V to V-ERR, Failed *'  TO  WS-COMMENT       11686099
114320                MOVE SPACES                     TO WS-ADDTL-INFO  11687099
114330                MOVE 'CTN:'            TO WS-ADDTL-INFO(1:4)      11688099
114340                MOVE SEARCH-BILLER-ID  TO WS-ADDTL-INFO(6:1)      11689099
114350                MOVE SEARCH-NL   TO WS-ADDTL-INFO(8:5)            11690099
114360                PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT  11691099
114370                PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT       11692099
114380           GO  TO  2200-EXIT                                      11693099
114390           END-IF                                                 11694099
114400          END-IF                                                  11695099
114410         END-IF                                                   11696099
114420       END-IF                                                     11697099
114430     END-IF                                                       11698099
114440                                                                  11699099
114450**                                                                11700099
114460                                                                  11701099
114470**                                                                11702099
114480**  JA0308   - Below  Cond.   (If's / to / End-if)                11703099
114490**   Biller  ID   Swap  From  VISION  to  RSS                     11704099
114500**     Based  Upon  RSS  Feed  Data  (V  to  R)                   11705099
114510**                                                                11706099
114520**  JA0402  -   WS-LEGIT-BILLER-ID-RESELLER Added                 11707099
114530                                                                  11708099
114540         IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA    11709099
114550           IF WS-LEGIT-BILLER-ID-RESELLER AND                     11710099
114560              SEARCH-BILLER-ID NOT =  WS-WHICH-BILLER-ID          11711099
114570                         AND                                      11712099
114580              MDNIN-MDN-STATUS     =  'PA'                        11713099
114590                         AND                                      11714099
114600             (SEARCH-CTN-STATUS    =  'AA'  OR  'NA')             11715099
114610              PERFORM  7051-SPECIAL-CTNINV-HIST-UPD  THRU         11716099
114620                       7051-EXIT                                  11717099
114630              ADD  1  TO  WS-TOTL-V-TO-R-BILLER-UPD               11718099
114640                IF  WS-PRIOR-CTN-STATUS  =  'AA'                  11719099
114650                    PERFORM 2175A-STORE-NGP-NL  THRU  2175A-EXIT  11720099
114660                END-IF                                            11721099
114670              GO  TO  2200-CONTINUE                               11722099
114680           END-IF                                                 11723099
114690         END-IF                                                   11724099
114700                                                                  11725099
114710**                                                                11726099
114720**   Biller  ID   Swap  For  VISION  (V to V)                     11727099
114730**                                                                11728099
114740     IF MDNIN-NL NOT = SPACE AND MDNIN-NL NOT = LOW-VALUES        11729099
114750        PERFORM 7050-GET-CTN-INV-BILLER THRU 7050-EXIT            11730099
114760*-------if biller was found in CTN-INV (not spaces) and is--------11731099
114770*-------different than Billing System's biller: maybe Swap time!  11732099
114780*                                                                 11733099
114790*  JA0815  - Removed  ws-rss-c  code, in favor of generic Reseller11734099
114800*             checking....                                        11735099
114810                                                                  11736099
114820        IF SEARCH-BILLER-ID NOT = SPACE AND                       11737099
114830           SEARCH-BILLER-ID NOT = MDNIN-NL(1:1)                   11738099
114840**  JA1207A  - Below  Cond.   (If's / to / End-if)                11739099
114850         IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA    11740099
114860           MOVE  SEARCH-BILLER-ID  TO  WS-RESELLER-FLAG           11741099
114870           IF WS-VISION  AND                                      11742099
114880                               NOT    WS-RESELLER-TRUE  AND       11743099
114890              SEARCH-BILLER-ID NOT =  WS-WHICH-BILLER-ID          11744099
114900              PERFORM  7051-SPECIAL-CTNINV-HIST-UPD  THRU         11745099
114910                       7051-EXIT                                  11746099
114920              GO  TO  2200-CONTINUE                               11747099
114930           END-IF                                                 11748099
114940         END-IF                                                   11749099
114950                                                                  11750099
114960**                                                                11751099
114970**  JA0308   - Below  Cond.   (If's / to / End-if)                11752099
114980**   Biller  ID   Swap  From  VISION  to  RSS                     11753099
114990**     Based  Upon  RSS  Feed  Data  (V  to  R)                   11754099
115000**                                                                11755099
115010**  JA0402  -   WS-LEGIT-BILLER-ID-RESELLER Added                 11756099
115020                                                                  11757099
115030         IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA    11758099
115040           IF WS-LEGIT-BILLER-ID-RESELLER AND                     11759099
115050              SEARCH-BILLER-ID NOT =  WS-WHICH-BILLER-ID          11760099
115060                         AND                                      11761099
115070              MDNIN-MDN-STATUS     =  'PA'                        11762099
115080                         AND                                      11763099
115090             (SEARCH-CTN-STATUS    =  'AA'  OR  'NA')             11764099
115100              PERFORM  7051-SPECIAL-CTNINV-HIST-UPD  THRU         11765099
115110                       7051-EXIT                                  11766099
115120              ADD  1  TO  WS-TOTL-V-TO-R-BILLER-UPD               11767099
115130                IF  WS-PRIOR-CTN-STATUS  =  'AA'                  11768099
115140                    PERFORM 2175A-STORE-NGP-NL  THRU  2175A-EXIT  11769099
115150                END-IF                                            11770099
115160              GO  TO  2200-CONTINUE                               11771099
115170           END-IF                                                 11772099
115180         END-IF                                                   11773099
115190                                                                  11774099
115200**  JA0308  -  Bypass  RSS, 'PA' to 'NH'; else Error Out          11775099
115210                                                                  11776099
115220**                                                                11777099
115230**  JA0402  -   WS-LEGIT-BILLER-ID-RESELLER Added                 11778099
115240                                                                  11779099
115250         IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA    11780099
115260           IF  WS-LEGIT-BILLER-ID-RESELLER AND                    11781099
115270               MDNIN-MDN-STATUS     =  'PA'                       11782099
115280               MOVE  MDNIN-MDN TO  WS-MDN                         11783099
115290               PERFORM  7000-SELECT-CTN-INV  THRU  7000-EXIT      11784099
115300               IF  SQLCODE  =  +0  AND                            11785099
115310                   CTN-STATUS  OF  DCLCTN-INV  =  'NH'            11786099
115320                   GO  TO  2200-EXIT                              11787099
115330               END-IF                                             11788099
115340           END-IF                                                 11789099
115350         END-IF                                                   11790099
115360                                                                  11791099
115370**  Continuation  of  Above  IF                                   11792099
115380                                                                  11793099
115390           ADD 1 TO WS-TOTL-ERROR-DUPE-BILLER                     11794099
115400           MOVE LIT-DUPE-BILLER-ID TO WS-COMMENT                  11795099
115410           STRING                                                 11796099
115420           'ETNI BILLER: '                    DELIMITED BY SIZE   11797099
115430           SEARCH-BILLER-ID                   DELIMITED BY SIZE   11798099
115440           INTO WS-ADDTL-INFO                                     11799099
115450           END-STRING                                             11800099
115460**  JA1207F  - Below  Modified to report on Both Billing & eTNI   11801099
115470           MOVE 'BILL' TO WS-SYSTEM                               11802099
115480           PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT       11803099
115490           PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT            11804099
115500**   JA0810 - Comment  Out  Below  Report  Lines (4 source lines) 11805099
115510**         MOVE 'ETNI' TO WS-SYSTEM                               11806099
115520**         MOVE  MDNIN-MDN  TO  WS-MDN                            11807099
115530**         PERFORM 7000-SELECT-CTN-INV       THRU 7000-EXIT       11808099
115540**         PERFORM 7054-WRITE-ERROR-RPT      THRU 7054-EXIT       11809099
115550                                                                  11810099
115560            IF  WS-4G-DETAIL-LINE  >  ' '                         11811099
115570                MOVE  WS-4G-DETAIL-LINE  TO  DETAIL-LINE-1        11812099
115580                PERFORM  6500-WRITE-ERROR-RPT  THRU  6500-EXIT    11813099
115590            END-IF                                                11814099
115600                                                                  11815099
115610           GO TO 2200-EXIT                                        11816099
115620           END-IF                                                 11817099
115630        END-IF                                                    11818099
115640                                                                  11819099
115650*=================================================================11820099
115660* VALIDATE LOCAL BILLING SYSTEM MDN FIELDS                        11821099
115670*=================================================================11822099
115680                                                                  11823099
115690* (here in 2200-MDN-NOT-IN-ETNI, the Biller is never allowed to   11824099
115700*  change eTNI's Port-Ind, so pre-set CTN-HAS-VZW-SPID to 'N'     11825099
115710*  below to disallow Biller to eTNI Port-ind updates....          11826099
115720                                                                  11827099
115730     MOVE 'N' TO CTN-HAS-VZW-SPID                                 11828099
115740     MOVE 'N' TO ALLOW-PORT-IND-CHG                               11829099
115750     PERFORM 2110-VALIDATE-BILL-MDN-FIELDS THRU 2110-EXIT         11830099
115760                                                                  11831099
115770*----after above validation, if either error found AND/OR---------11832099
115780*----Biller's Port-Ind <> eTNI's AND this CTN has a non-VZW-------11833099
115790*----SPID in the LSMS table, write to error report----------------11834099
115800     IF WS-ERROR-FIELDS-FOUND OR                                  11835099
115810     (PORT-INDS-DONT-MATCH = 'Y' AND ALLOW-PORT-IND-CHG NOT = 'Y')11836099
115820        PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT         11837099
115830        PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT         11838099
115840                                                                  11839099
115850           IF  WS-4G-DETAIL-LINE  >  ' '                          11840099
115860               MOVE  WS-4G-DETAIL-LINE  TO  DETAIL-LINE-1         11841099
115870               PERFORM  6500-WRITE-ERROR-RPT  THRU  6500-EXIT     11842099
115880           END-IF                                                 11843099
115890                                                                  11844099
115900     END-IF                                                       11845099
115910                                                                  11846099
115920*----if errors found, exit routine. Otherwise, if Port-Ind--------11847099
115930*----mismatch, keep going and write to Recon report---------------11848099
115940     IF WS-ERROR-FIELDS-FOUND                                     11849099
115950        GO TO 2200-EXIT                                           11850099
115960     END-IF                                                       11851099
115970                                                                  11852099
115980* REPORT LOCAL BILLING SYSTEM MDN FIELDS                          11853099
115990     MOVE   'BILL'                         TO   WS-SYSTEM         11854099
116000     MOVE SPACES                           TO   WS-COMMENT        11855099
116010                                                WS-ADDTL-INFO     11856099
116020     PERFORM 6000-MOVE-BILL-MDN-TO-RPT     THRU 6000-EXIT         11857099
116030     PERFORM 6400-WRITE-RECON-RPT          THRU 6400-EXIT         11858099
116040                                                                  11859099
116050* INSERT PROCESS                                                  11860099
116060     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        11861099
116070                                                                  11862099
116080*----below is a special version of 2180-UPDATE-MIN-INV-STATUS-----11863099
116090*----that's used ONLY when MDN exists in Biller and not in eTNI.--11864099
116100*----It assumes eTNI fields are spaces and doesn't test them.-----11865099
116110                                                                  11866099
116120        PERFORM 2183-UPDATE-MIN-INV-STATUS    THRU 2183-EXIT      11867099
116130                                                                  11868099
116140*----since this subroutine executes only when the CTN exists in---11869099
116150*----the Biller file but NOT in eTNI, we've got to equalize the---11870099
116160*----two systems by inserting Biller's CTN into eTNI's CTN-INV----11871099
116170                                                                  11872099
116180        PERFORM 2220-POPULATE-CTN             THRU 2220-EXIT      11873099
116190        PERFORM 7020-INSERT-CTN-INV           THRU 7020-EXIT      11874099
116200        IF SQL-DUP-INSERT                                         11875099
116210           PERFORM 6030-INIT-DETAIL-LINE      THRU 6030-EXIT      11876099
116220           PERFORM 6400-WRITE-RECON-RPT       THRU 6400-EXIT      11877099
116230           MOVE   'BILL'                      TO   WS-SYSTEM      11878099
116240           MOVE  LIT-CTN-INV-INSERT-ERROR-NIE TO   WS-COMMENT     11879099
116250           MOVE    CTN-TEXT     OF DCLCTN-INV                     11880099
116260                                          TO WS-ADDTL-INFO (1:10) 11881099
116270           MOVE    PRODUCT-TYPE OF DCLCTN-INV                     11882099
116280                                          TO WS-ADDTL-INFO (12:1) 11883099
116290           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      11884099
116300           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      11885099
116310                                                                  11886099
116320           IF  WS-4G-DETAIL-LINE  >  ' '                          11887099
116330               MOVE  WS-4G-DETAIL-LINE  TO  DETAIL-LINE-1         11888099
116340               PERFORM  6500-WRITE-ERROR-RPT  THRU  6500-EXIT     11889099
116350           END-IF                                                 11890099
116360                                                                  11891099
116370           GO TO 2200-EXIT                                        11892099
116380        END-IF                                                    11893099
116390                                                                  11894099
116400        PERFORM 2150-UPDATE-STATUS-COUNTERS   THRU 2150-EXIT      11895099
116410        IF WS-ERROR-FIELDS-FOUND                                  11896099
116420           MOVE   'BILL'                      TO   WS-SYSTEM      11897099
116430           MOVE ' Not in eTNI '               TO   WS-ADDTL-INFO  11898099
116440           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      11899099
116450           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      11900099
116460                                                                  11901099
116470           IF  WS-4G-DETAIL-LINE  >  ' '                          11902099
116480               MOVE  WS-4G-DETAIL-LINE  TO  DETAIL-LINE-1         11903099
116490               PERFORM  6500-WRITE-ERROR-RPT  THRU  6500-EXIT     11904099
116500           END-IF                                                 11905099
116510                                                                  11906099
116520           GO TO 2200-EXIT                                        11907099
116530        END-IF                                                    11908099
116540                                                                  11909099
116550* REPORT UPDATED FIELDS                                           11910099
116560*        VALUE 'INSERTED:MDN NOT IN ETNI'.                        11911099
116570     IF LIT-INSERTED-COMMENT-ETNI = SPACES                        11912099
116580*IR071503 -  MOVE   'ETNI'                     TO   WS-SYSTEM     11913099
116590     MOVE   'BILL'                     TO   WS-SYSTEM             11914099
116600     MOVE    LIT-INSERTED-COMMENT-ETNI TO   WS-COMMENT            11915099
116610**   MOVE    SPACES                    TO   WS-ADDTL-INFO         11916099
116620     MOVE ' Not in eTNI '              TO   WS-ADDTL-INFO         11917099
116630     PERFORM 6020-MOVE-ETNI-TO-RPT-NEW THRU 6020-EXIT             11918099
116640     PERFORM 6400-WRITE-RECON-RPT      THRU 6400-EXIT             11919099
116650                                                                  11920099
116660* PRINT BLANK LINE                                                11921099
116670     PERFORM 6300-PRINT-BLANK-LINE     THRU 6300-EXIT             11922099
116680     .                                                            11923099
116690 2200-CONTINUE.                                                   11924099
116700                                                                  11925099
116710*-----------------------------------------------------------------11926099
116720*  JA1109  -   4G                                                 11927099
116730*           If  SIM  or  VORA  implications, then Error Out       11928099
116740*             & Continue  Processing  Normally                    11929099
116750*-----------------------------------------------------------------11930099
116760                                                                  11931099
116770     INITIALIZE  WS-LTE-DATA-LAYER                                11932099
116780                 WS-4G-DETAIL-LINE                                11933099
116790                 DETAIL-LINE-1                                    11934099
116800                 WS-4G-ERROR-SW                                   11935099
116810                 DCLSIM-INV                                       11936099
116820                 DCLVORA-IMSI-INV                                 11937099
116830                                                                  11938099
116840     IF  MDNIN-ICC-ID-4G >  ' '  OR                               11939099
116850         MDNIN-IMSI  >  ' '                                       11940099
116860         PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT            11941099
116870                                                                  11942099
116880       IF  WS-4G-ERROR-YES                                        11943099
116890           MOVE ' Not in eTNI '               TO   WS-ADDTL-INFO  11944099
116900           PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT     11945099
116910           PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT     11946099
116920           ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                      11947099
116930           PERFORM  4G-REPORT-BUILD  THRU  4G-REPORT-BUILD-EXIT   11948099
116940           MOVE  WS-4G-DETAIL-LINE  TO  DETAIL-LINE-1             11949099
116950           MOVE  LIT-SIM-VORA-ERROR  TO   DETAIL-1-COMMENT        11950099
116960           ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                      11951099
116970           PERFORM  6500-WRITE-ERROR-RPT   THRU  6500-EXIT        11952099
116980           GO  TO  2200-EXIT                                      11953099
116990       END-IF                                                     11954099
117000                                                                  11955099
117010       PERFORM  4G-REPORT-BUILD      THRU  4G-REPORT-BUILD-EXIT   11956099
117020                                                                  11957099
117030     END-IF                                                       11958099
117040     .                                                            11959099
117050 2200-EXIT.                                                       11960099
117060     EXIT.                                                        11961099
117070                                                                  11962099
117080                                                                  11963099
117090 2200-VTS-NIE.                                                    11964099
117100******************************************************************11965099
117110*                                                                 11966099
117120*     VTS  -  Not  In  eTNI  (NIE)                                11967099
117130*                                                                 11968099
117140******************************************************************11969099
117150**---------------------------------                               11970099
117160**  Layout:  of  Array                                            11971099
117170**                                                                11972099
117180**    Bill_Status    (1:2)                                        11973099
117190**    Filler         (3:2)                                        11974099
117200**    Filler         (5:1)                                        11975099
117210**                                                                11976099
117220**    Reads  Error  Out,  If  NOT  in  List                       11977099
117230**---------------------------------                               11978099
117240                                                                  11979099
117250     SET  WS-VTS-PROCESSED  TO  TRUE                              11980099
117260     PERFORM  VARYING   WS-CTN-STATUS-V-C-IDX                     11981099
117270              FROM  1  BY  1                                      11982099
117280              UNTIL  WS-CTN-STATUS-V-C-IDX  >                     11983099
117290                     WS-CTN-STATUS-V-C-IDX-MAX                    11984099
117300          OR                                                      11985099
117310       WS-BC16-VTS-NIE-PROCESS-ARAY-L                             11986099
117320                                 (WS-CTN-STATUS-V-C-IDX)(1:2)     11987099
117330                      =                                           11988099
117340       MDNIN-MDN-STATUS                                           11989099
117350                                                                  11990099
117360     END-PERFORM                                                  11991099
117370                                                                  11992099
117380     IF  WS-CTN-STATUS-V-C-IDX  >                                 11993099
117390         WS-CTN-STATUS-V-C-IDX-MAX                                11994099
117400         SET  WS-ERROR-FIELDS-FOUND    TO TRUE                    11995099
117410         MOVE LIT-STATUS-ERROR-ETNI    TO WS-COMMENT              11996099
117420**       MOVE SPACES                   TO WS-ADDTL-INFO           11997099
117430         MOVE ' Not in eTNI '          TO WS-ADDTL-INFO           11998099
117440         MOVE 'BILL' TO WS-SYSTEM                                 11999099
117450         MOVE WS-SAVE-HDR-BILLER-ID  TO  WS-BILLER-ID             12000099
117460         PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT         12001099
117470         PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT         12002099
117480         ADD   +1 TO WS-TOTL-ERROR-STATUS-INVALID                 12003099
117490         GO TO 2200-VTS-NIE-EXIT                                  12004099
117500     END-IF                                                       12005099
117510                                                                  12006099
117520**  Determine,  If  this  is  a  Error  Candidate  -              12007099
117530                                                                  12008099
117540     PERFORM 7050-GET-CTN-INV-BILLER THRU 7050-EXIT               12009099
117550                                                                  12010099
117560     MOVE WS-MATCH-KEY-BILL(1:10) TO WS-MDN-HISTORY               12011099
117570     PERFORM 7090-CHECK-FOR-OVRRIDE-AGING THRU 7090-EXIT          12012099
117580     IF IS-THIS-RECENT-HISTORY = 'Y'                              12013099
117590        GO TO 2200-VTS-NIE-EXIT                                   12014099
117600     END-IF                                                       12015099
117610                                                                  12016099
117620* PROCESS RECORD                                                  12017099
117630     ADD +1 TO WS-TOTL-BILL-NOT-IN-ETNI-PROC                      12018099
117640                                                                  12019099
117650* REFORMAT BILL LAST TRANSACTION DATE                             12020099
117660     PERFORM 2020-CONVERT-BILL-DATE THRU 2020-EXIT                12021099
117670                                                                  12022099
117680*----The input eTNI CTN-INV fields are considered the "old" ones.-12023099
117690*----In this case spaces, because eTNI's CTN was not found--------12024099
117700     MOVE    WS-SAVE-HDR-BILLER-ID     TO WS-BILLER-ID            12025099
117710     MOVE    SPACES                    TO WS-OLD-MIN-NUM          12026099
117720                                          WS-OLD-STATUS           12027099
117730                                          WS-OLD-PRODUCT-TYPE     12028099
117740                                          WS-OLD-NL               12029099
117750                                          WS-OLD-NGP              12030099
117760                                          WS-OLD-PORT-IND         12031099
117770                                                                  12032099
117780*----the input Biller file fields are considered the "new" ones---12033099
117790     MOVE    MDNIN-MIN-NUM             TO WS-NEW-MIN-NUM          12034099
117800     MOVE    MDNIN-MDN-STATUS          TO WS-NEW-STATUS           12035099
117810     MOVE    MDNIN-PRODUCT-TYPE        TO WS-NEW-PRODUCT-TYPE     12036099
117820     MOVE    MDNIN-NL                  TO WS-NEW-NL               12037099
117830     MOVE    MDNIN-NGP                 TO WS-NEW-NGP              12038099
117840     MOVE    MDNIN-PORT-IND            TO WS-NEW-PORT-IND         12039099
117850     MOVE    MDNIN-LAST-TRX-CODE       TO WS-TRANS-CODE           12040099
117860                                                                  12041099
117870*----The biller RSS provides a Product Type, but it is often------12042099
117880*----inaccurate. To find the correct one for this MDN, do a search12043099
117890*----in MARKET-NPA-NXX-LR table. If not found there we assume that12044099
117900*----this MDN is a Port-In and just use the Product Type contained12045099
117910*----in the Biller's input file-----------------------------------12046099
117920                                                                  12047099
117930**   JA0402E - Below  Cond                                        12048099
117940                                                                  12049099
117950     IF  WS-LEGIT-BILLER-ID-RESELLER                              12050099
117960        PERFORM 7008-GET-PRODTYPE-FROM-MARKET THRU 7008-EXIT      12051099
117970        MOVE PRODUCT-TYPE OF DCLMARKET-NPA-NXX-LR TO              12052099
117980             MDNIN-PRODUCT-TYPE  WS-NEW-PRODUCT-TYPE              12053099
117990     END-IF                                                       12054099
118000                                                                  12055099
118010*=================================================================12056099
118020* VALIDATE LOCAL BILLING SYSTEM MDN FIELDS                        12057099
118030*=================================================================12058099
118040                                                                  12059099
118050* (here in 2200-MDN-NOT-IN-ETNI, the Biller is never allowed to   12060099
118060*  change eTNI's Port-Ind, so pre-set CTN-HAS-VZW-SPID to 'N'     12061099
118070*  below to disallow Biller to eTNI Port-ind updates....          12062099
118080                                                                  12063099
118090     MOVE 'N' TO CTN-HAS-VZW-SPID                                 12064099
118100     MOVE 'N' TO ALLOW-PORT-IND-CHG                               12065099
118110     PERFORM 2110-VALIDATE-BILL-MDN-FIELDS THRU 2110-EXIT         12066099
118120                                                                  12067099
118130*----after above validation, if either error found AND/OR---------12068099
118140*----Biller's Port-Ind <> eTNI's AND this CTN has a non-VZW-------12069099
118150*----SPID in the LSMS table, write to error report----------------12070099
118160     IF WS-ERROR-FIELDS-FOUND OR                                  12071099
118170     (PORT-INDS-DONT-MATCH = 'Y' AND ALLOW-PORT-IND-CHG NOT = 'Y')12072099
118180        MOVE ' Not in eTNI '          TO WS-ADDTL-INFO            12073099
118190        PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT         12074099
118200        PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT         12075099
118210                                                                  12076099
118220     END-IF                                                       12077099
118230                                                                  12078099
118240*----if errors found, exit routine. Otherwise, if Port-Ind--------12079099
118250*----mismatch, keep going and write to Recon report---------------12080099
118260     IF WS-ERROR-FIELDS-FOUND                                     12081099
118270        GO TO 2200-VTS-NIE-EXIT                                   12082099
118280     END-IF                                                       12083099
118290                                                                  12084099
118300* REPORT LOCAL BILLING SYSTEM MDN FIELDS                          12085099
118310     MOVE   'BILL'                         TO   WS-SYSTEM         12086099
118320     MOVE SPACES                           TO   WS-COMMENT        12087099
118330                                                WS-ADDTL-INFO     12088099
118340     MOVE ' Not in eTNI '                  TO   WS-ADDTL-INFO     12089099
118350     PERFORM 6000-MOVE-BILL-MDN-TO-RPT     THRU 6000-EXIT         12090099
118360     PERFORM 6400-WRITE-RECON-RPT          THRU 6400-EXIT         12091099
118370                                                                  12092099
118380*----below is a special version of 2180-UPDATE-MIN-INV-STATUS-----12093099
118390*----that's used ONLY when MDN exists in Biller and not in eTNI.--12094099
118400*----It assumes eTNI fields are spaces and doesn't test them.-----12095099
118410                                                                  12096099
118420*----since this subroutine executes only when the CTN exists in---12097099
118430*----the Biller file but NOT in eTNI, we've got to equalize the---12098099
118440*----two systems by inserting Biller's CTN into eTNI's CTN-INV----12099099
118450                                                                  12100099
118460* INSERT PROCESS                                                  12101099
118470     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        12102099
118480        PERFORM 2220-POPULATE-CTN             THRU 2220-EXIT      12103099
118490        PERFORM 7020-INSERT-CTN-INV           THRU 7020-EXIT      12104099
118500        IF SQL-DUP-INSERT                                         12105099
118510           PERFORM 6030-INIT-DETAIL-LINE      THRU 6030-EXIT      12106099
118520           PERFORM 6400-WRITE-RECON-RPT       THRU 6400-EXIT      12107099
118530           MOVE   'BILL'                      TO   WS-SYSTEM      12108099
118540           MOVE    LIT-CTN-INV-INSERT-ERROR-NIE  TO   WS-COMMENT  12109099
118550           MOVE    CTN-TEXT     OF DCLCTN-INV                     12110099
118560                                          TO WS-ADDTL-INFO (1:10) 12111099
118570           MOVE    PRODUCT-TYPE OF DCLCTN-INV                     12112099
118580                                          TO WS-ADDTL-INFO (12:1) 12113099
118590           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      12114099
118600           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      12115099
118610           GO TO 2200-VTS-NIE-EXIT                                12116099
118620        END-IF                                                    12117099
118630                                                                  12118099
118640        PERFORM 2150-UPDATE-STATUS-COUNTERS   THRU 2150-EXIT      12119099
118650        IF WS-ERROR-FIELDS-FOUND                                  12120099
118660           MOVE   'BILL'                      TO   WS-SYSTEM      12121099
118670           MOVE ' Not in eTNI '               TO   WS-ADDTL-INFO  12122099
118680           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      12123099
118690           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      12124099
118700           GO TO 2200-VTS-NIE-EXIT                                12125099
118710        END-IF                                                    12126099
118720                                                                  12127099
118730* REPORT UPDATED FIELDS                                           12128099
118740*        VALUE 'INSERTED:MDN NOT IN ETNI'.                        12129099
118750     IF LIT-INSERTED-COMMENT-ETNI = SPACES                        12130099
118760*IR071503 -  MOVE   'ETNI'                     TO   WS-SYSTEM     12131099
118770     MOVE   'BILL'                     TO   WS-SYSTEM             12132099
118780     MOVE    LIT-INSERTED-COMMENT-ETNI TO   WS-COMMENT            12133099
118790**   MOVE    SPACES                    TO   WS-ADDTL-INFO         12134099
118800     MOVE ' Not in eTNI '              TO   WS-ADDTL-INFO         12135099
118810     PERFORM 6020-MOVE-ETNI-TO-RPT-NEW THRU 6020-EXIT             12136099
118820     PERFORM 6400-WRITE-RECON-RPT      THRU 6400-EXIT             12137099
118830                                                                  12138099
118840* PRINT BLANK LINE                                                12139099
118850     PERFORM 6300-PRINT-BLANK-LINE     THRU 6300-EXIT             12140099
118860*-----------------------------------------------------------------12141099
118870*  JA1109  -   4G                                                 12142099
118880*           If  SIM  or  VORA  implications, then Error Out       12143099
118890*             & Continue  Processing  Normally                    12144099
118900*-----------------------------------------------------------------12145099
118910                                                                  12146099
118920     INITIALIZE  WS-LTE-DATA-LAYER                                12147099
118930                 WS-4G-DETAIL-LINE                                12148099
118940                 DETAIL-LINE-1                                    12149099
118950                 WS-4G-ERROR-SW                                   12150099
118960                 DCLSIM-INV                                       12151099
118970                 DCLVORA-IMSI-INV                                 12152099
118980                                                                  12153099
118990     IF  MDNIN-ICC-ID-4G >  ' '  OR                               12154099
119000         MDNIN-IMSI  >  ' '                                       12155099
119010         PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT            12156099
119020                                                                  12157099
119030       IF  WS-4G-ERROR-YES                                        12158099
119040           MOVE ' Not in eTNI '               TO   WS-ADDTL-INFO  12159099
119050           PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT     12160099
119060           PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT     12161099
119070           ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                      12162099
119080           PERFORM  4G-REPORT-BUILD  THRU  4G-REPORT-BUILD-EXIT   12163099
119090           MOVE  WS-4G-DETAIL-LINE  TO  DETAIL-LINE-1             12164099
119100           MOVE  LIT-SIM-VORA-ERROR  TO   DETAIL-1-COMMENT        12165099
119110           ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                      12166099
119120           PERFORM  6500-WRITE-ERROR-RPT   THRU  6500-EXIT        12167099
119130           GO  TO  2200-VTS-NIE-EXIT                              12168099
119140       END-IF                                                     12169099
119150                                                                  12170099
119160       PERFORM  4G-REPORT-BUILD      THRU  4G-REPORT-BUILD-EXIT   12171099
119170                                                                  12172099
119180     END-IF                                                       12173099
119190     .                                                            12174099
119200 2200-VTS-NIE-EXIT.  EXIT.                                        12175099
119210                                                                  12176099
119220 2200-5XX-NIE.                                                    12177099
119230******************************************************************12178099
119240*                                                                 12179099
119250*     VTS  -  Not  In  eTNI  (NIE)                                12180099
119260*                                                                 12181099
119270******************************************************************12182099
119280**---------------------------------                               12183099
119290**  Layout:  of  Array                                            12184099
119300**                                                                12185099
119310**    Bill_Status    (1:2)                                        12186099
119320**    Filler         (3:2)                                        12187099
119330**    Filler         (5:1)                                        12188099
119340**                                                                12189099
119350**    Reads  Error  Out,  If  NOT  in  List                       12190099
119360**---------------------------------                               12191099
119370                                                                  12192099
119380     SET  WS-5XX-PROCESSED  TO  TRUE                              12193099
119390     PERFORM  VARYING   WS-CTN-STATUS-5-C-IDX                     12194099
119400              FROM  1  BY  1                                      12195099
119410              UNTIL  WS-CTN-STATUS-5-C-IDX  >                     12196099
119420                     WS-CTN-STATUS-5-C-IDX-MAX                    12197099
119430          OR                                                      12198099
119440       WS-BC16-5XX-NIE-PROCESS-ARAY-L                             12199099
119450                                 (WS-CTN-STATUS-5-C-IDX)(1:2)     12200099
119460                      =                                           12201099
119470       MDNIN-MDN-STATUS                                           12202099
119480                                                                  12203099
119490     END-PERFORM                                                  12204099
119500                                                                  12205099
119510     IF  WS-CTN-STATUS-5-C-IDX  >                                 12206099
119520         WS-CTN-STATUS-5-C-IDX-MAX                                12207099
119530         SET  WS-ERROR-FIELDS-FOUND    TO TRUE                    12208099
119540         MOVE LIT-STATUS-ERROR-ETNI    TO WS-COMMENT              12209099
119550**       MOVE SPACES                   TO WS-ADDTL-INFO           12210099
119560         MOVE ' Not in eTNI '          TO WS-ADDTL-INFO           12211099
119570         MOVE 'BILL' TO WS-SYSTEM                                 12212099
119580         MOVE WS-SAVE-HDR-BILLER-ID  TO  WS-BILLER-ID             12213099
119590         PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT         12214099
119600         PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT         12215099
119610         ADD   +1 TO WS-TOTL-ERROR-STATUS-INVALID                 12216099
119620         GO TO 2200-5XX-NIE-EXIT                                  12217099
119630     END-IF                                                       12218099
119640                                                                  12219099
119650**  Determine,  If  this  is  a  Error  Candidate  -              12220099
119660                                                                  12221099
119670     PERFORM 7050-GET-CTN-INV-BILLER THRU 7050-EXIT               12222099
119680                                                                  12223099
119690     MOVE WS-MATCH-KEY-BILL(1:10) TO WS-MDN-HISTORY               12224099
119700     PERFORM 7090-CHECK-FOR-OVRRIDE-AGING THRU 7090-EXIT          12225099
119710     IF IS-THIS-RECENT-HISTORY = 'Y'                              12226099
119720        GO TO 2200-5XX-NIE-EXIT                                   12227099
119730     END-IF                                                       12228099
119740                                                                  12229099
119750* PROCESS RECORD                                                  12230099
119760     ADD +1 TO WS-TOTL-BILL-NOT-IN-ETNI-PROC                      12231099
119770                                                                  12232099
119780* REFORMAT BILL LAST TRANSACTION DATE                             12233099
119790     PERFORM 2020-CONVERT-BILL-DATE THRU 2020-EXIT                12234099
119800                                                                  12235099
119810*----The input eTNI CTN-INV fields are considered the "old" ones.-12236099
119820*----In this case spaces, because eTNI's CTN was not found--------12237099
119830     MOVE    WS-SAVE-HDR-BILLER-ID     TO WS-BILLER-ID            12238099
119840     MOVE    SPACES                    TO WS-OLD-MIN-NUM          12239099
119850                                          WS-OLD-STATUS           12240099
119860                                          WS-OLD-PRODUCT-TYPE     12241099
119870                                          WS-OLD-NL               12242099
119880                                          WS-OLD-NGP              12243099
119890                                          WS-OLD-PORT-IND         12244099
119900                                                                  12245099
119910*----the input Biller file fields are considered the "new" ones---12246099
119920     MOVE    MDNIN-MIN-NUM             TO WS-NEW-MIN-NUM          12247099
119930     MOVE    MDNIN-MDN-STATUS          TO WS-NEW-STATUS           12248099
119940     MOVE    MDNIN-PRODUCT-TYPE        TO WS-NEW-PRODUCT-TYPE     12249099
119950     MOVE    MDNIN-NL                  TO WS-NEW-NL               12250099
119960     MOVE    MDNIN-NGP                 TO WS-NEW-NGP              12251099
119970     MOVE    MDNIN-PORT-IND            TO WS-NEW-PORT-IND         12252099
119980     MOVE    MDNIN-LAST-TRX-CODE       TO WS-TRANS-CODE           12253099
119990                                                                  12254099
120000*----The biller RSS provides a Product Type, but it is often------12255099
120010*----inaccurate. To find the correct one for this MDN, do a search12256099
120020*----in MARKET-NPA-NXX-LR table. If not found there we assume that12257099
120030*----this MDN is a Port-In and just use the Product Type contained12258099
120040*----in the Biller's input file-----------------------------------12259099
120050                                                                  12260099
120060**   JA0402E - Below  Cond                                        12261099
120070                                                                  12262099
120080     IF  WS-LEGIT-BILLER-ID-RESELLER                              12263099
120090        PERFORM 7008-GET-PRODTYPE-FROM-MARKET THRU 7008-EXIT      12264099
120100        MOVE PRODUCT-TYPE OF DCLMARKET-NPA-NXX-LR TO              12265099
120110             MDNIN-PRODUCT-TYPE  WS-NEW-PRODUCT-TYPE              12266099
120120     END-IF                                                       12267099
120130                                                                  12268099
120140*=================================================================12269099
120150* VALIDATE LOCAL BILLING SYSTEM MDN FIELDS                        12270099
120160*=================================================================12271099
120170                                                                  12272099
120180* (here in 2200-MDN-NOT-IN-ETNI, the Biller is never allowed to   12273099
120190*  change eTNI's Port-Ind, so pre-set CTN-HAS-VZW-SPID to 'N'     12274099
120200*  below to disallow Biller to eTNI Port-ind updates....          12275099
120210                                                                  12276099
120220     MOVE 'N' TO CTN-HAS-VZW-SPID                                 12277099
120230     MOVE 'N' TO ALLOW-PORT-IND-CHG                               12278099
120240     PERFORM 2110-VALIDATE-BILL-MDN-FIELDS THRU 2110-EXIT         12279099
120250                                                                  12280099
120260*----after above validation, if either error found AND/OR---------12281099
120270*----Biller's Port-Ind <> eTNI's AND this CTN has a non-VZW-------12282099
120280*----SPID in the LSMS table, write to error report----------------12283099
120290     IF WS-ERROR-FIELDS-FOUND OR                                  12284099
120300     (PORT-INDS-DONT-MATCH = 'Y' AND ALLOW-PORT-IND-CHG NOT = 'Y')12285099
120310        MOVE ' Not in eTNI '          TO WS-ADDTL-INFO            12286099
120320        PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT         12287099
120330        PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT         12288099
120340                                                                  12289099
120350     END-IF                                                       12290099
120360                                                                  12291099
120370*----if errors found, exit routine. Otherwise, if Port-Ind--------12292099
120380*----mismatch, keep going and write to Recon report---------------12293099
120390     IF WS-ERROR-FIELDS-FOUND                                     12294099
120400        GO TO 2200-5XX-NIE-EXIT                                   12295099
120410     END-IF                                                       12296099
120420                                                                  12297099
120430* REPORT LOCAL BILLING SYSTEM MDN FIELDS                          12298099
120440     MOVE   'BILL'                         TO   WS-SYSTEM         12299099
120450     MOVE SPACES                           TO   WS-COMMENT        12300099
120460                                                WS-ADDTL-INFO     12301099
120470     MOVE ' Not in eTNI '                  TO   WS-ADDTL-INFO     12302099
120480     PERFORM 6000-MOVE-BILL-MDN-TO-RPT     THRU 6000-EXIT         12303099
120490     PERFORM 6400-WRITE-RECON-RPT          THRU 6400-EXIT         12304099
120500                                                                  12305099
120510*----below is a special version of 2180-UPDATE-MIN-INV-STATUS-----12306099
120520*----that's used ONLY when MDN exists in Biller and not in eTNI.--12307099
120530*----It assumes eTNI fields are spaces and doesn't test them.-----12308099
120540                                                                  12309099
120550*----since this subroutine executes only when the CTN exists in---12310099
120560*----the Biller file but NOT in eTNI, we've got to equalize the---12311099
120570*----two systems by inserting Biller's CTN into eTNI's CTN-INV----12312099
120580                                                                  12313099
120590* INSERT PROCESS                                                  12314099
120600     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        12315099
120610        PERFORM 2220-POPULATE-CTN             THRU 2220-EXIT      12316099
120620        PERFORM 7020-INSERT-CTN-INV           THRU 7020-EXIT      12317099
120630        IF SQL-DUP-INSERT                                         12318099
120640           PERFORM 6030-INIT-DETAIL-LINE      THRU 6030-EXIT      12319099
120650           PERFORM 6400-WRITE-RECON-RPT       THRU 6400-EXIT      12320099
120660           MOVE   'BILL'                      TO   WS-SYSTEM      12321099
120670           MOVE    LIT-CTN-INV-INSERT-ERROR-NIE  TO   WS-COMMENT  12322099
120680           MOVE    CTN-TEXT     OF DCLCTN-INV                     12323099
120690                                          TO WS-ADDTL-INFO (1:10) 12324099
120700           MOVE    PRODUCT-TYPE OF DCLCTN-INV                     12325099
120710                                          TO WS-ADDTL-INFO (12:1) 12326099
120720           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      12327099
120730           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      12328099
120740           GO TO 2200-5XX-NIE-EXIT                                12329099
120750        END-IF                                                    12330099
120760                                                                  12331099
120770        PERFORM 2150-UPDATE-STATUS-COUNTERS   THRU 2150-EXIT      12332099
120780        IF WS-ERROR-FIELDS-FOUND                                  12333099
120790           MOVE   'BILL'                      TO   WS-SYSTEM      12334099
120800           MOVE ' Not in eTNI '               TO   WS-ADDTL-INFO  12335099
120810           PERFORM 6000-MOVE-BILL-MDN-TO-RPT  THRU 6000-EXIT      12336099
120820           PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT      12337099
120830           GO TO 2200-5XX-NIE-EXIT                                12338099
120840        END-IF                                                    12339099
120850                                                                  12340099
120860* REPORT UPDATED FIELDS                                           12341099
120870*        VALUE 'INSERTED:MDN NOT IN ETNI'.                        12342099
120880     IF LIT-INSERTED-COMMENT-ETNI = SPACES                        12343099
120890*IR071503 -  MOVE   'ETNI'                     TO   WS-SYSTEM     12344099
120900     MOVE   'BILL'                     TO   WS-SYSTEM             12345099
120910     MOVE    LIT-INSERTED-COMMENT-ETNI TO   WS-COMMENT            12346099
120920**   MOVE    SPACES                    TO   WS-ADDTL-INFO         12347099
120930     MOVE ' Not in eTNI '              TO   WS-ADDTL-INFO         12348099
120940     PERFORM 6020-MOVE-ETNI-TO-RPT-NEW THRU 6020-EXIT             12349099
120950     PERFORM 6400-WRITE-RECON-RPT      THRU 6400-EXIT             12350099
120960                                                                  12351099
120970* PRINT BLANK LINE                                                12352099
120980     PERFORM 6300-PRINT-BLANK-LINE     THRU 6300-EXIT             12353099
120990*-----------------------------------------------------------------12354099
121000*  JA1109  -   4G                                                 12355099
121010*           If  SIM  or  VORA  implications, then Error Out       12356099
121020*             & Continue  Processing  Normally                    12357099
121030*-----------------------------------------------------------------12358099
121040                                                                  12359099
121050     INITIALIZE  WS-LTE-DATA-LAYER                                12360099
121060                 WS-4G-DETAIL-LINE                                12361099
121070                 DETAIL-LINE-1                                    12362099
121080                 WS-4G-ERROR-SW                                   12363099
121090                 DCLSIM-INV                                       12364099
121100                 DCLVORA-IMSI-INV                                 12365099
121110                                                                  12366099
121120     IF  MDNIN-ICC-ID-4G >  ' '  OR                               12367099
121130         MDNIN-IMSI  >  ' '                                       12368099
121140         PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT            12369099
121150                                                                  12370099
121160       IF  WS-4G-ERROR-YES                                        12371099
121170           MOVE ' Not in eTNI '               TO   WS-ADDTL-INFO  12372099
121180           PERFORM  6000-MOVE-BILL-MDN-TO-RPT THRU  6000-EXIT     12373099
121190           PERFORM  6500-WRITE-ERROR-RPT      THRU  6500-EXIT     12374099
121200           ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                      12375099
121210           PERFORM  4G-REPORT-BUILD  THRU  4G-REPORT-BUILD-EXIT   12376099
121220           MOVE  WS-4G-DETAIL-LINE  TO  DETAIL-LINE-1             12377099
121230           MOVE  LIT-SIM-VORA-ERROR  TO   DETAIL-1-COMMENT        12378099
121240           ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                      12379099
121250           PERFORM  6500-WRITE-ERROR-RPT   THRU  6500-EXIT        12380099
121260           GO  TO  2200-5XX-NIE-EXIT                              12381099
121270       END-IF                                                     12382099
121280                                                                  12383099
121290       PERFORM  4G-REPORT-BUILD      THRU  4G-REPORT-BUILD-EXIT   12384099
121300                                                                  12385099
121310     END-IF                                                       12386099
121320     .                                                            12387099
121330 2200-5XX-NIE-EXIT.  EXIT.                                        12388099
121340 2220-POPULATE-CTN.                                               12389099
121350******************************************************************12390099
121360*                                                                 12391099
121370*   PARAGRAPH NAME:  2220-POPULATE-CTN                            12392099
121380*                                                                 12393099
121390*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   12394099
121400*             POP                                                 12395099
121410*                                                                 12396099
121420******************************************************************12397099
121430     MOVE '2220-POPULATE-CTN' TO WS-CURR-PARA                     12398099
121440                                                                  12399099
121450     INITIALIZE DCLCTN-INV                                        12400099
121460                DCLCTN-INV-NULL-INDS                              12401099
121470                                                                  12402099
121480     INITIALIZE CTN OF DCLCTN-INV                                 12403099
121490     UNSTRING MDNIN-MDN                                           12404099
121500        DELIMITED BY WS-DELIMITER                                 12405099
121510           INTO         CTN-TEXT OF DCLCTN-INV                    12406099
121520           DELIMITER IN WS-DELIMITER-VALUE                        12407099
121530           COUNT     IN CTN-LEN  OF DCLCTN-INV                    12408099
121540     END-UNSTRING                                                 12409099
121550                                                                  12410099
121560                                                                  12411099
121570     MOVE WS-TIMESTAMP            TO SYS-CREATION-DATE            12412099
121580                                  OF DCLCTN-INV                   12413099
121590                                     SYS-UPDATE-DATE              12414099
121600                                  OF DCLCTN-INV                   12415099
121610                                                                  12416099
121620     MOVE LOW-VALUES              TO SPECIAL-TRX-DATE             12417099
121630                                  OF DCLCTN-INV                   12418099
121640     MOVE -1                      TO SPECIAL-TRX-DATE-NI          12419099
121650                                  OF DCLCTN-INV-NULL-INDS         12420099
121660                                                                  12421099
121670     MOVE LIT-OPERATOR-ID         TO OPERATOR-ID    OF DCLCTN-INV 12422099
121680     MOVE LIT-RECON-ID            TO APPLICATION-ID OF DCLCTN-INV 12423099
121690     MOVE LIT-DL-SERVICE-CD       TO DL-SERVICE-CODE              12424099
121700                                  OF DCLCTN-INV                   12425099
121710     MOVE ZEROES                  TO DL-UPDATE-STAMP              12426099
121720                                  OF DCLCTN-INV                   12427099
121730                                                                  12428099
121740                                                                  12429099
121750*----various Biller fields are moved to eTNI CTN-INV host vars----12430099
121760     MOVE WS-BILL-LAST-TRX-DATE-1 TO LAST-TRX-DATE  OF DCLCTN-INV 12431099
121770     MOVE WS-TRANS-CODE           TO LAST-TRX-CODE  OF DCLCTN-INV 12432099
121780     MOVE MDNIN-MDN-STATUS        TO CTN-STATUS     OF DCLCTN-INV 12433099
121790     IF   MDNIN-USER-ID           OF MDNIN-DETAIL-FIELDS          12434099
121800                                  =  SPACES OR LOW-VALUES         12435099
121810          MOVE LIT-UNKNOWN        TO LAST-TRX-UID   OF DCLCTN-INV 12436099
121820     ELSE                                                         12437099
121830          MOVE MDNIN-USER-ID      OF MDNIN-DETAIL-FIELDS          12438099
121840                                  TO LAST-TRX-UID   OF DCLCTN-INV 12439099
121850     END-IF                                                       12440099
121860                                                                  12441099
121870**(JK1008C) NL should be NULL not Spaces.  Per Sue B. 10/14/2008. 12442099
121880     IF   MDNIN-MDN-STATUS = 'NA'                                 12443099
121890          MOVE LOW-VALUES         TO NL             OF DCLCTN-INV 12444099
121900     ELSE                                                         12445099
121910          MOVE MDNIN-NL           TO NL             OF DCLCTN-INV 12446099
121920     END-IF                                                       12447099
121930                                                                  12448099
121940     MOVE MDNIN-NGP               TO NGP            OF DCLCTN-INV 12449099
121950* ir071503 - as of this date, billing system will not pass us     12450099
121960* ir071503 - the mdnin-conv-run-no, which is zero anyway.         12451099
121970* ir071503 - however, the biller-id and prepaid in the detail     12452099
121980* ir071503 - record will be passed - in the near future           12453099
121990* ir071503 - replaced by biller-id, prepaid-ind, filler, tot=3byte12454099
122000*    MOVE MDNIN-CONV-RUN-NO       TO CONV-RUN-NO    OF DCLCTN-INV 12455099
122010* ir071503 - end                                                  12456099
122020     MOVE zeroes                  TO CONV-RUN-NO    OF DCLCTN-INV 12457099
122030     MOVE ZEROES                  TO RUN-ID         OF DCLCTN-INV 12458099
122040*** #140804 LMS 05/21/2003 BEGIN                                  12459099
122050     IF ((WS-NEW-STATUS NOT = 'NH')                               12460099
122060         AND (MDNIN-HOLD-REASON NOT = SPACES))                    12461099
122070             MOVE SPACES                  TO MDNIN-HOLD-REASON    12462099
122080     END-IF                                                       12463099
122090*** #140804 LMS 05/21/2003 END                                    12464099
122100     MOVE MDNIN-HOLD-REASON       TO HOLD-REASON    OF DCLCTN-INV 12465099
122110     MOVE MDNIN-PRODUCT-TYPE      TO PRODUCT-TYPE   OF DCLCTN-INV 12466099
122120     MOVE ZEROES                  TO ICC-ID-LEN     OF DCLCTN-INV 12467099
122130     MOVE SPACES                  TO ICC-ID-TEXT    OF DCLCTN-INV 12468099
122140     MOVE MDNIN-PORT-IND          TO PORT-IND       OF DCLCTN-INV 12469099
122150                                                                  12470099
122160     IF   MDNIN-MDN-STATUS = 'NA' OR 'NH'                         12471099
122170          MOVE -1         TO MIN-NUM-NI                           12472099
122180          MOVE LOW-VALUES TO MIN-NUM-TEXT OF DCLCTN-INV           12473099
122190     ELSE                                                         12474099
122200          MOVE     MDNIN-MIN-NUM TO WS-TEMP-MIN-NUM               12475099
122210          UNSTRING WS-TEMP-MIN-NUM-TEXT                           12476099
122220                   DELIMITED BY WS-DELIMITER                      12477099
122230                   INTO         MIN-NUM-TEXT OF DCLCTN-INV        12478099
122240                   DELIMITER IN WS-DELIMITER-VALUE                12479099
122250                   COUNT     IN MIN-NUM-LEN  OF DCLCTN-INV        12480099
122260                   END-UNSTRING                                   12481099
122270     END-IF                                                       12482099
122280                                                                  12483099
122290*IR071503 - RSS - SINCE MDN DOES NOT EXISTS IN THE CTN-INV        12484099
122300*               - THE ONLY CHOICE POSSIBLE IS USING THE BILLER-ID 12485099
122310*               - OF THE HEADER RECORD, IN OTHERWORDS, CURRENT    12486099
122320*IR071503 - RSS - PROCESSING IS CORRECT                           12487099
122330                                                                  12488099
122340     MOVE WS-SAVE-HDR-BILLER-ID   TO BILLER-ID OF DCLCTN-INV      12489099
122350     MOVE SPACES                  TO STATUS-REASON-CD             12490099
122360                                  OF DCLCTN-INV                   12491099
122370     MOVE 'N'                     TO PREPAID-IND                  12492099
122380                                  OF DCLCTN-INV                   12493099
122390                                                                  12494099
122400*-------new tests on PrePaid Ind 9/28/04--------------------------12495099
122410                                                                  12496099
122420*    1) If input Biller Status is either AI or AG and its         12497099
122430*       Prepaid Ind is either Y or N, move prepaid ind to CTN-INV 12498099
122440*    OR Prepaid Ind is X                                          12499099
122450                                                                  12500099
122460**  JA1207B  -  Added  Prepaid Ind Valid, If X                    12501099
122470                                                                  12502099
122480*    2) If any case other than above, move space to CTN-INV       12503099
122490                                                                  12504099
122500*       (no tests on eTNI file here because this only executes    12505099
122510*        if we have a Biller MDN with no matching eTNI CTN)       12506099
122520                                                                  12507099
122530     IF (MDNIN-MDN-STATUS = 'AI' OR MDNIN-MDN-STATUS = 'AG')      12508099
122540         AND                                                      12509099
122550        (MDNIN-PREPAID-IND = 'Y' OR MDNIN-PREPAID-IND = 'N'       12510099
122560                                 OR MDNIN-PREPAID-IND = 'X')      12511099
122570         MOVE MDNIN-PREPAID-IND TO PREPAID-IND OF DCLCTN-INV      12512099
122580         GO TO 2220-CONTINUE-10                                   12513099
122590         END-IF                                                   12514099
122600                                                                  12515099
122610     MOVE SPACE TO PREPAID-IND OF DCLCTN-INV                      12516099
122620     .                                                            12517099
122630 2220-CONTINUE-10.                                                12518099
122640                                                                  12519099
122650*----if Biller is "R" (RSS) and its status was reset by pgm-------12520099
122660*----to NA (not assigned), reset the eTNI Biller back to its------12521099
122670*----original Biller as determined from 1st pos of NGP.-----------12522099
122680*----This will work regardless of eTNI already having a Status of-12523099
122690*----NA or Biller trying to change eTNI's Status to NA.-----------12524099
122700*----(first, default CTN-INV Biller to input Biller,      test)---12525099
122710                                                                  12526099
122720**   JA0320  -   Revision                                         12527099
122730                                                                  12528099
122740*----Now  For  VISION  &  RSS  &  OPC  &  et al                   12529099
122750*----reset the eTNI Biller back to its  Original  per  NGP        12530099
122760**** IF WS-SAVE-HDR-BILLER-ID = 'R' AND                           12531099
122770                                                                  12532099
122780     MOVE WS-SAVE-HDR-BILLER-ID TO BILLER-ID OF DCLCTN-INV        12533099
122790     MOVE 0 TO BILLER-ID-NI OF DCLCTN-INV-NULL-INDS               12534099
122800                                                                  12535099
122810**  JA0402  -   OPC  - Added  -  ALL  BILLER-ID's  Ok             12536099
122820**** IF  (WS-VISION  OR  WS-RSS)  AND ***                         12537099
122830                                                                  12538099
122840     IF  WS-LEGIT-BILLER-ID-ALL   AND                             12539099
122850        CTN-STATUS OF DCLCTN-INV = 'NA'                           12540099
122860*-------NGP Extension Project:                                    12541099
122870*-------no longer get Biller from 1st pos of NGP in CTN-INV-------12542099
122880*-------but rather from new Biller-ID column in NUMBER-GROUP table12543099
122890        MOVE WS-ETNDC38-BILLER TO BILLER-ID OF DCLCTN-INV         12544099
122900***     MOVE NGP OF DCLCTN-INV(1:1) TO BILLER-ID OF DCLCTN-INV    12545099
122910     END-IF                                                       12546099
122920                                                                  12547099
122930**  JA0310  -   4G                                                12548099
122940        PERFORM  7097-SELECT-TNI-MDN-MIN  THRU  7097-EXIT         12549099
122950        IF  SQLCODE  =  +0                                        12550099
122960            MOVE  IMSI  OF  DCLTNI-MDN-MIN  TO  IMSI              12551099
122970                                            OF  DCLCTN-INV        12552099
122980                                                MDNIN-IMSI        12553099
122990            MOVE  ICC-ID-4G  OF  DCLTNI-MDN-MIN  TO  ICC-ID-4G    12554099
123000                                            OF  DCLCTN-INV        12555099
123010                                                MDNIN-ICC-ID-4G   12556099
123020           ELSE                                                   12557099
123030            GO  TO  2220-EXIT                                     12558099
123040        END-IF                                                    12559099
123050                                                                  12560099
123060        IF  IMSI  OF  DCLCTN-INV  >  SPACES  OR                   12561099
123070            ICC-ID-4G  OF  DCLCTN-INV  >  SPACES                  12562099
123080            CONTINUE                                              12563099
123090           ELSE                                                   12564099
123100            GO  TO  2220-EXIT                                     12565099
123110        END-IF                                                    12566099
123120                                                                  12567099
123130        MOVE  WS-CTNIN-CTN-STATUS  TO  WS-CTNIN-CTN-STATUS-SAVED  12568099
123140        MOVE  'PC'  TO  WS-CTNIN-CTN-STATUS                       12569099
123150        MOVE  MDNIN-MDN  TO  MDN  OF  DCLSIM-INV                  12570099
123160                                                                  12571099
123170        IF  IMSI  OF  DCLCTN-INV  >  SPACES                       12572099
123180            PERFORM  4G-49000-CALL-ETLSC09 THRU                   12573099
123190                     4G-49000-EXIT                                12574099
123200            PERFORM  4G-51000-VORA-UPDATE  THRU                   12575099
123210                     4G-51000-EXIT                                12576099
123220            IF  WS-4G-ERROR-YES                                   12577099
123230                MOVE  'VORA'     TO  DETAIL-1-SYSTEM              12578099
123240                MOVE  MDNIN-MDN  TO  DETAIL-1-MDN                 12579099
123250                MOVE  LIT-SIM-VORA-ERROR  TO  DETAIL-1-COMMENT    12580099
123260                ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                 12581099
123270                MOVE  DETAIL-LINE-1  TO   WS-4G-DETAIL-LINE       12582099
123280                INITIALIZE  DETAIL-LINE-1                         12583099
123290            END-IF                                                12584099
123300        END-IF                                                    12585099
123310                                                                  12586099
123320        IF  ICC-ID-4G  OF  DCLCTN-INV  >  SPACES                  12587099
123330            PERFORM  4G-48000-CALL-ETLSC08 THRU                   12588099
123340                     4G-48000-EXIT                                12589099
123350            PERFORM  4G-50000-SIM-UPDATE   THRU                   12590099
123360                     4G-50000-EXIT                                12591099
123370            IF  WS-4G-ERROR-YES                                   12592099
123380                MOVE  'SIM '     TO  DETAIL-1-SYSTEM              12593099
123390                MOVE  MDNIN-MDN  TO  DETAIL-1-MDN                 12594099
123400                MOVE  LIT-SIM-VORA-ERROR  TO  DETAIL-1-COMMENT    12595099
123410                ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                 12596099
123420                MOVE  DETAIL-LINE-1  TO   WS-4G-DETAIL-LINE       12597099
123430                INITIALIZE  DETAIL-LINE-1                         12598099
123440            END-IF                                                12599099
123450        END-IF                                                    12600099
123460                                                                  12601099
123470        MOVE  WS-CTNIN-CTN-STATUS-SAVED  TO  WS-CTNIN-CTN-STATUS  12602099
123480     .                                                            12603099
123490 2220-EXIT.                                                       12604099
123500     EXIT.                                                        12605099
123510                                                                  12606099
123520 2300-MDN-NOT-IN-BILL.                                            12607099
123530******************************************************************12608099
123540**                                                                12609099
123550**  PARAGRAPH NAME:  2300-MDN-NOT-IN-BILL                         12610099
123560**                                                                12611099
123570**            PROCESS CTN                                         12612099
123580**                                                                12613099
123590******************************************************************12614099
123600     MOVE '2300-MDN-NOT-IN-BILL' TO WS-CURR-PARA                  12615099
123610                                                                  12616099
123620     INITIALIZE CTN-HAS-VZW-SPID  ALLOW-PORT-IND-CHG              12617099
123630                GATEWAY-INTRASERV-PORT                            12618099
123640                PORT-IND-IS-THE-ONLY-CHANGE                       12619099
123650                WS-OWNERSHIP-VARIABLES                            12620099
123660                NH-AND-PENDDASG-R-FLAG                            12621099
123670                NH-AND-OTHER-PENDING-FLAG                         12622099
123680                MDN-NOT-IN-ETNI-FLAG                              12623099
123690                WS-4G-DETAIL-LINE                                 12624099
123700                WS-NEW-STATUS                                     12625099
123710*  JA0612  -                                                      12626099
123720                    MODIFIED-MIN-STATUS                           12627099
123730                                                                  12628099
123740     MOVE 'Y' TO MDN-NOT-IN-BILL-FLAG                             12629099
123750     ADD     +1 TO WS-TOTL-ETNI-NOT-IN-BILL-CNT                   12630099
123760     SET  WS-REC-ETNI-NOT-IN-BILL TO TRUE                         12631099
123770                                                                  12632099
123780     MOVE  SPACES TO WS-ERROR-FIELDS-SW                           12633099
123790                     WS-COMMENT                                   12634099
123800                     WS-ADDTL-INFO                                12635099
123810                                                                  12636099
123820*----Bypass NEW transactions < 24 hours old-----------------------12637099
123830     MOVE WS-CTNIN-LAST-TRX-DATE (01:4) TO WS-TEMP-DATE-CCYY      12638099
123840     MOVE WS-CTNIN-LAST-TRX-DATE (06:2) TO WS-TEMP-DATE-MM        12639099
123850     MOVE WS-CTNIN-LAST-TRX-DATE (09:2) TO WS-TEMP-DATE-DD        12640099
123860     MOVE WS-CTNIN-LAST-TRX-DATE (12:2) TO WS-TEMP-DATE-HH        12641099
123870     MOVE WS-CTNIN-LAST-TRX-DATE (15:2) TO WS-TEMP-DATE-MI        12642099
123880     MOVE WS-CTNIN-LAST-TRX-DATE (18:2) TO WS-TEMP-DATE-SS        12643099
123890                                                                  12644099
123900     IF WS-TEMP-DATE-NUM > WS-HDR-DATE-TIME-MINUS-1DAY            12645099
123910        ADD +1 TO WS-TOTL-ETNI-NOT-IN-BILL-NEW                    12646099
123920        MOVE '004' TO WS-ERROR4-REASON                            12647099
123930        PERFORM 8878-WRITE-NOT-PROCESSED-FILE THRU 8878-EXIT      12648099
123940        GO TO 2300-EXIT                                           12649099
123950     END-IF                                                       12650099
123960                                                                  12651099
123970*----Since this CTN is in eTNI and not in Biller and is ported-out12652099
123980*----in eTNI, do not perform any updates or reporting on it-------12653099
123990                                                                  12654099
124000**  JA1208 - Next  Cond.  Just  Exit                              12655099
124010     IF WS-CTNIN-CTN-STATUS = 'PO' AND                            12656099
124020        WS-CTNIN-PORT-IND = 'PO'                                  12657099
124030        ADD 1 TO WS-PO-IN-ETNI-NOT-IN-BILL                        12658099
124040**      MOVE '005' TO WS-ERROR4-REASON                            12659099
124050**      PERFORM 8878-WRITE-NOT-PROCESSED-FILE THRU 8878-EXIT      12660099
124060        GO TO 2300-EXIT                                           12661099
124070     END-IF                                                       12662099
124080                                                                  12663099
124090*----Biller id validation. If bad: Exit --------------------------12664099
124100     IF WS-CTNIN-BILLER-ID NOT = WS-SAVE-HDR-BILLER-ID            12665099
124110        ADD   +1 TO WS-TOTL-ERROR-BILLER-NOTMTCH                  12666099
124120        MOVE  'ETNI'                   TO   WS-SYSTEM             12667099
124130        SET   WS-ERROR-FIELDS-FOUND    TO   TRUE                  12668099
124140        MOVE  LIT-BILLER-ERROR         TO   WS-COMMENT            12669099
124150        MOVE  WS-CTNIN-BILLER-ID       TO   WS-ADDTL-INFO (1:1)   12670099
124160        PERFORM 6010-MOVE-ETNI-TO-RPT  THRU 6010-EXIT             12671099
124170        PERFORM 6500-WRITE-ERROR-RPT   THRU 6500-EXIT             12672099
124180        GO TO 2300-EXIT                                           12673099
124190     END-IF                                                       12674099
124200                                                                  12675099
124210*----Bypass Prepaid numbers on HOLD-------------------------------12676099
124220     IF WS-CTNIN-NL(2:1) = 'H'                                    12677099
124230        ADD     +1 TO WS-TOTL-BILL-ETNI-MATCH-PP                  12678099
124240        MOVE    'ETNI'                     TO WS-SYSTEM           12679099
124250        MOVE    LIT-HELD-CONTRACT-RSV      TO WS-COMMENT          12680099
124260        MOVE    WS-CTNIN-NL                TO WS-ADDTL-INFO       12681099
124270        PERFORM 6010-MOVE-ETNI-TO-RPT      THRU 6010-EXIT         12682099
124280        PERFORM 6500-WRITE-ERROR-RPT       THRU 6500-EXIT         12683099
124290        GO TO 2300-EXIT                                           12684099
124300     END-IF                                                       12685099
124420                                                                  12686099
124430* JA1011  -  VTS  Processing                                      12687099
124440                                                                  12688099
124450     SET  NOT-VTS-MDN  TO  TRUE                                   12689099
124460     SET  WS-VTS-PROCESSED-NOT  TO  TRUE                          12690099
124470     PERFORM  WITH  TEST  BEFORE                                  12691099
124480              VARYING  WS-SUB-VTS-NL FROM +1 BY  +1               12692099
124490                 UNTIL  VTS-MDN                                   12693099
124500                 OR                                               12694099
124510                 WS-SUB-VTS-NL      >   WS-SUB-VTS-NL-MAX         12695099
124520        IF  WS-VTS-NL  (WS-SUB-VTS-NL) =  WS-CTNIN-NL             12696099
124530            SET  VTS-MDN  TO  TRUE                                12697099
124540        END-IF                                                    12698099
124550     END-PERFORM                                                  12699099
124560                                                                  12700099
      *   JA0912A  -  Use  CTNIN  data,  instead  of  MDNIN             12701099
124570     IF  VTS-MDN                                                  12702099
124580         MOVE  WS-CTNIN-CTN-TEXT(1:10)  TO  WS-CTNIN-MIN-NUM-TEXT 12703099
124590         PERFORM  2300-VTS-NIB    THRU  2300-VTS-NIB-EXIT         12704099
124600         GO  TO   2300-EXIT                                       12705099
124610     END-IF                                                       12706099
124620                                                                  12707099
124630* JA0412  -  5XX  Processing                                      12708099
124640                                                                  12709099
124650     SET  NOT-5XX-MDN  TO  TRUE                                   12710099
124660     SET  WS-5XX-PROCESSED-NOT  TO  TRUE                          12711099
124670     PERFORM  WITH  TEST  BEFORE                                  12712099
124680              VARYING  WS-SUB-5XX-NL FROM +1 BY  +1               12713099
124690                 UNTIL  5XX-MDN                                   12714099
124700                 OR                                               12715099
124710                 WS-SUB-5XX-NL      >   WS-SUB-5XX-NL-MAX         12716099
124720        IF  WS-5XX-NL  (WS-SUB-5XX-NL) =  WS-CTNIN-NL             12717099
124730            SET  5XX-MDN  TO  TRUE                                12718099
124740        END-IF                                                    12719099
124750     END-PERFORM                                                  12720099
124760                                                                  12721099
124770     IF  5XX-MDN                                                  12722099
124780         PERFORM  2300-5XX-NIB    THRU  2300-5XX-NIB-EXIT         12723099
124790         GO  TO   2300-EXIT                                       12724099
124800     END-IF                                                       12725099
124810                                                                  12726099
124820     IF WS-CTNIN-CTN-STATUS = 'NA'                                12727099
124830        ADD +1 TO WS-TOTL-ETNI-NA-NH-CNT                          12728099
124840        GO TO 2300-CONTINUE-10                                    12729099
124850     END-IF                                                       12730099
124860                                                                  12731099
124870     MOVE WS-CTNIN-HOLD-REASON(1:10) TO PENDING-HOLD-REASON-CODES 12732099
124880     IF WS-CTNIN-CTN-STATUS = 'NH' AND NOT                        12733099
124890        VALID-PENDING-HOLD-REASON-CODE                            12734099
124900        ADD +1 TO WS-TOTL-ETNI-NA-NH-CNT                          12735099
124910        GO TO 2300-EXIT                                           12736099
124920     END-IF                                                       12737099
124930                                                                  12738099
124940*----CTNs with 'SPL' Last Trx Code should not be deleted----------12739099
124950*--- These are special holding pools. Bypass them.----------------12740099
124960     IF WS-CTNIN-LAST-TRX-CODE = 'SPL'                            12741099
124970        ADD   +1 TO WS-TOTL-ERROR-BILLER-NOTMTCH                  12742099
124980        MOVE  'ETNI'                   TO   WS-SYSTEM             12743099
124990        MOVE 'ERROR: SPL NOT IN BILLING' TO WS-COMMENT            12744099
125000        PERFORM 6010-MOVE-ETNI-TO-RPT  THRU 6010-EXIT             12745099
125010        PERFORM 6500-WRITE-ERROR-RPT   THRU 6500-EXIT             12746099
125020        GO TO 2300-EXIT                                           12747099
125030     END-IF                                                       12748099
125040                                                                  12749099
125050**  JA0602  - START  -                                            12750099
125060                                                                  12751099
125070     IF  WS-CTNIN-CTN-TEXT(1:6)  =  WS-CTNIN-CTN-TEXT-SAVED       12752099
125080         CONTINUE                                                 12753099
125090        ELSE                                                      12754099
125100         PERFORM  7039-IS-IT-A-SPLIT  THRU  7039-EXIT             12755099
125110                                                                  12756099
125120         MOVE  WS-CTNIN-CTN-TEXT(1:6)  TO                         12757099
125130                                       WS-CTNIN-CTN-TEXT-SAVED    12758099
125140           IF  WS-ERROR-FIELDS-FOUND                              12759099
125150               GO TO 2300-EXIT                                    12760099
125160           END-IF                                                 12761099
125170                                                                  12762099
125180     END-IF                                                       12763099
125190                                                                  12764099
125200**  JA0602  - START                                               12765099
125210                                                                  12766099
125220     IF  WS-VISION                                                12767099
125230       IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA      12768099
125240**       PERFORM  7035-IS-IT-AN-ETNI-HUB  THRU  7035-EXIT         12769099
125250                                                                  12770099
125260           IF  WS-ERROR-FIELDS-FOUND                              12771099
125270               GO TO 2300-EXIT                                    12772099
125280           END-IF                                                 12773099
125290                                                                  12774099
125300         IF  WS-HUB-ETNI                                          12775099
125310                                                                  12776099
125320**  LOOKUP  BYPASS,  IF  MAX  -OR-  IN  BYPASS  LIST;  BYPASS     12777099
125330                                                                  12778099
125340            PERFORM  VARYING   WS-CTN-STATUS-B-A-IDX              12779099
125350                     FROM  1  BY  1                               12780099
125360                     UNTIL  WS-CTN-STATUS-B-A-IDX  >              12781099
125370                            WS-CTN-STATUS-B-A-IDX-MAX             12782099
125380            OR                                                    12783099
125390                                                                  12784099
125400            WS-ETNBC16-N-I-BILL-ARAY-L    (WS-CTN-STATUS-B-A-IDX) 12785099
125410                       =                                          12786099
125420            WS-CTNIN-CTN-STATUS                                   12787099
125430                                                                  12788099
125440            END-PERFORM                                           12789099
125450                                                                  12790099
125460            IF  WS-CTN-STATUS-B-A-IDX  >                          12791099
125470                WS-CTN-STATUS-B-A-IDX-MAX                         12792099
125480                CONTINUE                                          12793099
125490                ELSE                                              12794099
125500                                                                  12795099
125510**  BYPASS  AS  MATCH  OCCURED  -                                 12796099
125520                                                                  12797099
125530               GO TO 2300-EXIT                                    12798099
125540            END-IF                                                12799099
125550         END-IF                                                   12800099
125560       END-IF                                                     12801099
125570     END-IF                                                       12802099
125580                                                                  12803099
125590**  JA1208A  - START                                              12804099
125600**  JA0211   - Resolved  Bug  Cond  below                         12805099
125610                                                                  12806099
125620     IF  WS-LEGIT-BILLER-ID-RETAIL  OR                            12807099
125630         WS-LEGIT-BILLER-ID-RESELLER                              12808099
125640      IF   NOT  WS-HUB-ETNI                                       12809099
125650                                                                  12810099
125660       IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA      12811099
125670                                                                  12812099
125680**  LOOKUP  BYPASS,  IF  MAX  -OR-  IN  BYPASS  LIST;  BYPASS     12813099
125690                                                                  12814099
125700            PERFORM  VARYING   WS-CTN-STATUS-B-A-IDX              12815099
125710                     FROM  1  BY  1                               12816099
125720                     UNTIL  WS-CTN-STATUS-B-A-IDX  >              12817099
125730                            WS-CTN-STATUS-B-A-IDX-MAX             12818099
125740            OR                                                    12819099
125750                                                                  12820099
125760            WS-ETNBC16-N-I-BILL-ARAY-R    (WS-CTN-STATUS-B-A-IDX) 12821099
125770                       =                                          12822099
125780            WS-CTNIN-CTN-STATUS                                   12823099
125790                                                                  12824099
125800            END-PERFORM                                           12825099
125810                                                                  12826099
125820            IF  WS-CTN-STATUS-B-A-IDX  >                          12827099
125830                WS-CTN-STATUS-B-A-IDX-MAX                         12828099
125840                CONTINUE                                          12829099
125850                ELSE                                              12830099
125860                                                                  12831099
125870                ADD   +1  TO  WS-TOTL-BYPASS-NOT-IN-BILLING       12832099
125880**  BYPASS  AS  MATCH  OCCURED  -                                 12833099
125890                                                                  12834099
125900               GO TO 2300-EXIT                                    12835099
125910            END-IF                                                12836099
125920           END-IF                                                 12837099
125930        END-IF                                                    12838099
125940     END-IF                                                       12839099
125950                                                                  12840099
125960     IF  WS-VISION                                                12841099
125970       IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA      12842099
125980         IF  WS-HUB-ETNI                                          12843099
125990             IF  WS-CTNIN-CTN-STATUS  =  'AI'                     12844099
126000                 MOVE  LIT-ERROR-AI        TO  WS-COMMENT         12845099
126010                 ADD   +1  TO  WS-TOTL-HUB-ERROR-AI               12846099
126020                 PERFORM  6010-MOVE-ETNI-TO-RPT-HUB  THRU         12847099
126030                          6010-EXIT-HUB                           12848099
126040                 PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU         12849099
126050                          6510-EXIT                               12850099
126060                 GO TO 2300-EXIT                                  12851099
126070             END-IF                                               12852099
126080         END-IF                                                   12853099
126090       END-IF                                                     12854099
126100     END-IF                                                       12855099
126110**                                                                12856099
126120******                                                            12857099
126130**                                                                12858099
126140     IF  WS-VISION                                                12859099
126150       IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA      12860099
126160         IF  WS-HUB-ETNI                                          12861099
126170             IF  WS-CTNIN-CTN-STATUS  =  'AR'                     12862099
126180                 PERFORM  7040-GET-BILLER-FROM-NGP-TABLE  THRU    12863099
126190                          7040-EXIT                               12864099
126200                 PERFORM  6010-MOVE-ETNI-TO-RPT-HUB  THRU         12865099
126210                          6010-EXIT-HUB                           12866099
126220                 PERFORM  6401-WRITE-RECON-RPT-HUB   THRU         12867099
126230                          6401-EXIT                               12868099
126240                 PERFORM  10000-PROCESS-HUB-001      THRU         12869099
126250                          10000-EXIT                              12870099
126260                 MOVE  LIT-UPDATED-TO-AA   TO  WS-COMMENT         12871099
126270                 ADD   +1  TO  WS-TOTL-HUB-UPDATED-TO-AA          12872099
126280                 PERFORM  6010-MOVE-ETNI-TO-RPT-HUB  THRU         12873099
126290                          6010-EXIT-HUB                           12874099
126300                 PERFORM  6401-WRITE-RECON-RPT-HUB   THRU         12875099
126310                          6401-EXIT                               12876099
126320                 GO TO 2300-EXIT                                  12877099
126330             END-IF                                               12878099
126340         END-IF                                                   12879099
126350       END-IF                                                     12880099
126360     END-IF                                                       12881099
126370                                                                  12882099
126380**                                                                12883099
126390**  Error  Out  Any  Other  Status's                              12884099
126400                                                                  12885099
126410     IF  WS-VISION                                                12886099
126420       IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA      12887099
126430         IF  WS-HUB-ETNI                                          12888099
126440                 MOVE  LIT-STATUS-ERROR    TO  WS-COMMENT         12889099
126450                 ADD   +1  TO  WS-TOTL-HUB-STATUS-ERROR           12890099
126460                 PERFORM  6010-MOVE-ETNI-TO-RPT-HUB  THRU         12891099
126470                          6010-EXIT-HUB                           12892099
126480                 PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU         12893099
126490                          6510-EXIT                               12894099
126500                 GO TO 2300-EXIT                                  12895099
126510         END-IF                                                   12896099
126520       END-IF                                                     12897099
126530     END-IF                                                       12898099
126540**                                                                12899099
126550**  JA0602  - END                                                 12900099
126560                                                                  12901099
126570**  JA0602  - Start  For  New  Split  Logic                       12902099
126580                                                                  12903099
126590     IF  WS-SPLIT-BYPASS                                          12904099
126600         IF  WS-CTNIN-CTN-STATUS(1:1)  =  'A'                     12905099
126610             ADD   +1  TO  WS-TOTL-BYPASS-SPLIT                   12906099
126620             GO TO 2300-EXIT                                      12907099
126630         END-IF                                                   12908099
126640     END-IF                                                       12909099
126650                                                                  12910099
126660**  JA0507  - START                                               12911099
126660**  JA1012  - START - RTEL                                        12912099
126670                                                                  12913099
126680     IF  WS-VISION                                                12914099
126680       IF  WS-CTNIN-NL(2:4)  NOT  =  'RTEL'                       12915099
126690         IF WS-CTNIN-CTN-STATUS = 'PA'  OR                        12916099
126700            WS-CTNIN-CTN-STATUS = 'AA'                            12917099
126710                                                                  12918099
126720            GO TO 2300-CONTINUE-10                                12919099
126730         END-IF                                                   12920099
126730       END-IF                                                     12921099
126740     END-IF                                                       12922099
126750                                                                  12923099
126660**  JA1012  - START - RTEL                                        12924099
126670                                                                  12925099
126680     IF  WS-VISION                                                12926099
126680       IF  WS-CTNIN-NL(2:4)   =  'RTEL'                           12927099
126690         IF WS-CTNIN-CTN-STATUS = 'AA'                            12928099
126720            GO TO 2300-CONTINUE-10                                12929099
126730         END-IF                                                   12930099
126730       END-IF                                                     12931099
126740     END-IF                                                       12932099
126750                                                                  12933099
126760**  JA0507  - END                                                 12934099
126770                                                                  12935099
126780*                                                                 12936099
126790*       eTNI's CTN not on Biller's file  &  'AA'  Status          12937099
126800*       The CTN-INV  ROW  will  NOT  be  updated  For             12938099
126810*       BILLER-ID  VISION, Print Report & Bypass                  12939099
126820*                                                                 12940099
126830*  JA0410  - Added  Perm Reserve  NL(2:1) = H..Below              12941099
126840                                                                  12942099
126850     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        12943099
126860*-------port-outs have spaces in NL, so only compare NLs 1st byte-12944099
126870*-------to Biller from Header if the NL is populated!-------------12945099
126880          IF WS-CTNIN-NL(1:1) NOT = SPACE AND                     12946099
126890             WS-CTNIN-NL(1:1) NOT = LOW-VALUES AND                12947099
126900             WS-CTNIN-NL(1:1) NOT = WS-SAVE-HDR-BILLER-ID AND     12948099
126910             WS-CTNIN-NL(2:1) NOT =  'H'                          12949099
126920             ADD  +1 TO WS-TOTL-ERROR-RSS-BILL-NL-BYP             12950099
126930             MOVE WS-CTNIN-NL TO LIT-RSS-NL                       12951099
126940             MOVE WS-SAVE-HDR-BILLER-ID TO LIT-RSS-BILLER         12952099
126950             MOVE LIT-RSS-NL-1ST-TO-BILL-ID TO WS-COMMENT         12953099
126960             INITIALIZE WS-ADDTL-INFO                             12954099
126970             PERFORM 6010-MOVE-ETNI-TO-RPT  THRU 6010-EXIT        12955099
126980             PERFORM 6500-WRITE-ERROR-RPT   THRU 6500-EXIT        12956099
126990             GO TO 2300-EXIT                                      12957099
127000          END-IF                                                  12958099
127010        END-IF                                                    12959099
127020                                                                  12960099
127030*----it's OK for MDN to be missing in Biller if PO'd in eTNI------12961099
127040     IF WS-PARM-UPDATE AND                                        12962099
127050       (WS-CTNIN-CTN-STATUS NOT = 'PO' OR                         12963099
127060        WS-CTNIN-PORT-IND NOT = 'PO')                             12964099
127070        ADD   +1 TO WS-TOTL-ERROR-BILLER-NOTMTCH                  12965099
127080        MOVE  'ETNI'                   TO   WS-SYSTEM             12966099
127090        MOVE 'WARN: MDN NOT IN BILL*>ETNI ' TO WS-COMMENT         12967099
127100        MOVE WS-CTNIN-CTN-STATUS                                  12968099
127110                                    TO WS-COMMENT(24:2)           12969099
127120        PERFORM 6010-MOVE-ETNI-TO-RPT  THRU 6010-EXIT             12970099
127130        PERFORM 6500-WRITE-ERROR-RPT   THRU 6500-EXIT             12971099
127140        GO TO 2300-EXIT                                           12972099
127150     END-IF                                                       12973099
127160                                                                  12974099
127170**  JA0907  - START                                               12975099
127180                                                                  12976099
127190**  LOOKUP  BYPASS,  IF  MAX;  REPORT  &  EXIT                    12977099
127200                                                                  12978099
127210      PERFORM  VARYING   WS-CTN-STATUS-B-A-IDX                    12979099
127220               FROM  1  BY  1                                     12980099
127230               UNTIL  WS-CTN-STATUS-B-A-IDX  >                    12981099
127240                      WS-CTN-STATUS-B-A-IDX-MAX                   12982099
127250            OR                                                    12983099
127260                                                                  12984099
127270            WS-CTN-STATUS-BYPASS-ARRAY-LST(WS-CTN-STATUS-B-A-IDX) 12985099
127280                       =                                          12986099
127290            WS-CTNIN-CTN-STATUS                                   12987099
127300                                                                  12988099
127310      END-PERFORM                                                 12989099
127320                                                                  12990099
127330**  FOUND  IN  BYPASS  TABLE  ?                                   12991099
127340**    Y..Report  Warning, Create Report & Exit                    12992099
127350**                                                                12993099
127360     IF  WS-CTN-STATUS-B-A-IDX  <                                 12994099
127370         WS-CTN-STATUS-B-A-IDX-MAX  + 1                           12995099
127380         ADD   +1  TO  WS-TOTL-NOT-IN-BILLING-FEED                12996099
127390         MOVE  'ETNI'                   TO   WS-SYSTEM            12997099
127400         MOVE 'WARNING: MDN NOT IN BILL*' TO WS-COMMENT           12998099
127410         MOVE ' ETNI: '                   TO WS-ADDTL-INFO        12999099
127420         MOVE WS-CTNIN-CTN-STATUS                                 13000099
127430                                     TO WS-ADDTL-INFO(8:2)        13001099
127440         PERFORM 6010-MOVE-ETNI-TO-RPT  THRU 6010-EXIT            13002099
127450         PERFORM 6500-WRITE-ERROR-RPT   THRU 6500-EXIT            13003099
127460         GO TO 2300-EXIT                                          13004099
127470      END-IF                                                      13005099
127480                                                                  13006099
127490**  JA0907  - END                                                 13007099
127500                                                                  13008099
127510*=================================================================13009099
127520*    All the bypass logic is complete. Below starts REAL processng13010099
127530*=================================================================13011099
127540                                                                  13012099
127550     INITIALIZE USE-CTN-FIELDS-FOR-KEY                            13013099
127560     INITIALIZE CREATE-UNLOAD-HISTORY-FLAG                        13014099
127570     MOVE 'N' TO WS-ERROR-ALREADY-REPORTED                        13015099
127580                                                                  13016099
127590     IF WS-PARM-UPDDNA AND                                        13017099
127600        WS-CTNIN-PORT-IND = 'RE'                                  13018099
127610           MOVE WS-CTNIN-CTN-TEXT(1:10) TO NUMERIC-CTNIN-CTN      13019099
127620           MOVE NUMERIC-CTNIN-CTN TO MDN OF DCLTVZW-LSMS          13020099
127630           PERFORM 7200-CHECK-SPID-IN-LSMS THRU 7200-EXIT         13021099
127640           IF CTN-HAS-VZW-SPID = 'N'                              13022099
127650              MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  13023099
127660              MOVE 'N' TO WS-ERROR-ALREADY-REPORTED               13024099
127670              PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT         13025099
127680              IF WS-ERROR-FIELDS-FOUND AND                        13026099
127690                 WS-ERROR-ALREADY-REPORTED NOT = 'Y'              13027099
127700                    MOVE 'ETNI'  TO WS-SYSTEM                     13028099
127710                    PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT  13029099
127720                    PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT   13030099
127730                    GO TO 2300-EXIT                               13031099
127740              END-IF                                              13032099
127750                                                                  13033099
127760              MOVE 'N' TO WS-ERROR-ALREADY-REPORTED               13034099
127770                                                                  13035099
127780*----------update CTN-INV row-------------------------------------13036099
127790              PERFORM 7004-RE-PORTED-CTN-INV-UPD THRU 7004-EXIT   13037099
127800*----------change MIN-INV Status to "AP" so it's no longer in use-13038099
127810              MOVE 'AP' TO MODIFIED-MIN-STATUS                    13039099
127820              PERFORM 2184-UPDATE-MIN-STATUS THRU 2184-EXIT       13040099
127830              MOVE 'ETNI' TO WS-SYSTEM                            13041099
127840              MOVE LIT-UPD-PO-NOT-IN-BILL-COMMENT TO WS-COMMENT   13042099
127850              MOVE 'REG CTN PORTED ' TO WS-ADDTL-INFO             13043099
127860              PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT        13044099
127870              PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT        13045099
127880              PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT        13046099
127890              GO TO 2300-EXIT                                     13047099
127900           END-IF                                                 13048099
127910        END-IF                                                    13049099
127920                                                                  13050099
127930     INITIALIZE NH-AND-PENDDASG-R-FLAG                            13051099
127940     IF WS-CTNIN-CTN-STATUS = 'NH' AND                            13052099
127950        WS-CTNIN-HOLD-REASON(1:10) = 'PENDDASG-R'                 13053099
127960        MOVE 'Y' TO NH-AND-PENDDASG-R-FLAG                        13054099
127970        INITIALIZE NH-AND-OTHER-PENDING-FLAG                      13055099
127980                   USE-CTN-FIELDS-FOR-KEY                         13056099
127990                   CREATE-UNLOAD-HISTORY-FLAG                     13057099
128000        IF WS-PARM-UPDDNA AND                                     13058099
128010           WS-CTNIN-PORT-IND = 'RE'                               13059099
128020              MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  13060099
128030*----------create HISTORY row w. "GOODDASG-R" Hold-Reason in 2320-13061099
128040              PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT         13062099
128050              IF WS-ERROR-FIELDS-FOUND                            13063099
128060                 GO TO 2300-EXIT                                  13064099
128070              END-IF                                              13065099
128080*----------update CTN-INV row-------------------------------------13066099
128090              PERFORM 7009-NH-PENDING-CTN-INV-UPD THRU 7009-EXIT  13067099
128100*----------send an ASGN RAPI to the NEW Biller--------------------13068099
128110              PERFORM 9180-SEND-ASGN-RAPI THRU 9180-EXIT          13069099
128120              MOVE 'ETNI' TO WS-SYSTEM                            13070099
128130              MOVE BILLER-ID OF DCLCTN-INV TO                     13071099
128140                   LIT-UPD-PENDDASG-R-BILLER                      13072099
128150              MOVE LIT-UPD-PENDDASG-R-NOT-IN-BILL TO WS-COMMENT   13073099
128160              MOVE SPACE TO WS-ADDTL-INFO                         13074099
128170              PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT        13075099
128180              PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT        13076099
128190              PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT        13077099
128200              GO TO 2300-EXIT                                     13078099
128210           END-IF                                                 13079099
128220        END-IF                                                    13080099
128230                                                                  13081099
128240     INITIALIZE NH-AND-OTHER-PENDING-FLAG                         13082099
128250     MOVE WS-CTNIN-HOLD-REASON(1:10) TO                           13083099
128260          PENDING-HOLD-REASON-CODES-II                            13084099
128270                                                                  13085099
128280     IF WS-CTNIN-CTN-STATUS = 'NH' AND                            13086099
128290        VALID-PENDING-HOLD-REASON-II                              13087099
128300        MOVE 'Y' TO NH-AND-OTHER-PENDING-FLAG                     13088099
128310        INITIALIZE NH-AND-PENDDASG-R-FLAG                         13089099
128320     END-IF                                                       13090099
128330                                                                  13091099
128340                                                                  13092099
128350     INITIALIZE USE-CTN-FIELDS-FOR-KEY                            13093099
128360                CREATE-UNLOAD-HISTORY-FLAG                        13094099
128370                SHOULD-WE-DISCONNECT-FLAG                         13095099
128380                                                                  13096099
128390*----determine if we need to Disconnect and Unload by a read of---13097099
128400*----PORTIN-MDN-TDS table-----------------------------------------13098099
128410                                                                  13099099
128420     IF WS-CTNIN-CTN-STATUS NOT = 'NH'                            13100099
128430        AND                                                       13101099
128440       (WS-CTNIN-PORT-IND = 'PI' OR                               13102099
128450        WS-CTNIN-PORT-IND = 'IO')                                 13103099
128460        AND                                                       13104099
128470       (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)       13105099
128480           PERFORM 9170-READ-PORTIN-MDN-TDS THRU 9170-EXIT        13106099
128490     END-IF                                                       13107099
128500                                                                  13108099
128510*Case 1 of 2:                                                     13109099
128520*==========PORTIN-MDN-TDS says its NOT OK to Disconnect===========13110099
128530                                                                  13111099
128540*----based on the results of PORTIN-MDN-TDS lookup, do NOT--------13112099
128550*----disconnect, but then update HISTORY, CTN-INV and MIN-INV-----13113099
128560*                                                                 13114099
128570     IF SHOULD-WE-DISCONNECT-FLAG NOT = 'Y'                       13115099
128580        IF WS-CTNIN-CTN-STATUS NOT = 'NH'                         13116099
128590           AND                                                    13117099
128600          (WS-CTNIN-PORT-IND = 'PI' OR                            13118099
128610           WS-CTNIN-PORT-IND = 'IO')                              13119099
128620           AND                                                    13120099
128630          (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)    13121099
128640*----------first, create a HISTORY row identical to CTN-INV row---13122099
128650           MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                     13123099
128660           PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT            13124099
128670           IF WS-ERROR-FIELDS-FOUND                               13125099
128680              GO TO 2300-EXIT                                     13126099
128690           END-IF                                                 13127099
128700           PERFORM 7005-SPLIT-CTN-INV-UPD THROUGH 7005-EXIT       13128099
128710                                                                  13129099
128720*AGB 11/21/05                                                     13130099
128730           MOVE WS-CTNIN-BILLER-ID TO                             13131099
128740                WS-WHICH-BILLER-ID OF WS-COMMON-BILLERID          13132099
128750                                                                  13133099
128760           MOVE 'ETNI' TO WS-SYSTEM                               13134099
128770           MOVE LIT-SPLIT-COMMENT TO WS-COMMENT                   13135099
128780           MOVE SPACES TO WS-ADDTL-INFO                           13136099
128790           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           13137099
128800           PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT           13138099
128810           PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT           13139099
128820           GO TO 2300-CONTINUE-10                                 13140099
128830           END-IF                                                 13141099
128840       END-IF                                                     13142099
128850                                                                  13143099
128860*Case 2 of 2:                                                     13144099
128870*==========PORTIN-MDN-TDS says its OK to Disconnect===============13145099
128880                                                                  13146099
128890*----based on the results of PORTIN-MDN-TDS lookup, create an-----13147099
128900*----Unload History row and issue a Disconnect to the Gateway-----13148099
128910     IF SHOULD-WE-DISCONNECT-FLAG = 'Y'                           13149099
128920        IF WS-CTNIN-CTN-STATUS NOT = 'NH'                         13150099
128930           AND                                                    13151099
128940          (WS-CTNIN-PORT-IND = 'PI')                              13152099
128950** JA0907  WS-CTNIN-PORT-IND = 'IO')  ** Omit  Condition          13153099
128960           AND                                                    13154099
128970          (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)    13155099
128980*----------issue a Disconnect Message to the VZW Gateway----------13156099
128990*  JA0112  -  Comment  Out  DSCP  Processing                      13157099
129000**            ADD 1 TO DISCONNECT-MSG-COUNTER                     13158099
129010**            MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  13159099
129020**            PERFORM Q1000-ISSUE-DISCON-TO-GATEWAY THRU          13160099
129030**                    Q1000-EXIT                                  13161099
129040**                                                                13162099
129050*AGB 4/18/06--if CTN-INV row not found, dont write to MQ to-------13163099
129060*-------------prevent writing blank MQ records. (exit routine)----13164099
129070*-------------Keep a counter for display at end of pgm.-----------13165099
129080**            IF SQLCODE NOT = +0                                 13166099
129090**               ADD 1 TO WS-CANT-FIND-CTN-IN-Q1000               13167099
129100**               GO TO 2300-EXIT                                  13168099
129110**               END-IF                                           13169099
129120**                                                                13170099
129130**            PERFORM Q1010-PUT-DISCON-MESSAGE-TO-MQ THRU         13171099
129140**                    Q1010-EXIT                                  13172099
129150*----------create a HISTORY row identical to CTN-INV row----------13173099
129160              MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  13174099
129170              PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT         13175099
129180              IF WS-ERROR-FIELDS-FOUND                            13176099
129190                 GO TO 2300-EXIT                                  13177099
129200              END-IF                                              13178099
129210*----------create a HISTORY row with ULD, NA status, PI port-ind--13179099
129220              MOVE 'Y' TO CREATE-UNLOAD-HISTORY-FLAG              13180099
129230              MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  13181099
129240              PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT         13182099
129250              IF WS-ERROR-FIELDS-FOUND                            13183099
129260                 GO TO 2300-EXIT                                  13184099
129270              END-IF                                              13185099
129280*----------delete the CTN-INV row copied to History above---------13186099
129290              MOVE WS-CTNIN-CTN-TEXT (1:10) TO WS-MDN             13187099
129300              INITIALIZE NOT-DELETED-SW                           13188099
129310              PERFORM 7030-DELETE-CTN-INV THRU 7030-EXIT          13189099
129320*----------change MIN-INV Status to "AP" so it's no longer in use-13190099
129330              MOVE 'AP' TO MODIFIED-MIN-STATUS                    13191099
129340              PERFORM 2184-UPDATE-MIN-STATUS THRU 2184-EXIT       13192099
129350              MOVE 'ETNI' TO WS-SYSTEM                            13193099
129360              MOVE LIT-UNLOADED-COMMENT TO WS-COMMENT             13194099
129370              MOVE SPACES TO WS-ADDTL-INFO                        13195099
129380              PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT        13196099
129390              PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT        13197099
129400              PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT        13198099
129410*AXY042706 - BEG                                                  13199099
129420** JA0410     PERFORM Q1011-CMIT-QUEUE      THRU Q1011-EXIT       13200099
129430*AXY042706 - END                                                  13201099
129440              GO TO 2300-CONTINUE-10                              13202099
129450           END-IF                                                 13203099
129460     END-IF                                                       13204099
129470                                                                  13205099
129480     INITIALIZE USE-CTN-FIELDS-FOR-KEY                            13206099
129490     INITIALIZE CREATE-UNLOAD-HISTORY-FLAG                        13207099
129500     IF (WS-CTNIN-CTN-STATUS = 'PO' OR                            13208099
129510         WS-CTNIN-CTN-STATUS = 'NA')                              13209099
129520         AND                                                      13210099
129530         WS-CTNIN-PORT-IND = 'IO'                                 13211099
129540         AND                                                      13212099
129550        (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)      13213099
129560*----------create a HISTORY row identical to CTN-INV row--------- 13214099
129570           MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                     13215099
129580           PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT            13216099
129590           IF WS-ERROR-FIELDS-FOUND                               13217099
129600              GO TO 2300-EXIT                                     13218099
129610           END-IF                                                 13219099
129620*----------create a HISTORY row with ULD, NA status, PI Port-Ind--13220099
129630           MOVE 'Y' TO CREATE-UNLOAD-HISTORY-FLAG                 13221099
129640           MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                     13222099
129650           PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT            13223099
129660           IF WS-ERROR-FIELDS-FOUND                               13224099
129670              GO TO 2300-EXIT                                     13225099
129680           END-IF                                                 13226099
129690*----------delete the CTN-INV row copied to History above---------13227099
129700           MOVE WS-CTNIN-CTN-TEXT (1:10) TO WS-MDN                13228099
129710           INITIALIZE NOT-DELETED-SW                              13229099
129720           PERFORM 7030-DELETE-CTN-INV THRU 7030-EXIT             13230099
129730           MOVE 'ETNI' TO WS-SYSTEM                               13231099
129740           MOVE LIT-UNLOADED-COMMENT TO WS-COMMENT                13232099
129750           MOVE SPACES TO WS-ADDTL-INFO                           13233099
129760           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           13234099
129770           PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT           13235099
129780           PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT           13236099
129790           GO TO 2300-CONTINUE-10                                 13237099
129800     END-IF                                                       13238099
129810                                                                  13239099
129820*----If this is a Transitional Ported-Out CTN, write image of-----13240099
129830*----CTN-INV to History, update CTN-INV and change MIN-INV status-13241099
129840                                                                  13242099
129850     IF WS-CTNIN-CTN-STATUS NOT = 'PO' AND                        13243099
129860        WS-CTNIN-PORT-IND = 'PO'                                  13244099
129870        AND                                                       13245099
129880       (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)       13246099
129890*----------create a HISTORY row identical to CTN-INV row--------- 13247099
129900           MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                     13248099
129910           PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT            13249099
129920           IF WS-ERROR-FIELDS-FOUND                               13250099
129930              GO TO 2300-EXIT                                     13251099
129940           END-IF                                                 13252099
129950*----------update CTN-INV row------------------------------------ 13253099
129960           PERFORM 7003-TRANSITIONAL-CTN-INV-UPD THRU 7003-EXIT   13254099
129970*----------change MIN-INV Status to "AP" so it's no longer in use-13255099
129980           MOVE 'AP' TO MODIFIED-MIN-STATUS                       13256099
129990           PERFORM 2184-UPDATE-MIN-STATUS THRU 2184-EXIT          13257099
130000           MOVE 'ETNI' TO WS-SYSTEM                               13258099
130010           MOVE LIT-UPD-PO-NOT-IN-BILL-COMMENT TO WS-COMMENT      13259099
130020           MOVE 'TRANSITIONAL PO' TO WS-ADDTL-INFO                13260099
130030           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           13261099
130040           PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT           13262099
130050           PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT           13263099
130060           GO TO 2300-CONTINUE-10                                 13264099
130070        END-IF                                                    13265099
130080                                                                  13266099
130090**  JA0507  - START                                               13267099
130100                                                                  13268099
130110     IF  WS-VISION                                                13269099
130120         IF WS-CTNIN-CTN-STATUS = 'AG'  AND                       13270099
130130            WS-CTNIN-PORT-IND   = 'SB'                            13271099
130140                                                                  13272099
130150              GO TO 2300-EXIT                                     13273099
130160         END-IF                                                   13274099
130170     END-IF                                                       13275099
130180                                                                  13276099
130190**  JA0507  - END                                                 13277099
130200                                                                  13278099
130210*-------PARM: UPDDEL or UPDDNA------------------------------------13279099
130220     IF WS-PARM-UPDDEL OR WS-PARM-UPDDNA                          13280099
130230        ADD +1 TO WS-TOTL-ETNI-NOT-IN-BILL-PROC                   13281099
130240        PERFORM 2030-CONVERT-ETNI-DATE THRU 2030-EXIT             13282099
130250        MOVE    WS-CTNIN-BILLER-ID      TO WS-BILLER-ID           13283099
130260        MOVE    WS-CTNIN-CTN-STATUS     TO WS-OLD-STATUS          13284099
130270        MOVE    WS-CTNIN-PRODUCT-TYPE   TO WS-OLD-PRODUCT-TYPE    13285099
130280        MOVE    WS-CTNIN-NL             TO WS-OLD-NL              13286099
130290        MOVE    WS-CTNIN-NGP            TO WS-OLD-NGP             13287099
130300        IF WS-PARM-UPDDEL                                         13288099
130310           MOVE SPACES                  TO WS-NEW-STATUS          13289099
130320                                           WS-NEW-PRODUCT-TYPE    13290099
130330                                           WS-NEW-NL              13291099
130340                                           WS-NEW-NGP             13292099
130350        END-IF                                                    13293099
130360                                                                  13294099
130370        IF WS-PARM-UPDDNA                                         13295099
130380           MOVE 'N' TO NOT-UPDATED-SW                             13296099
130390*--* LMS 10/17/2003 begin added IO port ind to this code          13297099
130400           IF WS-CTNIN-PORT-IND = 'PO' OR 'PI' OR 'IO'            13298099
130410*--* LMS 10/17/2003 end added IO port ind to this code            13299099
130420               MOVE  WS-OLD-STATUS          TO WS-NEW-STATUS      13300099
130430               MOVE 'Y' TO NOT-UPDATED-SW                         13301099
130440           ELSE                                                   13302099
130450*          (not Ported CTNs get NA for Status)                    13303099
130460               MOVE 'N' TO NOT-UPDATED-SW                         13304099
130470               MOVE 'NA'                    TO WS-NEW-STATUS      13305099
130480        END-IF                                                    13306099
130490*--* #850803-2 LMS 4/21/2003 end                                  13307099
130500           MOVE WS-CTNIN-PRODUCT-TYPE   TO WS-NEW-PRODUCT-TYPE    13308099
130510***FIX0928 SCB NA HAS NO NL                                       13309099
130520***SCB     MOVE WS-CTNIN-NL             TO WS-NEW-NL              13310099
130530           MOVE SPACES                  TO WS-NEW-NL              13311099
130540           MOVE WS-CTNIN-NGP            TO WS-NEW-NGP             13312099
130550        END-IF                                                    13313099
130560     END-IF                                                       13314099
130570                                                                  13315099
130580     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA OR     13316099
130590        WS-PARM-UPDATX OR WS-PARM-UPDDEX                          13317099
130600        MOVE WS-CTNIN-CTN-STATUS TO WS-OLD-STATUS                 13318099
130610     END-IF                                                       13319099
130620                                                                  13320099
130630                                                                  13321099
130640**  JA1207B  -  Start  -  Lookup       -                          13322099
130650                                                                  13323099
130660**  LOOKUP  BYPASS,  IF  MAX;  REPORT  &  EXIT                    13324099
130670                                                                  13325099
130680      PERFORM  VARYING   WS-CTN-STATUS-B-A-IDX                    13326099
130690               FROM  1  BY  1                                     13327099
130700               UNTIL  WS-CTN-STATUS-B-A-IDX  >                    13328099
130710                      WS-CTN-STATUS-B-A-IDX-MAX                   13329099
130720                                                                  13330099
130730        OR                                                        13331099
130740                                                                  13332099
130750        WS-CTN-STATUS-TO-AA-ARRAY-LST(WS-CTN-STATUS-B-A-IDX)(1:2) 13333099
130760                     =                                            13334099
130770        WS-CTNIN-CTN-STATUS                                       13335099
130780                                                                  13336099
130790      END-PERFORM                                                 13337099
130800                                                                  13338099
130810     SET  WS-CTN-STATUS-TO-AA-NOTFOUND  TO  TRUE                  13339099
130820                                                                  13340099
130830**  FOUND  IN  SET-TO-AA  TABLE  ?                                13341099
130840**    Y..Report  Set  Flag  As  Such                              13342099
130850**                                                                13343099
130850**  JA1012  -  SET-TO-AA  - is  NOW  NO_OP'd  (no Operation)      13344099
130850**                                                                13345099
130860***  IF  WS-CTN-STATUS-B-A-IDX  <                                 13346099
130870***      WS-CTN-STATUS-B-A-IDX-MAX  + 1                           13347099
130880***      SET  WS-CTN-STATUS-TO-AA  TO  TRUE                       13348099
130890***  END-IF                                                       13349099
130900                                                                  13350099
130910**  JA1207B  -  Start  -  Next  Cond.  -                          13351099
130920                                                                  13352099
130930**  JA0402  -   WS-LEGIT-BILLER-ID-RESELLER ADDED                 13353099
130940                                                                  13354099
130950     IF  WS-LEGIT-BILLER-ID-RESELLER AND                          13355099
130960         WS-CTN-STATUS-TO-AA  AND                                 13356099
130970         WS-PARM-PROCESS-REQ(1:3)  =  'UPD'  AND                  13357099
134490         WS-CTNIN-ICC-ID-4G  NOT  >  SPACES                       13358099
130980         MOVE WS-CTNIN-CTN-TEXT(1:10) TO WS-MDN                   13359099
130990         PERFORM  7000-SELECT-CTN-INV   THRU 7000-EXIT            13360099
131000         IF  WS-SQLCODE  =  +0  AND                               13361099
131010             MIN-NUM-TEXT  OF  DCLCTN-INV  NUMERIC                13362099
131020               MOVE   MIN-NUM-TEXT  OF  DCLCTN-INV  TO            13363099
131030                                        WS-TEMP-MIN-NUM-TEXT      13364099
131040               MOVE   NL  OF  DCLCTN-INV            TO  WS-NL     13365099
131050                                                    WS-SAVED-NL   13366099
131060               MOVE  NGP OF  DCLCTN-INV             TO  WS-NGP    13367099
131070                                                    WS-HOLD-NGP   13368099
131080               MOVE  PRODUCT-TYPE  OF  DCLCTN-INV                 13369099
131090                                       TO  WS-PRODUCT-TYPE        13370099
131100               PERFORM  7500-SELECT-NUMBER-GRP-LOC                13371099
131110                                        THRU  7500-EXIT           13372099
131120**                                                                13373099
131130**       Process  As  Before,  If  Found                          13374099
131140**         Else..Update CTN-INV-HISTORY, CTN-INV,                 13375099
131150**                      NUMBER-GROUP, & MIN-INV                   13376099
131160**                      Create Recon Report, exit                 13377099
131170**                                                                13378099
131180         IF  WS-SQLCODE  =  +0                                    13379099
131190             CONTINUE                                             13380099
131200                                                                  13381099
131210           ELSE                                                   13382099
131220                                                                  13383099
131230          PERFORM  2320-POPULATE-CTN-HIST  THRU   2320-EXIT       13384099
131240          PERFORM  7100-INSERT-CTN-HIST    THRU   7100-EXIT       13385099
131250          PERFORM  7120-RETRY-UP-TO-10-TIMES THRU 7120-EXIT       13386099
131260          IF SQL-DUP-INSERT                                       13387099
131270             SET WS-ERROR-FIELDS-FOUND TO TRUE                    13388099
131280             PERFORM 6030-INIT-DETAIL-LINE THRU 6030-EXIT         13389099
131290             PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT         13390099
131300             MOVE 'ETNI' TO WS-SYSTEM                             13391099
131310             MOVE LIT-CTN-HIST-INSERT-ERROR TO WS-COMMENT         13392099
131320             MOVE CTN-TEXT OF DCLCTN-INV-HISTORY TO               13393099
131330                  WS-ADDTL-INFO (1:10)                            13394099
131340             MOVE PRODUCT-TYPE OF DCLCTN-INV-HISTORY TO           13395099
131350                  WS-ADDTL-INFO (12:1)                            13396099
131360             PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT         13397099
131370             PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT          13398099
131380             GO TO 2300-EXIT                                      13399099
131390         END-IF                                                   13400099
131400                                                                  13401099
131410         PERFORM  7040-GET-BILLER-FROM-NGP-TABLE THRU  7040-EXIT  13402099
131420                                                                  13403099
131430           IF  WS-SQLCODE  =  ZERO                                13404099
131440               MOVE  WS-ETNDC38-BILLER  TO                        13405099
131450                                    BILLER-ID  OF  DCLCTN-INV     13406099
131460           END-IF                                                 13407099
131470                                                                  13408099
131480         PERFORM  7019-UPDATE-CTN-INV-STATUS   THRU  7019-EXIT    13409099
131490         PERFORM  2190-UPD-NEW-MIN-NUM-STAT    THRU  2190-EXIT    13410099
131500                                                                  13411099
131510           IF SQL-ROW-NOT-FOUND                                   13412099
131520              SET  WS-ERROR-FIELDS-FOUND    TO   TRUE             13413099
131530              PERFORM  6010-MOVE-ETNI-TO-RPT    THRU   6010-EXIT  13414099
131540              PERFORM  6500-WRITE-ERROR-RPT     THRU   6500-EXIT  13415099
131550              MOVE 'N' TO NOT-UPDATED-SW                          13416099
131560              GO TO 2300-EXIT                                     13417099
131570           END-IF                                                 13418099
131580                                                                  13419099
131590          MOVE  NL  OF  DCLCTN-INV  TO  WS-NL                     13420099
131600          MOVE  NGP OF  DCLCTN-INV  TO  WS-NGP                    13421099
131610                                                                  13422099
131620          PERFORM  7510-SELECT-NGP-NL-ASSIGNMENT  THRU  7510-EXIT 13423099
131630                                                                  13424099
131640           IF  WS-SQLCODE =  +0                                   13425099
131650               COMPUTE  WS-QTY  =  AA-STS-CNT  +  1               13426099
131660               PERFORM  7520-UPDATE-NGP-NL-ASSIGNMENT             13427099
131670                                                THRU  7520-EXIT   13428099
131680           END-IF                                                 13429099
131690                                                                  13430099
131700         MOVE  'ETNI'  TO  WS-SYSTEM                              13431099
131710         MOVE  CTN-STATUS  OF  DCLCTN-INV  TO                     13432099
131720                                           WS-CTNIN-CTN-STATUS    13433099
131730         MOVE  NL  OF  DCLCTN-INV    TO    WS-CTNIN-NL            13434099
131740         MOVE  NGP OF  DCLCTN-INV    TO    WS-CTNIN-NGP           13435099
131750         MOVE  BILLER-ID  OF  DCLCTN-INV   TO                     13436099
131760                                           WS-CTNIN-BILLER-ID     13437099
131770         MOVE  LAST-TRX-CODE  OF  DCLCTN-INV  TO                  13438099
131780                                           WS-CTNIN-LAST-TRX-CODE 13439099
131790                                                                  13440099
131800         MOVE  'AA'  TO  COMMENT-STATUS                           13441099
131810         MOVE  LIT-DYNAMIC-STATUS-COMMENT   TO    WS-COMMENT      13442099
131820                                                                  13443099
131830         PERFORM  6010-MOVE-ETNI-TO-RPT    THRU   6010-EXIT       13444099
131840         PERFORM  6400-WRITE-RECON-RPT     THRU   6400-EXIT       13445099
131850         MOVE 'N' TO NOT-UPDATED-SW                               13446099
131860                                                                  13447099
131870         PERFORM 6300-PRINT-BLANK-LINE     THRU   6300-EXIT       13448099
131880         GO TO 2300-CONTINUE-10                                   13449099
131890         END-IF                                                   13450099
131900       END-IF                                                     13451099
131910     END-IF                                                       13452099
131920                                                                  13453099
131930**  JA1207B  -  End                                               13454099
131940                                                                  13455099
131950**  JA1207B  -  Start  -  Next  Cond.  -                          13456099
131950**           -  Removed  WS-CTN-STATUS-TO-AA   Cond.              13457099
131960                                                                  13458099
131970     IF  WS-VISION  AND                                           13459099
131980        (WS-CTNIN-CTN-STATUS  =  'AG'  OR  'PA'  OR  'AR')  AND   13460099
131980         WS-CTNIN-PORT-IND    =  'RE'  AND                        13461099
131980***      WS-CTN-STATUS-TO-AA  AND                                 13462099
131990         WS-PARM-PROCESS-REQ(1:3)  =  'UPD'                       13463099
132000         MOVE WS-CTNIN-CTN-TEXT(1:10) TO WS-MDN                   13464099
132010         PERFORM  7000-SELECT-CTN-INV   THRU 7000-EXIT            13465099
132020         IF  WS-SQLCODE  =  +0  AND                               13466099
132030             MIN-NUM-TEXT  OF  DCLCTN-INV  NUMERIC                13467099
132040               MOVE   MIN-NUM-TEXT  OF  DCLCTN-INV  TO            13468099
132050                                        WS-TEMP-MIN-NUM-TEXT      13469099
132060               MOVE   NL  OF  DCLCTN-INV            TO  WS-NL     13470099
132070                                                    WS-SAVED-NL   13471099
132080               MOVE  NGP OF  DCLCTN-INV             TO  WS-NGP    13472099
132090                                                    WS-HOLD-NGP   13473099
132100               MOVE  PRODUCT-TYPE  OF  DCLCTN-INV  TO             13474099
132110                                             WS-PRODUCT-TYPE      13475099
132120**                                                                13476099
132130**       Process                                                  13477099
132140**               Update CTN-INV-HISTORY, CTN-INV,                 13478099
132150**                      NUMBER-GROUP, & MIN-INV                   13479099
132160**                      Create Recon Report, exit                 13480099
132170**                                                                13481099
132180             PERFORM  2320-POPULATE-CTN-HIST  THRU   2320-EXIT    13482099
132190             PERFORM  7100-INSERT-CTN-HIST    THRU   7100-EXIT    13483099
132200             PERFORM  7120-RETRY-UP-TO-10-TIMES THRU 7120-EXIT    13484099
132210                                                                  13485099
132220            IF SQL-DUP-INSERT                                     13486099
132230               SET WS-ERROR-FIELDS-FOUND TO TRUE                  13487099
132240               PERFORM 6030-INIT-DETAIL-LINE THRU 6030-EXIT       13488099
132250               PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT       13489099
132260               MOVE 'ETNI' TO WS-SYSTEM                           13490099
132270               MOVE LIT-CTN-HIST-INSERT-ERROR TO WS-COMMENT       13491099
132280               MOVE CTN-TEXT OF DCLCTN-INV-HISTORY TO             13492099
132290                    WS-ADDTL-INFO (1:10)                          13493099
132300               MOVE PRODUCT-TYPE OF DCLCTN-INV-HISTORY TO         13494099
132310                    WS-ADDTL-INFO (12:1)                          13495099
132320               PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT       13496099
132330               PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT        13497099
132340               GO TO 2300-CONTINUE-10                             13498099
132350            END-IF                                                13499099
132360                                                                  13500099
132370         PERFORM  7040-GET-BILLER-FROM-NGP-TABLE THRU  7040-EXIT  13501099
132380*                                                                 13502099
132390           IF  WS-SQLCODE  =  ZERO                                13503099
132400               MOVE  WS-ETNDC38-BILLER  TO                        13504099
132410                                    BILLER-ID  OF  DCLCTN-INV     13505099
132420           END-IF                                                 13506099
132430                                                                  13507099
096110* NUMBER LOCATION VALIDATION  -                                   13508099
096100                                                                  13509099
               MOVE  WS-CTNIN-NL  TO  WS-NL                             13510099
                                                                        13511099
      * JA1012  -  Minimize  NL  Access,  If  Same                      13512099
                                                                        13513099
096144         IF  WS-NL  NOT  =  WS-NL-SAVED                           13514099
096150            PERFORM 7400-SELECT-NUMBER-LOCATION    THRU 7400-EXIT 13515099
096160           IF SQL-ROW-NOT-FOUND                                   13516099
096144             MOVE    SPACES                      TO   WS-NL-SAVED 13517099
096170             ADD     +1 TO WS-TOTL-ERROR-NUMLOC-NOTFND            13518099
096180             SET     WS-ERROR-FIELDS-FOUND       TO   TRUE        13519099
096190             MOVE    LIT-NL-ERROR                TO   WS-COMMENT  13520099
096200             MOVE    WS-NL                       TO               13521099
096200                                                    WS-ADDTL-INFO 13522099
096210             GO  TO  2300-EXIT                                    13523099
096220           END-IF                                                 13524099
096230         END-IF                                                   13525099
131500                                                                  13526099
      * JA1012  -  Below  Move                                          13527099
096144         MOVE  WS-NL  TO   WS-NL-SAVED                            13528099
131500                                                                  13529099
132440         PERFORM  7019-UPDATE-CTN-INV-STATUS   THRU  7019-EXIT    13530099
132450         PERFORM  2190-UPD-NEW-MIN-NUM-STAT    THRU  2190-EXIT    13531099
132460                                                                  13532099
132470           IF SQL-ROW-NOT-FOUND                                   13533099
132480              SET  WS-ERROR-FIELDS-FOUND    TO   TRUE             13534099
132490              PERFORM  6010-MOVE-ETNI-TO-RPT    THRU   6010-EXIT  13535099
132500              PERFORM  6500-WRITE-ERROR-RPT     THRU   6500-EXIT  13536099
132510              MOVE 'N' TO NOT-UPDATED-SW                          13537099
132520              GO TO 2300-EXIT                                     13538099
132530           END-IF                                                 13539099
132540                                                                  13540099
132550          MOVE  NL  OF  DCLCTN-INV  TO  WS-NL                     13541099
132560          MOVE  NGP OF  DCLCTN-INV  TO  WS-NGP                    13542099
132570                                                                  13543099
132580          PERFORM  7510-SELECT-NGP-NL-ASSIGNMENT  THRU  7510-EXIT 13544099
132590                                                                  13545099
132600           IF  WS-SQLCODE =  +0                                   13546099
132610               COMPUTE  WS-QTY  =  AA-STS-CNT  +  1               13547099
132620               PERFORM  7520-UPDATE-NGP-NL-ASSIGNMENT             13548099
132630                                                THRU  7520-EXIT   13549099
132640           END-IF                                                 13550099
132650                                                                  13551099
132660          MOVE  'ETNI'  TO  WS-SYSTEM                             13552099
132670          MOVE  CTN-STATUS  OF  DCLCTN-INV  TO                    13553099
132680                                            WS-CTNIN-CTN-STATUS   13554099
132690          MOVE  NL  OF  DCLCTN-INV    TO    WS-CTNIN-NL           13555099
132700          MOVE  NGP OF  DCLCTN-INV    TO    WS-CTNIN-NGP          13556099
132710          MOVE  BILLER-ID  OF  DCLCTN-INV   TO                    13557099
132720                                            WS-CTNIN-BILLER-ID    13558099
132730          MOVE  LAST-TRX-CODE  OF  DCLCTN-INV  TO                 13559099
132740                                           WS-CTNIN-LAST-TRX-CODE 13560099
132750                                                                  13561099
132760          MOVE  'AA'  TO  COMMENT-STATUS                          13562099
132770          MOVE  LIT-DYNAMIC-STATUS-COMMENT   TO    WS-COMMENT     13563099
132780                                                                  13564099
132790         PERFORM  6010-MOVE-ETNI-TO-RPT    THRU   6010-EXIT       13565099
132800         PERFORM  6400-WRITE-RECON-RPT     THRU   6400-EXIT       13566099
132810         MOVE 'N' TO NOT-UPDATED-SW                               13567099
132820                                                                  13568099
132830         PERFORM 6300-PRINT-BLANK-LINE     THRU   6300-EXIT       13569099
132840         GO TO 2300-CONTINUE-10                                   13570099
132850       END-IF                                                     13571099
132860     END-IF                                                       13572099
132870                                                                  13573099
132880**  JA1207B  -  End                                               13574099
132890                                                                  13575099
132900*-------PARM: UPDDEL or UPDDNA------------------------------------13576099
132910                                                                  13577099
132920* UPDATE + DELETE PROCESS                                         13578099
132930     IF WS-PARM-UPDDEL OR WS-PARM-UPDDNA                          13579099
132940* RETRIEVE CTN-INV RECORD                                         13580099
132950        MOVE WS-CTNIN-PRODUCT-TYPE TO WS-PRODUCT-TYPE             13581099
132960**      added line below 3/24/04...                               13582099
132970**                                                                13583099
132980        MOVE WS-CTNIN-CTN-TEXT(1:10) TO WS-MDN                    13584099
132990        PERFORM  7000-SELECT-CTN-INV   THRU 7000-EXIT             13585099
133000                                                                  13586099
133010        IF SQL-ROW-NOT-FOUND                                      13587099
133020           ADD   +1 TO WS-TOTL-ERROR-CTNINV-NOTFND                13588099
133030           SET   WS-ERROR-FIELDS-FOUND   TO TRUE                  13589099
133040           MOVE  LIT-CTN-INV-ERROR       TO WS-COMMENT            13590099
133050           MOVE  WS-MDN                  TO WS-ADDTL-INFO (1:10)  13591099
133060           MOVE  WS-PRODUCT-TYPE         TO WS-ADDTL-INFO (12:1)  13592099
133070           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           13593099
133080           PERFORM 6500-WRITE-ERROR-RPT  THRU 6500-EXIT           13594099
133090           GO TO 2300-EXIT                                        13595099
133100        END-IF                                                    13596099
133110                                                                  13597099
133120     IF CREATE-UNLOAD-HISTORY-FLAG NOT = 'Y'                      13598099
133130*****   NH-AND-PENDDASG-R-FLAG NOT = 'Y'                          13599099
133140        PERFORM 2103-CALL-ETNDC15-HIST-INSERT THRU 2103-EXIT      13600099
133150*****   GO TO 2300-CONTINUE-10                                    13601099
133160        END-IF                                                    13602099
133170                                                                  13603099
133180     IF CREATE-UNLOAD-HISTORY-FLAG = 'Y'                          13604099
133190*****   NH-AND-PENDDASG-R-FLAG = 'Y'                              13605099
133200        PERFORM 2320-POPULATE-CTN-HIST THRU 2320-EXIT             13606099
133210        PERFORM 7100-INSERT-CTN-HIST THRU 7100-EXIT               13607099
133220        PERFORM 7120-RETRY-UP-TO-10-TIMES THRU 7120-EXIT          13608099
133230        IF SQL-DUP-INSERT                                         13609099
133240           SET WS-ERROR-FIELDS-FOUND TO TRUE                      13610099
133250           PERFORM 6030-INIT-DETAIL-LINE THRU 6030-EXIT           13611099
133260           PERFORM 6400-WRITE-RECON-RPT THRU 6400-EXIT            13612099
133270           MOVE 'ETNI' TO WS-SYSTEM                               13613099
133280           MOVE LIT-CTN-HIST-INSERT-ERROR TO WS-COMMENT           13614099
133290           MOVE CTN-TEXT OF DCLCTN-INV-HISTORY TO                 13615099
133300                WS-ADDTL-INFO (1:10)                              13616099
133310           MOVE PRODUCT-TYPE OF DCLCTN-INV-HISTORY TO             13617099
133320                WS-ADDTL-INFO (12:1)                              13618099
133330           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           13619099
133340           PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT            13620099
133350           GO TO 2300-EXIT                                        13621099
133360           END-IF                                                 13622099
133370        END-IF                                                    13623099
133380                                                                  13624099
133390***FIX0928 SCB CTN IS UNLOADED FOR UPDDEL ONLY                    13625099
133400                                                                  13626099
133410*-------PARM: UPDDEL----------------------------------------------13627099
133420        IF WS-PARM-UPDDEL                                         13628099
133430           PERFORM 2330-POPULATE-CTN-HIST-ULD   THRU 2330-EXIT    13629099
133440           PERFORM 7100-INSERT-CTN-HIST         THRU 7100-EXIT    13630099
133450           PERFORM 7120-RETRY-UP-TO-10-TIMES    THRU 7120-EXIT    13631099
133460           IF SQL-DUP-INSERT                                      13632099
133470              PERFORM 6030-INIT-DETAIL-LINE     THRU 6030-EXIT    13633099
133480              PERFORM 6400-WRITE-RECON-RPT      THRU 6400-EXIT    13634099
133490              MOVE   'ETNI'                     TO   WS-SYSTEM    13635099
133500              MOVE    LIT-CTN-HIST-INSERT-ERROR TO   WS-COMMENT   13636099
133510              MOVE    CTN-TEXT     OF DCLCTN-INV-HISTORY          13637099
133520                                   TO WS-ADDTL-INFO (1:10)        13638099
133530              MOVE    PRODUCT-TYPE OF DCLCTN-INV-HISTORY          13639099
133540                                   TO WS-ADDTL-INFO (12:1)        13640099
133550              PERFORM 6010-MOVE-ETNI-TO-RPT     THRU 6010-EXIT    13641099
133560              PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT    13642099
133570              GO TO 2300-EXIT                                     13643099
133580              END-IF                                              13644099
133590* DELETE CTN-INV RECORD                                           13645099
133600***FIX0928 INCLUDED WITH PREVIOUS IF                              13646099
133610***      IF WS-PARM-UPDDEL                                        13647099
133620           MOVE WS-CTNIN-CTN-TEXT (1:WS-CTNIN-CTN-LEN) TO WS-MDN  13648099
133630           MOVE WS-CTNIN-PRODUCT-TYPE        TO   WS-PRODUCT-TYPE 13649099
133640           IF (WS-CTNIN-PORT-IND = 'PO' OR                        13650099
133650               WS-CTNIN-PORT-IND = 'PI' OR                        13651099
133660               WS-CTNIN-PORT-IND = 'IO')                          13652099
133670*--* LMS 10/17/2003 end added IO port ind to this code            13653099
133680               MOVE 'Y' TO NOT-DELETED-SW                         13654099
133690           ELSE                                                   13655099
133700               MOVE 'N' TO NOT-DELETED-SW                         13656099
133710               PERFORM 7030-DELETE-CTN-INV THRU 7030-EXIT         13657099
133720               END-IF                                             13658099
133730*--* #850803-2 LMS 4/21/2003 end                                  13659099
133740         END-IF                                                   13660099
133750*****                                                             13661099
133760* UPDATE CTN STATUS TO "NA" (only for "UPDDNA" parm!)             13662099
      *-------PARM: UPDDNA----------------------------------------------13663099
133780     IF WS-PARM-UPDDNA                                            13664099
133790        PERFORM 7015-UPDATE-CTN-INV-STATUS   THRU 7015-EXIT       13665099
133800     END-IF                                                       13666099
133810                                                                  13667099
133820* UPDATE MIN STATUS TO AA                                         13668099
133830*       below status is from WS-CTNIN-CTN-STATUS (CTN-INV status)-13669099
133840     IF WS-OLD-STATUS = 'AI' OR 'AG' OR 'AR' OR 'AT' OR           13670099
133850                        'AA' OR 'NA' OR 'NH' OR 'PA'              13671099
133860**  JA0507  -  ABOVE  1  LINE  ADDED  'PA'                        13672099
133870        PERFORM 7830-UPDATE-MIN-INV-STATUS   THRU 7830-EXIT       13673099
133880     END-IF                                                       13674099
133890                                                                  13675099
133900* UPDATE STATUS COUNTERS                                          13676099
133910        PERFORM 2150-UPDATE-STATUS-COUNTERS  THRU 2150-EXIT       13677099
133920        IF WS-ERROR-FIELDS-FOUND                                  13678099
133930           MOVE   'ETNI'                     TO   WS-SYSTEM       13679099
133940           PERFORM 6010-MOVE-ETNI-TO-RPT     THRU 6010-EXIT       13680099
133950           PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT       13681099
133960           GO TO 2300-EXIT                                        13682099
133970        END-IF                                                    13683099
133980     ELSE                                                         13684099
133990        PERFORM 2320-POPULATE-CTN-HIST       THRU 2320-EXIT       13685099
134000     END-IF                                                       13686099
134010                                                                  13687099
134020* REPORT UPDATED STATUS ETNI CTN RECORD                           13688099
134030                                                                  13689099
134040*-------PARM: UPDDNA----------------------------------------------13690099
134050                                                                  13691099
134060     IF WS-PARM-UPDDNA                                            13692099
134070        IF NOT-UPDATED-SW = 'Y'                                   13693099
134080            MOVE LIT-NOT-UPDATED-COMMENT TO WS-COMMENT            13694099
134090        ELSE                                                      13695099
134100            MOVE LIT-UPDATED-STATUS-COMMENT TO WS-COMMENT         13696099
134110        END-IF                                                    13697099
134120     ELSE                                                         13698099
134130* REPORT DELETED ETNI CTN RECORD                                  13699099
134140        MOVE LIT-DELETED-COMMENT TO WS-COMMENT                    13700099
134150*--* #850803-2 LMS 4/21/2003 BEGIN                                13701099
134160        IF NOT-DELETED-SW = 'Y'                                   13702099
134170            MOVE LIT-NOT-DELETED-COMMENT TO WS-COMMENT            13703099
134180        END-IF                                                    13704099
134190        MOVE 'N' TO NOT-DELETED-SW                                13705099
134200*--* #850803-2 LMS 4/21/2003 END                                  13706099
134210     END-IF                                                       13707099
134220                                                                  13708099
134230     IF WS-CTNIN-PORT-IND = 'PO' OR                               13709099
134240        WS-CTNIN-PORT-IND = 'IO'                                  13710099
134250        ADD 1 TO WS-PO-IN-ETNI-NOT-IN-BILL                        13711099
134260        GO TO 2300-EXIT                                           13712099
134270     END-IF                                                       13713099
134280                                                                  13714099
134290     MOVE   'ETNI'                      TO   WS-SYSTEM            13715099
134300*----if UPDDNA parm and we DID update CTN-INV status, show it-----13716099
134310     IF WS-PARM-UPDDNA AND NOT-UPDATED-SW NOT = 'Y'               13717099
134320        MOVE CTN-STATUS OF DCLCTN-INV TO COMMENT-STATUS           13718099
134330        MOVE LIT-DYNAMIC-STATUS-COMMENT TO WS-COMMENT             13719099
134340     ELSE                                                         13720099
134350        MOVE LIT-UPDATED-COMMENT-BILL   TO WS-COMMENT             13721099
134360        END-IF                                                    13722099
134370     MOVE    SPACES                     TO   WS-ADDTL-INFO        13723099
134380     PERFORM 6010-MOVE-ETNI-TO-RPT      THRU 6010-EXIT            13724099
134390     PERFORM 6400-WRITE-RECON-RPT       THRU 6400-EXIT            13725099
134400     MOVE 'N' TO NOT-UPDATED-SW                                   13726099
134410     .                                                            13727099
134420 2300-CONTINUE-10.                                                13728099
134430                                                                  13729099
134440*-----------------------------------------------------------------13730099
134450*  JA1109  -   4G                                                 13731099
134460*-----------------------------------------------------------------13732099
134470                                                                  13733099
134480     IF  WS-CTNIN-IMSI       >  SPACES  OR                        13734099
134490         WS-CTNIN-ICC-ID-4G  >  SPACES                            13735099
134500         INITIALIZE  WS-LTE-DATA-LAYER                            13736099
134510                     WS-4G-DETAIL-LINE                            13737099
134520                     DETAIL-LINE-1                                13738099
134530                     WS-4G-ERROR-SW                               13739099
134540                     DCLSIM-INV                                   13740099
134550                     DCLVORA-IMSI-INV                             13741099
134560                                                                  13742099
134570         PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT            13743099
134580                                                                  13744099
134590         IF  WS-4G-ERROR-YES                                      13745099
134600             PERFORM  6010-MOVE-ETNI-TO-RPT  THRU  6010-EXIT      13746099
134610             PERFORM  6500-WRITE-ERROR-RPT   THRU  6500-EXIT      13747099
134620             MOVE  WS-4G-DETAIL-LINE  TO  DETAIL-LINE-1           13748099
134630             MOVE  LIT-SIM-VORA-ERROR  TO   DETAIL-1-COMMENT      13749099
134640             ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                    13750099
134650             PERFORM  6500-WRITE-ERROR-RPT   THRU  6500-EXIT      13751099
134660             GO  TO  2300-EXIT                                    13752099
134670         END-IF                                                   13753099
134680                                                                  13754099
134690*  JA1210   -  Only  Update,  If  Update NOT within 24 Hrs        13755099
134700                                                                  13756099
134710     IF  WS-CTNIN-IMSI       >  SPACES                            13757099
134720         PERFORM  4G-9100-SELECT-VORA-10  THRU  4G-9100-EXIT      13758099
134730         PERFORM  2041-CONVERT-VORA-DATE  THRU  2041-EXIT         13759099
134740         IF  WS-VORA-SYS-UPDATE-DATE2                             13760099
134750                             >  WS-HDR-DATE-TIME-MINUS-1DAY       13761099
134760             GO  TO   2300-EXIT                                   13762099
134770         END-IF                                                   13763099
134780     END-IF                                                       13764099
134790                                                                  13765099
134800*  JA1210   -  Only  Update,  If  Update NOT within 24 Hrs        13766099
134810                                                                  13767099
134820     IF  WS-CTNIN-ICC-ID-4G  >  SPACES                            13768099
134830         PERFORM  4G-9000-SELECT-SIM-10  THRU  4G-9000-EXIT       13769099
134840         PERFORM  2051-CONVERT-SIM-DATE  THRU  2051-EXIT          13770099
134850         IF  WS-SIM-SYS-UPDATE-DATE2                              13771099
134860                             >  WS-HDR-DATE-TIME-MINUS-1DAY       13772099
134870             GO  TO   2300-EXIT                                   13773099
134880         END-IF                                                   13774099
134890     END-IF                                                       13775099
134900                                                                  13776099
134910*  JA1210  -   4G Update                                          13777099
134920*  JA0111  - Below  Cond - rewritten                              13778099
134930                                                                  13779099
134940                                                                  13780099
      *  JA0612  -  Below  Conditions                                   13781099
134960*  ICC-ID-4G                                                      13782099
      *  JA0912  -  NA  COND  last                                      13783099
134970     IF  WS-CTNIN-CTN-STATUS  =  'AA'  OR  'NA'  OR               13784099
134980         WS-CTN-STATUS-TO-AA  OR                                  13785099
134990         WS-NEW-STATUS  =  'AA'  OR  'NA'  OR                     13786099
134990         CTN-STATUS OF DCLCTN-INV  =  'NA' OR                     13787099
135000         MODIFIED-MIN-STATUS  =  'AP'                             13788099
135010         IF  WS-PARM-UPDATE OR WS-PARM-UPDDEL                     13789099
135020                            OR WS-PARM-UPDDNA                     13790099
135030             IF  WS-CTNIN-ICC-ID-4G  >  SPACES                    13791099
135040                 PERFORM  4G-UPDATE  THRU  4G-UPDATE-EXIT         13792099
135050                 GO  TO  2300-EXIT                                13793099
135060             END-IF                                               13794099
135070         END-IF                                                   13795099
135080     END-IF                                                       13796099
135090                                                                  13797099
135100*  IMSI                                    ---                    13798099
135200*  JA0612  -  IMSI  Handling  - Officially NOT  Supported         13799099
135210*  IMSI                                    ---                    13800099
135210*  JA0912  -  NA - Last                    ---                    13801099
135220        IF  WS-CTNIN-CTN-STATUS  =  'AA'  OR  'NA'  OR            13802099
135230            WS-CTN-STATUS-TO-AA  OR                               13803099
135240            WS-NEW-STATUS  =  'AA'  OR  'NA'  OR                  13804099
134990            CTN-STATUS OF DCLCTN-INV  =  'NA'                     13805099
135250            IF  WS-PARM-UPDATE OR WS-PARM-UPDDEL                  13806099
135260                               OR WS-PARM-UPDDNA                  13807099
135270              IF  SQLCODE  =  +0                                  13808099
135280                  IF IMSI-STATUS OF DCLVORA-IMSI-INV NOT = 'AA'   13809099
135290                     IF  WS-CTNIN-IMSI       >  SPACES            13810099
135300                         MOVE  'AA'  TO  WS-VORA-STATUS           13811099
135310                         PERFORM  4G-49500-CALL-ETLSC09           13812099
135320                                      THRU  4G-49500-EXIT         13813099
135330                         PERFORM  4G-51500-VORA-UPDATE            13814099
135340                                      THRU  4G-51500-EXIT         13815099
135350                         PERFORM  4G-REPORT-BUILD                 13816099
135360                                      THRU  4G-REPORT-BUILD-EXIT  13817099
135370                         GO  TO  2300-EXIT                        13818099
135380                     END-IF                                       13819099
135390                  END-IF                                          13820099
135400              END-IF                                              13821099
135410          END-IF                                                  13822099
135420     END-IF                                                       13823099
135430                                                                  13824099
135440*  End 4G processing                                              13825099
135450                                                                  13826099
135460     END-IF                                                       13827099
135470     .                                                            13828099
135480                                                                  13829099
135490 2300-EXIT.                                                       13830099
135500     EXIT.                                                        13831099
135510                                                                  13832099
135520 2300-VTS-NIB.                                                    13833099
135530******************************************************************13834099
135540*                                                                 13835099
135550*     VTS  -  Not  In  Billing  (NIB)                             13836099
135560*                                                                 13837099
135570******************************************************************13838099
135580**---------------------------------                               13839099
135590**  Layout:  of  Array                                            13840099
135600**                                                                13841099
135610**    From_eTNI_Status  (1:2)                                     13842099
135620**                                                                13843099
135630**    Reads  Bypass  Status,  No  Processing  If  in  List        13844099
135640**    UNLESS,  Bytes  3-4  Specify  OTHER THAN '..'               13845099
135650**--------------------------------------------------------        13846099
135660**  JA0312                                                        13847099
135670**                                                                13848099
135680**    If  Second  Parameter  is  OTHER  Than  '..',  Then         13849099
135690**      Update  TO  Specified  Value                              13850099
135700**      Provided  eTNI  Status  Matches  1st  Value               13851099
135710**    In  effect,  we  are  repairing  our  data  when  VTS       13852099
135720**        is  'out of sync'  &...                                 13853099
135730**                                                                13854099
135740**    ONLY  'A*'  in  second  Status  is  Supported               13855099
135750**--------------------------------------------------------        13856099
135760                                                                  13857099
135770     SET  WS-VTS-PROCESSED  TO  TRUE                              13858099
135780                                                                  13859099
135790     PERFORM  VARYING   WS-CTN-STATUS-V-B-IDX                     13860099
135800              FROM  1  BY  1                                      13861099
135810              UNTIL  WS-CTN-STATUS-V-B-IDX  >                     13862099
135820                     WS-CTN-STATUS-V-B-IDX-MAX                    13863099
135830          OR                                                      13864099
135840       WS-BC16-VTS-NIB-PROCESS-ARAY-L                             13865099
135850                                 (WS-CTN-STATUS-V-B-IDX)(1:2)     13866099
135860                      =                                           13867099
135870       WS-CTNIN-CTN-STATUS                                        13868099
135880     END-PERFORM                                                  13869099
135890                                                                  13870099
135900     IF  WS-CTN-STATUS-V-B-IDX  NOT  >                            13871099
135910         WS-CTN-STATUS-V-B-IDX-MAX                                13872099
135920***      GO TO 2300-VTS-NIB-EXIT   - JA0312                       13873099
135930         CONTINUE                                                 13874099
135940       ELSE                                                       13875099
135950         SET  WS-ERROR-FIELDS-FOUND    TO TRUE                    13876099
135960         MOVE LIT-STATUS-ERROR         TO WS-COMMENT              13877099
135970         MOVE 'Not in Billing'         TO WS-ADDTL-INFO           13878099
135980         MOVE 'ETNI' TO WS-SYSTEM                                 13879099
135990         MOVE WS-SAVE-HDR-BILLER-ID  TO  WS-BILLER-ID             13880099
136000         PERFORM 6010-MOVE-ETNI-TO-RPT  THRU 6010-EXIT            13881099
136010         PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT         13882099
136020         ADD   +1 TO WS-TOTL-ERROR-STATUS-INVALID                 13883099
136030         GO TO 2300-VTS-NIB-EXIT                                  13884099
136040     END-IF                                                       13885099
136050                                                                  13886099
136060** JA0312  -  Bypass                                              13887099
136070     IF  WS-BC16-VTS-NIB-PROCESS-ARAY-L                           13888099
136080                                 (WS-CTN-STATUS-V-B-IDX)(3:2)     13889099
136090                                 =  '..'                          13890099
136100         GO TO 2300-VTS-NIB-EXIT                                  13891099
136110     END-IF                                                       13892099
136120                                                                  13893099
      ** JA0412  -  Match  Ctn-Status,  New  'A*'  Status  & Update     13894099
           IF  WS-BC16-VTS-NIB-PROCESS-ARAY-L                           13895099
                 (WS-CTN-STATUS-V-B-IDX)(3:1)  =  'A'                   13896099
                  MOVE  WS-CTNIN-CTN-TEXT  TO  WS-MDN                   13897099
                  PERFORM  7000-SELECT-CTN-INV   THRU  7000-EXIT        13898099
              IF  CTN-STATUS  IN  DCLCTN-INV  =  WS-CTNIN-CTN-STATUS    13899099
                AND   WS-PARM-UPDDNA                                    13900099
                      MOVE  'Y'  TO  USE-CTN-FIELDS-FOR-KEY             13901099
                      PERFORM  2102-CREATE-CTN-HIST  THRU  2102-EXIT    13902099
                      IF  WS-ERROR-FIELDS-FOUND                         13903099
                          GO TO 2300-VTS-NIB-EXIT                       13904099
                      END-IF                                            13905099
                      MOVE  CTN-STATUS  IN  DCLCTN-INV  TO              13906099
                                                       WS-COMMENT(22:2) 13907099
                      MOVE  WS-BC16-VTS-NIB-PROCESS-ARAY-L              13908099
                              (WS-CTN-STATUS-V-B-IDX)(3:2)  TO          13909099
                                  CTN-STATUS  IN  DCLCTN-INV            13910099
                                  WS-CTNIN-CTN-STATUS                   13911099
                                  WS-NEW-STATUS                         13912099
                      MOVE  WS-CTNIN-NGP  TO  WS-HOLD-NGP               13913099
                      MOVE  SPACES  TO  WS-ETNDC38-BILLER               13914099
                      PERFORM  7040-GET-BILLER-FROM-NGP-TABLE           13915099
                               THRU  7040-EXIT                          13916099
                      IF WS-ETNDC38-BILLER  >  SPACES                   13917099
                         MOVE  WS-ETNDC38-BILLER  TO  WS-CTNIN-BILLER-ID13918099
                      END-IF                                            13919099
                      PERFORM  7010-UPDATE-CTN-INV  THRU  7010-EXIT     13920099
                      MOVE 'ETNI' TO WS-SYSTEM                          13921099
                      MOVE 'Repair CTN Stat-VTS '  TO  WS-COMMENT(1:20) 13922099
                      PERFORM  6010-MOVE-ETNI-TO-RPT  THRU  6010-EXIT   13923099
                      PERFORM  6400-WRITE-RECON-RPT   THRU  6400-EXIT   13924099
                      PERFORM  6300-PRINT-BLANK-LINE  THRU  6300-EXIT   13925099
                      MOVE  WS-CTNIN-NL                TO WS-NEW-NL     13926099
                      MOVE  WS-CTNIN-NGP               TO WS-NEW-NGP    13927099
                      MOVE  WS-CTNIN-PRODUCT-TYPE      TO               13928099
                                                    WS-NEW-PRODUCT-TYPE 13929099
097170                PERFORM 2150-UPDATE-STATUS-COUNTERS  THRU         13930099
097170                                                     2150-EXIT    13931099
058150                GO TO 2300-VTS-NIB-EXIT                           13932099
058150             END-IF                                               13933099
058150     END-IF                                                       13934099
136441                                                                  13935099
136442**  Any Status Listed  In  Param  Will  Continue  Processing      13936099
136443**       other  Status's  Will  Error  Out                        13937099
136450                                                                  13938099
136460     IF WS-CTNIN-CTN-STATUS = 'NH'                                13939099
136470        ADD +1 TO WS-TOTL-ETNI-NA-NH-CNT                          13940099
136480        GO TO 2300-VTS-NIB-CONTINUE-10                            13941099
136490     END-IF                                                       13942099
136500                                                                  13943099
136510     MOVE WS-CTNIN-HOLD-REASON(1:10) TO PENDING-HOLD-REASON-CODES 13944099
136520     IF WS-CTNIN-CTN-STATUS = 'NH' AND NOT                        13945099
136530        VALID-PENDING-HOLD-REASON-CODE                            13946099
136540        ADD +1 TO WS-TOTL-ETNI-NA-NH-CNT                          13947099
136550        GO TO 2300-VTS-NIB-EXIT                                   13948099
136560     END-IF                                                       13949099
136570                                                                  13950099
136580*----CTNs with 'SPL' Last Trx Code should not be deleted----------13951099
136590*--- These are special holding pools. Bypass them.----------------13952099
136600     IF WS-CTNIN-LAST-TRX-CODE = 'SPL'                            13953099
136610        ADD   +1 TO WS-TOTL-ERROR-BILLER-NOTMTCH                  13954099
136620        MOVE  'ETNI'                   TO   WS-SYSTEM             13955099
136630        MOVE 'ERROR: SPL NOT IN BILLING' TO WS-COMMENT            13956099
136640        PERFORM 6010-MOVE-ETNI-TO-RPT  THRU 6010-EXIT             13957099
136650        PERFORM 6500-WRITE-ERROR-RPT   THRU 6500-EXIT             13958099
136660        GO TO 2300-VTS-NIB-EXIT                                   13959099
136670     END-IF                                                       13960099
136680                                                                  13961099
136690**  JA0602  - Start  For  New  Split  Logic                       13962099
136700                                                                  13963099
136710     IF  WS-SPLIT-BYPASS                                          13964099
136720         IF  WS-CTNIN-CTN-STATUS(1:1)  =  'A'                     13965099
136730             ADD   +1  TO  WS-TOTL-BYPASS-SPLIT                   13966099
136740             GO TO 2300-VTS-NIB-EXIT                              13967099
136750         END-IF                                                   13968099
136760     END-IF                                                       13969099
136770                                                                  13970099
136780**  JA0507  - START                                               13971099
136790                                                                  13972099
136800     IF  WS-VISION                                                13973099
136810         IF WS-CTNIN-CTN-STATUS = 'PA'  OR                        13974099
136820            WS-CTNIN-CTN-STATUS = 'AA'                            13975099
136830                                                                  13976099
136840            GO TO 2300-VTS-NIB-CONTINUE-10                        13977099
136850         END-IF                                                   13978099
136860     END-IF                                                       13979099
136870                                                                  13980099
136880**  JA0507  - END                                                 13981099
136890*                                                                 13982099
136900*       eTNI's CTN not on Biller's file  &  'AA'  Status          13983099
136910*       The CTN-INV  ROW  will  NOT  be  updated  For             13984099
136920*       BILLER-ID  VISION, Print Report & Bypass                  13985099
136930*                                                                 13986099
136940*  JA0410  - Added  Perm Reserve  NL(2:1) = H..Below              13987099
136950                                                                  13988099
136960     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        13989099
136970*-------port-outs have spaces in NL, so only compare NLs 1st byte-13990099
136980*-------to Biller from Header if the NL is populated!-------------13991099
136990          IF WS-CTNIN-NL(1:1) NOT = SPACE AND                     13992099
137000             WS-CTNIN-NL(1:1) NOT = LOW-VALUES AND                13993099
137010             WS-CTNIN-NL(1:1) NOT = WS-SAVE-HDR-BILLER-ID AND     13994099
137020             WS-CTNIN-NL(2:1) NOT =  'H'                          13995099
137030             ADD  +1 TO WS-TOTL-ERROR-RSS-BILL-NL-BYP             13996099
137040             MOVE WS-CTNIN-NL TO LIT-RSS-NL                       13997099
137050             MOVE WS-SAVE-HDR-BILLER-ID TO LIT-RSS-BILLER         13998099
137060             MOVE LIT-RSS-NL-1ST-TO-BILL-ID TO WS-COMMENT         13999099
137070             INITIALIZE WS-ADDTL-INFO                             14000099
137080             PERFORM 6010-MOVE-ETNI-TO-RPT  THRU 6010-EXIT        14001099
137090             PERFORM 6500-WRITE-ERROR-RPT   THRU 6500-EXIT        14002099
137100             GO TO 2300-VTS-NIB-EXIT                              14003099
137110          END-IF                                                  14004099
137120        END-IF                                                    14005099
137130                                                                  14006099
137140*----it's OK for MDN to be missing in Biller if PO'd in eTNI------14007099
137150     IF WS-PARM-UPDATE AND                                        14008099
137160       (WS-CTNIN-CTN-STATUS NOT = 'PO' OR                         14009099
137170        WS-CTNIN-PORT-IND NOT = 'PO')                             14010099
137180        ADD   +1 TO WS-TOTL-ERROR-BILLER-NOTMTCH                  14011099
137190        MOVE  'ETNI'                   TO   WS-SYSTEM             14012099
137200        MOVE 'WARN: MDN NOT IN BILL*>ETNI ' TO WS-COMMENT         14013099
137210        MOVE WS-CTNIN-CTN-STATUS                                  14014099
137220                                    TO WS-COMMENT(24:2)           14015099
137230        PERFORM 6010-MOVE-ETNI-TO-RPT  THRU 6010-EXIT             14016099
137240        PERFORM 6500-WRITE-ERROR-RPT   THRU 6500-EXIT             14017099
137250        GO TO 2300-VTS-NIB-EXIT                                   14018099
137260     END-IF                                                       14019099
137270                                                                  14020099
137280**  JA0907  - START                                               14021099
137290*=================================================================14022099
137300*    All the bypass logic is complete. Below starts REAL processng14023099
137310*=================================================================14024099
137320                                                                  14025099
137330     INITIALIZE USE-CTN-FIELDS-FOR-KEY                            14026099
137340     INITIALIZE CREATE-UNLOAD-HISTORY-FLAG                        14027099
137350     MOVE 'N' TO WS-ERROR-ALREADY-REPORTED                        14028099
137360                                                                  14029099
137370     IF WS-PARM-UPDDNA AND                                        14030099
137380        WS-CTNIN-PORT-IND = 'RE'                                  14031099
137390           MOVE WS-CTNIN-CTN-TEXT(1:10) TO NUMERIC-CTNIN-CTN      14032099
137400           MOVE NUMERIC-CTNIN-CTN TO MDN OF DCLTVZW-LSMS          14033099
137410           PERFORM 7200-CHECK-SPID-IN-LSMS THRU 7200-EXIT         14034099
137420           IF CTN-HAS-VZW-SPID = 'N'                              14035099
137430              MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  14036099
137440              MOVE 'N' TO WS-ERROR-ALREADY-REPORTED               14037099
137450              PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT         14038099
137460              IF WS-ERROR-FIELDS-FOUND AND                        14039099
137470                 WS-ERROR-ALREADY-REPORTED NOT = 'Y'              14040099
137480                    MOVE 'ETNI'  TO WS-SYSTEM                     14041099
137490                    PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT  14042099
137500                    PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT   14043099
137510                    GO TO 2300-VTS-NIB-EXIT                       14044099
137520              END-IF                                              14045099
137530                                                                  14046099
137540              MOVE 'N' TO WS-ERROR-ALREADY-REPORTED               14047099
137550                                                                  14048099
137560*----------update CTN-INV row-------------------------------------14049099
137570              PERFORM 7004-RE-PORTED-CTN-INV-UPD THRU 7004-EXIT   14050099
137580*----------change MIN-INV Status to "AP" so it's no longer in use-14051099
137590**            MOVE 'AP' TO MODIFIED-MIN-STATUS                    14052099
137600**            PERFORM 2184-UPDATE-MIN-STATUS THRU 2184-EXIT       14053099
137610              MOVE 'ETNI' TO WS-SYSTEM                            14054099
137620              MOVE LIT-UPD-PO-NOT-IN-BILL-COMMENT TO WS-COMMENT   14055099
137630              MOVE 'REG CTN PORTED ' TO WS-ADDTL-INFO             14056099
137640              PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT        14057099
137650              PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT        14058099
137660              PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT        14059099
137670              GO TO 2300-VTS-NIB-EXIT                             14060099
137680           END-IF                                                 14061099
137690        END-IF                                                    14062099
137700                                                                  14063099
137710     INITIALIZE NH-AND-PENDDASG-R-FLAG                            14064099
137720     IF WS-CTNIN-CTN-STATUS = 'NH' AND                            14065099
137730        WS-CTNIN-HOLD-REASON(1:10) = 'PENDDASG-R'                 14066099
137740        MOVE 'Y' TO NH-AND-PENDDASG-R-FLAG                        14067099
137750        INITIALIZE NH-AND-OTHER-PENDING-FLAG                      14068099
137760                   USE-CTN-FIELDS-FOR-KEY                         14069099
137770                   CREATE-UNLOAD-HISTORY-FLAG                     14070099
137780        IF WS-PARM-UPDDNA AND                                     14071099
137790           WS-CTNIN-PORT-IND = 'RE'                               14072099
137800              MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  14073099
137810*----------create HISTORY row w. "GOODDASG-R" Hold-Reason in 2320-14074099
137820              PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT         14075099
137830              IF WS-ERROR-FIELDS-FOUND                            14076099
137840                 GO TO 2300-VTS-NIB-EXIT                          14077099
137850              END-IF                                              14078099
137860*----------update CTN-INV row-------------------------------------14079099
137870              PERFORM 7009-NH-PENDING-CTN-INV-UPD THRU 7009-EXIT  14080099
137880*----------send an ASGN RAPI to the NEW Biller--------------------14081099
137890              PERFORM 9180-SEND-ASGN-RAPI THRU 9180-EXIT          14082099
137900              MOVE 'ETNI' TO WS-SYSTEM                            14083099
137910              MOVE BILLER-ID OF DCLCTN-INV TO                     14084099
137920                   LIT-UPD-PENDDASG-R-BILLER                      14085099
137930              MOVE LIT-UPD-PENDDASG-R-NOT-IN-BILL TO WS-COMMENT   14086099
137940              MOVE SPACE TO WS-ADDTL-INFO                         14087099
137950              PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT        14088099
137960              PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT        14089099
137970              PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT        14090099
137980              GO TO 2300-VTS-NIB-EXIT                             14091099
137990           END-IF                                                 14092099
138000        END-IF                                                    14093099
138010                                                                  14094099
138020     INITIALIZE NH-AND-OTHER-PENDING-FLAG                         14095099
138030     MOVE WS-CTNIN-HOLD-REASON(1:10) TO                           14096099
138040          PENDING-HOLD-REASON-CODES-II                            14097099
138050                                                                  14098099
138060     IF WS-CTNIN-CTN-STATUS = 'NH' AND                            14099099
138070        VALID-PENDING-HOLD-REASON-II                              14100099
138080        MOVE 'Y' TO NH-AND-OTHER-PENDING-FLAG                     14101099
138090        INITIALIZE NH-AND-PENDDASG-R-FLAG                         14102099
138100     END-IF                                                       14103099
138110                                                                  14104099
138120     INITIALIZE USE-CTN-FIELDS-FOR-KEY                            14105099
138130                CREATE-UNLOAD-HISTORY-FLAG                        14106099
138140                SHOULD-WE-DISCONNECT-FLAG                         14107099
138150                                                                  14108099
138160*----determine if we need to Disconnect and Unload by a read of---14109099
138170*----PORTIN-MDN-TDS table-----------------------------------------14110099
138180                                                                  14111099
138190     IF WS-CTNIN-CTN-STATUS NOT = 'NH'                            14112099
138200        AND                                                       14113099
138210       (WS-CTNIN-PORT-IND = 'PI' OR                               14114099
138220        WS-CTNIN-PORT-IND = 'IO')                                 14115099
138230        AND                                                       14116099
138240       (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)       14117099
138250           PERFORM 9170-READ-PORTIN-MDN-TDS THRU 9170-EXIT        14118099
138260     END-IF                                                       14119099
138270                                                                  14120099
138280*Case 1 of 2:                                                     14121099
138290*==========PORTIN-MDN-TDS says its NOT OK to Disconnect===========14122099
138300                                                                  14123099
138310*----based on the results of PORTIN-MDN-TDS lookup, do NOT--------14124099
138320*----disconnect, but then update HISTORY, CTN-INV and MIN-INV-----14125099
138330*                                                                 14126099
138340     IF SHOULD-WE-DISCONNECT-FLAG NOT = 'Y'                       14127099
138350        IF WS-CTNIN-CTN-STATUS NOT = 'NH'                         14128099
138360           AND                                                    14129099
138370          (WS-CTNIN-PORT-IND = 'PI' OR                            14130099
138380           WS-CTNIN-PORT-IND = 'IO')                              14131099
138390           AND                                                    14132099
138400          (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)    14133099
138410*----------first, create a HISTORY row identical to CTN-INV row---14134099
138420           MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                     14135099
138430           PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT            14136099
138440           IF WS-ERROR-FIELDS-FOUND                               14137099
138450              GO TO 2300-VTS-NIB-EXIT                             14138099
138460           END-IF                                                 14139099
138470           PERFORM 7005-SPLIT-CTN-INV-UPD THROUGH 7005-EXIT       14140099
138480                                                                  14141099
138490*AGB 11/21/05                                                     14142099
138500           MOVE WS-CTNIN-BILLER-ID TO                             14143099
138510                WS-WHICH-BILLER-ID OF WS-COMMON-BILLERID          14144099
138520                                                                  14145099
138530           MOVE 'ETNI' TO WS-SYSTEM                               14146099
138540           MOVE LIT-SPLIT-COMMENT TO WS-COMMENT                   14147099
138550           MOVE SPACES TO WS-ADDTL-INFO                           14148099
138560           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           14149099
138570           PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT           14150099
138580           PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT           14151099
138590           GO TO 2300-VTS-NIB-CONTINUE-10                         14152099
138600           END-IF                                                 14153099
138610       END-IF                                                     14154099
138620                                                                  14155099
138630*Case 2 of 2:                                                     14156099
138640*==========PORTIN-MDN-TDS says its OK to Disconnect===============14157099
138650                                                                  14158099
138660*----based on the results of PORTIN-MDN-TDS lookup, create an-----14159099
138670*----Unload History row and issue a Disconnect to the Gateway-----14160099
138680     IF SHOULD-WE-DISCONNECT-FLAG = 'Y'                           14161099
138690        IF WS-CTNIN-CTN-STATUS NOT = 'NH'                         14162099
138700           AND                                                    14163099
138710          (WS-CTNIN-PORT-IND = 'PI')                              14164099
138720** JA0907  WS-CTNIN-PORT-IND = 'IO')  ** Omit  Condition          14165099
138730           AND                                                    14166099
138740          (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)    14167099
138750*----------issue a Disconnect Message to the VZW Gateway----------14168099
138760*  JA0112  -  Comment  Out  DSCP  Processing                      14169099
138770**            ADD 1 TO DISCONNECT-MSG-COUNTER                     14170099
138780**            MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  14171099
138790**            PERFORM Q1000-ISSUE-DISCON-TO-GATEWAY THRU          14172099
138800**                    Q1000-EXIT                                  14173099
138810                                                                  14174099
138820*AGB 4/18/06--if CTN-INV row not found, dont write to MQ to-------14175099
138830*-------------prevent writing blank MQ records. (exit routine)----14176099
138840*-------------Keep a counter for display at end of pgm.-----------14177099
138850**            IF SQLCODE NOT = +0                                 14178099
138860**               ADD 1 TO WS-CANT-FIND-CTN-IN-Q1000               14179099
138870**               GO TO 2300-VTS-NIB-EXIT                          14180099
138880**               END-IF                                           14181099
138890                                                                  14182099
138900**            PERFORM Q1010-PUT-DISCON-MESSAGE-TO-MQ THRU         14183099
138910**                    Q1010-EXIT                                  14184099
138920*----------create a HISTORY row identical to CTN-INV row----------14185099
138930              MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  14186099
138940              PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT         14187099
138950              IF WS-ERROR-FIELDS-FOUND                            14188099
138960                 GO TO 2300-VTS-NIB-EXIT                          14189099
138970              END-IF                                              14190099
138980*----------create a HISTORY row with ULD, NA status, PI port-ind--14191099
138990              MOVE 'Y' TO CREATE-UNLOAD-HISTORY-FLAG              14192099
139000              MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  14193099
139010              PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT         14194099
139020              IF WS-ERROR-FIELDS-FOUND                            14195099
139030                 GO TO 2300-VTS-NIB-EXIT                          14196099
139040              END-IF                                              14197099
139050*----------delete the CTN-INV row copied to History above---------14198099
139060              MOVE WS-CTNIN-CTN-TEXT (1:10) TO WS-MDN             14199099
139070              INITIALIZE NOT-DELETED-SW                           14200099
139080              PERFORM 7030-DELETE-CTN-INV THRU 7030-EXIT          14201099
139090*----------change MIN-INV Status to "AP" so it's no longer in use-14202099
139100**            MOVE 'AP' TO MODIFIED-MIN-STATUS                    14203099
139110**            PERFORM 2184-UPDATE-MIN-STATUS THRU 2184-EXIT       14204099
139120              MOVE 'ETNI' TO WS-SYSTEM                            14205099
139130              MOVE LIT-UNLOADED-COMMENT TO WS-COMMENT             14206099
139140              MOVE SPACES TO WS-ADDTL-INFO                        14207099
139150              PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT        14208099
139160              PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT        14209099
139170              PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT        14210099
139180*AXY042706 - BEG                                                  14211099
139190** JA0410     PERFORM Q1011-CMIT-QUEUE      THRU Q1011-EXIT       14212099
139200*AXY042706 - END                                                  14213099
139210              GO TO 2300-VTS-NIB-CONTINUE-10                      14214099
139220           END-IF                                                 14215099
139230     END-IF                                                       14216099
139240                                                                  14217099
139250     INITIALIZE USE-CTN-FIELDS-FOR-KEY                            14218099
139260     INITIALIZE CREATE-UNLOAD-HISTORY-FLAG                        14219099
139270     IF (WS-CTNIN-CTN-STATUS = 'PO' OR                            14220099
139280         WS-CTNIN-CTN-STATUS = 'NA')                              14221099
139290         AND                                                      14222099
139300         WS-CTNIN-PORT-IND = 'IO'                                 14223099
139310         AND                                                      14224099
139320        (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)      14225099
139330*----------create a HISTORY row identical to CTN-INV row--------- 14226099
139340           MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                     14227099
139350           PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT            14228099
139360           IF WS-ERROR-FIELDS-FOUND                               14229099
139370              GO TO 2300-VTS-NIB-EXIT                             14230099
139380           END-IF                                                 14231099
139390*----------create a HISTORY row with ULD, NA status, PI Port-Ind--14232099
139400           MOVE 'Y' TO CREATE-UNLOAD-HISTORY-FLAG                 14233099
139410           MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                     14234099
139420           PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT            14235099
139430           IF WS-ERROR-FIELDS-FOUND                               14236099
139440              GO TO 2300-VTS-NIB-EXIT                             14237099
139450           END-IF                                                 14238099
139460*----------delete the CTN-INV row copied to History above---------14239099
139470           MOVE WS-CTNIN-CTN-TEXT (1:10) TO WS-MDN                14240099
139480           INITIALIZE NOT-DELETED-SW                              14241099
139490           PERFORM 7030-DELETE-CTN-INV THRU 7030-EXIT             14242099
139500           MOVE 'ETNI' TO WS-SYSTEM                               14243099
139510           MOVE LIT-UNLOADED-COMMENT TO WS-COMMENT                14244099
139520           MOVE SPACES TO WS-ADDTL-INFO                           14245099
139530           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           14246099
139540           PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT           14247099
139550           PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT           14248099
139560           GO TO 2300-VTS-NIB-CONTINUE-10                         14249099
139570     END-IF                                                       14250099
139580                                                                  14251099
139590*----If this is a Transitional Ported-Out CTN, write image of-----14252099
139600*----CTN-INV to History, update CTN-INV and change MIN-INV status-14253099
139610                                                                  14254099
139620     IF WS-CTNIN-CTN-STATUS NOT = 'PO' AND                        14255099
139630        WS-CTNIN-PORT-IND = 'PO'                                  14256099
139640        AND                                                       14257099
139650       (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)       14258099
139660*----------create a HISTORY row identical to CTN-INV row--------- 14259099
139670           MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                     14260099
139680           PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT            14261099
139690           IF WS-ERROR-FIELDS-FOUND                               14262099
139700              GO TO 2300-VTS-NIB-EXIT                             14263099
139710           END-IF                                                 14264099
139720*----------update CTN-INV row------------------------------------ 14265099
139730           PERFORM 7003-TRANSITIONAL-CTN-INV-UPD THRU 7003-EXIT   14266099
139740*----------change MIN-INV Status to "AP" so it's no longer in use-14267099
139750**         MOVE 'AP' TO MODIFIED-MIN-STATUS                       14268099
139760**         PERFORM 2184-UPDATE-MIN-STATUS THRU 2184-EXIT          14269099
139770           MOVE 'ETNI' TO WS-SYSTEM                               14270099
139780           MOVE LIT-UPD-PO-NOT-IN-BILL-COMMENT TO WS-COMMENT      14271099
139790           MOVE 'TRANSITIONAL PO' TO WS-ADDTL-INFO                14272099
139800           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           14273099
139810           PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT           14274099
139820           PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT           14275099
139830           GO TO 2300-VTS-NIB-CONTINUE-10                         14276099
139840        END-IF                                                    14277099
139850                                                                  14278099
139860**  JA0507  - START                                               14279099
139870                                                                  14280099
139880     IF  WS-VISION                                                14281099
139890         IF WS-CTNIN-CTN-STATUS = 'AG'  AND                       14282099
139900            WS-CTNIN-PORT-IND   = 'SB'                            14283099
139910                                                                  14284099
139920              GO TO 2300-VTS-NIB-EXIT                             14285099
139930         END-IF                                                   14286099
139940     END-IF                                                       14287099
139950                                                                  14288099
139960**  JA0507  - END                                                 14289099
139970                                                                  14290099
139980*-------PARM: UPDDEL or UPDDNA------------------------------------14291099
139990     IF WS-PARM-UPDDEL OR WS-PARM-UPDDNA                          14292099
140000        ADD +1 TO WS-TOTL-ETNI-NOT-IN-BILL-PROC                   14293099
140010        PERFORM 2030-CONVERT-ETNI-DATE THRU 2030-EXIT             14294099
140020        MOVE    WS-CTNIN-BILLER-ID      TO WS-BILLER-ID           14295099
140030        MOVE    WS-CTNIN-CTN-STATUS     TO WS-OLD-STATUS          14296099
140040        MOVE    WS-CTNIN-PRODUCT-TYPE   TO WS-OLD-PRODUCT-TYPE    14297099
140050        MOVE    WS-CTNIN-NL             TO WS-OLD-NL              14298099
140060        MOVE    WS-CTNIN-NGP            TO WS-OLD-NGP             14299099
140070        IF WS-PARM-UPDDEL                                         14300099
140080           MOVE SPACES                  TO WS-NEW-STATUS          14301099
140090                                           WS-NEW-PRODUCT-TYPE    14302099
140100                                           WS-NEW-NL              14303099
140110                                           WS-NEW-NGP             14304099
140120           END-IF                                                 14305099
140130                                                                  14306099
140140**      IF WS-PARM-UPDDNA                                         14307099
140150**         MOVE 'N' TO NOT-UPDATED-SW                             14308099
140160*--* LMS 10/17/2003 begin added IO port ind to this code          14309099
140170**         IF WS-CTNIN-PORT-IND = 'PO' OR 'PI' OR 'IO'            14310099
140180*--* LMS 10/17/2003 end added IO port ind to this code            14311099
140190**             MOVE  WS-OLD-STATUS          TO WS-NEW-STATUS      14312099
140200**             MOVE 'Y' TO NOT-UPDATED-SW                         14313099
140210**         ELSE                                                   14314099
140220*          (not Ported CTNs get NA for Status)                    14315099
140230**             MOVE 'N' TO NOT-UPDATED-SW                         14316099
140240**             MOVE 'NA'                    TO WS-NEW-STATUS      14317099
140250**         END-IF                                                 14318099
140260*--* #850803-2 LMS 4/21/2003 end                                  14319099
140270**         MOVE WS-CTNIN-PRODUCT-TYPE   TO WS-NEW-PRODUCT-TYPE    14320099
140280***FIX0928 SCB NA HAS NO NL                                       14321099
140290***SCB     MOVE WS-CTNIN-NL             TO WS-NEW-NL              14322099
140300**         MOVE SPACES                  TO WS-NEW-NL              14323099
140310**         MOVE WS-CTNIN-NGP            TO WS-NEW-NGP             14324099
140320**         END-IF                                                 14325099
140330**   END-IF                                                       14326099
140340                                                                  14327099
140350     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA OR     14328099
140360        WS-PARM-UPDATX OR WS-PARM-UPDDEX                          14329099
140370        MOVE WS-CTNIN-CTN-STATUS TO WS-OLD-STATUS                 14330099
140380        END-IF                                                    14331099
140390                                                                  14332099
140400**  JA1207B  -  Start  -  Lookup       -                          14333099
140410                                                                  14334099
140420**  LOOKUP  BYPASS,  IF  MAX;  REPORT  &  EXIT                    14335099
140430                                                                  14336099
140440      PERFORM  VARYING   WS-CTN-STATUS-B-A-IDX                    14337099
140450               FROM  1  BY  1                                     14338099
140460               UNTIL  WS-CTN-STATUS-B-A-IDX  >                    14339099
140470                      WS-CTN-STATUS-B-A-IDX-MAX                   14340099
140480                                                                  14341099
140490        OR                                                        14342099
140500                                                                  14343099
140510        WS-CTN-STATUS-TO-AA-ARRAY-LST(WS-CTN-STATUS-B-A-IDX)(1:2) 14344099
140520                     =                                            14345099
140530        WS-CTNIN-CTN-STATUS                                       14346099
140540                                                                  14347099
140550      END-PERFORM                                                 14348099
140560                                                                  14349099
140570     SET  WS-CTN-STATUS-TO-AA-NOTFOUND  TO  TRUE                  14350099
140580                                                                  14351099
140590**  FOUND  IN  SET-TO-AA  TABLE  ?                                14352099
140600**    Y..Report  Set  Flag  As  Such                              14353099
140610**                                                                14354099
140620     IF  WS-CTN-STATUS-B-A-IDX  <                                 14355099
140630         WS-CTN-STATUS-B-A-IDX-MAX  + 1                           14356099
140640         SET  WS-CTN-STATUS-TO-AA  TO  TRUE                       14357099
140650     END-IF                                                       14358099
140660                                                                  14359099
140670**  JA1207B  -  Start  -  Next  Cond.  -                          14360099
140680                                                                  14361099
140690**  JA0402  -   WS-LEGIT-BILLER-ID-RESELLER ADDED                 14362099
140700                                                                  14363099
140710     IF  WS-LEGIT-BILLER-ID-RESELLER AND                          14364099
140720         WS-CTN-STATUS-TO-AA  AND                                 14365099
140730         WS-PARM-PROCESS-REQ(1:3)  =  'UPD'  AND                  14366099
134490         WS-CTNIN-ICC-ID-4G  NOT  >  SPACES                       14367099
140740         MOVE WS-CTNIN-CTN-TEXT(1:10) TO WS-MDN                   14368099
140750         PERFORM  7000-SELECT-CTN-INV   THRU 7000-EXIT            14369099
140760         IF  WS-SQLCODE  =  +0  AND                               14370099
140770             MIN-NUM-TEXT  OF  DCLCTN-INV  NUMERIC                14371099
140780**             MOVE   MIN-NUM-TEXT  OF  DCLCTN-INV  TO            14372099
140790**                                      WS-TEMP-MIN-NUM-TEXT      14373099
140800               MOVE   NL  OF  DCLCTN-INV            TO  WS-NL     14374099
140810                                                    WS-SAVED-NL   14375099
140820               MOVE  NGP OF  DCLCTN-INV             TO  WS-NGP    14376099
140830                                                    WS-HOLD-NGP   14377099
140840               MOVE  PRODUCT-TYPE  OF  DCLCTN-INV                 14378099
140850                                       TO  WS-PRODUCT-TYPE        14379099
140860               PERFORM  7500-SELECT-NUMBER-GRP-LOC                14380099
140870                                        THRU  7500-EXIT           14381099
140880**                                                                14382099
140890**       Process  As  Before,  If  Found                          14383099
140900**         Else..Update CTN-INV-HISTORY, CTN-INV,                 14384099
140910**                      NUMBER-GROUP, & MIN-INV                   14385099
140920**                      Create Recon Report, exit                 14386099
140930**                                                                14387099
140940         IF  WS-SQLCODE  =  +0                                    14388099
140950             CONTINUE                                             14389099
140960                                                                  14390099
140970           ELSE                                                   14391099
140980                                                                  14392099
140990          PERFORM  2320-POPULATE-CTN-HIST  THRU   2320-EXIT       14393099
141000          PERFORM  7100-INSERT-CTN-HIST    THRU   7100-EXIT       14394099
141010          PERFORM  7120-RETRY-UP-TO-10-TIMES THRU 7120-EXIT       14395099
141020          IF SQL-DUP-INSERT                                       14396099
141030             SET WS-ERROR-FIELDS-FOUND TO TRUE                    14397099
141040             PERFORM 6030-INIT-DETAIL-LINE THRU 6030-EXIT         14398099
141050             PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT         14399099
141060             MOVE 'ETNI' TO WS-SYSTEM                             14400099
141070             MOVE LIT-CTN-HIST-INSERT-ERROR TO WS-COMMENT         14401099
141080             MOVE CTN-TEXT OF DCLCTN-INV-HISTORY TO               14402099
141090                  WS-ADDTL-INFO (1:10)                            14403099
141100             MOVE PRODUCT-TYPE OF DCLCTN-INV-HISTORY TO           14404099
141110                  WS-ADDTL-INFO (12:1)                            14405099
141120             PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT         14406099
141130             PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT          14407099
141140             GO TO 2300-VTS-NIB-EXIT                              14408099
141150         END-IF                                                   14409099
141160                                                                  14410099
141170         PERFORM  7040-GET-BILLER-FROM-NGP-TABLE THRU  7040-EXIT  14411099
141180                                                                  14412099
141190           IF  WS-SQLCODE  =  ZERO                                14413099
141200               MOVE  WS-ETNDC38-BILLER  TO                        14414099
141210                                    BILLER-ID  OF  DCLCTN-INV     14415099
141220           END-IF                                                 14416099
141230                                                                  14417099
141240         PERFORM  7019-UPDATE-CTN-INV-STATUS   THRU  7019-EXIT    14418099
141250**       PERFORM  2190-UPD-NEW-MIN-NUM-STAT    THRU  2190-EXIT    14419099
141260                                                                  14420099
141270           IF SQL-ROW-NOT-FOUND                                   14421099
141280              SET  WS-ERROR-FIELDS-FOUND    TO   TRUE             14422099
141290              PERFORM  6010-MOVE-ETNI-TO-RPT    THRU   6010-EXIT  14423099
141300              PERFORM  6500-WRITE-ERROR-RPT     THRU   6500-EXIT  14424099
141310              MOVE 'N' TO NOT-UPDATED-SW                          14425099
141320              GO TO 2300-VTS-NIB-EXIT                             14426099
141330           END-IF                                                 14427099
141340                                                                  14428099
141350          MOVE  NL  OF  DCLCTN-INV  TO  WS-NL                     14429099
141360          MOVE  NGP OF  DCLCTN-INV  TO  WS-NGP                    14430099
141370                                                                  14431099
141380          PERFORM  7510-SELECT-NGP-NL-ASSIGNMENT  THRU  7510-EXIT 14432099
141390                                                                  14433099
141400           IF  WS-SQLCODE =  +0                                   14434099
141410               COMPUTE  WS-QTY  =  AA-STS-CNT  +  1               14435099
141420               PERFORM  7520-UPDATE-NGP-NL-ASSIGNMENT             14436099
141430                                                THRU  7520-EXIT   14437099
141440           END-IF                                                 14438099
141450                                                                  14439099
141460         MOVE  'ETNI'  TO  WS-SYSTEM                              14440099
141470         MOVE  CTN-STATUS  OF  DCLCTN-INV  TO                     14441099
141480                                           WS-CTNIN-CTN-STATUS    14442099
141490         MOVE  NL  OF  DCLCTN-INV    TO    WS-CTNIN-NL            14443099
141500         MOVE  NGP OF  DCLCTN-INV    TO    WS-CTNIN-NGP           14444099
141510         MOVE  BILLER-ID  OF  DCLCTN-INV   TO                     14445099
141520                                           WS-CTNIN-BILLER-ID     14446099
141530         MOVE  LAST-TRX-CODE  OF  DCLCTN-INV  TO                  14447099
141540                                           WS-CTNIN-LAST-TRX-CODE 14448099
141550                                                                  14449099
141560         MOVE  'AA'  TO  COMMENT-STATUS                           14450099
141570         MOVE  LIT-DYNAMIC-STATUS-COMMENT   TO    WS-COMMENT      14451099
141580                                                                  14452099
141590         PERFORM  6010-MOVE-ETNI-TO-RPT    THRU   6010-EXIT       14453099
141600         PERFORM  6400-WRITE-RECON-RPT     THRU   6400-EXIT       14454099
141610         MOVE 'N' TO NOT-UPDATED-SW                               14455099
141620                                                                  14456099
141630         PERFORM 6300-PRINT-BLANK-LINE     THRU   6300-EXIT       14457099
141640         GO TO 2300-VTS-NIB-CONTINUE-10                           14458099
141650         END-IF                                                   14459099
141660       END-IF                                                     14460099
141670     END-IF                                                       14461099
141680                                                                  14462099
141690**  JA1207B  -  End                                               14463099
141700                                                                  14464099
141710**  JA1207B  -  Start  -  Next  Cond.  -                          14465099
141720                                                                  14466099
141730     IF  WS-VISION  AND                                           14467099
141740         WS-CTN-STATUS-TO-AA  AND                                 14468099
141750         WS-PARM-PROCESS-REQ(1:3)  =  'UPD'                       14469099
141760         MOVE WS-CTNIN-CTN-TEXT(1:10) TO WS-MDN                   14470099
141770         PERFORM  7000-SELECT-CTN-INV   THRU 7000-EXIT            14471099
141780         IF  WS-SQLCODE  =  +0  AND                               14472099
141790             MIN-NUM-TEXT  OF  DCLCTN-INV  NUMERIC                14473099
141800**             MOVE   MIN-NUM-TEXT  OF  DCLCTN-INV  TO            14474099
141810**                                      WS-TEMP-MIN-NUM-TEXT      14475099
141820               MOVE   NL  OF  DCLCTN-INV            TO  WS-NL     14476099
141830                                                    WS-SAVED-NL   14477099
141840               MOVE  NGP OF  DCLCTN-INV             TO  WS-NGP    14478099
141850                                                    WS-HOLD-NGP   14479099
141860               MOVE  PRODUCT-TYPE  OF  DCLCTN-INV  TO             14480099
141870                                             WS-PRODUCT-TYPE      14481099
141880**                                                                14482099
141890**       Process                                                  14483099
141900**               Update CTN-INV-HISTORY, CTN-INV,                 14484099
141910**                      NUMBER-GROUP, & MIN-INV                   14485099
141920**                      Create Recon Report, exit                 14486099
141930**                                                                14487099
141940             PERFORM  2320-POPULATE-CTN-HIST  THRU   2320-EXIT    14488099
141950             PERFORM  7100-INSERT-CTN-HIST    THRU   7100-EXIT    14489099
141960             PERFORM  7120-RETRY-UP-TO-10-TIMES THRU 7120-EXIT    14490099
141970                                                                  14491099
141980            IF SQL-DUP-INSERT                                     14492099
141990               SET WS-ERROR-FIELDS-FOUND TO TRUE                  14493099
142000               PERFORM 6030-INIT-DETAIL-LINE THRU 6030-EXIT       14494099
142010               PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT       14495099
142020               MOVE 'ETNI' TO WS-SYSTEM                           14496099
142030               MOVE LIT-CTN-HIST-INSERT-ERROR TO WS-COMMENT       14497099
142040               MOVE CTN-TEXT OF DCLCTN-INV-HISTORY TO             14498099
142050                    WS-ADDTL-INFO (1:10)                          14499099
142060               MOVE PRODUCT-TYPE OF DCLCTN-INV-HISTORY TO         14500099
142070                    WS-ADDTL-INFO (12:1)                          14501099
142080               PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT       14502099
142090               PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT        14503099
142100               GO TO 2300-VTS-NIB-CONTINUE-10                     14504099
142110            END-IF                                                14505099
142120                                                                  14506099
142130         PERFORM  7040-GET-BILLER-FROM-NGP-TABLE THRU  7040-EXIT  14507099
142140*                                                                 14508099
142150           IF  WS-SQLCODE  =  ZERO                                14509099
142160               MOVE  WS-ETNDC38-BILLER  TO                        14510099
142170                                    BILLER-ID  OF  DCLCTN-INV     14511099
142180           END-IF                                                 14512099
142190                                                                  14513099
142200         PERFORM  7019-UPDATE-CTN-INV-STATUS   THRU  7019-EXIT    14514099
142210**       PERFORM  2190-UPD-NEW-MIN-NUM-STAT    THRU  2190-EXIT    14515099
142220                                                                  14516099
142230           IF SQL-ROW-NOT-FOUND                                   14517099
142240              SET  WS-ERROR-FIELDS-FOUND    TO   TRUE             14518099
142250              PERFORM  6010-MOVE-ETNI-TO-RPT    THRU   6010-EXIT  14519099
142260              PERFORM  6500-WRITE-ERROR-RPT     THRU   6500-EXIT  14520099
142270              MOVE 'N' TO NOT-UPDATED-SW                          14521099
142280              GO TO 2300-VTS-NIB-EXIT                             14522099
142290           END-IF                                                 14523099
142300                                                                  14524099
142310          MOVE  NL  OF  DCLCTN-INV  TO  WS-NL                     14525099
142320          MOVE  NGP OF  DCLCTN-INV  TO  WS-NGP                    14526099
142330                                                                  14527099
142340          PERFORM  7510-SELECT-NGP-NL-ASSIGNMENT  THRU  7510-EXIT 14528099
142350                                                                  14529099
142360           IF  WS-SQLCODE =  +0                                   14530099
142370               COMPUTE  WS-QTY  =  AA-STS-CNT  +  1               14531099
142380               PERFORM  7520-UPDATE-NGP-NL-ASSIGNMENT             14532099
142390                                                THRU  7520-EXIT   14533099
142400           END-IF                                                 14534099
142410                                                                  14535099
142420          MOVE  'ETNI'  TO  WS-SYSTEM                             14536099
142430          MOVE  CTN-STATUS  OF  DCLCTN-INV  TO                    14537099
142440                                            WS-CTNIN-CTN-STATUS   14538099
142450          MOVE  NL  OF  DCLCTN-INV    TO    WS-CTNIN-NL           14539099
142460          MOVE  NGP OF  DCLCTN-INV    TO    WS-CTNIN-NGP          14540099
142470          MOVE  BILLER-ID  OF  DCLCTN-INV   TO                    14541099
142480                                            WS-CTNIN-BILLER-ID    14542099
142490          MOVE  LAST-TRX-CODE  OF  DCLCTN-INV  TO                 14543099
142500                                           WS-CTNIN-LAST-TRX-CODE 14544099
142510                                                                  14545099
142520          MOVE  'AA'  TO  COMMENT-STATUS                          14546099
142530          MOVE  LIT-DYNAMIC-STATUS-COMMENT   TO    WS-COMMENT     14547099
142540                                                                  14548099
142550         PERFORM  6010-MOVE-ETNI-TO-RPT    THRU   6010-EXIT       14549099
142560         PERFORM  6400-WRITE-RECON-RPT     THRU   6400-EXIT       14550099
142570         MOVE 'N' TO NOT-UPDATED-SW                               14551099
142580                                                                  14552099
142590         PERFORM 6300-PRINT-BLANK-LINE     THRU   6300-EXIT       14553099
142600         GO TO 2300-VTS-NIB-CONTINUE-10                           14554099
142610       END-IF                                                     14555099
142620     END-IF                                                       14556099
142630                                                                  14557099
142640**  JA1207B  -  End                                               14558099
142650                                                                  14559099
142660*-------PARM: UPDDEL or UPDDNA------------------------------------14560099
142670                                                                  14561099
142680* UPDATE + DELETE PROCESS                                         14562099
142690     IF WS-PARM-UPDDEL OR WS-PARM-UPDDNA                          14563099
142700* RETRIEVE CTN-INV RECORD                                         14564099
142710        MOVE WS-CTNIN-PRODUCT-TYPE TO WS-PRODUCT-TYPE             14565099
142720**      added line below 3/24/04...                               14566099
142730**                                                                14567099
142740        MOVE WS-CTNIN-CTN-TEXT(1:10) TO WS-MDN                    14568099
142750        PERFORM  7000-SELECT-CTN-INV   THRU 7000-EXIT             14569099
142760                                                                  14570099
142770        IF SQL-ROW-NOT-FOUND                                      14571099
142780           ADD   +1 TO WS-TOTL-ERROR-CTNINV-NOTFND                14572099
142790           SET   WS-ERROR-FIELDS-FOUND   TO TRUE                  14573099
142800           MOVE  LIT-CTN-INV-ERROR       TO WS-COMMENT            14574099
142810           MOVE  WS-MDN                  TO WS-ADDTL-INFO (1:10)  14575099
142820           MOVE  WS-PRODUCT-TYPE         TO WS-ADDTL-INFO (12:1)  14576099
142830           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           14577099
142840           PERFORM 6500-WRITE-ERROR-RPT  THRU 6500-EXIT           14578099
142850           GO TO 2300-VTS-NIB-EXIT                                14579099
142860        END-IF                                                    14580099
142870                                                                  14581099
142880     IF CREATE-UNLOAD-HISTORY-FLAG NOT = 'Y'                      14582099
142890*****   NH-AND-PENDDASG-R-FLAG NOT = 'Y'                          14583099
142900        PERFORM 2103-CALL-ETNDC15-HIST-INSERT THRU 2103-EXIT      14584099
142910*****   GO TO 2300-VTS-NIB-CONTINUE-10                            14585099
142920        END-IF                                                    14586099
142930                                                                  14587099
142940     IF CREATE-UNLOAD-HISTORY-FLAG = 'Y'                          14588099
142950*****   NH-AND-PENDDASG-R-FLAG = 'Y'                              14589099
142960        PERFORM 2320-POPULATE-CTN-HIST THRU 2320-EXIT             14590099
142970        PERFORM 7100-INSERT-CTN-HIST THRU 7100-EXIT               14591099
142980        PERFORM 7120-RETRY-UP-TO-10-TIMES THRU 7120-EXIT          14592099
142990        IF SQL-DUP-INSERT                                         14593099
143000           SET WS-ERROR-FIELDS-FOUND TO TRUE                      14594099
143010           PERFORM 6030-INIT-DETAIL-LINE THRU 6030-EXIT           14595099
143020           PERFORM 6400-WRITE-RECON-RPT THRU 6400-EXIT            14596099
143030           MOVE 'ETNI' TO WS-SYSTEM                               14597099
143040           MOVE LIT-CTN-HIST-INSERT-ERROR TO WS-COMMENT           14598099
143050           MOVE CTN-TEXT OF DCLCTN-INV-HISTORY TO                 14599099
143060                WS-ADDTL-INFO (1:10)                              14600099
143070           MOVE PRODUCT-TYPE OF DCLCTN-INV-HISTORY TO             14601099
143080                WS-ADDTL-INFO (12:1)                              14602099
143090           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           14603099
143100           PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT            14604099
143110           GO TO 2300-VTS-NIB-EXIT                                14605099
143120           END-IF                                                 14606099
143130        END-IF                                                    14607099
143140                                                                  14608099
143150***FIX0928 SCB CTN IS UNLOADED FOR UPDDEL ONLY                    14609099
143160                                                                  14610099
143170*-------PARM: UPDDEL----------------------------------------------14611099
143180        IF WS-PARM-UPDDEL                                         14612099
143190           PERFORM 2330-POPULATE-CTN-HIST-ULD   THRU 2330-EXIT    14613099
143200           PERFORM 7100-INSERT-CTN-HIST         THRU 7100-EXIT    14614099
143210           PERFORM 7120-RETRY-UP-TO-10-TIMES    THRU 7120-EXIT    14615099
143220           IF SQL-DUP-INSERT                                      14616099
143230              PERFORM 6030-INIT-DETAIL-LINE     THRU 6030-EXIT    14617099
143240              PERFORM 6400-WRITE-RECON-RPT      THRU 6400-EXIT    14618099
143250              MOVE   'ETNI'                     TO   WS-SYSTEM    14619099
143260              MOVE    LIT-CTN-HIST-INSERT-ERROR TO   WS-COMMENT   14620099
143270              MOVE    CTN-TEXT     OF DCLCTN-INV-HISTORY          14621099
143280                                   TO WS-ADDTL-INFO (1:10)        14622099
143290              MOVE    PRODUCT-TYPE OF DCLCTN-INV-HISTORY          14623099
143300                                   TO WS-ADDTL-INFO (12:1)        14624099
143310              PERFORM 6010-MOVE-ETNI-TO-RPT     THRU 6010-EXIT    14625099
143320              PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT    14626099
143330              GO TO 2300-VTS-NIB-EXIT                             14627099
143340              END-IF                                              14628099
143350* DELETE CTN-INV RECORD                                           14629099
143360***FIX0928 INCLUDED WITH PREVIOUS IF                              14630099
143370***      IF WS-PARM-UPDDEL                                        14631099
143380           MOVE WS-CTNIN-CTN-TEXT (1:WS-CTNIN-CTN-LEN) TO WS-MDN  14632099
143390           MOVE WS-CTNIN-PRODUCT-TYPE        TO   WS-PRODUCT-TYPE 14633099
143400           IF (WS-CTNIN-PORT-IND = 'PO' OR                        14634099
143410               WS-CTNIN-PORT-IND = 'PI' OR                        14635099
143420               WS-CTNIN-PORT-IND = 'IO')                          14636099
143430*--* LMS 10/17/2003 end added IO port ind to this code            14637099
143440               MOVE 'Y' TO NOT-DELETED-SW                         14638099
143450           ELSE                                                   14639099
143460               MOVE 'N' TO NOT-DELETED-SW                         14640099
143470               PERFORM 7030-DELETE-CTN-INV THRU 7030-EXIT         14641099
143480               END-IF                                             14642099
143490*--* #850803-2 LMS 4/21/2003 end                                  14643099
143500         END-IF                                                   14644099
143510*                                                                 14645099
143520*  JA0312  -  Comment  Out  NA  Update  for  VTS,  due to  Data   14646099
143530*               Errors                                            14647099
143540*****                                                             14648099
143550* UPDATE CTN STATUS TO "NA" (only for "UPDDNA" parm!)             14649099
143560*-------PARM: UPDDNA----------------------------------------------14650099
143570*    IF WS-PARM-UPDDNA                                            14651099
143580*       PERFORM 7015-UPDATE-CTN-INV-STATUS   THRU 7015-EXIT       14652099
143590*    END-IF                                                       14653099
143600                                                                  14654099
143610* UPDATE MIN STATUS TO AA                                         14655099
143620*       below status is from WS-CTNIN-CTN-STATUS (CTN-INV status)-14656099
143630**   IF WS-OLD-STATUS = 'AI' OR 'AG' OR 'AR' OR 'AT' OR           14657099
143640**                      'AA' OR 'NA' OR 'NH' OR 'PA'              14658099
143650**  JA0507  -  ABOVE  1  LINE  ADDED  'PA'                        14659099
143660**      PERFORM 7830-UPDATE-MIN-INV-STATUS   THRU 7830-EXIT       14660099
143670**      END-IF                                                    14661099
143680                                                                  14662099
143690* UPDATE STATUS COUNTERS                                          14663099
143700        PERFORM 2150-UPDATE-STATUS-COUNTERS  THRU 2150-EXIT       14664099
143710        IF WS-ERROR-FIELDS-FOUND                                  14665099
143720           MOVE   'ETNI'                     TO   WS-SYSTEM       14666099
143730           PERFORM 6010-MOVE-ETNI-TO-RPT     THRU 6010-EXIT       14667099
143740           PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT       14668099
143750           GO TO 2300-VTS-NIB-EXIT                                14669099
143760        END-IF                                                    14670099
143770     ELSE                                                         14671099
143780        PERFORM 2320-POPULATE-CTN-HIST       THRU 2320-EXIT       14672099
143790     END-IF                                                       14673099
143800                                                                  14674099
143810* REPORT UPDATED STATUS ETNI CTN RECORD                           14675099
143820                                                                  14676099
143830*-------PARM: UPDDNA----------------------------------------------14677099
143840                                                                  14678099
143850     IF WS-PARM-UPDDNA                                            14679099
143860        IF NOT-UPDATED-SW = 'Y'                                   14680099
143870            MOVE LIT-NOT-UPDATED-COMMENT TO WS-COMMENT            14681099
143880        ELSE                                                      14682099
143890            MOVE LIT-UPDATED-STATUS-COMMENT TO WS-COMMENT         14683099
143900        END-IF                                                    14684099
143910     ELSE                                                         14685099
143920* REPORT DELETED ETNI CTN RECORD                                  14686099
143930        MOVE LIT-DELETED-COMMENT TO WS-COMMENT                    14687099
143940*--* #850803-2 LMS 4/21/2003 BEGIN                                14688099
143950        IF NOT-DELETED-SW = 'Y'                                   14689099
143960            MOVE LIT-NOT-DELETED-COMMENT TO WS-COMMENT            14690099
143970        END-IF                                                    14691099
143980        MOVE 'N' TO NOT-DELETED-SW                                14692099
143990*--* #850803-2 LMS 4/21/2003 END                                  14693099
144000     END-IF                                                       14694099
144010                                                                  14695099
144020     IF WS-CTNIN-PORT-IND = 'PO' OR                               14696099
144030        WS-CTNIN-PORT-IND = 'IO'                                  14697099
144040        ADD 1 TO WS-PO-IN-ETNI-NOT-IN-BILL                        14698099
144050        GO TO 2300-VTS-NIB-EXIT                                   14699099
144060     END-IF                                                       14700099
144070                                                                  14701099
144080     MOVE   'ETNI'                      TO   WS-SYSTEM            14702099
144090*----if UPDDNA parm and we DID update CTN-INV status, show it-----14703099
144100     IF WS-PARM-UPDDNA AND NOT-UPDATED-SW NOT = 'Y'               14704099
144110        MOVE CTN-STATUS OF DCLCTN-INV TO COMMENT-STATUS           14705099
144120        MOVE LIT-DYNAMIC-STATUS-COMMENT TO WS-COMMENT             14706099
144130     ELSE                                                         14707099
144140        MOVE LIT-UPDATED-COMMENT-BILL   TO WS-COMMENT             14708099
144150        END-IF                                                    14709099
144160     MOVE    SPACES                     TO   WS-ADDTL-INFO        14710099
144170     PERFORM 6010-MOVE-ETNI-TO-RPT      THRU 6010-EXIT            14711099
144180     PERFORM 6400-WRITE-RECON-RPT       THRU 6400-EXIT            14712099
144190     MOVE 'N' TO NOT-UPDATED-SW                                   14713099
144200     .                                                            14714099
144210 2300-VTS-NIB-CONTINUE-10.                                        14715099
144220*-----------------------------------------------------------------14716099
144230*  JA1109  -   4G                                                 14717099
144240*-----------------------------------------------------------------14718099
144250                                                                  14719099
144260     IF  WS-CTNIN-IMSI       >  SPACES  OR                        14720099
144270         WS-CTNIN-ICC-ID-4G  >  SPACES                            14721099
144280         INITIALIZE  WS-LTE-DATA-LAYER                            14722099
144290                     WS-4G-DETAIL-LINE                            14723099
144300                     DETAIL-LINE-1                                14724099
144310                     WS-4G-ERROR-SW                               14725099
144320                     DCLSIM-INV                                   14726099
144330                     DCLVORA-IMSI-INV                             14727099
144340                                                                  14728099
144350         PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT            14729099
144360                                                                  14730099
144370         IF  WS-4G-ERROR-YES                                      14731099
144380             PERFORM  6010-MOVE-ETNI-TO-RPT  THRU  6010-EXIT      14732099
144390             PERFORM  6500-WRITE-ERROR-RPT   THRU  6500-EXIT      14733099
144400             MOVE  WS-4G-DETAIL-LINE  TO  DETAIL-LINE-1           14734099
144410             MOVE  LIT-SIM-VORA-ERROR  TO   DETAIL-1-COMMENT      14735099
144420             ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                    14736099
144430             PERFORM  6500-WRITE-ERROR-RPT   THRU  6500-EXIT      14737099
144440             GO  TO  2300-VTS-NIB-EXIT                            14738099
144450         END-IF                                                   14739099
144460                                                                  14740099
144470*  JA1210   -  Only  Update,  If  Update NOT within 24 Hrs        14741099
144480                                                                  14742099
144490     IF  WS-CTNIN-IMSI       >  SPACES                            14743099
144500         PERFORM  4G-9100-SELECT-VORA-10  THRU  4G-9100-EXIT      14744099
144510         PERFORM  2041-CONVERT-VORA-DATE  THRU  2041-EXIT         14745099
144520         IF  WS-VORA-SYS-UPDATE-DATE2                             14746099
144530                             >  WS-HDR-DATE-TIME-MINUS-1DAY       14747099
144540             GO  TO   2300-VTS-NIB-EXIT                           14748099
144550         END-IF                                                   14749099
144560     END-IF                                                       14750099
144570                                                                  14751099
144580*  JA1210   -  Only  Update,  If  Update NOT within 24 Hrs        14752099
144590                                                                  14753099
144600     IF  WS-CTNIN-ICC-ID-4G  >  SPACES                            14754099
144610         PERFORM  4G-9000-SELECT-SIM-10  THRU  4G-9000-EXIT       14755099
144620         PERFORM  2051-CONVERT-SIM-DATE  THRU  2051-EXIT          14756099
144630         IF  WS-SIM-SYS-UPDATE-DATE2                              14757099
144640                             >  WS-HDR-DATE-TIME-MINUS-1DAY       14758099
144650             GO  TO   2300-VTS-NIB-EXIT                           14759099
144660         END-IF                                                   14760099
144670     END-IF                                                       14761099
144680                                                                  14762099
144690*  JA1210  -   4G Update                                          14763099
144700*  JA0111  - Below  Cond - rewritten                              14764099
144710                                                                  14765099
144720*  ICC-ID-4G                                                      14766099
144720*  JA0912  - NA  Last                                             14767099
144730        IF  WS-CTNIN-CTN-STATUS  =  'AA'  OR  'NA'  OR            14768099
144740            WS-CTN-STATUS-TO-AA  OR                               14769099
144750            WS-NEW-STATUS  =  'AA'  OR  'NA'  OR                  14770099
134990            CTN-STATUS OF DCLCTN-INV  =  'NA'                     14771099
144760           IF  WS-PARM-UPDATE OR WS-PARM-UPDDEL                   14772099
144770                              OR WS-PARM-UPDDNA                   14773099
144780             IF  WS-CTNIN-ICC-ID-4G  >  SPACES                    14774099
144790               IF  SQLCODE  =  +0                                 14775099
144800                  IF  SIM-STATUS  OF  DCLSIM-INV  NOT  =  'AA'    14776099
144810                      MOVE  'AA'  TO  WS-SIM-STATUS               14777099
144820                      PERFORM  4G-48500-CALL-ETLSC08              14778099
144830                                  THRU  4G-48500-EXIT             14779099
144840                      PERFORM  4G-50500-SIM-UPDATE                14780099
144850                                  THRU  4G-50500-EXIT             14781099
144860                      IF  WS-SQLCODE  =  +0                       14782099
144870                          PERFORM  4G-REPORT-BUILD    THRU        14783099
144880                                   4G-REPORT-BUILD-EXIT           14784099
144890                      GO  TO  2300-VTS-NIB-EXIT                   14785099
144900                      END-IF                                      14786099
144910                  END-IF                                          14787099
144920               END-IF                                             14788099
144930             END-IF                                               14789099
144940           END-IF                                                 14790099
144950        END-IF                                                    14791099
144960                                                                  14792099
144970*  IMSI                                                           14793099
144970*  JA0912 - NA  LAST                                              14794099
144980        IF  WS-CTNIN-CTN-STATUS  =  'AA'  OR  'NA'  OR            14795099
144990            WS-CTN-STATUS-TO-AA  OR                               14796099
145000            WS-NEW-STATUS  =  'AA'  OR  'NA'  OR                  14797099
134990            CTN-STATUS OF DCLCTN-INV  =  'NA'                     14798099
145010            IF  WS-PARM-UPDATE OR WS-PARM-UPDDEL                  14799099
145020                               OR WS-PARM-UPDDNA                  14800099
145030              IF  SQLCODE  =  +0                                  14801099
145040                  IF IMSI-STATUS OF DCLVORA-IMSI-INV NOT = 'AA'   14802099
145050                     IF  WS-CTNIN-IMSI       >  SPACES            14803099
145060                         MOVE  'AA'  TO  WS-VORA-STATUS           14804099
145070                         PERFORM  4G-49500-CALL-ETLSC09           14805099
145080                                      THRU  4G-49500-EXIT         14806099
145090                         PERFORM  4G-51500-VORA-UPDATE            14807099
145100                                      THRU  4G-51500-EXIT         14808099
145110                         PERFORM  4G-REPORT-BUILD                 14809099
145120                                      THRU  4G-REPORT-BUILD-EXIT  14810099
145130                         GO  TO  2300-VTS-NIB-EXIT                14811099
145140                     END-IF                                       14812099
145150                  END-IF                                          14813099
145160              END-IF                                              14814099
145170          END-IF                                                  14815099
145180     END-IF                                                       14816099
145190                                                                  14817099
145200*  End 4G processing                                              14818099
145210     .                                                            14819099
145220 2300-VTS-NIB-EXIT.  EXIT.                                        14820099
145230                                                                  14821099
145240                                                                  14822099
145250 2300-5XX-NIB.                                                    14823099
145260******************************************************************14824099
145270*                                                                 14825099
145280*     VTS  -  Not  In  Billing  (NIB)                             14826099
145290*                                                                 14827099
145300******************************************************************14828099
145310**---------------------------------                               14829099
145320**  Layout:  of  Array                                            14830099
145330**                                                                14831099
145340**    From_eTNI_Status  (1:2)                                     14832099
145350**                                                                14833099
145360**    Reads  Bypass  Status,  No  Processing  If  in  List        14834099
145370**    UNLESS,  Bytes  3-4  Specify  OTHER THAN '..'               14835099
145380**--------------------------------------------------------        14836099
145390**  JA0312                                                        14837099
145400**                                                                14838099
145410**    If  Second  Parameter  is  OTHER  Than  '..',  Then         14839099
145420**      Update  TO  Specified  Value                              14840099
145430**      Provided  eTNI  Status  Matches  1st  Value               14841099
145440**    In  effect,  we  are  repairing  our  data  when  5XX       14842099
145450**        is  'out of sync'  &...                                 14843099
145460**                                                                14844099
145470**    ONLY  'A*'  in  second  Status  is  Supported               14845099
145480**--------------------------------------------------------        14846099
145490                                                                  14847099
145500     SET  WS-5XX-PROCESSED  TO  TRUE                              14848099
145510                                                                  14849099
145520     PERFORM  VARYING   WS-CTN-STATUS-5-B-IDX                     14850099
145530              FROM  1  BY  1                                      14851099
145540              UNTIL  WS-CTN-STATUS-5-B-IDX  >                     14852099
145550                     WS-CTN-STATUS-5-B-IDX-MAX                    14853099
145560          OR                                                      14854099
145570       WS-BC16-5XX-NIB-PROCESS-ARAY-L                             14855099
145580                                 (WS-CTN-STATUS-5-B-IDX)(1:2)     14856099
145590                      =                                           14857099
145600       WS-CTNIN-CTN-STATUS                                        14858099
145610     END-PERFORM                                                  14859099
145620                                                                  14860099
145630     MOVE  WS-CTNIN-CTN-STATUS  TO  WS-CTNIN-CTN-STATUS-PREV      14861099
145640                                                                  14862099
145650     IF  WS-CTN-STATUS-5-B-IDX  NOT  >                            14863099
145660         WS-CTN-STATUS-5-B-IDX-MAX                                14864099
145670***      GO TO 2300-5XX-NIB-EXIT                                  14865099
145680         CONTINUE                                                 14866099
145690       ELSE                                                       14867099
145700         SET  WS-ERROR-FIELDS-FOUND    TO TRUE                    14868099
145710         MOVE LIT-STATUS-ERROR         TO WS-COMMENT              14869099
145720         MOVE 'Not in Billing'         TO WS-ADDTL-INFO           14870099
145730         MOVE 'ETNI'                   TO WS-SYSTEM               14871099
145740         MOVE WS-SAVE-HDR-BILLER-ID    TO WS-BILLER-ID            14872099
145750         PERFORM 6010-MOVE-ETNI-TO-RPT     THRU 6010-EXIT         14873099
145760         PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT         14874099
145770         ADD   +1 TO WS-TOTL-ERROR-STATUS-INVALID                 14875099
145780         GO TO 2300-5XX-NIB-EXIT                                  14876099
145790     END-IF                                                       14877099
145800                                                                  14878099
145810** JA0312  -  Bypass                                              14879099
145820     IF  WS-BC16-5XX-NIB-PROCESS-ARAY-L                           14880099
145830                                 (WS-CTN-STATUS-5-B-IDX)(3:2)     14881099
145840                                 =  '..'                          14882099
145850         GO TO 2300-5XX-NIB-EXIT                                  14883099
145860     END-IF                                                       14884099
145870                                                                  14885099
      ** JA0412  -  Match  Ctn-Status,  New  'A*'  Status  & Update     14886099
           IF  WS-BC16-5XX-NIB-PROCESS-ARAY-L                           14887099
                 (WS-CTN-STATUS-5-B-IDX)(3:1)  =  'A'                   14888099
                  MOVE  WS-CTNIN-CTN-TEXT  TO  WS-MDN                   14889099
                  PERFORM  7000-SELECT-CTN-INV   THRU  7000-EXIT        14890099
              IF  CTN-STATUS  IN  DCLCTN-INV  =  WS-CTNIN-CTN-STATUS    14891099
                AND   WS-PARM-UPDDNA                                    14892099
                      MOVE  'Y'  TO  USE-CTN-FIELDS-FOR-KEY             14893099
                      PERFORM  2102-CREATE-CTN-HIST  THRU  2102-EXIT    14894099
                      IF  WS-ERROR-FIELDS-FOUND                         14895099
                          GO TO 2300-5XX-NIB-EXIT                       14896099
                      END-IF                                            14897099
                      MOVE  CTN-STATUS  IN  DCLCTN-INV  TO              14898099
                                                       WS-COMMENT(22:2) 14899099
                      MOVE  WS-BC16-5XX-NIB-PROCESS-ARAY-L              14900099
                              (WS-CTN-STATUS-5-B-IDX)(3:2)  TO          14901099
                                  CTN-STATUS  IN  DCLCTN-INV            14902099
                                  WS-CTNIN-CTN-STATUS                   14903099
                                  WS-NEW-STATUS                         14904099
                      MOVE  WS-CTNIN-NGP  TO  WS-HOLD-NGP               14905099
                      MOVE  SPACES  TO  WS-ETNDC38-BILLER               14906099
                      PERFORM  7040-GET-BILLER-FROM-NGP-TABLE           14907099
                               THRU  7040-EXIT                          14908099
                      IF WS-ETNDC38-BILLER  >  SPACES                   14909099
                         MOVE  WS-ETNDC38-BILLER  TO  WS-CTNIN-BILLER-ID14910099
                      END-IF                                            14911099
                      PERFORM  7010-UPDATE-CTN-INV  THRU  7010-EXIT     14912099
                      MOVE 'ETNI' TO WS-SYSTEM                          14913099
                      MOVE 'Repair CTN Stat-5XX '  TO  WS-COMMENT(1:20) 14914099
                      PERFORM  6010-MOVE-ETNI-TO-RPT  THRU  6010-EXIT   14915099
                      PERFORM  6400-WRITE-RECON-RPT   THRU  6400-EXIT   14916099
                      PERFORM  6300-PRINT-BLANK-LINE  THRU  6300-EXIT   14917099
                      MOVE  WS-CTNIN-NL                TO WS-NEW-NL     14918099
                      MOVE  WS-CTNIN-NGP               TO WS-NEW-NGP    14919099
                      MOVE  WS-CTNIN-PRODUCT-TYPE      TO               14920099
                                                    WS-NEW-PRODUCT-TYPE 14921099
097170                PERFORM 2150-UPDATE-STATUS-COUNTERS  THRU         14922099
097170                                                     2150-EXIT    14923099
058150                GO TO 2300-5XX-NIB-EXIT                           14924099
058150             END-IF                                               14925099
058150     END-IF                                                       14926099
146170                                                                  14927099
146180**  Any Status Listed  In  Param  Will  Continue  Processing      14928099
146190**       other  Status's  Will  Error  Out                        14929099
146200                                                                  14930099
146210     IF WS-CTNIN-CTN-STATUS = 'NH'                                14931099
146220        ADD +1 TO WS-TOTL-ETNI-NA-NH-CNT                          14932099
146230        GO TO 2300-5XX-NIB-CONTINUE-10                            14933099
146240     END-IF                                                       14934099
146250                                                                  14935099
146260     MOVE WS-CTNIN-HOLD-REASON(1:10) TO PENDING-HOLD-REASON-CODES 14936099
146270     IF WS-CTNIN-CTN-STATUS = 'NH' AND NOT                        14937099
146280        VALID-PENDING-HOLD-REASON-CODE                            14938099
146290        ADD +1 TO WS-TOTL-ETNI-NA-NH-CNT                          14939099
146300        GO TO 2300-5XX-NIB-EXIT                                   14940099
146310     END-IF                                                       14941099
146320                                                                  14942099
146330*----CTNs with 'SPL' Last Trx Code should not be deleted----------14943099
146340*--- These are special holding pools. Bypass them.----------------14944099
146350     IF WS-CTNIN-LAST-TRX-CODE = 'SPL'                            14945099
146360        ADD   +1 TO WS-TOTL-ERROR-BILLER-NOTMTCH                  14946099
146370        MOVE  'ETNI'                   TO   WS-SYSTEM             14947099
146380        MOVE 'ERROR: SPL NOT IN BILLING' TO WS-COMMENT            14948099
146390        PERFORM 6010-MOVE-ETNI-TO-RPT  THRU 6010-EXIT             14949099
146400        PERFORM 6500-WRITE-ERROR-RPT   THRU 6500-EXIT             14950099
146410        GO TO 2300-5XX-NIB-EXIT                                   14951099
146420     END-IF                                                       14952099
146430                                                                  14953099
146440**  JA0602  - Start  For  New  Split  Logic                       14954099
146450                                                                  14955099
146460     IF  WS-SPLIT-BYPASS                                          14956099
146470         IF  WS-CTNIN-CTN-STATUS(1:1)  =  'A'                     14957099
146480             ADD   +1  TO  WS-TOTL-BYPASS-SPLIT                   14958099
146490             GO TO 2300-5XX-NIB-EXIT                              14959099
146500         END-IF                                                   14960099
146510     END-IF                                                       14961099
146520                                                                  14962099
146530**  JA0507  - START                                               14963099
146540                                                                  14964099
146550     IF  WS-VISION                                                14965099
146560         IF WS-CTNIN-CTN-STATUS = 'PA'  OR                        14966099
146570            WS-CTNIN-CTN-STATUS = 'AA'                            14967099
146580                                                                  14968099
146590            GO TO 2300-5XX-NIB-CONTINUE-10                        14969099
146600         END-IF                                                   14970099
146610     END-IF                                                       14971099
146620                                                                  14972099
146630**  JA0507  - END                                                 14973099
146640*                                                                 14974099
146650*       eTNI's CTN not on Biller's file  &  'AA'  Status          14975099
146660*       The CTN-INV  ROW  will  NOT  be  updated  For             14976099
146670*       BILLER-ID  VISION, Print Report & Bypass                  14977099
146680*                                                                 14978099
146690*  JA0410  - Added  Perm Reserve  NL(2:1) = H..Below              14979099
146700                                                                  14980099
146710     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        14981099
146720*-------port-outs have spaces in NL, so only compare NLs 1st byte-14982099
146730*-------to Biller from Header if the NL is populated!-------------14983099
146740          IF WS-CTNIN-NL(1:1) NOT = SPACE AND                     14984099
146750             WS-CTNIN-NL(1:1) NOT = LOW-VALUES AND                14985099
146760             WS-CTNIN-NL(1:1) NOT = WS-SAVE-HDR-BILLER-ID AND     14986099
146770             WS-CTNIN-NL(2:1) NOT =  'H'                          14987099
146780             ADD  +1 TO WS-TOTL-ERROR-RSS-BILL-NL-BYP             14988099
146790             MOVE WS-CTNIN-NL TO LIT-RSS-NL                       14989099
146800             MOVE WS-SAVE-HDR-BILLER-ID TO LIT-RSS-BILLER         14990099
146810             MOVE LIT-RSS-NL-1ST-TO-BILL-ID TO WS-COMMENT         14991099
146820             INITIALIZE WS-ADDTL-INFO                             14992099
146830             PERFORM 6010-MOVE-ETNI-TO-RPT  THRU 6010-EXIT        14993099
146840             PERFORM 6500-WRITE-ERROR-RPT   THRU 6500-EXIT        14994099
146850             GO TO 2300-5XX-NIB-EXIT                              14995099
146860          END-IF                                                  14996099
146870        END-IF                                                    14997099
146880                                                                  14998099
146890*----it's OK for MDN to be missing in Biller if PO'd in eTNI------14999099
146900     IF WS-PARM-UPDATE AND                                        15000099
146910       (WS-CTNIN-CTN-STATUS NOT = 'PO' OR                         15001099
146920        WS-CTNIN-PORT-IND NOT = 'PO')                             15002099
146930        ADD   +1 TO WS-TOTL-ERROR-BILLER-NOTMTCH                  15003099
146940        MOVE  'ETNI'                   TO   WS-SYSTEM             15004099
146950        MOVE 'WARN: MDN NOT IN BILL*>ETNI ' TO WS-COMMENT         15005099
146960        MOVE WS-CTNIN-CTN-STATUS                                  15006099
146970                                    TO WS-COMMENT(24:2)           15007099
146980        PERFORM 6010-MOVE-ETNI-TO-RPT  THRU 6010-EXIT             15008099
146990        PERFORM 6500-WRITE-ERROR-RPT   THRU 6500-EXIT             15009099
147000        GO TO 2300-5XX-NIB-EXIT                                   15010099
147010     END-IF                                                       15011099
147020                                                                  15012099
147030**  JA0907  - START                                               15013099
147040*=================================================================15014099
147050*    All the bypass logic is complete. Below starts REAL processng15015099
147060*=================================================================15016099
147070                                                                  15017099
147080     INITIALIZE USE-CTN-FIELDS-FOR-KEY                            15018099
147090     INITIALIZE CREATE-UNLOAD-HISTORY-FLAG                        15019099
147100     MOVE 'N' TO WS-ERROR-ALREADY-REPORTED                        15020099
147110                                                                  15021099
147120     IF WS-PARM-UPDDNA AND                                        15022099
147130        WS-CTNIN-PORT-IND = 'RE'                                  15023099
147140           MOVE WS-CTNIN-CTN-TEXT(1:10) TO NUMERIC-CTNIN-CTN      15024099
147150           MOVE NUMERIC-CTNIN-CTN TO MDN OF DCLTVZW-LSMS          15025099
147160           PERFORM 7200-CHECK-SPID-IN-LSMS THRU 7200-EXIT         15026099
147170           IF CTN-HAS-VZW-SPID = 'N'                              15027099
147180              MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  15028099
147190              MOVE 'N' TO WS-ERROR-ALREADY-REPORTED               15029099
147200              PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT         15030099
147210              IF WS-ERROR-FIELDS-FOUND AND                        15031099
147220                 WS-ERROR-ALREADY-REPORTED NOT = 'Y'              15032099
147230                    MOVE 'ETNI'  TO WS-SYSTEM                     15033099
147240                    PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT  15034099
147250                    PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT   15035099
147260                    GO TO 2300-5XX-NIB-EXIT                       15036099
147270              END-IF                                              15037099
147280                                                                  15038099
147290              MOVE 'N' TO WS-ERROR-ALREADY-REPORTED               15039099
147300                                                                  15040099
147310*----------update CTN-INV row-------------------------------------15041099
147320              PERFORM 7004-RE-PORTED-CTN-INV-UPD THRU 7004-EXIT   15042099
147330*----------change MIN-INV Status to "AP" so it's no longer in use-15043099
147340**            MOVE 'AP' TO MODIFIED-MIN-STATUS                    15044099
147350**            PERFORM 2184-UPDATE-MIN-STATUS THRU 2184-EXIT       15045099
147360              MOVE 'ETNI' TO WS-SYSTEM                            15046099
147370              MOVE LIT-UPD-PO-NOT-IN-BILL-COMMENT TO WS-COMMENT   15047099
147380              MOVE 'REG CTN PORTED ' TO WS-ADDTL-INFO             15048099
147390              PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT        15049099
147400              PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT        15050099
147410              PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT        15051099
147420              GO TO 2300-5XX-NIB-EXIT                             15052099
147430           END-IF                                                 15053099
147440        END-IF                                                    15054099
147450                                                                  15055099
147460     INITIALIZE NH-AND-PENDDASG-R-FLAG                            15056099
147470     IF WS-CTNIN-CTN-STATUS = 'NH' AND                            15057099
147480        WS-CTNIN-HOLD-REASON(1:10) = 'PENDDASG-R'                 15058099
147490        MOVE 'Y' TO NH-AND-PENDDASG-R-FLAG                        15059099
147500        INITIALIZE NH-AND-OTHER-PENDING-FLAG                      15060099
147510                   USE-CTN-FIELDS-FOR-KEY                         15061099
147520                   CREATE-UNLOAD-HISTORY-FLAG                     15062099
147530        IF WS-PARM-UPDDNA AND                                     15063099
147540           WS-CTNIN-PORT-IND = 'RE'                               15064099
147550              MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  15065099
147560*----------create HISTORY row w. "GOODDASG-R" Hold-Reason in 2320-15066099
147570              PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT         15067099
147580              IF WS-ERROR-FIELDS-FOUND                            15068099
147590                 GO TO 2300-5XX-NIB-EXIT                          15069099
147600              END-IF                                              15070099
147610*----------update CTN-INV row-------------------------------------15071099
147620              PERFORM 7009-NH-PENDING-CTN-INV-UPD THRU 7009-EXIT  15072099
147630*----------send an ASGN RAPI to the NEW Biller--------------------15073099
147640              PERFORM 9180-SEND-ASGN-RAPI THRU 9180-EXIT          15074099
147650              MOVE 'ETNI' TO WS-SYSTEM                            15075099
147660              MOVE BILLER-ID OF DCLCTN-INV TO                     15076099
147670                   LIT-UPD-PENDDASG-R-BILLER                      15077099
147680              MOVE LIT-UPD-PENDDASG-R-NOT-IN-BILL TO WS-COMMENT   15078099
147690              MOVE SPACE TO WS-ADDTL-INFO                         15079099
147700              PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT        15080099
147710              PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT        15081099
147720              PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT        15082099
147730              GO TO 2300-5XX-NIB-EXIT                             15083099
147740           END-IF                                                 15084099
147750        END-IF                                                    15085099
147760                                                                  15086099
147770     INITIALIZE NH-AND-OTHER-PENDING-FLAG                         15087099
147780     MOVE WS-CTNIN-HOLD-REASON(1:10) TO                           15088099
147790          PENDING-HOLD-REASON-CODES-II                            15089099
147800                                                                  15090099
147810     IF WS-CTNIN-CTN-STATUS = 'NH' AND                            15091099
147820        VALID-PENDING-HOLD-REASON-II                              15092099
147830        MOVE 'Y' TO NH-AND-OTHER-PENDING-FLAG                     15093099
147840        INITIALIZE NH-AND-PENDDASG-R-FLAG                         15094099
147850     END-IF                                                       15095099
147860                                                                  15096099
147870     INITIALIZE USE-CTN-FIELDS-FOR-KEY                            15097099
147880                CREATE-UNLOAD-HISTORY-FLAG                        15098099
147890                SHOULD-WE-DISCONNECT-FLAG                         15099099
147900                                                                  15100099
147910*----determine if we need to Disconnect and Unload by a read of---15101099
147920*----PORTIN-MDN-TDS table-----------------------------------------15102099
147930                                                                  15103099
147940     IF WS-CTNIN-CTN-STATUS NOT = 'NH'                            15104099
147950        AND                                                       15105099
147960       (WS-CTNIN-PORT-IND = 'PI' OR                               15106099
147970        WS-CTNIN-PORT-IND = 'IO')                                 15107099
147980        AND                                                       15108099
147990       (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)       15109099
148000           PERFORM 9170-READ-PORTIN-MDN-TDS THRU 9170-EXIT        15110099
148010     END-IF                                                       15111099
148020                                                                  15112099
148030*Case 1 of 2:                                                     15113099
148040*==========PORTIN-MDN-TDS says its NOT OK to Disconnect===========15114099
148050                                                                  15115099
148060*----based on the results of PORTIN-MDN-TDS lookup, do NOT--------15116099
148070*----disconnect, but then update HISTORY, CTN-INV and MIN-INV-----15117099
148080*                                                                 15118099
148090     IF SHOULD-WE-DISCONNECT-FLAG NOT = 'Y'                       15119099
148100        IF WS-CTNIN-CTN-STATUS NOT = 'NH'                         15120099
148110           AND                                                    15121099
148120          (WS-CTNIN-PORT-IND = 'PI' OR                            15122099
148130           WS-CTNIN-PORT-IND = 'IO')                              15123099
148140           AND                                                    15124099
148150          (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)    15125099
148160*----------first, create a HISTORY row identical to CTN-INV row---15126099
148170           MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                     15127099
148180           PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT            15128099
148190           IF WS-ERROR-FIELDS-FOUND                               15129099
148200              GO TO 2300-5XX-NIB-EXIT                             15130099
148210           END-IF                                                 15131099
148220           PERFORM 7005-SPLIT-CTN-INV-UPD THROUGH 7005-EXIT       15132099
148230                                                                  15133099
148240*AGB 11/21/05                                                     15134099
148250           MOVE WS-CTNIN-BILLER-ID TO                             15135099
148260                WS-WHICH-BILLER-ID OF WS-COMMON-BILLERID          15136099
148270                                                                  15137099
148280           MOVE 'ETNI' TO WS-SYSTEM                               15138099
148290           MOVE LIT-SPLIT-COMMENT TO WS-COMMENT                   15139099
148300           MOVE SPACES TO WS-ADDTL-INFO                           15140099
148310           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           15141099
148320           PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT           15142099
148330           PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT           15143099
148340           GO TO 2300-5XX-NIB-CONTINUE-10                         15144099
148350           END-IF                                                 15145099
148360       END-IF                                                     15146099
148370                                                                  15147099
148380*Case 2 of 2:                                                     15148099
148390*==========PORTIN-MDN-TDS says its OK to Disconnect===============15149099
148400                                                                  15150099
148410*----based on the results of PORTIN-MDN-TDS lookup, create an-----15151099
148420*----Unload History row and issue a Disconnect to the Gateway-----15152099
148430     IF SHOULD-WE-DISCONNECT-FLAG = 'Y'                           15153099
148440        IF WS-CTNIN-CTN-STATUS NOT = 'NH'                         15154099
148450           AND                                                    15155099
148460          (WS-CTNIN-PORT-IND = 'PI')                              15156099
148470** JA0907  WS-CTNIN-PORT-IND = 'IO')  ** Omit  Condition          15157099
148480           AND                                                    15158099
148490          (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)    15159099
148500*----------issue a Disconnect Message to the VZW Gateway----------15160099
148510*  JA0112  -  Comment  Out  DSCP  Processing                      15161099
148520**            ADD 1 TO DISCONNECT-MSG-COUNTER                     15162099
148530**            MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  15163099
148540**            PERFORM Q1000-ISSUE-DISCON-TO-GATEWAY THRU          15164099
148550**                    Q1000-EXIT                                  15165099
148560                                                                  15166099
148570*AGB 4/18/06--if CTN-INV row not found, dont write to MQ to-------15167099
148580*-------------prevent writing blank MQ records. (exit routine)----15168099
148590*-------------Keep a counter for display at end of pgm.-----------15169099
148600**            IF SQLCODE NOT = +0                                 15170099
148610**               ADD 1 TO WS-CANT-FIND-CTN-IN-Q1000               15171099
148620**               GO TO 2300-5XX-NIB-EXIT                          15172099
148630**               END-IF                                           15173099
148640                                                                  15174099
148650**            PERFORM Q1010-PUT-DISCON-MESSAGE-TO-MQ THRU         15175099
148660**                    Q1010-EXIT                                  15176099
148670*----------create a HISTORY row identical to CTN-INV row----------15177099
148680              MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  15178099
148690              PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT         15179099
148700              IF WS-ERROR-FIELDS-FOUND                            15180099
148710                 GO TO 2300-5XX-NIB-EXIT                          15181099
148720              END-IF                                              15182099
148730*----------create a HISTORY row with ULD, NA status, PI port-ind--15183099
148740              MOVE 'Y' TO CREATE-UNLOAD-HISTORY-FLAG              15184099
148750              MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                  15185099
148760              PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT         15186099
148770              IF WS-ERROR-FIELDS-FOUND                            15187099
148780                 GO TO 2300-5XX-NIB-EXIT                          15188099
148790              END-IF                                              15189099
148800*----------delete the CTN-INV row copied to History above---------15190099
148810              MOVE WS-CTNIN-CTN-TEXT (1:10) TO WS-MDN             15191099
148820              INITIALIZE NOT-DELETED-SW                           15192099
148830              PERFORM 7030-DELETE-CTN-INV THRU 7030-EXIT          15193099
148840*----------change MIN-INV Status to "AP" so it's no longer in use-15194099
148850**            MOVE 'AP' TO MODIFIED-MIN-STATUS                    15195099
148860**            PERFORM 2184-UPDATE-MIN-STATUS THRU 2184-EXIT       15196099
148870              MOVE 'ETNI' TO WS-SYSTEM                            15197099
148880              MOVE LIT-UNLOADED-COMMENT TO WS-COMMENT             15198099
148890              MOVE SPACES TO WS-ADDTL-INFO                        15199099
148900              PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT        15200099
148910              PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT        15201099
148920              PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT        15202099
148930*AXY042706 - BEG                                                  15203099
148940** JA0410     PERFORM Q1011-CMIT-QUEUE      THRU Q1011-EXIT       15204099
148950*AXY042706 - END                                                  15205099
148960              GO TO 2300-5XX-NIB-CONTINUE-10                      15206099
148970           END-IF                                                 15207099
148980     END-IF                                                       15208099
148990                                                                  15209099
149000     INITIALIZE USE-CTN-FIELDS-FOR-KEY                            15210099
149010     INITIALIZE CREATE-UNLOAD-HISTORY-FLAG                        15211099
149020     IF (WS-CTNIN-CTN-STATUS = 'PO' OR                            15212099
149030         WS-CTNIN-CTN-STATUS = 'NA')                              15213099
149040         AND                                                      15214099
149050         WS-CTNIN-PORT-IND = 'IO'                                 15215099
149060         AND                                                      15216099
149070        (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)      15217099
149080*----------create a HISTORY row identical to CTN-INV row--------- 15218099
149090           MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                     15219099
149100           PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT            15220099
149110           IF WS-ERROR-FIELDS-FOUND                               15221099
149120              GO TO 2300-5XX-NIB-EXIT                             15222099
149130           END-IF                                                 15223099
149140*----------create a HISTORY row with ULD, NA status, PI Port-Ind--15224099
149150           MOVE 'Y' TO CREATE-UNLOAD-HISTORY-FLAG                 15225099
149160           MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                     15226099
149170           PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT            15227099
149180           IF WS-ERROR-FIELDS-FOUND                               15228099
149190              GO TO 2300-5XX-NIB-EXIT                             15229099
149200           END-IF                                                 15230099
149210*----------delete the CTN-INV row copied to History above---------15231099
149220           MOVE WS-CTNIN-CTN-TEXT (1:10) TO WS-MDN                15232099
149230           INITIALIZE NOT-DELETED-SW                              15233099
149240           PERFORM 7030-DELETE-CTN-INV THRU 7030-EXIT             15234099
149250           MOVE 'ETNI' TO WS-SYSTEM                               15235099
149260           MOVE LIT-UNLOADED-COMMENT TO WS-COMMENT                15236099
149270           MOVE SPACES TO WS-ADDTL-INFO                           15237099
149280           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           15238099
149290           PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT           15239099
149300           PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT           15240099
149310           GO TO 2300-5XX-NIB-CONTINUE-10                         15241099
149320     END-IF                                                       15242099
149330                                                                  15243099
149340*----If this is a Transitional Ported-Out CTN, write image of-----15244099
149350*----CTN-INV to History, update CTN-INV and change MIN-INV status-15245099
149360                                                                  15246099
149370     IF WS-CTNIN-CTN-STATUS NOT = 'PO' AND                        15247099
149380        WS-CTNIN-PORT-IND = 'PO'                                  15248099
149390        AND                                                       15249099
149400       (WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA)       15250099
149410*----------create a HISTORY row identical to CTN-INV row--------- 15251099
149420           MOVE 'Y' TO USE-CTN-FIELDS-FOR-KEY                     15252099
149430           PERFORM 2102-CREATE-CTN-HIST THRU 2102-EXIT            15253099
149440           IF WS-ERROR-FIELDS-FOUND                               15254099
149450              GO TO 2300-5XX-NIB-EXIT                             15255099
149460           END-IF                                                 15256099
149470*----------update CTN-INV row------------------------------------ 15257099
149480           PERFORM 7003-TRANSITIONAL-CTN-INV-UPD THRU 7003-EXIT   15258099
149490*----------change MIN-INV Status to "AP" so it's no longer in use-15259099
149500**         MOVE 'AP' TO MODIFIED-MIN-STATUS                       15260099
149510**         PERFORM 2184-UPDATE-MIN-STATUS THRU 2184-EXIT          15261099
149520           MOVE 'ETNI' TO WS-SYSTEM                               15262099
149530           MOVE LIT-UPD-PO-NOT-IN-BILL-COMMENT TO WS-COMMENT      15263099
149540           MOVE 'TRANSITIONAL PO' TO WS-ADDTL-INFO                15264099
149550           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           15265099
149560           PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT           15266099
149570           PERFORM 6300-PRINT-BLANK-LINE THRU 6300-EXIT           15267099
149580           GO TO 2300-5XX-NIB-CONTINUE-10                         15268099
149590        END-IF                                                    15269099
149600                                                                  15270099
149610**  JA0507  - START                                               15271099
149620                                                                  15272099
149630     IF  WS-VISION                                                15273099
149640         IF WS-CTNIN-CTN-STATUS = 'AG'  AND                       15274099
149650            WS-CTNIN-PORT-IND   = 'SB'                            15275099
149660                                                                  15276099
149670              GO TO 2300-5XX-NIB-EXIT                             15277099
149680         END-IF                                                   15278099
149690     END-IF                                                       15279099
149700                                                                  15280099
149710**  JA0507  - END                                                 15281099
149720                                                                  15282099
149730*-------PARM: UPDDEL or UPDDNA------------------------------------15283099
149740     IF WS-PARM-UPDDEL OR WS-PARM-UPDDNA                          15284099
149750        ADD +1 TO WS-TOTL-ETNI-NOT-IN-BILL-PROC                   15285099
149760        PERFORM 2030-CONVERT-ETNI-DATE THRU 2030-EXIT             15286099
149770        MOVE    WS-CTNIN-BILLER-ID      TO WS-BILLER-ID           15287099
149780        MOVE    WS-CTNIN-CTN-STATUS     TO WS-OLD-STATUS          15288099
149790        MOVE    WS-CTNIN-PRODUCT-TYPE   TO WS-OLD-PRODUCT-TYPE    15289099
149800        MOVE    WS-CTNIN-NL             TO WS-OLD-NL              15290099
149810        MOVE    WS-CTNIN-NGP            TO WS-OLD-NGP             15291099
149820        IF WS-PARM-UPDDEL                                         15292099
149830           MOVE SPACES                  TO WS-NEW-STATUS          15293099
149840                                           WS-NEW-PRODUCT-TYPE    15294099
149850                                           WS-NEW-NL              15295099
149860                                           WS-NEW-NGP             15296099
149870        END-IF                                                    15297099
150090                                                                  15298099
150100     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA OR     15299099
150110        WS-PARM-UPDATX OR WS-PARM-UPDDEX                          15300099
150120        MOVE WS-CTNIN-CTN-STATUS TO WS-OLD-STATUS                 15301099
150130     END-IF                                                       15302099
150140                                                                  15303099
150150**  JA1207B  -  Start  -  Lookup       -                          15304099
150160                                                                  15305099
150170**  LOOKUP  BYPASS,  IF  MAX;  REPORT  &  EXIT                    15306099
150180                                                                  15307099
150190      PERFORM  VARYING   WS-CTN-STATUS-B-A-IDX                    15308099
150200               FROM  1  BY  1                                     15309099
150210               UNTIL  WS-CTN-STATUS-B-A-IDX  >                    15310099
150220                      WS-CTN-STATUS-B-A-IDX-MAX                   15311099
150230                                                                  15312099
150240        OR                                                        15313099
150250                                                                  15314099
150260        WS-CTN-STATUS-TO-AA-ARRAY-LST(WS-CTN-STATUS-B-A-IDX)(1:2) 15315099
150270                     =                                            15316099
150280        WS-CTNIN-CTN-STATUS                                       15317099
150290                                                                  15318099
150300      END-PERFORM                                                 15319099
150310                                                                  15320099
150320     SET  WS-CTN-STATUS-TO-AA-NOTFOUND  TO  TRUE                  15321099
150330                                                                  15322099
150340**  FOUND  IN  SET-TO-AA  TABLE  ?                                15323099
150350**    Y..Report  Set  Flag  As  Such                              15324099
150360**                                                                15325099
150370     IF  WS-CTN-STATUS-B-A-IDX  <                                 15326099
150380         WS-CTN-STATUS-B-A-IDX-MAX  + 1                           15327099
150390         SET  WS-CTN-STATUS-TO-AA  TO  TRUE                       15328099
150400     END-IF                                                       15329099
150410                                                                  15330099
150420**  JA1207B  -  Start  -  Next  Cond.  -                          15331099
150430                                                                  15332099
150440**  JA0402  -   WS-LEGIT-BILLER-ID-RESELLER ADDED                 15333099
150450                                                                  15334099
150460     IF  WS-LEGIT-BILLER-ID-RESELLER AND                          15335099
150470         WS-CTN-STATUS-TO-AA  AND                                 15336099
150480         WS-PARM-PROCESS-REQ(1:3)  =  'UPD'  AND                  15337099
134490         WS-CTNIN-ICC-ID-4G  NOT  >  SPACES                       15338099
150490         MOVE WS-CTNIN-CTN-TEXT(1:10) TO WS-MDN                   15339099
150500         PERFORM  7000-SELECT-CTN-INV   THRU 7000-EXIT            15340099
150510         IF  WS-SQLCODE  =  +0  AND                               15341099
150520             MIN-NUM-TEXT  OF  DCLCTN-INV  NUMERIC                15342099
150530**             MOVE   MIN-NUM-TEXT  OF  DCLCTN-INV  TO            15343099
150540**                                      WS-TEMP-MIN-NUM-TEXT      15344099
150550               MOVE   NL  OF  DCLCTN-INV            TO  WS-NL     15345099
150560                                                    WS-SAVED-NL   15346099
150570               MOVE  NGP OF  DCLCTN-INV             TO  WS-NGP    15347099
150580                                                    WS-HOLD-NGP   15348099
150590               MOVE  PRODUCT-TYPE  OF  DCLCTN-INV                 15349099
150600                                       TO  WS-PRODUCT-TYPE        15350099
150610               PERFORM  7500-SELECT-NUMBER-GRP-LOC                15351099
150620                                        THRU  7500-EXIT           15352099
150630**                                                                15353099
150640**       Process  As  Before,  If  Found                          15354099
150650**         Else..Update CTN-INV-HISTORY, CTN-INV,                 15355099
150660**                      NUMBER-GROUP, & MIN-INV                   15356099
150670**                      Create Recon Report, exit                 15357099
150680**                                                                15358099
150690         IF  WS-SQLCODE  =  +0                                    15359099
150700             CONTINUE                                             15360099
150710                                                                  15361099
150720           ELSE                                                   15362099
150730                                                                  15363099
150740          PERFORM  2320-POPULATE-CTN-HIST  THRU   2320-EXIT       15364099
150750          PERFORM  7100-INSERT-CTN-HIST    THRU   7100-EXIT       15365099
150760          PERFORM  7120-RETRY-UP-TO-10-TIMES THRU 7120-EXIT       15366099
150770          IF SQL-DUP-INSERT                                       15367099
150780             SET WS-ERROR-FIELDS-FOUND TO TRUE                    15368099
150790             PERFORM 6030-INIT-DETAIL-LINE THRU 6030-EXIT         15369099
150800             PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT         15370099
150810             MOVE 'ETNI' TO WS-SYSTEM                             15371099
150820             MOVE LIT-CTN-HIST-INSERT-ERROR TO WS-COMMENT         15372099
150830             MOVE CTN-TEXT OF DCLCTN-INV-HISTORY TO               15373099
150840                  WS-ADDTL-INFO (1:10)                            15374099
150850             MOVE PRODUCT-TYPE OF DCLCTN-INV-HISTORY TO           15375099
150860                  WS-ADDTL-INFO (12:1)                            15376099
150870             PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT         15377099
150880             PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT          15378099
150890             GO TO 2300-5XX-NIB-EXIT                              15379099
150900         END-IF                                                   15380099
150910                                                                  15381099
150920         PERFORM  7040-GET-BILLER-FROM-NGP-TABLE THRU  7040-EXIT  15382099
150930                                                                  15383099
150940           IF  WS-SQLCODE  =  ZERO                                15384099
150950               MOVE  WS-ETNDC38-BILLER  TO                        15385099
150960                                    BILLER-ID  OF  DCLCTN-INV     15386099
150970           END-IF                                                 15387099
150980                                                                  15388099
150990         PERFORM  7019-UPDATE-CTN-INV-STATUS   THRU  7019-EXIT    15389099
151000**       PERFORM  2190-UPD-NEW-MIN-NUM-STAT    THRU  2190-EXIT    15390099
151010                                                                  15391099
151020           IF SQL-ROW-NOT-FOUND                                   15392099
151030              SET  WS-ERROR-FIELDS-FOUND    TO   TRUE             15393099
151040              PERFORM  6010-MOVE-ETNI-TO-RPT    THRU   6010-EXIT  15394099
151050              PERFORM  6500-WRITE-ERROR-RPT     THRU   6500-EXIT  15395099
151060              MOVE 'N' TO NOT-UPDATED-SW                          15396099
151070              GO TO 2300-5XX-NIB-EXIT                             15397099
151080           END-IF                                                 15398099
151090                                                                  15399099
151100          MOVE  NL  OF  DCLCTN-INV  TO  WS-NL                     15400099
151110          MOVE  NGP OF  DCLCTN-INV  TO  WS-NGP                    15401099
151120                                                                  15402099
151130          PERFORM  7510-SELECT-NGP-NL-ASSIGNMENT  THRU  7510-EXIT 15403099
151140                                                                  15404099
151150           IF  WS-SQLCODE =  +0                                   15405099
151160               COMPUTE  WS-QTY  =  AA-STS-CNT  +  1               15406099
151170               PERFORM  7520-UPDATE-NGP-NL-ASSIGNMENT             15407099
151180                                                THRU  7520-EXIT   15408099
151190           END-IF                                                 15409099
151200                                                                  15410099
151210         MOVE  'ETNI'  TO  WS-SYSTEM                              15411099
151220         MOVE  CTN-STATUS  OF  DCLCTN-INV  TO                     15412099
151230                                           WS-CTNIN-CTN-STATUS    15413099
151240         MOVE  NL  OF  DCLCTN-INV    TO    WS-CTNIN-NL            15414099
151250         MOVE  NGP OF  DCLCTN-INV    TO    WS-CTNIN-NGP           15415099
151260         MOVE  BILLER-ID  OF  DCLCTN-INV   TO                     15416099
151270                                           WS-CTNIN-BILLER-ID     15417099
151280         MOVE  LAST-TRX-CODE  OF  DCLCTN-INV  TO                  15418099
151290                                           WS-CTNIN-LAST-TRX-CODE 15419099
151300                                                                  15420099
151310         MOVE  'AA'  TO  COMMENT-STATUS                           15421099
151320         MOVE  LIT-DYNAMIC-STATUS-COMMENT   TO    WS-COMMENT      15422099
151330                                                                  15423099
151340         PERFORM  6010-MOVE-ETNI-TO-RPT    THRU   6010-EXIT       15424099
151350         PERFORM  6400-WRITE-RECON-RPT     THRU   6400-EXIT       15425099
151360         MOVE 'N' TO NOT-UPDATED-SW                               15426099
151370                                                                  15427099
151380         PERFORM 6300-PRINT-BLANK-LINE     THRU   6300-EXIT       15428099
151390         GO TO 2300-5XX-NIB-CONTINUE-10                           15429099
151400         END-IF                                                   15430099
151410       END-IF                                                     15431099
151420     END-IF                                                       15432099
151430                                                                  15433099
151440**  JA1207B  -  End                                               15434099
151450                                                                  15435099
151460**  JA1207B  -  Start  -  Next  Cond.  -                          15436099
151470                                                                  15437099
151480     IF  WS-VISION  AND                                           15438099
151490         WS-CTN-STATUS-TO-AA  AND                                 15439099
151500         WS-PARM-PROCESS-REQ(1:3)  =  'UPD'                       15440099
151510         MOVE WS-CTNIN-CTN-TEXT(1:10) TO WS-MDN                   15441099
151520         PERFORM  7000-SELECT-CTN-INV   THRU 7000-EXIT            15442099
151530         IF  WS-SQLCODE  =  +0  AND                               15443099
151540             MIN-NUM-TEXT  OF  DCLCTN-INV  NUMERIC                15444099
151550**             MOVE   MIN-NUM-TEXT  OF  DCLCTN-INV  TO            15445099
151560**                                      WS-TEMP-MIN-NUM-TEXT      15446099
151570               MOVE   NL  OF  DCLCTN-INV            TO  WS-NL     15447099
151580                                                    WS-SAVED-NL   15448099
151590               MOVE  NGP OF  DCLCTN-INV             TO  WS-NGP    15449099
151600                                                    WS-HOLD-NGP   15450099
151610               MOVE  PRODUCT-TYPE  OF  DCLCTN-INV  TO             15451099
151620                                             WS-PRODUCT-TYPE      15452099
151630**                                                                15453099
151640**       Process                                                  15454099
151650**               Update CTN-INV-HISTORY, CTN-INV,                 15455099
151660**                      NUMBER-GROUP, & MIN-INV                   15456099
151670**                      Create Recon Report, exit                 15457099
151680**                                                                15458099
151690             PERFORM  2320-POPULATE-CTN-HIST  THRU   2320-EXIT    15459099
151700             PERFORM  7100-INSERT-CTN-HIST    THRU   7100-EXIT    15460099
151710             PERFORM  7120-RETRY-UP-TO-10-TIMES THRU 7120-EXIT    15461099
151720                                                                  15462099
151730            IF SQL-DUP-INSERT                                     15463099
151740               SET WS-ERROR-FIELDS-FOUND TO TRUE                  15464099
151750               PERFORM 6030-INIT-DETAIL-LINE THRU 6030-EXIT       15465099
151760               PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT       15466099
151770               MOVE 'ETNI' TO WS-SYSTEM                           15467099
151780               MOVE LIT-CTN-HIST-INSERT-ERROR TO WS-COMMENT       15468099
151790               MOVE CTN-TEXT OF DCLCTN-INV-HISTORY TO             15469099
151800                    WS-ADDTL-INFO (1:10)                          15470099
151810               MOVE PRODUCT-TYPE OF DCLCTN-INV-HISTORY TO         15471099
151820                    WS-ADDTL-INFO (12:1)                          15472099
151830               PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT       15473099
151840               PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT        15474099
151850               GO TO 2300-5XX-NIB-CONTINUE-10                     15475099
151860            END-IF                                                15476099
151870                                                                  15477099
151880         PERFORM  7040-GET-BILLER-FROM-NGP-TABLE THRU  7040-EXIT  15478099
151890*                                                                 15479099
151900           IF  WS-SQLCODE  =  ZERO                                15480099
151910               MOVE  WS-ETNDC38-BILLER  TO                        15481099
151920                                    BILLER-ID  OF  DCLCTN-INV     15482099
151930           END-IF                                                 15483099
151940                                                                  15484099
151950         PERFORM  7019-UPDATE-CTN-INV-STATUS   THRU  7019-EXIT    15485099
151960**       PERFORM  2190-UPD-NEW-MIN-NUM-STAT    THRU  2190-EXIT    15486099
151970                                                                  15487099
151980           IF SQL-ROW-NOT-FOUND                                   15488099
151990              SET  WS-ERROR-FIELDS-FOUND    TO   TRUE             15489099
152000              PERFORM  6010-MOVE-ETNI-TO-RPT    THRU   6010-EXIT  15490099
152010              PERFORM  6500-WRITE-ERROR-RPT     THRU   6500-EXIT  15491099
152020              MOVE 'N' TO NOT-UPDATED-SW                          15492099
152030              GO TO 2300-5XX-NIB-EXIT                             15493099
152040           END-IF                                                 15494099
152050                                                                  15495099
152060          MOVE  NL  OF  DCLCTN-INV  TO  WS-NL                     15496099
152070          MOVE  NGP OF  DCLCTN-INV  TO  WS-NGP                    15497099
152080                                                                  15498099
152090          PERFORM  7510-SELECT-NGP-NL-ASSIGNMENT  THRU  7510-EXIT 15499099
152100                                                                  15500099
152110           IF  WS-SQLCODE =  +0                                   15501099
152120               COMPUTE  WS-QTY  =  AA-STS-CNT  +  1               15502099
152130               PERFORM  7520-UPDATE-NGP-NL-ASSIGNMENT             15503099
152140                                                THRU  7520-EXIT   15504099
152150           END-IF                                                 15505099
152160                                                                  15506099
152170          MOVE  'ETNI'  TO  WS-SYSTEM                             15507099
152180          MOVE  CTN-STATUS  OF  DCLCTN-INV  TO                    15508099
152190                                            WS-CTNIN-CTN-STATUS   15509099
152200          MOVE  NL  OF  DCLCTN-INV    TO    WS-CTNIN-NL           15510099
152210          MOVE  NGP OF  DCLCTN-INV    TO    WS-CTNIN-NGP          15511099
152220          MOVE  BILLER-ID  OF  DCLCTN-INV   TO                    15512099
152230                                            WS-CTNIN-BILLER-ID    15513099
152240          MOVE  LAST-TRX-CODE  OF  DCLCTN-INV  TO                 15514099
152250                                           WS-CTNIN-LAST-TRX-CODE 15515099
152260                                                                  15516099
152270          MOVE  'AA'  TO  COMMENT-STATUS                          15517099
152280          MOVE  LIT-DYNAMIC-STATUS-COMMENT   TO    WS-COMMENT     15518099
152290                                                                  15519099
152300         PERFORM  6010-MOVE-ETNI-TO-RPT    THRU   6010-EXIT       15520099
152310         PERFORM  6400-WRITE-RECON-RPT     THRU   6400-EXIT       15521099
152320         MOVE 'N' TO NOT-UPDATED-SW                               15522099
152330                                                                  15523099
152340         PERFORM 6300-PRINT-BLANK-LINE     THRU   6300-EXIT       15524099
152350         GO TO 2300-5XX-NIB-CONTINUE-10                           15525099
152360       END-IF                                                     15526099
152370     END-IF                                                       15527099
152380                                                                  15528099
152390**  JA1207B  -  End                                               15529099
152400                                                                  15530099
152410*-------PARM: UPDDEL or UPDDNA------------------------------------15531099
152420                                                                  15532099
152430* UPDATE + DELETE PROCESS                                         15533099
152440     IF WS-PARM-UPDDEL OR WS-PARM-UPDDNA                          15534099
152450* RETRIEVE CTN-INV RECORD                                         15535099
152460        MOVE WS-CTNIN-PRODUCT-TYPE TO WS-PRODUCT-TYPE             15536099
152470**      added line below 3/24/04...                               15537099
152480**                                                                15538099
152490        MOVE WS-CTNIN-CTN-TEXT(1:10) TO WS-MDN                    15539099
152500        PERFORM  7000-SELECT-CTN-INV   THRU 7000-EXIT             15540099
152510                                                                  15541099
152520        IF SQL-ROW-NOT-FOUND                                      15542099
152530           ADD   +1 TO WS-TOTL-ERROR-CTNINV-NOTFND                15543099
152540           SET   WS-ERROR-FIELDS-FOUND   TO TRUE                  15544099
152550           MOVE  LIT-CTN-INV-ERROR       TO WS-COMMENT            15545099
152560           MOVE  WS-MDN                  TO WS-ADDTL-INFO (1:10)  15546099
152570           MOVE  WS-PRODUCT-TYPE         TO WS-ADDTL-INFO (12:1)  15547099
152580           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           15548099
152590           PERFORM 6500-WRITE-ERROR-RPT  THRU 6500-EXIT           15549099
152600           GO TO 2300-5XX-NIB-EXIT                                15550099
152610        END-IF                                                    15551099
152620                                                                  15552099
152630     IF CREATE-UNLOAD-HISTORY-FLAG NOT = 'Y'                      15553099
152640*****   NH-AND-PENDDASG-R-FLAG NOT = 'Y'                          15554099
152650        PERFORM 2103-CALL-ETNDC15-HIST-INSERT THRU 2103-EXIT      15555099
152660*****   GO TO 2300-5XX-NIB-CONTINUE-10                            15556099
152670        END-IF                                                    15557099
152680                                                                  15558099
152690     IF CREATE-UNLOAD-HISTORY-FLAG = 'Y'                          15559099
152700*****   NH-AND-PENDDASG-R-FLAG = 'Y'                              15560099
152710        PERFORM 2320-POPULATE-CTN-HIST THRU 2320-EXIT             15561099
152720        PERFORM 7100-INSERT-CTN-HIST THRU 7100-EXIT               15562099
152730        PERFORM 7120-RETRY-UP-TO-10-TIMES THRU 7120-EXIT          15563099
152740        IF SQL-DUP-INSERT                                         15564099
152750           SET WS-ERROR-FIELDS-FOUND TO TRUE                      15565099
152760           PERFORM 6030-INIT-DETAIL-LINE THRU 6030-EXIT           15566099
152770           PERFORM 6400-WRITE-RECON-RPT THRU 6400-EXIT            15567099
152780           MOVE 'ETNI' TO WS-SYSTEM                               15568099
152790           MOVE LIT-CTN-HIST-INSERT-ERROR TO WS-COMMENT           15569099
152800           MOVE CTN-TEXT OF DCLCTN-INV-HISTORY TO                 15570099
152810                WS-ADDTL-INFO (1:10)                              15571099
152820           MOVE PRODUCT-TYPE OF DCLCTN-INV-HISTORY TO             15572099
152830                WS-ADDTL-INFO (12:1)                              15573099
152840           PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT           15574099
152850           PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT            15575099
152860           GO TO 2300-5XX-NIB-EXIT                                15576099
152870           END-IF                                                 15577099
152880        END-IF                                                    15578099
152890                                                                  15579099
152900***FIX0928 SCB CTN IS UNLOADED FOR UPDDEL ONLY                    15580099
152910                                                                  15581099
152920*-------PARM: UPDDEL----------------------------------------------15582099
152930        IF WS-PARM-UPDDEL                                         15583099
152940           PERFORM 2330-POPULATE-CTN-HIST-ULD   THRU 2330-EXIT    15584099
152950           PERFORM 7100-INSERT-CTN-HIST         THRU 7100-EXIT    15585099
152960           PERFORM 7120-RETRY-UP-TO-10-TIMES    THRU 7120-EXIT    15586099
152970           IF SQL-DUP-INSERT                                      15587099
152980              PERFORM 6030-INIT-DETAIL-LINE     THRU 6030-EXIT    15588099
152990              PERFORM 6400-WRITE-RECON-RPT      THRU 6400-EXIT    15589099
153000              MOVE   'ETNI'                     TO   WS-SYSTEM    15590099
153010              MOVE    LIT-CTN-HIST-INSERT-ERROR TO   WS-COMMENT   15591099
153020              MOVE    CTN-TEXT     OF DCLCTN-INV-HISTORY          15592099
153030                                   TO WS-ADDTL-INFO (1:10)        15593099
153040              MOVE    PRODUCT-TYPE OF DCLCTN-INV-HISTORY          15594099
153050                                   TO WS-ADDTL-INFO (12:1)        15595099
153060              PERFORM 6010-MOVE-ETNI-TO-RPT     THRU 6010-EXIT    15596099
153070              PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT    15597099
153080              GO TO 2300-5XX-NIB-EXIT                             15598099
153090              END-IF                                              15599099
153100* DELETE CTN-INV RECORD                                           15600099
153110***FIX0928 INCLUDED WITH PREVIOUS IF                              15601099
153120***      IF WS-PARM-UPDDEL                                        15602099
153130           MOVE WS-CTNIN-CTN-TEXT (1:WS-CTNIN-CTN-LEN) TO WS-MDN  15603099
153140           MOVE WS-CTNIN-PRODUCT-TYPE        TO   WS-PRODUCT-TYPE 15604099
153150           IF (WS-CTNIN-PORT-IND = 'PO' OR                        15605099
153160               WS-CTNIN-PORT-IND = 'PI' OR                        15606099
153170               WS-CTNIN-PORT-IND = 'IO')                          15607099
153180*--* LMS 10/17/2003 end added IO port ind to this code            15608099
153190               MOVE 'Y' TO NOT-DELETED-SW                         15609099
153200           ELSE                                                   15610099
153210               MOVE 'N' TO NOT-DELETED-SW                         15611099
153220               PERFORM 7030-DELETE-CTN-INV THRU 7030-EXIT         15612099
153230               END-IF                                             15613099
153240*--* #850803-2 LMS 4/21/2003 end                                  15614099
153250         END-IF                                                   15615099
153260*                                                                 15616099
153270*  JA0312  -  Comment  Out  NA  Update  for  5XX,  due to  Data   15617099
153280*               Errors                                            15618099
153290*****                                                             15619099
153300* UPDATE CTN STATUS TO "NA" (only for "UPDDNA" parm!)             15620099
153310*-------PARM: UPDDNA----------------------------------------------15621099
153320*    IF WS-PARM-UPDDNA                                            15622099
153330*       PERFORM 7015-UPDATE-CTN-INV-STATUS   THRU 7015-EXIT       15623099
153340*    END-IF                                                       15624099
153350                                                                  15625099
153360* UPDATE MIN STATUS TO AA                                         15626099
153370*       below status is from WS-CTNIN-CTN-STATUS (CTN-INV status)-15627099
153380**   IF WS-OLD-STATUS = 'AI' OR 'AG' OR 'AR' OR 'AT' OR           15628099
153390**                      'AA' OR 'NA' OR 'NH' OR 'PA'              15629099
153400**  JA0507  -  ABOVE  1  LINE  ADDED  'PA'                        15630099
153410**      PERFORM 7830-UPDATE-MIN-INV-STATUS   THRU 7830-EXIT       15631099
153420**      END-IF                                                    15632099
153430                                                                  15633099
153440* UPDATE STATUS COUNTERS                                          15634099
153450        PERFORM 2150-UPDATE-STATUS-COUNTERS  THRU 2150-EXIT       15635099
153460        IF WS-ERROR-FIELDS-FOUND                                  15636099
153470           MOVE   'ETNI'                     TO   WS-SYSTEM       15637099
153480           PERFORM 6010-MOVE-ETNI-TO-RPT     THRU 6010-EXIT       15638099
153490           PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT       15639099
153500           GO TO 2300-5XX-NIB-EXIT                                15640099
153510        END-IF                                                    15641099
153520     ELSE                                                         15642099
153530        PERFORM 2320-POPULATE-CTN-HIST       THRU 2320-EXIT       15643099
153540     END-IF                                                       15644099
153550                                                                  15645099
153560* REPORT UPDATED STATUS ETNI CTN RECORD                           15646099
153570                                                                  15647099
153580*-------PARM: UPDDNA----------------------------------------------15648099
153590                                                                  15649099
153600     IF WS-PARM-UPDDNA                                            15650099
153610        IF NOT-UPDATED-SW = 'Y'                                   15651099
153620            MOVE LIT-NOT-UPDATED-COMMENT TO WS-COMMENT            15652099
153630        ELSE                                                      15653099
153640            MOVE LIT-UPDATED-STATUS-COMMENT TO WS-COMMENT         15654099
153650        END-IF                                                    15655099
153660     ELSE                                                         15656099
153670* REPORT DELETED ETNI CTN RECORD                                  15657099
153680        MOVE LIT-DELETED-COMMENT TO WS-COMMENT                    15658099
153690*--* #850803-2 LMS 4/21/2003 BEGIN                                15659099
153700        IF NOT-DELETED-SW = 'Y'                                   15660099
153710            MOVE LIT-NOT-DELETED-COMMENT TO WS-COMMENT            15661099
153720        END-IF                                                    15662099
153730        MOVE 'N' TO NOT-DELETED-SW                                15663099
153740*--* #850803-2 LMS 4/21/2003 END                                  15664099
153750     END-IF                                                       15665099
153760                                                                  15666099
153770     IF WS-CTNIN-PORT-IND = 'PO' OR                               15667099
153780        WS-CTNIN-PORT-IND = 'IO'                                  15668099
153790        ADD 1 TO WS-PO-IN-ETNI-NOT-IN-BILL                        15669099
153800        GO TO 2300-5XX-NIB-EXIT                                   15670099
153810     END-IF                                                       15671099
153820                                                                  15672099
153830     MOVE   'ETNI'                      TO   WS-SYSTEM            15673099
153840*----if UPDDNA parm and we DID update CTN-INV status, show it-----15674099
153850     IF WS-PARM-UPDDNA AND NOT-UPDATED-SW NOT = 'Y'               15675099
153860        MOVE CTN-STATUS OF DCLCTN-INV TO COMMENT-STATUS           15676099
153870        MOVE LIT-DYNAMIC-STATUS-COMMENT TO WS-COMMENT             15677099
153880     ELSE                                                         15678099
153890        MOVE LIT-UPDATED-COMMENT-BILL   TO WS-COMMENT             15679099
153900        END-IF                                                    15680099
153910     MOVE    SPACES                     TO   WS-ADDTL-INFO        15681099
153920     PERFORM 6010-MOVE-ETNI-TO-RPT      THRU 6010-EXIT            15682099
153930     PERFORM 6400-WRITE-RECON-RPT       THRU 6400-EXIT            15683099
153940     MOVE 'N' TO NOT-UPDATED-SW                                   15684099
153950     .                                                            15685099
153960 2300-5XX-NIB-CONTINUE-10.                                        15686099
153970*-----------------------------------------------------------------15687099
153980*  JA1109  -   4G                                                 15688099
153990*-----------------------------------------------------------------15689099
154000                                                                  15690099
154010     IF  WS-CTNIN-IMSI       >  SPACES  OR                        15691099
154020         WS-CTNIN-ICC-ID-4G  >  SPACES                            15692099
154030         INITIALIZE  WS-LTE-DATA-LAYER                            15693099
154040                     WS-4G-DETAIL-LINE                            15694099
154050                     DETAIL-LINE-1                                15695099
154060                     WS-4G-ERROR-SW                               15696099
154070                     DCLSIM-INV                                   15697099
154080                     DCLVORA-IMSI-INV                             15698099
154090                                                                  15699099
154100         PERFORM  4G-PROCESS     THRU  4G-PROCESS-EXIT            15700099
154110                                                                  15701099
154120         IF  WS-4G-ERROR-YES                                      15702099
154130             PERFORM  6010-MOVE-ETNI-TO-RPT  THRU  6010-EXIT      15703099
154140             PERFORM  6500-WRITE-ERROR-RPT   THRU  6500-EXIT      15704099
154150             MOVE  WS-4G-DETAIL-LINE  TO  DETAIL-LINE-1           15705099
154160             MOVE  LIT-SIM-VORA-ERROR  TO   DETAIL-1-COMMENT      15706099
154170             ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                    15707099
154180             PERFORM  6500-WRITE-ERROR-RPT   THRU  6500-EXIT      15708099
154190             GO  TO  2300-5XX-NIB-EXIT                            15709099
154200         END-IF                                                   15710099
154210                                                                  15711099
154220*  JA1210   -  Only  Update,  If  Update NOT within 24 Hrs        15712099
154230                                                                  15713099
154240     IF  WS-CTNIN-IMSI       >  SPACES                            15714099
154250         PERFORM  4G-9100-SELECT-VORA-10  THRU  4G-9100-EXIT      15715099
154260         PERFORM  2041-CONVERT-VORA-DATE  THRU  2041-EXIT         15716099
154270         IF  WS-VORA-SYS-UPDATE-DATE2                             15717099
154280                             >  WS-HDR-DATE-TIME-MINUS-1DAY       15718099
154290             GO  TO   2300-5XX-NIB-EXIT                           15719099
154300         END-IF                                                   15720099
154310     END-IF                                                       15721099
154320                                                                  15722099
154330*  JA1210   -  Only  Update,  If  Update NOT within 24 Hrs        15723099
154340                                                                  15724099
154350     IF  WS-CTNIN-ICC-ID-4G  >  SPACES                            15725099
154360         PERFORM  4G-9000-SELECT-SIM-10  THRU  4G-9000-EXIT       15726099
154370         PERFORM  2051-CONVERT-SIM-DATE  THRU  2051-EXIT          15727099
154380         IF  WS-SIM-SYS-UPDATE-DATE2                              15728099
154390                             >  WS-HDR-DATE-TIME-MINUS-1DAY       15729099
154400             GO  TO   2300-5XX-NIB-EXIT                           15730099
154410         END-IF                                                   15731099
154420     END-IF                                                       15732099
154430                                                                  15733099
154440*  JA1210  -   4G Update                                          15734099
154450*  JA0111  - Below  Cond - rewritten                              15735099
154460                                                                  15736099
154470*  ICC-ID-4G                                                      15737099
154470*  JA0912  -  Last                                                15738099
154480        IF  WS-CTNIN-CTN-STATUS  =  'AA'  OR  'NA'  OR            15739099
154490            WS-CTN-STATUS-TO-AA  OR                               15740099
154500            WS-NEW-STATUS  =  'AA'  OR  'NA'  OR                  15741099
134990            CTN-STATUS OF DCLCTN-INV  =  'NA'                     15742099
154510           IF  WS-PARM-UPDATE OR WS-PARM-UPDDEL                   15743099
154520                              OR WS-PARM-UPDDNA                   15744099
154530             IF  WS-CTNIN-ICC-ID-4G  >  SPACES                    15745099
154540               IF  SQLCODE  =  +0                                 15746099
154550                  IF  SIM-STATUS  OF  DCLSIM-INV  NOT  =  'AA'    15747099
154560                      MOVE  'AA'  TO  WS-SIM-STATUS               15748099
154570                      PERFORM  4G-48500-CALL-ETLSC08              15749099
154580                                  THRU  4G-48500-EXIT             15750099
154590                      PERFORM  4G-50500-SIM-UPDATE                15751099
154600                                  THRU  4G-50500-EXIT             15752099
154610                      IF  WS-SQLCODE  =  +0                       15753099
154620                          PERFORM  4G-REPORT-BUILD    THRU        15754099
154630                                   4G-REPORT-BUILD-EXIT           15755099
154640                      GO  TO  2300-5XX-NIB-EXIT                   15756099
154650                      END-IF                                      15757099
154660                  END-IF                                          15758099
154670               END-IF                                             15759099
154680             END-IF                                               15760099
154690           END-IF                                                 15761099
154700        END-IF                                                    15762099
154710                                                                  15763099
154720*  IMSI                                                           15764099
154720*  JA0912  - NA  Last                                             15765099
154730        IF  WS-CTNIN-CTN-STATUS  =  'AA'  OR  'NA'  OR            15766099
154740            WS-CTN-STATUS-TO-AA  OR                               15767099
154750            WS-NEW-STATUS  =  'AA'  OR  'NA'  OR                  15768099
134990            CTN-STATUS OF DCLCTN-INV  =  'NA'                     15769099
154760            IF  WS-PARM-UPDATE OR WS-PARM-UPDDEL                  15770099
154770                               OR WS-PARM-UPDDNA                  15771099
154780              IF  SQLCODE  =  +0                                  15772099
154790                  IF IMSI-STATUS OF DCLVORA-IMSI-INV NOT = 'AA'   15773099
154800                     IF  WS-CTNIN-IMSI       >  SPACES            15774099
154810                         MOVE  'AA'  TO  WS-VORA-STATUS           15775099
154820                         PERFORM  4G-49500-CALL-ETLSC09           15776099
154830                                      THRU  4G-49500-EXIT         15777099
154840                         PERFORM  4G-51500-VORA-UPDATE            15778099
154850                                      THRU  4G-51500-EXIT         15779099
154860                         PERFORM  4G-REPORT-BUILD                 15780099
154870                                      THRU  4G-REPORT-BUILD-EXIT  15781099
154880                         GO  TO  2300-5XX-NIB-EXIT                15782099
154890                     END-IF                                       15783099
154900                  END-IF                                          15784099
154910              END-IF                                              15785099
154920          END-IF                                                  15786099
154930     END-IF                                                       15787099
154940                                                                  15788099
154950*  End 4G processing                                              15789099
154960     .                                                            15790099
154970 2300-5XX-NIB-EXIT.  EXIT.                                        15791099
154980                                                                  15792099
154990 2320-POPULATE-CTN-HIST.                                          15793099
155000******************************************************************15794099
155010*                                                                 15795099
155020*   PARAGRAPH NAME:  2320-POPULATE-CTN-HIST                       15796099
155030*                                                                 15797099
155040*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   15798099
155050*             ¢POP                                                15799099
155060*                                                                 15800099
155070******************************************************************15801099
155080     MOVE '2320-POPULATE-CTN-HIST' TO WS-CURR-PARA                15802099
155090                                                                  15803099
155100     INITIALIZE DCLCTN-INV-HISTORY                                15804099
155110                                                                  15805099
155120     MOVE CTN-LEN                     OF DCLCTN-INV               15806099
155130       TO CTN-LEN                     OF DCLCTN-INV-HISTORY       15807099
155140     MOVE CTN-TEXT                    OF DCLCTN-INV               15808099
155150         (1:CTN-LEN OF DCLCTN-INV)                                15809099
155160       TO CTN-TEXT                    OF DCLCTN-INV-HISTORY       15810099
155170     MOVE LAST-TRX-DATE               OF DCLCTN-INV               15811099
155180       TO LAST-TRX-DATE               OF DCLCTN-INV-HISTORY       15812099
155190                                                                  15813099
155200*AGB052511 start                                                  15814099
155210     MOVE SYS-UPDATE-DATE             OF DCLCTN-INV               15815099
155220       TO SYS-UPDATE-DATE             OF DCLCTN-INV-HISTORY       15816099
155230*AGB052511 end                                                    15817099
155240                                                                  15818099
155250                                                                  15819099
155260     MOVE WS-TIMESTAMP                                            15820099
155270       TO SYS-CREATION-DATE           OF DCLCTN-INV-HISTORY       15821099
155280                                                                  15822099
155290     MOVE OPERATOR-ID                 OF DCLCTN-INV               15823099
155300       TO OPERATOR-ID                 OF DCLCTN-INV-HISTORY       15824099
155310                                                                  15825099
155320     MOVE APPLICATION-ID              OF DCLCTN-INV               15826099
155330       TO APPLICATION-ID              OF DCLCTN-INV-HISTORY       15827099
155340     MOVE DL-SERVICE-CODE             OF DCLCTN-INV               15828099
155350       TO DL-SERVICE-CODE             OF DCLCTN-INV-HISTORY       15829099
155360                                                                  15830099
155370     IF   DL-UPDATE-STAMP             OF DCLCTN-INV NUMERIC       15831099
155380          MOVE DL-UPDATE-STAMP        OF DCLCTN-INV               15832099
155390          TO DL-UPDATE-STAMP          OF DCLCTN-INV-HISTORY       15833099
155400          END-IF                                                  15834099
155410                                                                  15835099
155420     MOVE CTN-STATUS OF DCLCTN-INV TO                             15836099
155430          CTN-STATUS OF DCLCTN-INV-HISTORY                        15837099
155440     MOVE PORT-IND OF DCLCTN-INV TO                               15838099
155450          PORT-IND OF DCLCTN-INV-HISTORY                          15839099
155460     MOVE LAST-TRX-CODE OF DCLCTN-INV TO                          15840099
155470          LAST-TRX-CODE OF DCLCTN-INV-HISTORY                     15841099
155480     MOVE LAST-TRX-UID OF DCLCTN-INV TO                           15842099
155490          LAST-TRX-UID OF DCLCTN-INV-HISTORY                      15843099
155500                                                                  15844099
155510     MOVE NL                          OF DCLCTN-INV               15845099
155520       TO NL                          OF DCLCTN-INV-HISTORY       15846099
155530     MOVE NGP                         OF DCLCTN-INV               15847099
155540       TO NGP                         OF DCLCTN-INV-HISTORY       15848099
155550                                                                  15849099
155560     IF   CONV-RUN-NO                 OF DCLCTN-INV NUMERIC       15850099
155570          MOVE CONV-RUN-NO            OF DCLCTN-INV               15851099
155580            TO CONV-RUN-NO            OF DCLCTN-INV-HISTORY       15852099
155590     END-IF                                                       15853099
155600                                                                  15854099
155610     MOVE SPECIAL-TRX-DATE            OF DCLCTN-INV               15855099
155620       TO SPECIAL-TRX-DATE            OF DCLCTN-INV-HISTORY       15856099
155630                                                                  15857099
155640     IF   RUN-ID                      OF DCLCTN-INV NUMERIC       15858099
155650          MOVE RUN-ID                 OF DCLCTN-INV               15859099
155660            TO RUN-ID                 OF DCLCTN-INV-HISTORY       15860099
155670     END-IF                                                       15861099
155680                                                                  15862099
155690     MOVE HOLD-REASON                 OF DCLCTN-INV               15863099
155700       TO HOLD-REASON                 OF DCLCTN-INV-HISTORY       15864099
155710     MOVE PRODUCT-TYPE                OF DCLCTN-INV               15865099
155720       TO PRODUCT-TYPE                OF DCLCTN-INV-HISTORY       15866099
155730     MOVE ICC-ID-LEN                  OF DCLCTN-INV               15867099
155740       TO ICC-ID-LEN                  OF DCLCTN-INV-HISTORY       15868099
155750     MOVE ICC-ID-TEXT                 OF DCLCTN-INV               15869099
155760         (1:ICC-ID-LEN OF DCLCTN-INV)                             15870099
155770       TO ICC-ID-TEXT                 OF DCLCTN-INV-HISTORY       15871099
155780     MOVE MIN-NUM-LEN                 OF DCLCTN-INV               15872099
155790       TO MIN-NUM-LEN                 OF DCLCTN-INV-HISTORY       15873099
155800     MOVE MIN-NUM-TEXT                OF DCLCTN-INV               15874099
155810         (1:MIN-NUM-LEN OF DCLCTN-INV)                            15875099
155820       TO MIN-NUM-TEXT                OF DCLCTN-INV-HISTORY       15876099
155830     MOVE BILLER-ID                   OF DCLCTN-INV               15877099
155840       TO BILLER-ID                   OF DCLCTN-INV-HISTORY       15878099
155850     MOVE STATUS-REASON-CD            OF DCLCTN-INV               15879099
155860       TO STATUS-REASON-CD            OF DCLCTN-INV-HISTORY       15880099
155870     MOVE PREPAID-IND                 OF DCLCTN-INV               15881099
155880       TO PREPAID-IND                 OF DCLCTN-INV-HISTORY       15882099
155890                                                                  15883099
155900**  JA1210                                                        15884099
155910     MOVE IMSI                        OF DCLCTN-INV               15885099
155920       TO IMSI                        OF DCLCTN-INV-HISTORY       15886099
155930                                                                  15887099
155940     MOVE ICC-ID-4G                   OF DCLCTN-INV               15888099
155950       TO ICC-ID-4G                   OF DCLCTN-INV-HISTORY       15889099
155960                                                                  15890099
155970*----if we're using this routine to create an "UNLOADED" History--15891099
155980*----row in 2300-MDN-NOT-IN-BILL,      move specific values to----15892099
155990*----History DCLGEN. Otherwise, use values from CTN-INV above.----15893099
156000*---(Below mimics unload values in ETNBC21's routine shown below:-15894099
156010*----2250-WRITE-CTN-INV-HIST-PI-IO)-------------------------------15895099
156020                                                                  15896099
156030     IF CREATE-UNLOAD-HISTORY-FLAG = 'Y'                          15897099
156040        MOVE 'NA' TO CTN-STATUS OF DCLCTN-INV-HISTORY             15898099
156050        MOVE 'PI' TO PORT-IND OF DCLCTN-INV-HISTORY               15899099
156060        MOVE 'ULD' TO LAST-TRX-CODE OF DCLCTN-INV-HISTORY         15900099
156070        MOVE 'ETNBC16' TO LAST-TRX-UID OF DCLCTN-INV-HISTORY      15901099
156080        MOVE 'ETNBC16' TO OPERATOR-ID OF DCLCTN-INV-HISTORY       15902099
156090        MOVE 'DELETEPI' TO STATUS-REASON-CD OF DCLCTN-INV-HISTORY 15903099
156100        INITIALIZE NL OF DCLCTN-INV-HISTORY                       15904099
156110        MOVE -1 TO NL-NI OF DCLCTN-INV-NULL-INDS                  15905099
156120        INITIALIZE MIN-NUM OF DCLCTN-INV-HISTORY                  15906099
156130        MOVE -1 TO MIN-NUM-NI OF DCLCTN-INV-NULL-INDS             15907099
156140        INITIALIZE HOLD-REASON OF DCLCTN-INV-HISTORY              15908099
156150        MOVE -1 TO HOLD-REASON-NI OF DCLCTN-INV-NULL-INDS         15909099
156160        MOVE WS-TIMESTAMP TO LAST-TRX-DATE OF DCLCTN-INV-HISTORY  15910099
156170                                                                  15911099
156180     INITIALIZE CREATE-UNLOAD-HISTORY-FLAG                        15912099
156190                                                                  15913099
156200*----AGB 5/31/05--------------------------------------------------15914099
156210*----if we're using this routine to create a History row for a----15915099
156220*----Pending Assignment CTN-INV record,      populate the HISTORY-15916099
156230*----Hold-Reason with "GOODDASG-R"--------------------------------15917099
156240                                                                  15918099
156250     IF NH-AND-PENDDASG-R-FLAG = 'Y'                              15919099
156260        MOVE 'GOODDASG-R' TO HOLD-REASON OF DCLCTN-INV-HISTORY    15920099
156270        MOVE 0 TO HOLD-REASON-NI OF DCLCTN-INV-NULL-INDS          15921099
156280        END-IF.                                                   15922099
156290 2320-EXIT.                                                       15923099
156300      EXIT.                                                       15924099
156310                                                                  15925099
156320 2330-POPULATE-CTN-HIST-ULD.                                      15926099
156330******************************************************************15927099
156340*                                                                 15928099
156350*   PARAGRAPH NAME:  2330-POPULATE-CTN-HIST-UND                   15929099
156360*                                                                 15930099
156370*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   15931099
156380*             ¢POP                                                15932099
156390*                                                                 15933099
156400******************************************************************15934099
156410     MOVE '2330-POPULATE-CTN-HIST-ULD' TO WS-CURR-PARA            15935099
156420                                                                  15936099
156430     MOVE WS-TIMESTAMP                                            15937099
156440       TO LAST-TRX-DATE               OF DCLCTN-INV-HISTORY       15938099
156450     MOVE 'ULD'                                                   15939099
156460       TO LAST-TRX-CODE               OF DCLCTN-INV-HISTORY       15940099
156470     MOVE LIT-PGM-ID                                              15941099
156480       TO LAST-TRX-UID                OF DCLCTN-INV-HISTORY       15942099
156490     .                                                            15943099
156500 2330-EXIT.                                                       15944099
156510     EXIT.                                                        15945099
156520                                                                  15946099
156530 2500-WRAP-UP-ROUTINE.                                            15947099
156540******************************************************************15948099
156550*                                                                 15949099
156560*   PARAGRAPH NAME:  2500-WRAP                                    15950099
156570*                                                                 15951099
156580*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   15952099
156590*             End  Processing                                     15953099
156600*                                                                 15954099
156610******************************************************************15955099
156620     MOVE '2500-WRAP-UP-ROUTINE' TO WS-CURR-PARA                  15956099
156630                                                                  15957099
156640* PROCESS REMAINING ETNI CTN RECORDS                              15958099
156650     IF WS-NO-MORE-RECORD-BILL                                    15959099
156660        PERFORM 2300-MDN-NOT-IN-BILL       THRU 2300-EXIT         15960099
156670*AXY042706 - BEG                                                  15961099
156680**      IF COMMIT-DSCP                                            15962099
156690** JA0410  PERFORM Q1011-CMIT-QUEUE        THRU Q1011-EXIT        15963099
156700**      END-IF                                                    15964099
156710*AXY042706 - END                                                  15965099
156720        PERFORM 8110-READ-NEXT-ETNI-RECORD THRU 8110-EXIT         15966099
156730        GO TO 2500-EXIT                                           15967099
156740     END-IF                                                       15968099
156750                                                                  15969099
156760* PROCESS REMAINING LOCAL BILLING SYSTEM MDN RECORDS              15970099
156770     IF WS-NO-MORE-RECORD-ETNI                                    15971099
156780        PERFORM 2200-MDN-NOT-IN-ETNI       THRU 2200-EXIT         15972099
156790        PERFORM 8500-CHECK-COMMIT          THRU 8500-EXIT         15973099
156800        PERFORM 8100-READ-NEXT-BILL-RECORD THRU 8100-EXIT         15974099
156810* BYPASS MDN TRAILER RECORD                                       15975099
156820        IF WS-MDNIN-TRAILER                                       15976099
156830           DISPLAY ' '                                            15977099
156840           DISPLAY 'LOCAL BILLING SYSTEM MDN FILE TRAILER: '      15978099
156850           DISPLAY '   RECORD COUNT: ' MDNIN-RECORD-COUNT         15979099
156860           PERFORM 8100-READ-NEXT-BILL-RECORD                     15980099
156870              THRU 8100-EXIT                                      15981099
156880        END-IF                                                    15982099
156890        GO TO 2500-EXIT                                           15983099
156900     END-IF                                                       15984099
156910                                                                  15985099
156920     .                                                            15986099
156930 2500-EXIT.                                                       15987099
156940     EXIT.                                                        15988099
156950                                                                  15989099
156960 3000-TERMINATE.                                                  15990099
156970******************************************************************15991099
156980*   PARAGRAPH NAME:   3000-TERMINATE                              15992099
156990*                                                                 15993099
157000*   PURPOSE:                                                      15994099
157010*     THIS PARAGRAPH WRITES OUT THE COUNTERS AND CLOSES ALL       15995099
157020*     OPEN FILES.                                                 15996099
157030*                                                                 15997099
157040*   PRIMARY PARAGRAPH FUNCTIONS:                                  15998099
157050*   - DISPLAY THE RECORD COUNTS.                                  15999099
157060*   - CLOSE ALL OPEN FILES.                                       16000099
157070******************************************************************16001099
157080     MOVE '3000-TERMINATE' TO WS-CURR-PARA                        16002099
157090                                                                  16003099
157100**  JA1207A -  Start  /   Below  Cond.                            16004099
157110                                                                  16005099
157120     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        16006099
157130        INITIALIZE  WS-SEQ-NUMBERING-AREA                         16007099
157140        MOVE  LIT-PGM-ID  TO  OPERATOR-ID  OF                     16008099
157150                                           WS-SEQ-NUMBERING-AREA  16009099
157160                                                                  16010099
157170        PERFORM  8510-CALL-ETNSC58   THRU                         16011099
157180                 8510-EXIT                                        16012099
157190                 VARYING  WS-NGP-NL-A-IDX  FROM  +1  BY  +1       16013099
157200                 UNTIL    WS-NGP-NL-A-IDX  >                      16014099
157210                          WS-NGP-NL-A-IDX-MAX                     16015099
157220                 OR       WS-NGP-ENTRY (WS-NGP-NL-A-IDX)  =       16016099
157230                          SPACES                                  16017099
157240                                                                  16018099
157250        MOVE  SPACES  TO  WS-NGP-NL-AREA                          16019099
157260                                                                  16020099
157270**  JA0410  -  Start                                              16021099
157280**          -  Modified  MQ Commit to be in Sync w/ DB2  Commit   16022099
157290                                                                  16023099
157300        EXEC SQL                                                  16024099
157310             COMMIT                                               16025099
157320        END-EXEC                                                  16026099
157330                                                                  16027099
157340        IF SQLCODE = +0                                           16028099
157350                                                                  16029099
157360           MOVE  WS-TOTL-UPD-INS-DEL-MQ           TO              16030099
157370                 WS-SAVE-UPD-INS-DEL-MQ                           16031099
157380           CONTINUE                                               16032099
157390          ELSE                                                    16033099
157400           MOVE 'ERROR ON COMMIT @ 3000- '                        16034099
157410                                    TO WS-ABEND-TEXT              16035099
157420           MOVE    SQLCODE     TO   WS-ABEND-CODE                 16036099
157430           PERFORM 9000-ABORT  THRU 9000-EXIT                     16037099
157440        END-IF                                                    16038099
157450                                                                  16039099
157460        MOVE CHK-CNT   OF DCLTCHKPT-CNTRL TO WS-COMMIT-CNT        16040099
157470        MOVE YES-VALUE TO WS-COMMIT-ON-IND                        16041099
157480                                                                  16042099
157490        PERFORM Q1011-CMIT-QUEUE      THRU Q1011-EXIT             16043099
157500     END-IF                                                       16044099
157510                                                                  16045099
157520**  JA1207A -  End                                                16046099
157530                                                                  16047099
157540* DISPLAY COUNTS                                                  16048099
157550     PERFORM 3010-DISPLAY-PROGRAM-RUN-INFO THRU 3010-EXIT         16049099
157560     PERFORM 6420-WRITE-CNTRLRPT-SUMM      THRU 6420-EXIT         16050099
157570                                                                  16051099
157580* CLOSE FILES                                                     16052099
157590     PERFORM 8950-CLOSE-CNTRLRPT-FILE THRU 8950-EXIT              16053099
157600     PERFORM 8940-CLOSE-ERROROUT-FILE THRU 8940-EXIT              16054099
157610     PERFORM 8945-CLOSE-ERROROUT2-FILE THRU 8945-EXIT             16055099
157620     PERFORM 8947-CLOSE-ERROROUT3-FILE THRU 8947-EXIT             16056099
157630     PERFORM 8948-CLOSE-ERROROUT4-FILE THRU 8948-EXIT             16057099
157640     PERFORM 8930-CLOSE-RECONOUT-FILE THRU 8930-EXIT              16058099
157650     PERFORM 8920-CLOSE-NMCTNINP-FILE THRU 8920-EXIT              16059099
157660     PERFORM 8910-CLOSE-NMMDNINP-FILE THRU 8910-EXIT              16060099
157670                                                                  16061099
157680     CLOSE  ERRORHUB-FILE                                         16062099
157690            RECONHUB-FILE.                                        16063099
157700                                                                  16064099
157710     MOVE SPACES TO                                               16065099
157720       SEQ-CNTL-DDNAME(NMMDNINP-SUB)                              16066099
157730       SEQ-CNTL-DDNAME(NMCTNINP-SUB)                              16067099
157740       SEQ-CNTL-DDNAME(RECONOUT-SUB)                              16068099
157750       SEQ-CNTL-DDNAME(ERROROUT-SUB)                              16069099
157760       SEQ-CNTL-DDNAME(CNTRLRPT-SUB)                              16070099
157770                                                                  16071099
157780     IF WS-COMMIT-ON-IND = YES-VALUE                              16072099
157790        PERFORM C200-CLEANUP-CHKPT-RSTRT                          16073099
157800           THRU C200-EXIT                                         16074099
157810     END-IF                                                       16075099
157820                                                                  16076099
157830     PERFORM Q1060-CLOSE-GATEWAY-QUEUE THRU Q1060-EXIT            16077099
157840     PERFORM Q1061-CLOSE-NOTIF-QUEUE THRU Q1061-EXIT              16078099
157850     PERFORM Q1062-CLOSE-TRIGGER-QUEUE THRU Q1062-EXIT            16079099
157860     PERFORM Q1063-CLOSE-CDVC-QUEUE THRU Q1063-EXIT               16080099
157870     PERFORM Q1072-DISCON-FROM-MQ-MGR THRU Q1072-EXIT             16081099
157880*                                                                 16082099
157890*  JA0412                                                         16083099
157900                                                                  16084099
157900     IF  WS-RETURN-CODE  >  +0                                    16085099
157900         MOVE  WS-RETURN-CODE  TO  RETURN-CODE                    16086099
157910     END-IF                                                       16087099
157920                                                                  16088099
157930          .                                                       16089099
157940 3000-EXIT.                                                       16090099
157950      EXIT.                                                       16091099
157960                                                                  16092099
157970 3010-DISPLAY-PROGRAM-RUN-INFO.                                   16093099
157980******************************************************************16094099
157990*                                                                 16095099
158000*   PARAGRAPH NAME:  3010-DISPLAY-PROGRAM-RUN-INFO                16096099
158010*                                                                 16097099
158020*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   16098099
158030*             DISPLAY                                             16099099
158040*                                                                 16100099
158050******************************************************************16101099
158060     MOVE '3010-DISPLAY-PROGRAM-RUN-INFO' TO WS-CURR-PARA         16102099
158070                                                                  16103099
158080     DISPLAY ' '                                                  16104099
158090     DISPLAY                                                      16105099
158100     '**************** PROGRAM RUN INFORMATION  ***************'  16106099
158110     DISPLAY ' '                                                  16107099
158120     DISPLAY 'NO. OF LOCAL BILLING SYSTEM INPUT RECORDS READ  : ' 16108099
158130              WS-TOTL-BILL-RECS-READ                              16109099
158140     DISPLAY 'NO. OF ETNI INPUT RECORDS READ                  : ' 16110099
158150              WS-TOTL-ETNI-RECS-READ                              16111099
158160     DISPLAY 'NO. OF ETNI SNAPBACKS BYPASSED                  : ' 16112099
158170               FILTERED-SNAPBACKS                                 16113099
158180     DISPLAY ' '                                                  16114099
158190     DISPLAY 'NO. OF  MATCHING LOCAL BILLING & ETNI RECORDS   : ' 16115099
158200              WS-TOTL-BILL-ETNI-MATCH-CNT                         16116099
158210     DISPLAY 'BYPASS  MATCHING LOCAL BILLING & ETNI NEW TRANS : ' 16117099
158220              WS-TOTL-BILL-ETNI-MATCH-NEW                         16118099
158230     DISPLAY 'BYPASS  MATCHING LOCAL BILLING & ETNI PREPAID   : ' 16119099
158240              WS-TOTL-BILL-ETNI-MATCH-PP                          16120099
158250     DISPLAY 'BYPASS  MATCHING LOCAL BILLING & ETNI NH        : ' 16121099
158260              WS-TOTL-BILL-ETNI-MATCH-NH                          16122099
158270     DISPLAY 'BYPASS  BILLER PREPD-IND BLANK & NO OTHER DIFF  : ' 16123099
158280              WS-TOTL-PP-BLANK-MATCH-ALL                          16124099
158290     DISPLAY 'BYPASS  MATCHING LOCAL BILLING & ETNI NO DIFF   : ' 16125099
158300              WS-TOTL-BILL-ETNI-MATCH-OK                          16126099
158310     DISPLAY 'PROCESS MATCHING LOCAL BILLING & ETNI W/ DIFF   : ' 16127099
158320              WS-TOTL-BILL-ETNI-DIFF-CNT                          16128099
158330     DISPLAY ' '                                                  16129099
158340     DISPLAY 'NO. OF  LOCAL BILLING MDN RECORDS NOT IN ETNI   : ' 16130099
158350              WS-TOTL-BILL-NOT-IN-ETNI-CNT                        16131099
158360     DISPLAY 'BYPASS  LOCAL BILLING MDN RECORDS NOT IN ETN NEW: ' 16132099
158370              WS-TOTL-BILL-NOT-IN-ETNI-NEW                        16133099
158380     DISPLAY 'PROCESS LOCAL BILLING MDN RECORDS NOT IN ETNI   : ' 16134099
158390              WS-TOTL-BILL-NOT-IN-ETNI-PROC                       16135099
158400     DISPLAY ' '                                                  16136099
158410     DISPLAY 'NO. OF  ETNI MDN RECORDS NOT IN LOCAL BILLING   : ' 16137099
158420              WS-TOTL-ETNI-NOT-IN-BILL-CNT                        16138099
158430     DISPLAY 'PORTED OUT ETNI RECORDS NOT IN LOCAL BILLING    : ' 16139099
158440              WS-PO-IN-ETNI-NOT-IN-BILL                           16140099
158450     DISPLAY 'BYPASS  ETNI MDN RECORDS NOT IN LOCAL NEW TRANS : ' 16141099
158460              WS-TOTL-ETNI-NOT-IN-BILL-NEW                        16142099
158470     DISPLAY 'BYPASS  ETNI MDN RECORDS NOT IN LOCAL NA/NH STAT: ' 16143099
158480              WS-TOTL-ETNI-NA-NH-CNT                              16144099
158490     DISPLAY 'PROCESS ETNI MDN RECORDS NOT IN LOCAL BILLING   : ' 16145099
158500              WS-TOTL-ETNI-NOT-IN-BILL-PROC                       16146099
158510     DISPLAY 'ETNI IN NON-NH & PI/IO & NOT IN BILL DISCONNCTD : ' 16147099
158520              DISCONNECT-MSG-COUNTER                              16148099
158530     DISPLAY ' '                                                  16149099
158540     DISPLAY 'NO. OF  RECORDS UPDATED  IN CTN-INV             : ' 16150099
158550              WS-TOTL-ETNI-CTNINV-UPD-CNT                         16151099
158560     DISPLAY 'NO. OF  RECORDS UPDATED STATUS IN CTN-INV       : ' 16152099
158570              WS-TOTL-ETNI-CTNINV-UPD-ST-CNT                      16153099
158580     DISPLAY 'NO. OF  RECORDS INSERTED IN CTN-INV             : ' 16154099
158590              WS-TOTL-ETNI-CTNINV-INS-CNT                         16155099
158600     DISPLAY '        RECORDS DUPLICATE INSERTS IN CTN-INV    : ' 16156099
158610              WS-TOTL-ETNI-CTNINV-DUPINS                          16157099
158620     DISPLAY '        RECORDS DELETED FROM CTN-INV            : ' 16158099
158630              WS-TOTL-ETNI-CTNINV-DLT-CNT                         16159099
158640     DISPLAY 'LAST-TRX-DATE INCREMENTED TO PREVENT HIST DUPES : ' 16160099
158650              HAD-TO-INCREMENT-COUNT                              16161099
158660     DISPLAY ' '                                                  16162099
158670     DISPLAY 'NO. OF  RECORDS INSERTED IN CTN-HIST            : ' 16163099
158680              WS-TOTL-ETNI-CTNHIST-INS-CNT                        16164099
158690     DISPLAY '        RECORDS DUPLICATE INSERTS IN CTN-HIST   : ' 16165099
158700              WS-TOTL-ETNI-CTNHIST-DUPINS                         16166099
158710     DISPLAY '        ERRORS IN CALL TO ETNDC15: UPDT HISTORY : ' 16167099
158720              WS-TOTL-BAD-CALLS-TO-ETNDC15                        16168099
158730     DISPLAY 'HIST < 24 HRS AGO. BILLER INSERTS BYPASSED      : ' 16169099
158740              HISTORY-TOO-RECENT-COUNT                            16170099
158750     DISPLAY ' '                                                  16171099
158760     DISPLAY 'NO. OF  RECORDS UPDATED IN NGP-COUNTERS         : ' 16172099
158770              WS-TOTL-ETNI-NGPCNTS-UPD-CNT                        16173099
158780     DISPLAY 'NO. OF  RECORDS UPDATED IN NGP-NL-ASSIGNMENT    : ' 16174099
158790              WS-TOTL-ETNI-NGPNLAS-UPD-CNT                        16175099
158800     DISPLAY ' '                                                  16176099
158810     DISPLAY 'NO. OF  RECORDS UPDATED  IN MIN-INV             : ' 16177099
158820              WS-TOTL-ETNI-MININV-UPD-CNT                         16178099
158830     DISPLAY ' '                                                  16179099
158840     DISPLAY 'NO. OF  RECORDS UPDATED STATUS IN MIN-INV       : ' 16180099
158850              WS-TOTL-ETNI-MININV-UPD-ST-CNT                      16181099
158860                                                                  16182099
158870     DISPLAY ' '                                                  16183099
158880     DISPLAY 'ALL BILLER/ETNI FIELDS SAME EXCEPT PORT-IND     : ' 16184099
158890              PORT-INDS-DIFFERENT                                 16185099
158900                                                                  16186099
158910     DISPLAY 'AS ABOVE, AND PORT-IND CHANGE DISALLOWED        : ' 16187099
158920              PORT-INDS-DIFF-BUT-DISALLOW                         16188099
158930                                                                  16189099
158940     DISPLAY ' '                                                  16190099
158950     DISPLAY 'NO. OF  ERROR RECORDS                           : ' 16191099
158960              WS-TOTL-ERROR-CNT                                   16192099
158970     DISPLAY '        ' LIT-CTN-INV-ERROR                         16193099
158980             '               : '                                  16194099
158990              WS-TOTL-ERROR-CTNINV-NOTFND                         16195099
159000     DISPLAY '        ' LIT-CTN-INV-INSERT-ERROR                  16196099
159010             '               : '                                  16197099
159020              WS-TOTL-ERROR-CTNINV-DUPINS                         16198099
159030     DISPLAY '        ' LIT-CTN-HIST-INSERT-ERROR                 16199099
159040             '               : '                                  16200099
159050              WS-TOTL-ERROR-CTNHIST-DUPINS                        16201099
159060     DISPLAY '        ' LIT-BILLER-ERROR                          16202099
159070             '               : '                                  16203099
159080              WS-TOTL-ERROR-BILLER-NOTMTCH                        16204099
159090     DISPLAY '        ' LIT-LERG6-ERROR                           16205099
159100             '               : '                                  16206099
159110              WS-TOTL-ERROR-LERG6-NOTFND                          16207099
159120     DISPLAY '        ' LIT-NL-ERROR                              16208099
159130             '               : '                                  16209099
159140              WS-TOTL-ERROR-NUMLOC-NOTFND                         16210099
159150     MOVE    SPACES                   TO   LIT-NGP-ERROR(23:3)    16211099
159160     DISPLAY '        ' LIT-NGP-ERROR                             16212099
159170             '               : '                                  16213099
159180              WS-TOTL-ERROR-NUMGRP-NOTFND                         16214099
159190**   DISPLAY '        ' LIT-NGP-NL-ERROR                          16215099
159200**           '               : '                                  16216099
159210**            WS-TOTL-ERROR-GRPLOC-NOTFND                         16217099
159220     DISPLAY '        ' LIT-STATUS-NGP-COUNTER-ERROR              16218099
159230             '               : '                                  16219099
159240              WS-TOTL-ERROR-NGPCNT-NOTFND                         16220099
159250                                                                  16221099
159260**   JA0909  -  Below  Comments                                   16222099
159270                                                                  16223099
159280***  DISPLAY '        ' LIT-STATUS-NGP-NL-PTYP-ERROR              16224099
159290***          '               : '                                  16225099
159300***           WS-TOTL-ERROR-NGPNL-NOTFND                          16226099
159310     DISPLAY '        ' LIT-TRANS-DATE-ERROR                      16227099
159320             '               : '                                  16228099
159330              WS-TOTL-ERROR-DATE-INVALID                          16229099
159340     DISPLAY '        ' LIT-TRANS-CODE-ERROR                      16230099
159350             '               : '                                  16231099
159360              WS-TOTL-ERROR-TRX-CODE-NOTFND                       16232099
159370     DISPLAY '        ' LIT-TRANS-STAT-ERROR                      16233099
159380             '               : '                                  16234099
159390              WS-TOTL-ERROR-TRX-STAT-NOTFND                       16235099
159400     DISPLAY '        ' LIT-STATUS-ERROR                          16236099
159410             '               : '                                  16237099
159420              WS-TOTL-ERROR-STATUS-INVALID                        16238099
159430     DISPLAY '        ' LIT-HOLD-REASON-ERROR                     16239099
159440             '               : '                                  16240099
159450              WS-TOTL-ERROR-HOLD-REASON                           16241099
159460     DISPLAY '        ' LIT-MIN-NUM-NOTFND                        16242099
159470             '               : '                                  16243099
159480              WS-TOTL-ERROR-MIN-NUM-NOTFND                        16244099
159490     DISPLAY '        ' LIT-MIN-NUM-IN-CTN                        16245099
159500             '               : '                                  16246099
159510              WS-TOTL-ERROR-MIN-NUM-IN-CTN                        16247099
159520     DISPLAY '        ' LIT-MIN-NUM-NOTFND-S                      16248099
159530             '               : '                                  16249099
159540              WS-TOTL-ERROR-MIN-NUM-NOTFND-S                      16250099
159550     DISPLAY '        ' LIT-PORT-IND-CHANGE-ERROR                 16251099
159560             '               : '                                  16252099
159570              WS-TOTL-ERROR-PORT-IND-CHANGED                      16253099
159580*** #870803 SDL BEGIN                                             16254099
159590     DISPLAY '        ' LIT-PRODUCT-TYPE-MISMATCH                 16255099
159600             '               : '                                  16256099
159610              WS-SAVE-ERROR-PRDTYP-MISMATCH                       16257099
159620*** #870803 SDL END                                               16258099
159630*** #071503 KIN BEGIN                                             16259099
159640     DISPLAY '        ' LIT-RSS-NL-1ST-TO-BILL-ID                 16260099
159650             '               : '                                  16261099
159660              WS-SAVE-ERROR-RSS-BILL-NL-BYP                       16262099
159670*** #071503 KIN END                                               16263099
159680                                                                  16264099
159690     DISPLAY '        ' LIT-ETNI-PORTED-PO-ERROR                  16265099
159700             '               : '                                  16266099
159710             WS-SAVE-ERROR-POPO-MISMATCH                          16267099
159720                                                                  16268099
159730     DISPLAY '        ' LIT-ETNI-PORTED-IO-ERROR                  16269099
159740             '               : '                                  16270099
159750             WS-SAVE-ERROR-POIO-MISMATCH                          16271099
159760                                                                  16272099
159770     DISPLAY '        ' LIT-DUPE-BILLER-ID                        16273099
159780             '               : '                                  16274099
159790             WS-SAVE-ERROR-DUPE-BILLER                            16275099
159800                                                                  16276099
159810     DISPLAY '        ' LIT-NOT-NUMERIC-ERROR                     16277099
159820             '               : '                                  16278099
159830              WS-TOTL-ERROR-NOT-NUMERIC                           16279099
159840                                                                  16280099
159850**  JA0907 - START                                                16281099
159860                                                                  16282099
159870     DISPLAY '        ' LIT-NOT-IN-BILLING-FEED                   16283099
159880             '               : '                                  16284099
159890              WS-TOTL-NOT-IN-BILLING-FEED                         16285099
159900                                                                  16286099
159910**  JA0907 -END                                                   16287099
159920                                                                  16288099
159930     DISPLAY '        ' LIT-NGP-NOT-FOUND                         16289099
159940             '               : '                                  16290099
159950              WS-TOTL-ERROR-NGP-NOT-FOUND                         16291099
159960                                                                  16292099
159970     DISPLAY '        ' LIT-NGP-IS-EMPTY                          16293099
159980             '               : '                                  16294099
159990              WS-TOTL-ERROR-NGP-ARE-EMPTY                         16295099
160000                                                                  16296099
160010**  JA0507 -  Start                                               16297099
160020                                                                  16298099
160030     DISPLAY '        ' LIT-PA-ERROR                              16299099
160040             '               : '                                  16300099
160050              WS-TOTL-ERROR-PA-ERROR                              16301099
160060                                                                  16302099
160070     DISPLAY '        ' LIT-AA-ERROR                              16303099
160080             '               : '                                  16304099
160090              WS-TOTL-ERROR-AA                                    16305099
160100                                                                  16306099
160110**  JA0507 -  End                                                 16307099
160120                                                                  16308099
160130**  JA1207  - Start -                                             16309099
160140                                                                  16310099
160150     MOVE  WS-TOTL-V-TO-V-BILLER-UPD  TO                          16311099
160160           WS-SAVE-V-TO-V-BILLER-UPD                              16312099
160170     DISPLAY '        '                                           16313099
160180         LIT-V-TO-V-BILLER-ID-UPD                                 16314099
160190             '               : '                                  16315099
160200              WS-SAVE-V-TO-V-BILLER-UPD                           16316099
160210                                                                  16317099
160220     DISPLAY '        '                                           16318099
160230         LIT-V-TO-R-BILLER-ID-UPD                                 16319099
160240             '               : '                                  16320099
160250              WS-SAVE-V-TO-R-BILLER-UPD                           16321099
160260                                                                  16322099
160270**  JA1207  - End                                                 16323099
160280**  JA1207D - Start -                                             16324099
160290                                                                  16325099
160300     MOVE  WS-TOTL-NGP-BILLER-ERROR   TO                          16326099
160310           WS-SAVE-NGP-BILLER-ERROR                               16327099
160320     DISPLAY '        '                                           16328099
160330         LIT-NGP-BILLER-ERROR                                     16329099
160340             '               : '                                  16330099
160350           WS-SAVE-NGP-BILLER-ERROR                               16331099
160360                                                                  16332099
160370     DISPLAY '        '                                           16333099
160380         LIT-MKT-MIN-LR-ERROR                                     16334099
160390             '               : '                                  16335099
160400           WS-TOTL-MKT-MIN-LR-ERR                                 16336099
160410                                                                  16337099
160420     DISPLAY '        '                                           16338099
160430         LIT-MKT-NPA-NXX-LR-ERROR                                 16339099
160440             '               : '                                  16340099
160450           WS-TOTL-MKT-NPANXX-ERR                                 16341099
160460                                                                  16342099
160470     DISPLAY '        '                                           16343099
160480         LIT-BYPASS-SPLIT                                         16344099
160490             '               : '                                  16345099
160500           WS-TOTL-BYPASS-SPLIT                                   16346099
160510                                                                  16347099
160520** JA1208A                                                        16348099
160530     DISPLAY '        '                                           16349099
160540     LIT-DEL-BL-MDN-PROFILE                                       16350099
160550             '               : '                                  16351099
160560           WS-TOTL-BL-MDN-PROFILE-DEL                             16352099
160570                                                                  16353099
160580     DISPLAY '        '                                           16354099
160590     LIT-BYP-NOT-IN-BILLING                                       16355099
160600             '               : '                                  16356099
160610           WS-TOTL-BYPASS-NOT-IN-BILLING                          16357099
160620                                                                  16358099
160630**  JA0602  - Start -                                             16359099
160640                                                                  16360099
160650     DISPLAY '         ---- HUB  SUMMARY  TOTALS ---- '           16361099
160660             '                                        '           16362099
160670                                                                  16363099
160680     DISPLAY '        '                                           16364099
160690             'Total HUB Matches (Billing vs eTNI)     : '         16365099
160700              WS-TOTL-HUB-MATCHES                                 16366099
160710                                                                  16367099
160720     DISPLAY '        #  OF  ERROR RECORDS - HUB              : ' 16368099
160730              WS-TOTL-ERROR-CNT-HUB                               16369099
160740                                                                  16370099
160750     DISPLAY '        '                                           16371099
160760              LIT-TN-MINS-NOT-BOTH-HUB '               : '        16372099
160770              WS-TOTL-HUB-MIN-ERRORS                              16373099
160780                                                                  16374099
160790     IF  WS-LEGIT-BILLER-ID-RESELLER                              16375099
160800         DISPLAY '        '                                       16376099
160810                 LIT-TN-MINS-ARE-HUB '               : '          16377099
160820           WS-TOTL-RESELLER-HUB-ERROR                             16378099
160830     END-IF                                                       16379099
160840                                                                  16380099
160850     DISPLAY '        '                                           16381099
160860              LIT-TN-MINS-BILL-NOT-HUB '               : '        16382099
160870              WS-TOTL-HUB-MIN-ERRORS-BILL                         16383099
160880                                                                  16384099
160890     DISPLAY '        '                                           16385099
160900              LIT-TN-MINS-ETNI-NOT-HUB '               : '        16386099
160910              WS-TOTL-HUB-MIN-ERRORS-ETNI                         16387099
160920                                                                  16388099
160930     DISPLAY '        '                                           16389099
160940              'TOTAL Billing HUB MINs Detected         : '        16390099
160950              WS-TOTL-BILL-HUB-DETECTED                           16391099
160960                                                                  16392099
160970     DISPLAY '        '                                           16393099
160980              'TOTAL ETNI    HUB MINs Detected         : '        16394099
160990              WS-TOTL-ETNI-HUB-DETECTED                           16395099
161000**                                                                16396099
161010     DISPLAY '        '                                           16397099
161020              LIT-ADDED-FROM-BILLING '               : '          16398099
161030              WS-TOTL-HUB-ADD-ETNI-PER-BILL                       16399099
161040                                                                  16400099
161050     DISPLAY '        '                                           16401099
161060              LIT-UPDATED-TO-AA      '               : '          16402099
161070              WS-TOTL-HUB-UPDATED-TO-AA                           16403099
161080                                                                  16404099
161090     DISPLAY '        '                                           16405099
161100              LIT-NOT-IN-ETNI        '               : '          16406099
161110              WS-TOTL-NOT-IN-ETNI                                 16407099
161120                                                                  16408099
161130     DISPLAY '        '                                           16409099
161140              LIT-ERROR-AI           '               : '          16410099
161150              WS-TOTL-HUB-ERROR-AI                                16411099
161160                                                                  16412099
161170     DISPLAY '        '                                           16413099
161180              LIT-STATUS-ERROR       '               : '          16414099
161190              WS-TOTL-HUB-STATUS-ERROR                            16415099
161200                                                                  16416099
161210     DISPLAY '        '                                           16417099
161220              LIT-TN-NH-NOT-UPDATED-HUB    '               : '    16418099
161230              WS-TOTL-NH-HUB-ERRORS                               16419099
161240     DISPLAY '         ---- HUB  SUMMARY  TOTALS END ---- '       16420099
161250             '                                        '           16421099
161260                                                                  16422099
161270*  JA1109  -  4G                                                  16423099
161280                                                                  16424099
161290     DISPLAY '------------------------------------------- '       16425099
161300             '                                        '           16426099
161310     DISPLAY '         ---- 4G   SUMMARY  TOTALS Start--- '       16427099
161320             '                                        '           16428099
161330*  JA0912                                                         16429099
161330     DISPLAY '        '                                           16430099
161340         LIT-SIM-UPD               '               : '            16431099
161350         WS-TOTL-SIM-UPD                                          16432099
161330     DISPLAY '        '                                           16433099
161340         LIT-SIM-MDN-MISMATCH      '               : '            16434099
161350         WS-TOTL-SIM-MDN-ERR                                      16435099
161360     DISPLAY '        '                                           16436099
161370         LIT-SIM-STATUS-MISMATCH   '               : '            16437099
161380         WS-TOTL-SIM-STATUS-ERR                                   16438099
161390     DISPLAY '        '                                           16439099
161400         LIT-SIM-ICCID-MISMATCH    '               : '            16440099
161410         WS-TOTL-SIM-ICCID-ERR                                    16441099
161420     DISPLAY '        '                                           16442099
161430         LIT-SIM-VORA-ERROR        '               : '            16443099
161440         WS-TOTL-SIM-VORA-ERR                                     16444099
161450     DISPLAY '        '                                           16445099
161460         LIT-VORA-STATUS-MISMATCH  '               : '            16446099
161470         WS-TOTL-VORA-STATUS-ERR                                  16447099
161480     DISPLAY '        '                                           16448099
161490         LIT-VORA-IMSI-MISMATCH    '               : '            16449099
161500         WS-TOTL-VORA-IMSI-ERR                                    16450099
161510     DISPLAY '        '                                           16451099
161520        LIT-4G-NL-MISMATCH-RESELLER'               : '            16452099
161530         WS-TOTL-NL-MISMATCH-RESELLER                             16453099
161540                                                                  16454099
161550     DISPLAY '        '                                           16455099
161560        LIT-BILL-ETNI-IMSI-MISMATCH'               : '            16456099
161570         WS-T-BILL-ETNI-IMSI-MISMATCH                             16457099
161580                                                                  16458099
161590     DISPLAY '        '                                           16459099
161600        LIT-BILL-ETNI-SIM-MISMATCH '               : '            16460099
161610         WS-T-BILL-ETNI-SIM-MISMATCH                              16461099
161620                                                                  16462099
161630     DISPLAY '        '                                           16463099
161640        LIT-TOTL-CDVC-GENERATED     '               : '           16464099
161650         WS-TOTL-CDVC-GENERATED                                   16465099
161660                                                                  16466099
161670     DISPLAY '         ---- 4G   SUMMARY  TOTALS End  --- '       16467099
161680             '                                        '           16468099
161690                                                                  16469099
161700     DISPLAY '        '                                           16470099
161710     DISPLAY '         ---- Grand Totals..............--- '       16471099
161720             '                                        '           16472099
161730                                                                  16473099
161740     MOVE  WS-TOTL-UPD-INS-DEL-MQ           TO                    16474099
161750           WS-DISP-UPD-INS-DEL-MQ                                 16475099
161760                                                                  16476099
161770     DISPLAY '        '                                           16477099
161780        LIT-TOTL-IUD-MQ             '               : '           16478099
161790           WS-DISP-UPD-INS-DEL-MQ                                 16479099
161800                                                                  16480099
161810     MOVE  WS-TOTL-UPDATES-INSERTS-CHKPT  TO                      16481099
161820           WS-DISP-UPDATES-INSERTS-CHKPT                          16482099
161830                                                                  16483099
161840     DISPLAY '        '                                           16484099
161850         LIT-TOTL-CHKPT             '               : '           16485099
161860           WS-DISP-UPDATES-INSERTS-CHKPT                          16486099
161870                                                                  16487099
161880**  JA0602  - Start -                                             16488099
161890**  JA1207D - End                                                 16489099
161900                                                                  16490099
161910     DISPLAY ' '                                                  16491099
161920     DISPLAY 'NO. OF  CONTROL REPORT RECORDS WRITTEN          : ' 16492099
161930              WS-TOTL-CNTRLRPT-CNT                                16493099
161940     DISPLAY ' '                                                  16494099
161950                                                                  16495099
161960     DISPLAY                                                      16496099
161970     '**************** PROGRAM RUN INFORMATION  ************END'  16497099
161980                                                                  16498099
161990     .                                                            16499099
162000 3010-EXIT.                                                       16500099
162010     EXIT.                                                        16501099
162020                                                                  16502099
162030 6000-MOVE-BILL-MDN-TO-RPT.                                       16503099
162040******************************************************************16504099
162050*                                                                 16505099
162060*   PARAGRAPH NAME:  6000-MOVE-BILL-MDN-TO-RPT                    16506099
162070*                                                                 16507099
162080*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   16508099
162090*             MOVE                                                16509099
162100*                                                                 16510099
162110******************************************************************16511099
162120     MOVE '6000-MOVE-BILL-MDN-TO-RPT' TO WS-CURR-PARA             16512099
162130     INITIALIZE  DETAIL-LINE-1                                    16513099
162140     MOVE 'BILL '                    TO DETAIL-1-SYSTEM           16514099
162150     MOVE MDNIN-MDN                  TO DETAIL-1-MDN              16515099
162160     MOVE MDNIN-MIN-NUM              TO DETAIL-1-MIN              16516099
162170                                                                  16517099
162180**  JA1209  -  4G                                                 16518099
162190                                                                  16519099
162200     IF  MDNIN-ICC-ID-4G >  ' '                                   16520099
162210         MOVE  MDNIN-ICC-ID-4G  TO  DETAIL-1-ICC-IMSI             16521099
162220     END-IF                                                       16522099
162230                                                                  16523099
162240     IF  MDNIN-IMSI  >  ' '                                       16524099
162250         MOVE  MDNIN-IMSI       TO  DETAIL-1-ICC-IMSI             16525099
162260     END-IF                                                       16526099
162270                                                                  16527099
162340                                                                  16528099
162350*  JA1109  -  4G                                                  16529099
162360**   IF WS-COMINGLED-IND = 'Y'                                    16530099
162370**      MOVE WS-MDNIN-PRODUCT-TYPE-SAVE  TO DETAIL-1-P-TYPE       16531099
162380**   ELSE                                                         16532099
162390**      MOVE MDNIN-PRODUCT-TYPE          TO DETAIL-1-P-TYPE       16533099
162400**   END-IF                                                       16534099
162410                                                                  16535099
162420*** #870803 SDL END                                               16536099
162430                                                                  16537099
162440     MOVE MDNIN-LAST-TRX-DATE(1:8)   TO DETAIL-1-LAST-TRX-DT      16538099
162450     MOVE MDNIN-MDN-STATUS           TO DETAIL-1-CTN-STATUS       16539099
162460     MOVE MDNIN-NL                   TO DETAIL-1-NL               16540099
162470     MOVE MDNIN-NGP                  TO DETAIL-1-NGP              16541099
162480     MOVE MDNIN-PORT-IND             TO DETAIL-1-PORT-IND         16542099
162490     MOVE MDNIN-LAST-TRX-CODE        TO DETAIL-1-LAST-TRX-CD      16543099
162500***  MOVE WS-BILLER-ID               TO DETAIL-1-BILLER-ID        16544099
162510     MOVE WS-CHECK-BILLER-ID OF WS-COMMON-BILLERID                16545099
162520                                     TO DETAIL-1-BILLER-ID        16546099
162530     MOVE WS-COMMENT                 TO DETAIL-1-COMMENT          16547099
162540     MOVE WS-ADDTL-INFO              TO DETAIL-1-ADDTL-INFO       16548099
162550                                                                  16549099
162560**  JA1211 -  Added  'Non Existent  eTNI'  Message / Process      16550099
162570                                                                  16551099
162580     IF  WS-ERROR-FIELDS-FOUND  AND                               16552099
162590         WS-NO-MORE-RECORD-ETNI  OR                               16553099
162600         WS-ERROR-FIELDS-FOUND  AND                               16554099
162610         MDN-NOT-IN-ETNI-FLAG   =  'Y'                            16555099
162620                                                                  16556099
162630         PERFORM  7807-SELECT-IN-CTN  THRU  7807-EXIT             16557099
162640                                                                  16558099
162650          IF  WS-CTN-INV-MIN-COUNT  =  +0                         16559099
162660              MOVE  'Non Exist. eTNI'  TO  DETAIL-1-COMMENT       16560099
162670          END-IF                                                  16561099
162680     END-IF                                                       16562099
162690     .                                                            16563099
162700 6000-EXIT.                                                       16564099
162710     EXIT.                                                        16565099
162720                                                                  16566099
162730**  JA0602   -  Start                                             16567099
162740 6000-MOVE-BILL-TO-RPT-HUB.                                       16568099
162750******************************************************************16569099
162760**                                                                16570099
162770**  PARAGRAPH NAME:  6000-MOVE-BILL-TO-RPT-HUB                    16571099
162780**                                                                16572099
162790**            MOVE  DETAIL  BILLING  DATA  TO  REPORT             16573099
162800**                & PRINT                                         16574099
162810**                                                                16575099
162820******************************************************************16576099
162830     MOVE '6000-MOVE-BILL-TO-RPT-HUB' TO WS-CURR-PARA             16577099
162840                                                                  16578099
162850     MOVE 'BILL '                 TO DETAIL-1-SYSTEM-HUB          16579099
162860     ADD  +1  TO  WS-TOTL-HUB-ERRORS                              16580099
162870                                                                  16581099
162880     MOVE MDNIN-MDN               TO DETAIL-1-MDN-HUB             16582099
162890     MOVE MDNIN-MIN-NUM           TO DETAIL-1-MIN-HUB             16583099
162900     MOVE MDNIN-PRODUCT-TYPE      TO DETAIL-1-P-TYPE-HUB          16584099
162910     MOVE MDNIN-LAST-TRX-DATE     TO DETAIL-1-LAST-TRX-D-HUB      16585099
162920     MOVE MDNIN-MDN-STATUS        TO DETAIL-1-CTN-STATUS-HUB      16586099
162930     MOVE MDNIN-NL                TO DETAIL-1-NL-HUB              16587099
162940     MOVE MDNIN-NGP               TO DETAIL-1-NGP-HUB             16588099
162950     MOVE MDNIN-BILLER-ID  OF  MDNIN-DETAIL-FIELDS                16589099
162960                                  TO DETAIL-1-BILLER-ID-HUB       16590099
162970     MOVE MDNIN-PORT-IND          TO DETAIL-1-PORT-IND-HUB        16591099
162980     MOVE MDNIN-LAST-TRX-CODE     TO DETAIL-1-LAST-TRX-CD-HUB     16592099
162990     MOVE WS-COMMENT              TO DETAIL-1-COMMENT-HUB         16593099
163000     MOVE WS-ADDTL-INFO           TO DETAIL-1-ADDTL-INFO-HUB      16594099
163010                                                                  16595099
163020     .                                                            16596099
163030 6000-EXIT-HUB.                                                   16597099
163040     EXIT.                                                        16598099
163050                                                                  16599099
163060**  JA0602   -  End                                               16600099
163070                                                                  16601099
163080 6010-MOVE-ETNI-TO-RPT.                                           16602099
163090******************************************************************16603099
163100*                                                                 16604099
163110*   PARAGRAPH NAME:  6010-MOVE-ETNI-TO-RPT                        16605099
163120*                                                                 16606099
163130*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   16607099
163140*             MOVE  eTNI  Data  to  Report                        16608099
163150*                                                                 16609099
163160******************************************************************16610099
163170     MOVE '6010-MOVE-ETNI-TO-RPT' TO WS-CURR-PARA                 16611099
163180     INITIALIZE  DETAIL-LINE-1                                    16612099
163190     MOVE 'ETNI '                 TO DETAIL-1-SYSTEM              16613099
163200     MOVE WS-CTNIN-CTN-TEXT (1:WS-CTNIN-CTN-LEN)                  16614099
163210                                  TO DETAIL-1-MDN                 16615099
163220     MOVE WS-CTNIN-MIN-NUM-TEXT   TO DETAIL-1-MIN                 16616099
163230**   MOVE WS-CTNIN-PRODUCT-TYPE   TO DETAIL-1-P-TYPE              16617099
163240                                                                  16618099
163250**  JA1209  -  4G                                                 16619099
163260                                                                  16620099
163270     IF  WS-CTNIN-ICC-ID-4G  >  SPACES                            16621099
163280         MOVE  WS-CTNIN-ICC-ID-4G   TO  DETAIL-1-ICC-IMSI         16622099
163290     END-IF                                                       16623099
163300                                                                  16624099
163310     IF  WS-CTNIN-IMSI    >  SPACES                               16625099
163320         MOVE  WS-CTNIN-IMSI  TO  DETAIL-1-ICC-IMSI               16626099
163330     END-IF                                                       16627099
163340                                                                  16628099
163350**  JA0809A  -  below  Perform                                    16629099
163360     PERFORM  2030-CONVERT-ETNI-DATE  THRU  2030-EXIT             16630099
163370     MOVE WS-ETNI-LAST-TRX-DATE-2 TO DETAIL-1-LAST-TRX-DT         16631099
163380     MOVE WS-CTNIN-CTN-STATUS     TO DETAIL-1-CTN-STATUS          16632099
163390     MOVE WS-CTNIN-NL             TO DETAIL-1-NL                  16633099
163400     MOVE WS-CTNIN-NGP            TO DETAIL-1-NGP                 16634099
163410     MOVE WS-CTNIN-BILLER-ID      TO DETAIL-1-BILLER-ID           16635099
163420     MOVE WS-CTNIN-PORT-IND       TO DETAIL-1-PORT-IND            16636099
163430     MOVE WS-CTNIN-LAST-TRX-CODE  TO DETAIL-1-LAST-TRX-CD         16637099
163440     MOVE WS-COMMENT              TO DETAIL-1-COMMENT             16638099
163450     MOVE WS-ADDTL-INFO           TO DETAIL-1-ADDTL-INFO          16639099
163460     .                                                            16640099
163470 6010-EXIT.                                                       16641099
163480     EXIT.                                                        16642099
163490                                                                  16643099
163500**  JA0602   -  Start                                             16644099
163510 6010-MOVE-ETNI-TO-RPT-HUB.                                       16645099
163520******************************************************************16646099
163530*                                                                 16647099
163540*   PARAGRAPH NAME:  6010-MOVE-ETNI-TO-RPT-HUB                    16648099
163550*                                                                 16649099
163560*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   16650099
163570*             MOVE                                                16651099
163580*                                                                 16652099
163590******************************************************************16653099
163600     MOVE '6010-MOVE-ETNI-TO-RPT-HUB' TO WS-CURR-PARA             16654099
163610                                                                  16655099
163620     MOVE 'ETNI '                 TO DETAIL-1-SYSTEM-HUB          16656099
163630     ADD  +1  TO  WS-TOTL-HUB-ERRORS                              16657099
163640                                                                  16658099
163650     MOVE WS-CTNIN-CTN-TEXT (1:WS-CTNIN-CTN-LEN)                  16659099
163660                                  TO DETAIL-1-MDN-HUB             16660099
163670     MOVE WS-CTNIN-MIN-NUM-TEXT   TO DETAIL-1-MIN-HUB             16661099
163680     MOVE WS-CTNIN-PRODUCT-TYPE   TO DETAIL-1-P-TYPE-HUB          16662099
163690     PERFORM  2030-CONVERT-ETNI-DATE  THRU  2030-EXIT             16663099
163700     MOVE WS-ETNI-LAST-TRX-DATE-2 TO DETAIL-1-LAST-TRX-D-HUB      16664099
163710     MOVE WS-CTNIN-CTN-STATUS     TO DETAIL-1-CTN-STATUS-HUB      16665099
163720     MOVE WS-CTNIN-NL             TO DETAIL-1-NL-HUB              16666099
163730     MOVE WS-CTNIN-NGP            TO DETAIL-1-NGP-HUB             16667099
163740     MOVE WS-CTNIN-BILLER-ID      TO DETAIL-1-BILLER-ID-HUB       16668099
163750     MOVE WS-CTNIN-PORT-IND       TO DETAIL-1-PORT-IND-HUB        16669099
163760     MOVE WS-CTNIN-LAST-TRX-CODE  TO DETAIL-1-LAST-TRX-CD-HUB     16670099
163770     MOVE WS-COMMENT              TO DETAIL-1-COMMENT-HUB         16671099
163780     MOVE WS-ADDTL-INFO           TO DETAIL-1-ADDTL-INFO-HUB      16672099
163790                                                                  16673099
163800     .                                                            16674099
163810 6010-EXIT-HUB.                                                   16675099
163820     EXIT.                                                        16676099
163830                                                                  16677099
163840 6011-MOVE-ETNI-TO-RPT-FROM-CTN.                                  16678099
163850******************************************************************16679099
163860*                                                                 16680099
163870*   PARAGRAPH NAME:  6011-MOVE-ETNI-TO-RPT-FROM-CTN               16681099
163880*                                                                 16682099
163890*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   16683099
163900*             MOVE                                                16684099
163910*                                                                 16685099
163920******************************************************************16686099
163930     MOVE '6011-MOVE-ETNI-TO-RPT-FROM-CTN' TO WS-CURR-PARA        16687099
163940                                                                  16688099
163950     MOVE 'ETNI '                 TO DETAIL-1-SYSTEM-HUB          16689099
163960     MOVE CTN-TEXT  OF  DCLCTN-INV                                16690099
163970                                  TO DETAIL-1-MDN-HUB             16691099
163980     MOVE MIN-NUM-TEXT  OF  DCLCTN-INV                            16692099
163990                                  TO DETAIL-1-MIN-HUB             16693099
164000     MOVE PORT-IND  OF  DCLCTN-INV                                16694099
164010                                  TO DETAIL-1-P-TYPE-HUB          16695099
164020                                                                  16696099
164030*  Save  Last-Trx-Date                                            16697099
164040                                                                  16698099
164050     MOVE WS-CTNIN-LAST-TRX-DATE  TO  WS-CTNIN-LAST-TRX-DATE-SAVED16699099
164060     MOVE LAST-TRX-DATE  OF  DCLCTN-INV  TO                       16700099
164070                                      WS-CTNIN-LAST-TRX-DATE      16701099
164080                                                                  16702099
164090     PERFORM  2030-CONVERT-ETNI-DATE  THRU  2030-EXIT             16703099
164100                                                                  16704099
164110     MOVE WS-ETNI-LAST-TRX-DATE-2 TO DETAIL-1-LAST-TRX-D-HUB      16705099
164120                                                                  16706099
164130*  Restore  Last-Trx-Date                                         16707099
164140                                                                  16708099
164150     MOVE WS-CTNIN-LAST-TRX-DATE-SAVED  TO  WS-CTNIN-LAST-TRX-DATE16709099
164160                                                                  16710099
164170     MOVE CTN-STATUS     OF  DCLCTN-INV                           16711099
164180                                  TO DETAIL-1-CTN-STATUS-HUB      16712099
164190     MOVE NL             OF  DCLCTN-INV                           16713099
164200                                  TO DETAIL-1-NL-HUB              16714099
164210     MOVE PRODUCT-TYPE   OF  DCLCTN-INV                           16715099
164220                                  TO DETAIL-1-P-TYPE-HUB          16716099
164230     MOVE NGP            OF  DCLCTN-INV                           16717099
164240                                  TO DETAIL-1-NGP-HUB             16718099
164250     MOVE BILLER-ID      OF  DCLCTN-INV                           16719099
164260                                  TO DETAIL-1-BILLER-ID-HUB       16720099
164270     MOVE PORT-IND       OF  DCLCTN-INV                           16721099
164280                                  TO DETAIL-1-PORT-IND-HUB        16722099
164290     MOVE LAST-TRX-CODE  OF  DCLCTN-INV                           16723099
164300                                  TO DETAIL-1-LAST-TRX-CD-HUB     16724099
164310     MOVE LIT-ADDED-FROM-BILLING  TO DETAIL-1-COMMENT-HUB         16725099
164320     MOVE SPACES                  TO DETAIL-1-ADDTL-INFO-HUB      16726099
164330                                                                  16727099
164340     .                                                            16728099
164350 6011-EXIT.                                                       16729099
164360     EXIT.                                                        16730099
164370                                                                  16731099
164380**  JA0602   -  End                                               16732099
164390                                                                  16733099
164400 6020-MOVE-ETNI-TO-RPT-NEW.                                       16734099
164410******************************************************************16735099
164420*                                                                 16736099
164430*   PARAGRAPH NAME:  6020-MOVE-ETNI-TO-RPT-NEW                    16737099
164440*                                                                 16738099
164450*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   16739099
164460*             MOVE                                                16740099
164470*                                                                 16741099
164480******************************************************************16742099
164490     MOVE '6020-MOVE-ETNI-TO-RPT-NEW' TO WS-CURR-PARA             16743099
164500                                                                  16744099
164510     INITIALIZE  DETAIL-LINE-1                                    16745099
164520     MOVE WS-SYSTEM                   TO DETAIL-1-SYSTEM          16746099
164530     MOVE WS-COMMENT                  TO DETAIL-1-COMMENT         16747099
164540     MOVE WS-ADDTL-INFO               TO DETAIL-1-ADDTL-INFO      16748099
164550                                                                  16749099
164560* REFORMAT LAST TRANSACTION DATE                                  16750099
164570     MOVE LAST-TRX-DATE OF DCLCTN-INV TO WS-ETNI-LAST-TRX-DATE-1  16751099
164580     MOVE WS-ETNI-LAST-TRX-1-CCYY     TO WS-ETNI-LAST-TRX-2-CCYY  16752099
164590     MOVE WS-ETNI-LAST-TRX-1-MM       TO WS-ETNI-LAST-TRX-2-MM    16753099
164600     MOVE WS-ETNI-LAST-TRX-1-DD       TO WS-ETNI-LAST-TRX-2-DD    16754099
164610     MOVE WS-ETNI-LAST-TRX-1-HH       TO WS-ETNI-LAST-TRX-2-HH    16755099
164620     MOVE WS-ETNI-LAST-TRX-1-MI       TO WS-ETNI-LAST-TRX-2-MI    16756099
164630     MOVE WS-ETNI-LAST-TRX-1-SS       TO WS-ETNI-LAST-TRX-2-SS    16757099
164640                                                                  16758099
164650                                                                  16759099
164660     IF WS-REC-BILL-NOT-IN-ETNI                                   16760099
164670        MOVE CTN-TEXT      OF DCLCTN-INV                          16761099
164680          (1:CTN-LEN       OF DCLCTN-INV)                         16762099
164690                                         TO DETAIL-1-MDN          16763099
164700        MOVE MIN-NUM-TEXT  OF DCLCTN-INV TO DETAIL-1-MIN          16764099
164710**      MOVE PRODUCT-TYPE  OF DCLCTN-INV TO DETAIL-1-P-TYPE       16765099
164720        PERFORM  2030-CONVERT-ETNI-DATE  THRU  2030-EXIT          16766099
164730        MOVE WS-ETNI-LAST-TRX-DATE-2     TO DETAIL-1-LAST-TRX-DT  16767099
164740        MOVE CTN-STATUS    OF DCLCTN-INV TO DETAIL-1-CTN-STATUS   16768099
164750        MOVE NL            OF DCLCTN-INV TO DETAIL-1-NL           16769099
164760        MOVE NGP           OF DCLCTN-INV TO DETAIL-1-NGP          16770099
164770        MOVE WS-BILLER-ID                TO DETAIL-1-BILLER-ID    16771099
164780        MOVE PORT-IND      OF DCLCTN-INV TO DETAIL-1-PORT-IND     16772099
164790        MOVE LAST-TRX-CODE OF DCLCTN-INV TO DETAIL-1-LAST-TRX-CD  16773099
164800        GO TO 6020-EXIT                                           16774099
164810     ELSE                                                         16775099
164820        MOVE SPACES                      TO DETAIL-1-MDN          16776099
164830                                            DETAIL-1-MIN          16777099
164840**                                          DETAIL-1-P-TYPE       16778099
164850                                            DETAIL-1-CTN-STATUS   16779099
164860                                            DETAIL-1-NL           16780099
164870                                            DETAIL-1-NGP          16781099
164880                                            DETAIL-1-BILLER-ID    16782099
164890                                            DETAIL-1-PORT-IND     16783099
164900                                            DETAIL-1-LAST-TRX-CD  16784099
164910        MOVE ZEROES                      TO DETAIL-1-LAST-TRX-DT  16785099
164920     END-IF                                                       16786099
164930                                                                  16787099
164940                                                                  16788099
164950     IF WS-CTNIN-CTN-TEXT (1:WS-CTNIN-CTN-LEN) NOT =              16789099
164960        CTN-TEXT OF DCLCTN-INV (1:CTN-LEN OF DCLCTN-INV)          16790099
164970        MOVE CTN-TEXT      OF DCLCTN-INV                          16791099
164980          (1:CTN-LEN       OF DCLCTN-INV) TO DETAIL-1-MDN         16792099
164990        END-IF                                                    16793099
165000                                                                  16794099
165010     IF WS-CTNIN-MIN-NUM-TEXT NOT =                               16795099
165020        MIN-NUM-TEXT OF DCLCTN-INV                                16796099
165030        MOVE MIN-NUM-TEXT  OF DCLCTN-INV  TO DETAIL-1-MIN         16797099
165040        END-IF                                                    16798099
165050                                                                  16799099
165060*----since we no longer allow I2K E/W to update eTNI MINs, print--16800099
165070*----original eTNI MIN (not that of I2K) on "eTNI Changed" line---16801099
165080                                                                  16802099
165090     IF IS-THIS-I2K-INPUT = 'Y'                                   16803099
165100        MOVE WS-CTNIN-MIN-NUM-TEXT TO DETAIL-1-MIN                16804099
165110        END-IF                                                    16805099
165120                                                                  16806099
165130     IF WS-CTNIN-LAST-TRX-DATE NOT =                              16807099
165140        LAST-TRX-DATE OF DCLCTN-INV                               16808099
165150        PERFORM  2030-CONVERT-ETNI-DATE  THRU  2030-EXIT          16809099
165160        MOVE WS-ETNI-LAST-TRX-DATE-2     TO DETAIL-1-LAST-TRX-DT  16810099
165170        END-IF                                                    16811099
165180                                                                  16812099
165190     IF WS-CTNIN-CTN-STATUS    NOT =                              16813099
165200        CTN-STATUS OF DCLCTN-INV                                  16814099
165210        MOVE CTN-STATUS    OF DCLCTN-INV TO DETAIL-1-CTN-STATUS   16815099
165220     END-IF                                                       16816099
165230                                                                  16817099
165240     IF WS-CTNIN-NL            NOT =                              16818099
165250        NL OF DCLCTN-INV                                          16819099
165260        MOVE NL            OF DCLCTN-INV TO DETAIL-1-NL           16820099
165270     END-IF                                                       16821099
165280                                                                  16822099
165290     IF WS-CTNIN-NGP           NOT =                              16823099
165300        NGP OF DCLCTN-INV                                         16824099
165310        MOVE NGP           OF DCLCTN-INV TO DETAIL-1-NGP          16825099
165320     END-IF                                                       16826099
165330                                                                  16827099
165340     IF WS-CTNIN-BILLER-ID     NOT =                              16828099
165350        BILLER-ID OF DCLCTN-INV                                   16829099
165360        MOVE BILLER-ID     OF DCLCTN-INV TO DETAIL-1-BILLER-ID    16830099
165370     END-IF                                                       16831099
165380                                                                  16832099
165390     IF WS-CTNIN-PORT-IND      NOT =                              16833099
165400        PORT-IND OF DCLCTN-INV                                    16834099
165410        MOVE PORT-IND      OF DCLCTN-INV TO DETAIL-1-PORT-IND     16835099
165420     END-IF                                                       16836099
165430                                                                  16837099
165440     IF WS-CTNIN-LAST-TRX-CODE NOT =                              16838099
165450        LAST-TRX-CODE OF DCLCTN-INV                               16839099
165460        MOVE LAST-TRX-CODE OF DCLCTN-INV TO DETAIL-1-LAST-TRX-CD  16840099
165470     END-IF                                                       16841099
165480     .                                                            16842099
165490 6020-EXIT.                                                       16843099
165500     EXIT.                                                        16844099
165510                                                                  16845099
165520 6030-INIT-DETAIL-LINE.                                           16846099
165530******************************************************************16847099
165540*                                                                 16848099
165550*   PARAGRAPH NAME:  6030-INIT-DETAIL-LINE                        16849099
165560*                                                                 16850099
165570*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   16851099
165580*             INIT                                                16852099
165590*                                                                 16853099
165620******************************************************************16854099
165630     MOVE '6030-INIT-DETAIL-LINE'     TO WS-CURR-PARA             16855099
165640                                                                  16856099
165650     MOVE SPACES                      TO DETAIL-1-SYSTEM          16857099
165660                                         DETAIL-1-COMMENT         16858099
165670                                         DETAIL-1-ADDTL-INFO      16859099
165680                                         DETAIL-1-MDN             16860099
165690                                         DETAIL-1-MIN             16861099
165700**                                       DETAIL-1-P-TYPE          16862099
165710                                         DETAIL-1-CTN-STATUS      16863099
165720                                         DETAIL-1-NL              16864099
165730                                         DETAIL-1-NGP             16865099
165740                                         DETAIL-1-BILLER-ID       16866099
165750                                         DETAIL-1-PORT-IND        16867099
165760                                         DETAIL-1-LAST-TRX-CD     16868099
165770*  JA0410  -  Initialize                                          16869099
165780                                         DETAIL-1-ICC-IMSI        16870099
165790                                         DETAIL-1-4G-STATUS       16871099
165800     MOVE ZEROES                      TO DETAIL-1-LAST-TRX-DT     16872099
165810                                                                  16873099
165820     .                                                            16874099
165830 6030-EXIT.                                                       16875099
165840     EXIT.                                                        16876099
165850                                                                  16877099
165860 6300-PRINT-BLANK-LINE.                                           16878099
165870******************************************************************16879099
165880*                                                                 16880099
165890*   PARAGRAPH NAME:  6300-PRINT-BLANK-LINE                        16881099
165900*                                                                 16882099
165910*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   16883099
165920*             WRITE                                               16884099
165930*                                                                 16885099
165970******************************************************************16886099
165980     MOVE '6300-PRINT-BLANK-LINE' TO WS-CURR-PARA                 16887099
165990     PERFORM 6030-INIT-DETAIL-LINE THRU 6030-EXIT                 16888099
166000     PERFORM 6400-WRITE-RECON-RPT  THRU 6400-EXIT                 16889099
166010     .                                                            16890099
166020 6300-EXIT.                                                       16891099
166030     EXIT.                                                        16892099
166040                                                                  16893099
166050 6400-WRITE-RECON-RPT.                                            16894099
166060******************************************************************16895099
166070*                                                                 16896099
166080*   PARAGRAPH NAME:  6400-WRITE-RECON-RPT                         16897099
166090*                                                                 16898099
166100*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   16899099
166110*             WRITE                                               16900099
166120*                                                                 16901099
166130*   PRIMARY PARAGRAPH FUNCTIONS:                                  16902099
166140*     - WRITE                                                     16903099
166150*                                                                 16904099
166160******************************************************************16905099
166170     MOVE '6400-WRITE-RECON-RPT' TO WS-CURR-PARA                  16906099
166180                                                                  16907099
166190     PERFORM 6410-WRITE-RECON-RPT-HDR THRU 6410-EXIT              16908099
166200                                                                  16909099
166210     MOVE    WS-CC-1-LINE             TO   WS-RECON-REC-CC        16910099
166220     MOVE    DETAIL-LINE-1            TO   WS-RECON-REC-DATA      16911099
166230     PERFORM 8860-WRITE-RECONOUT      THRU 8860-EXIT              16912099
166240     ADD     +1                       TO   WS-LINE-CTR-RECON      16913099
166250                                                                  16914099
166260     .                                                            16915099
166270 6400-EXIT.                                                       16916099
166280     EXIT.                                                        16917099
166290                                                                  16918099
166300 6410-WRITE-RECON-RPT-HDR.                                        16919099
166310******************************************************************16920099
166320*                                                                 16921099
166330*   PARAGRAPH NAME:  6410-WRITE-RECON-RPT-HDR                     16922099
166340*                                                                 16923099
166350*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   16924099
166360*             WRITE                                               16925099
166370*                                                                 16926099
166410******************************************************************16927099
166420     MOVE '6420-WRITE-RECON-RPT-HDR' TO WS-CURR-PARA              16928099
166430                                                                  16929099
166440     IF WS-LINE-CTR-RECON > WS-RPT-MAX-LINES                      16930099
166450        ADD     +1                  TO   WS-PAGE-CTR-RECON        16931099
166460        MOVE    LIT-RPT-ID-RECON    TO   HEADING-1-RPT-ID         16932099
166470        MOVE    LIT-RPT-TITLE-RECON TO   HEADING-2-RPT-TITLE      16933099
166480        MOVE    WS-PAGE-CTR-RECON   TO   HEADING-3-PAGE           16934099
166490        MOVE    WS-CC-PAGE          TO   WS-RECON-REC-CC          16935099
166500        MOVE    WS-HEADING-1        TO   WS-RECON-REC-DATA        16936099
166510        PERFORM 8860-WRITE-RECONOUT THRU 8860-EXIT                16937099
166520        MOVE    WS-CC-1-LINE        TO   WS-RECON-REC-CC          16938099
166530        MOVE    WS-HEADING-2        TO   WS-RECON-REC-DATA        16939099
166540        PERFORM 8860-WRITE-RECONOUT THRU 8860-EXIT                16940099
166550        MOVE    WS-CC-1-LINE        TO   WS-RECON-REC-CC          16941099
166560        MOVE    WS-HEADING-3        TO   WS-RECON-REC-DATA        16942099
166570        PERFORM 8860-WRITE-RECONOUT THRU 8860-EXIT                16943099
166580        MOVE    WS-CC-2-LINES       TO   WS-RECON-REC-CC          16944099
166590        MOVE    WS-HEADING-4        TO   WS-RECON-REC-DATA        16945099
166600        PERFORM 8860-WRITE-RECONOUT THRU 8860-EXIT                16946099
166610        MOVE    WS-CC-1-LINE        TO   WS-RECON-REC-CC          16947099
166620        MOVE    WS-HEADING-5        TO   WS-RECON-REC-DATA        16948099
166630        PERFORM 8860-WRITE-RECONOUT THRU 8860-EXIT                16949099
166640        MOVE    WS-CC-1-LINE        TO   WS-RECON-REC-CC          16950099
166650        MOVE    WS-HEADING-6        TO   WS-RECON-REC-DATA        16951099
166660        PERFORM 8860-WRITE-RECONOUT THRU 8860-EXIT                16952099
166670        MOVE    +7                  TO   WS-LINE-CTR-RECON        16953099
166680     END-IF                                                       16954099
166690                                                                  16955099
166700     .                                                            16956099
166710 6410-EXIT.                                                       16957099
166720     EXIT.                                                        16958099
166730                                                                  16959099
166740 6401-WRITE-RECON-RPT-HUB.                                        16960099
166750******************************************************************16961099
166760**                                                                16962099
166770**  6401-WRITE-RECON-RPT-HUB                                      16963099
166780**                                                                16964099
166790**  CHECK  FOR  PAGE  HEADER  &  WRITE  DETAIL  LINE              16965099
166800**                                                                16966099
166810******************************************************************16967099
166820     MOVE '6401-WRITE-RECON-RPT-HUB' TO WS-CURR-PARA              16968099
166830                                                                  16969099
166840     IF WS-LINE-CTR-RECON-HUB  >  WS-RPT-MAX-LINES                16970099
166850        ADD     +1                  TO   WS-PAGE-CTR-RECON-HUB    16971099
166860        MOVE    LIT-RPT-ID-RECON-HUB  TO  HEADING-1-RPT-ID-HUB    16972099
166870        MOVE    LIT-RPT-TITLE-RECON      TO                       16973099
166880                                         HEADING-2-RPT-TITLE-HUB  16974099
166890        MOVE    WS-PAGE-CTR-RECON-HUB  TO                         16975099
166900                                         HEADING-3-PAGE-HUB       16976099
166910        MOVE    WS-CC-PAGE          TO   WS-RECON-REC-CC-HUB      16977099
166920        MOVE    WS-HEADING-1-HUB    TO   WS-RECON-REC-DATA-HUB    16978099
166930        WRITE   RECONHUB-RECORD    FROM  WS-RECON-REC-HUB         16979099
166940        MOVE    WS-CC-1-LINE        TO   WS-RECON-REC-CC-HUB      16980099
166950        MOVE    WS-HEADING-2-HUB    TO   WS-RECON-REC-DATA-HUB    16981099
166960        WRITE   RECONHUB-RECORD    FROM  WS-RECON-REC-HUB         16982099
166970        MOVE    WS-CC-1-LINE        TO   WS-RECON-REC-CC-HUB      16983099
166980        MOVE    WS-HEADING-3-HUB    TO   WS-RECON-REC-DATA-HUB    16984099
166990        WRITE   RECONHUB-RECORD    FROM  WS-RECON-REC-HUB         16985099
167000        MOVE    WS-CC-2-LINES       TO   WS-RECON-REC-CC-HUB      16986099
167010        MOVE    WS-HEADING-4-HUB    TO   WS-RECON-REC-DATA-HUB    16987099
167020        WRITE   RECONHUB-RECORD    FROM  WS-RECON-REC-HUB         16988099
167030        MOVE    WS-CC-1-LINE        TO   WS-RECON-REC-CC-HUB      16989099
167040        MOVE    WS-HEADING-5-HUB    TO   WS-RECON-REC-DATA-HUB    16990099
167050        WRITE   RECONHUB-RECORD    FROM  WS-RECON-REC-HUB         16991099
167060        MOVE    WS-CC-1-LINE        TO   WS-RECON-REC-CC-HUB      16992099
167070        MOVE    WS-HEADING-6-HUB    TO   WS-RECON-REC-DATA-HUB    16993099
167080        WRITE   RECONHUB-RECORD    FROM  WS-RECON-REC-HUB         16994099
167090        MOVE    +7                  TO   WS-LINE-CTR-RECON-HUB    16995099
167100     END-IF                                                       16996099
167110                                                                  16997099
167120     MOVE    WS-CC-1-LINE             TO   WS-RECON-REC-CC-HUB    16998099
167130     MOVE    DETAIL-LINE-1-HUB        TO   WS-RECON-REC-DATA-HUB  16999099
167140     WRITE   RECONHUB-RECORD  FROM  WS-RECON-REC-HUB              17000099
167150     ADD     +1                       TO   WS-LINE-CTR-RECON      17001099
167160                                                                  17002099
167170     .                                                            17003099
167180 6401-EXIT.                                                       17004099
167190     EXIT.                                                        17005099
167200                                                                  17006099
167210 6420-WRITE-CNTRLRPT-SUMM.                                        17007099
167220******************************************************************17008099
167230*                                                                 17009099
167240*   PARAGRAPH NAME:  6420-WRITE-CNTRLRPT-SUMM.                    17010099
167250*                                                                 17011099
167260*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   17012099
167270*             WRITE                                               17013099
167280*                                                                 17014099
167320******************************************************************17015099
167330     MOVE '6420-WRITE-CNTRLRPT-SUMM' TO WS-CURR-PARA              17016099
167350                                                                  17017099
167360     MOVE     SPACES                         TO   SUMMARY-LINE    17018099
167370                                                                  17019099
167380     COMPUTE  WS-LINE-CTR-CNTRLRPT = WS-RPT-MAX-LINES + 1         17020099
167390     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17021099
167400                                                                  17022099
167410     MOVE     SPACES                         TO   SUMMARY-LINE    17023099
167420     MOVE    '          ******* PROGRAM RUN INFORMATION  *******' 17024099
167430                                             TO   SUMMARY-DESC    17025099
167440     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17026099
167450                                                                  17027099
167460     MOVE     SPACES                         TO   SUMMARY-LINE    17028099
167470     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17029099
167490                                                                  17030099
167500     MOVE    'NO. OF LOCAL BILLING SYSTEM INPUT RECORDS READ : '  17031099
167510                                             TO   SUMMARY-DESC    17032099
167520     MOVE     WS-TOTL-BILL-RECS-READ         TO   SUMMARY-COUNT   17033099
167530     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17034099
167540                                                                  17035099
167550     MOVE    'NO. OF ETNI INPUT RECORDS READ                 : '  17036099
167560                                             TO   SUMMARY-DESC    17037099
167570     MOVE     WS-TOTL-ETNI-RECS-READ         TO   SUMMARY-COUNT   17038099
167580     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17039099
167590                                                                  17040099
167600     MOVE     SPACES                         TO   SUMMARY-LINE    17041099
167610     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17042099
167620                                                                  17043099
167630                                                                  17044099
167640     MOVE    'NO. OF MATCHING LOCAL BILLING & ETNI RECORDS   : '  17045099
167650                                             TO   SUMMARY-DESC    17046099
167660     MOVE     WS-TOTL-BILL-ETNI-MATCH-CNT    TO   SUMMARY-COUNT   17047099
167670     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17048099
167680                                                                  17049099
167690     MOVE    'BYPASS MATCHING LOCAL BILLING & ETNI NEW TRANS : '  17050099
167700                                             TO   SUMMARY-DESC    17051099
167710     MOVE     WS-TOTL-BILL-ETNI-MATCH-NEW    TO   SUMMARY-COUNT   17052099
167720     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17053099
167730                                                                  17054099
167740     MOVE    'BYPASS MATCHING LOCAL BILLING & ETNI PREPAID   : '  17055099
167750                                             TO   SUMMARY-DESC    17056099
167760     MOVE     WS-TOTL-BILL-ETNI-MATCH-PP     TO   SUMMARY-COUNT   17057099
167770     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17058099
167780                                                                  17059099
167790     MOVE    'BYPASS MATCHING LOCAL BILLING & ETNI NH TO NA  : '  17060099
167800                                             TO   SUMMARY-DESC    17061099
167810     MOVE     WS-TOTL-BILL-ETNI-MATCH-NH     TO   SUMMARY-COUNT   17062099
167820     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17063099
167840                                                                  17064099
167850     MOVE    'BYPASS BILL PREPAID-IND BLANK & NO OTHER DIFF  : '  17065099
167860                                             TO   SUMMARY-DESC    17066099
167870     MOVE     WS-TOTL-PP-BLANK-MATCH-ALL     TO   SUMMARY-COUNT   17067099
167880     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17068099
167900                                                                  17069099
167910     MOVE    'BYPASS MATCHING LOCAL BILLING & ETNI NO DIFF   : '  17070099
167920                                             TO   SUMMARY-DESC    17071099
167930     MOVE     WS-TOTL-BILL-ETNI-MATCH-OK     TO   SUMMARY-COUNT   17072099
167940     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17073099
167960                                                                  17074099
167970     MOVE    'PROCESS MATCHING LOCAL BILLING & ETNI W/ DIFF   : ' 17075099
167980                                             TO   SUMMARY-DESC    17076099
167990     MOVE     WS-TOTL-BILL-ETNI-DIFF-CNT     TO   SUMMARY-COUNT   17077099
168000     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17078099
168010                                                                  17079099
168020     MOVE     SPACES                         TO   SUMMARY-LINE    17080099
168030     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17081099
168040                                                                  17082099
168050                                                                  17083099
168060     MOVE    'NO. OF  LOCAL BILLING MDN RECORDS NOT IN ETNI   : ' 17084099
168070                                             TO   SUMMARY-DESC    17085099
168080     MOVE     WS-TOTL-BILL-NOT-IN-ETNI-CNT   TO   SUMMARY-COUNT   17086099
168090     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17087099
168100                                                                  17088099
168110     MOVE    'BYPASS  LOCAL BILLING MDN RECORDS NOT IN ETN NEW:'  17089099
168120                                             TO   SUMMARY-DESC    17090099
168130     MOVE     WS-TOTL-BILL-NOT-IN-ETNI-NEW   TO   SUMMARY-COUNT   17091099
168140     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17092099
168150                                                                  17093099
168160     MOVE    'PROCESS LOCAL BILLING MDN RECORDS NOT IN ETNI   : ' 17094099
168170                                             TO   SUMMARY-DESC    17095099
168180     MOVE     WS-TOTL-BILL-NOT-IN-ETNI-PROC  TO   SUMMARY-COUNT   17096099
168190     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17097099
168200                                                                  17098099
168210     MOVE     SPACES                         TO   SUMMARY-LINE    17099099
168220     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17100099
168240                                                                  17101099
168250     MOVE    'NO. OF  ETNI MDN RECORDS NOT IN LOCAL BILLING   : ' 17102099
168260                                             TO   SUMMARY-DESC    17103099
168270     MOVE     WS-TOTL-ETNI-NOT-IN-BILL-CNT   TO   SUMMARY-COUNT   17104099
168280     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17105099
168290                                                                  17106099
168300     MOVE    'BYPASS  ETNI MDN RECORDS NOT IN LOCAL NEW TRANS : ' 17107099
168310                                             TO   SUMMARY-DESC    17108099
168320     MOVE     WS-TOTL-ETNI-NOT-IN-BILL-NEW   TO   SUMMARY-COUNT   17109099
168330     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17110099
168340                                                                  17111099
168350     MOVE    'BYPASS  ETNI MDN RECORDS NOT IN LOCAL NA/NH STAT: ' 17112099
168360                                             TO   SUMMARY-DESC    17113099
168370     MOVE     WS-TOTL-ETNI-NA-NH-CNT         TO   SUMMARY-COUNT   17114099
168380     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17115099
168390                                                                  17116099
168400     MOVE    'PROCESS ETNI MDN RECORDS NOT IN LOCAL BILLING   : ' 17117099
168410                                             TO   SUMMARY-DESC    17118099
168420     MOVE     WS-TOTL-ETNI-NOT-IN-BILL-PROC  TO   SUMMARY-COUNT   17119099
168430     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17120099
168440                                                                  17121099
168450     MOVE     SPACES                         TO   SUMMARY-LINE    17122099
168460     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17123099
168480                                                                  17124099
168490     MOVE    'NO. OF  RECORDS UPDATED  IN CTN-INV             : ' 17125099
168500                                             TO   SUMMARY-DESC    17126099
168510     MOVE     WS-TOTL-ETNI-CTNINV-UPD-CNT    TO   SUMMARY-COUNT   17127099
168520     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17128099
168530                                                                  17129099
168540     MOVE    'NO. OF  RECORDS UPDATED STATUS IN CTN-INV       : ' 17130099
168550                                             TO   SUMMARY-DESC    17131099
168560     MOVE     WS-TOTL-ETNI-CTNINV-UPD-ST-CNT      TO SUMMARY-COUNT17132099
168570     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17133099
168580                                                                  17134099
168590     MOVE    '        RECORDS INSERTED IN CTN-INV             : ' 17135099
168600                                             TO   SUMMARY-DESC    17136099
168610     MOVE     WS-TOTL-ETNI-CTNINV-INS-CNT    TO   SUMMARY-COUNT   17137099
168620     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17138099
168630                                                                  17139099
168640     MOVE    '        RECORDS DUPLICATE INSERTS IN CTN-INV    : ' 17140099
168650                                             TO   SUMMARY-DESC    17141099
168660     MOVE     WS-TOTL-ETNI-CTNINV-DUPINS     TO   SUMMARY-COUNT   17142099
168670     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17143099
168680                                                                  17144099
168690     MOVE    '        RECORDS DELETED FROM CTN-INV            : ' 17145099
168700                                             TO   SUMMARY-DESC    17146099
168710     MOVE     WS-TOTL-ETNI-CTNINV-DLT-CNT    TO   SUMMARY-COUNT   17147099
168720     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17148099
168730                                                                  17149099
168740     MOVE     SPACES                         TO   SUMMARY-LINE    17150099
168750     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17151099
168770                                                                  17152099
168780     MOVE    'NO. OF  RECORDS INSERTED IN CTN-HIST            : ' 17153099
168790                                             TO   SUMMARY-DESC    17154099
168800     MOVE     WS-TOTL-ETNI-CTNHIST-INS-CNT   TO   SUMMARY-COUNT   17155099
168810     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17156099
168820                                                                  17157099
168830     MOVE    '        RECORDS DUPLICATE INSERTS IN CTN-HIST   : ' 17158099
168840                                             TO   SUMMARY-DESC    17159099
168850     MOVE     WS-TOTL-ETNI-CTNHIST-DUPINS    TO   SUMMARY-COUNT   17160099
168860     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17161099
168870                                                                  17162099
168880     MOVE     SPACES                         TO   SUMMARY-LINE    17163099
168890     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17164099
168900                                                                  17165099
168910     MOVE    'NO. OF  RECORDS UPDATED IN NGP-COUNTERS         : ' 17166099
168920                                             TO   SUMMARY-DESC    17167099
168930     MOVE     WS-TOTL-ETNI-NGPCNTS-UPD-CNT   TO   SUMMARY-COUNT   17168099
168940     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17169099
168950                                                                  17170099
168960     MOVE    'NO. OF  RECORDS UPDATED IN NGP-NL-ASSIGNMENT    : ' 17171099
168970                                             TO   SUMMARY-DESC    17172099
168980     MOVE     WS-TOTL-ETNI-NGPNLAS-UPD-CNT   TO   SUMMARY-COUNT   17173099
168990     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17174099
169000                                                                  17175099
169010     MOVE     SPACES                         TO   SUMMARY-LINE    17176099
169020     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17177099
169030                                                                  17178099
169050     MOVE    'NO. OF  RECORDS UPDATED  IN MIN-INV             : ' 17179099
169060                                             TO   SUMMARY-DESC    17180099
169070     MOVE     WS-TOTL-ETNI-MININV-UPD-CNT    TO   SUMMARY-COUNT   17181099
169080     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17182099
169090                                                                  17183099
169100     MOVE     SPACES                         TO   SUMMARY-LINE    17184099
169110     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17185099
169120                                                                  17186099
169130     MOVE    'NO. OF  RECORDS UPDATED STATUS IN MIN-INV       : ' 17187099
169140                                             TO   SUMMARY-DESC    17188099
169150     MOVE     WS-TOTL-ETNI-MININV-UPD-ST-CNT TO   SUMMARY-COUNT   17189099
169160     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17190099
169170                                                                  17191099
169180     MOVE     SPACES                         TO   SUMMARY-LINE    17192099
169190     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17193099
169200                                                                  17194099
169210     MOVE    'NO. OF  ERROR RECORDS                           : ' 17195099
169220                                             TO   SUMMARY-DESC    17196099
169230     MOVE     WS-TOTL-ERROR-CNT              TO   SUMMARY-COUNT   17197099
169240     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17198099
169250                                                                  17199099
169260     MOVE    SPACES                       TO SUMMARY-DESC         17200099
169270     MOVE    ' : '                        TO SUMMARY-DESC (48:03) 17201099
169280                                                                  17202099
169290     MOVE     LIT-CTN-INV-ERROR           TO SUMMARY-DESC (09:25) 17203099
169300     MOVE     WS-TOTL-ERROR-CTNINV-NOTFND TO SUMMARY-COUNT        17204099
169310     PERFORM  6600-WRITE-CONTROL-RPT      THRU 6600-EXIT          17205099
169320                                                                  17206099
169330     MOVE     LIT-CTN-INV-INSERT-ERROR    TO SUMMARY-DESC (09:25) 17207099
169340     MOVE     WS-TOTL-ERROR-CTNINV-DUPINS TO SUMMARY-COUNT        17208099
169350     PERFORM  6600-WRITE-CONTROL-RPT      THRU 6600-EXIT          17209099
169360                                                                  17210099
169370     MOVE     LIT-CTN-HIST-INSERT-ERROR   TO SUMMARY-DESC (09:25) 17211099
169380     MOVE     WS-TOTL-ERROR-CTNHIST-DUPINS TO  SUMMARY-COUNT      17212099
169390     PERFORM  6600-WRITE-CONTROL-RPT      THRU 6600-EXIT          17213099
169400                                                                  17214099
169410     MOVE     LIT-BILLER-ERROR            TO SUMMARY-DESC (09:25) 17215099
169420     MOVE     WS-TOTL-ERROR-BILLER-NOTMTCH TO   SUMMARY-COUNT     17216099
169430     PERFORM  6600-WRITE-CONTROL-RPT       THRU 6600-EXIT         17217099
169440                                                                  17218099
169450     MOVE     LIT-LERG6-ERROR             TO SUMMARY-DESC (09:25) 17219099
169460     MOVE     WS-TOTL-ERROR-LERG6-NOTFND  TO SUMMARY-COUNT        17220099
169470     PERFORM  6600-WRITE-CONTROL-RPT      THRU 6600-EXIT          17221099
169480                                                                  17222099
169490     MOVE     LIT-NL-ERROR                TO SUMMARY-DESC (09:25) 17223099
169500     MOVE     WS-TOTL-ERROR-NUMLOC-NOTFND TO SUMMARY-COUNT        17224099
169510     PERFORM  6600-WRITE-CONTROL-RPT      THRU 6600-EXIT          17225099
169520                                                                  17226099
169530     MOVE     SPACES                      TO  LIT-NGP-ERROR(23:3) 17227099
169540     MOVE     LIT-NGP-ERROR               TO SUMMARY-DESC (09:25) 17228099
169550     MOVE     WS-TOTL-ERROR-NUMGRP-NOTFND TO SUMMARY-COUNT        17229099
169560     PERFORM  6600-WRITE-CONTROL-RPT      THRU 6600-EXIT          17230099
169570                                                                  17231099
169580**   MOVE     LIT-NGP-NL-ERROR            TO SUMMARY-DESC (09:25) 17232099
169590**   MOVE     WS-TOTL-ERROR-GRPLOC-NOTFND TO SUMMARY-COUNT        17233099
169600**   PERFORM  6600-WRITE-CONTROL-RPT      THRU 6600-EXIT          17234099
169610                                                                  17235099
169620     MOVE     LIT-STATUS-NGP-COUNTER-ERROR TO SUMMARY-DESC(09:25) 17236099
169630     MOVE     WS-TOTL-ERROR-NGPCNT-NOTFND  TO SUMMARY-COUNT       17237099
169640     PERFORM  6600-WRITE-CONTROL-RPT       THRU 6600-EXIT         17238099
169650                                                                  17239099
169660**   JA0909  -  Below  Comments                                   17240099
169670                                                                  17241099
169680***  MOVE     LIT-STATUS-NGP-NL-PTYP-ERROR TO SUMMARY-DESC(09:25) 17242099
169690***  MOVE     WS-TOTL-ERROR-NGPNL-NOTFND   TO SUMMARY-COUNT       17243099
169700***  PERFORM  6600-WRITE-CONTROL-RPT       THRU 6600-EXIT         17244099
169710                                                                  17245099
169720     MOVE     LIT-TRANS-DATE-ERROR         TO SUMMARY-DESC(09:25) 17246099
169730     MOVE     WS-TOTL-ERROR-DATE-INVALID   TO SUMMARY-COUNT       17247099
169740     PERFORM  6600-WRITE-CONTROL-RPT       THRU 6600-EXIT         17248099
169750                                                                  17249099
169760     MOVE     LIT-TRANS-CODE-ERROR         TO SUMMARY-DESC(09:25) 17250099
169770     MOVE     WS-TOTL-ERROR-TRX-CODE-NOTFND TO   SUMMARY-COUNT    17251099
169780     PERFORM  6600-WRITE-CONTROL-RPT        THRU 6600-EXIT        17252099
169790                                                                  17253099
169800     MOVE     LIT-TRANS-STAT-ERROR         TO SUMMARY-DESC(09:25) 17254099
169810     MOVE     WS-TOTL-ERROR-TRX-STAT-NOTFND TO   SUMMARY-COUNT    17255099
169820     PERFORM  6600-WRITE-CONTROL-RPT        THRU 6600-EXIT        17256099
169830                                                                  17257099
169840     MOVE     LIT-STATUS-ERROR             TO SUMMARY-DESC(09:25) 17258099
169850     MOVE     WS-TOTL-ERROR-STATUS-INVALID TO SUMMARY-COUNT       17259099
169860     PERFORM  6600-WRITE-CONTROL-RPT       THRU 6600-EXIT         17260099
169870                                                                  17261099
169880     MOVE     LIT-HOLD-REASON-ERROR        TO SUMMARY-DESC(09:25) 17262099
169890     MOVE     WS-TOTL-ERROR-HOLD-REASON    TO SUMMARY-COUNT       17263099
169900     PERFORM  6600-WRITE-CONTROL-RPT       THRU 6600-EXIT         17264099
169910                                                                  17265099
169920     MOVE     LIT-MIN-NUM-NOTFND           TO SUMMARY-DESC(09:25) 17266099
169930     MOVE     WS-TOTL-ERROR-MIN-NUM-NOTFND TO SUMMARY-COUNT       17267099
169940     PERFORM  6600-WRITE-CONTROL-RPT       THRU 6600-EXIT         17268099
169950                                                                  17269099
169960     MOVE     LIT-MIN-NUM-IN-CTN           TO SUMMARY-DESC(09:25) 17270099
169970     MOVE     WS-TOTL-ERROR-MIN-NUM-IN-CTN TO SUMMARY-COUNT       17271099
169980     PERFORM  6600-WRITE-CONTROL-RPT       THRU 6600-EXIT         17272099
169990                                                                  17273099
170000     MOVE     LIT-MIN-NUM-NOTFND-S         TO SUMMARY-DESC(09:25) 17274099
170010     MOVE     WS-TOTL-ERROR-MIN-NUM-NOTFND-S  TO SUMMARY-COUNT    17275099
170020     PERFORM  6600-WRITE-CONTROL-RPT       THRU 6600-EXIT         17276099
170030                                                                  17277099
170040     MOVE     LIT-PORT-IND-ERROR           TO SUMMARY-DESC(09:25) 17278099
170050     MOVE     WS-TOTL-ERROR-PORT-IND-CHANGED TO   SUMMARY-COUNT   17279099
170060     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17280099
170070                                                                  17281099
170080*** #870803 SDL BEGIN                                             17282099
170090     MOVE     LIT-PRODUCT-TYPE-MISMATCH    TO SUMMARY-DESC(09:25) 17283099
170100     MOVE     WS-SAVE-ERROR-PRDTYP-MISMATCH  TO   SUMMARY-COUNT   17284099
170110     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17285099
170120*** #870803 SDL END                                               17286099
170130                                                                  17287099
170140*** #071503 KIN BEGIN                                             17288099
170150     MOVE   LIT-RSS-NL-1ST-TO-BILL-ID      TO SUMMARY-DESC(09:25) 17289099
170160     MOVE   WS-SAVE-ERROR-RSS-BILL-NL-BYP  TO SUMMARY-COUNT       17290099
170170     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17291099
170180*** #071503 KIN END                                               17292099
170190                                                                  17293099
170200     MOVE     LIT-NOT-NUMERIC-ERROR        TO SUMMARY-DESC(09:25) 17294099
170210     MOVE     WS-TOTL-ERROR-NOT-NUMERIC    TO SUMMARY-COUNT       17295099
170220     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17296099
170230                                                                  17297099
170240**  JA0907 - START                                                17298099
170250                                                                  17299099
170260     MOVE     LIT-NOT-IN-BILLING-FEED      TO SUMMARY-DESC(09:25) 17300099
170270     MOVE     WS-TOTL-NOT-IN-BILLING-FEED  TO SUMMARY-COUNT       17301099
170280     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17302099
170290                                                                  17303099
170300     MOVE     LIT-PA-ERROR                 TO SUMMARY-DESC(09:25) 17304099
170310     MOVE     WS-TOTL-ERROR-PA-ERROR       TO SUMMARY-COUNT       17305099
170320     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17306099
170330                                                                  17307099
170340     MOVE     LIT-AA-ERROR                 TO SUMMARY-DESC(09:25) 17308099
170350     MOVE     WS-TOTL-ERROR-AA             TO SUMMARY-COUNT       17309099
170360     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17310099
170370                                                                  17311099
170380     MOVE  LIT-V-TO-V-BILLER-ID-UPD   TO SUMMARY-DESC(09:25)      17312099
170390     MOVE     WS-SAVE-V-TO-V-BILLER-UPD    TO SUMMARY-COUNT       17313099
170400     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17314099
170410                                                                  17315099
170420                                                                  17316099
170430     MOVE  LIT-V-TO-R-BILLER-ID-UPD   TO SUMMARY-DESC(09:25)      17317099
170440     MOVE     WS-SAVE-V-TO-R-BILLER-UPD    TO SUMMARY-COUNT       17318099
170450     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17319099
170460                                                                  17320099
170470     MOVE  LIT-NGP-BILLER-ERROR       TO SUMMARY-DESC(09:25)      17321099
170480     MOVE     WS-TOTL-NGP-BILLER-ERROR     TO SUMMARY-COUNT       17322099
170490     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17323099
170500                                                                  17324099
170510     MOVE  LIT-MKT-MIN-LR-ERROR       TO SUMMARY-DESC(09:25)      17325099
170520     MOVE  WS-TOTL-MKT-MIN-LR-ERR     TO SUMMARY-COUNT            17326099
170530     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17327099
170540                                                                  17328099
170550     MOVE  LIT-MKT-NPA-NXX-LR-ERROR   TO SUMMARY-DESC(09:25)      17329099
170560     MOVE  WS-TOTL-MKT-NPANXX-ERR     TO SUMMARY-COUNT            17330099
170570     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17331099
170580                                                                  17332099
170590     MOVE  LIT-BYPASS-SPLIT           TO SUMMARY-DESC(09:25)      17333099
170600     MOVE  WS-TOTL-BYPASS-SPLIT       TO SUMMARY-COUNT            17334099
170610     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17335099
170620                                                                  17336099
170630     MOVE  LIT-DEL-BL-MDN-PROFILE     TO SUMMARY-DESC(09:25)      17337099
170640     MOVE  WS-TOTL-BL-MDN-PROFILE-DEL TO SUMMARY-COUNT            17338099
170650     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17339099
170660                                                                  17340099
170670     MOVE  LIT-BYP-NOT-IN-BILLING        TO SUMMARY-DESC(09:25)   17341099
170680     MOVE  WS-TOTL-BYPASS-NOT-IN-BILLING TO SUMMARY-COUNT         17342099
170690     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17343099
170700                                                                  17344099
170710     MOVE     SPACES                         TO   SUMMARY-LINE    17345099
170720     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17346099
170730                                                                  17347099
170740     MOVE  '--- HUB  SUMMARY  TOTALS ---' TO  SUMMARY-DESC(09:25) 17348099
170750     MOVE     0                            TO SUMMARY-COUNT       17349099
170760     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17350099
170770                                                                  17351099
170780     MOVE 'TOTAL HUB MATCHES (Billing vs eTNI)'  TO               17352099
170790                                              SUMMARY-DESC(09:25) 17353099
170800     MOVE     WS-TOTL-HUB-MATCHES          TO SUMMARY-COUNT       17354099
170810     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17355099
170820                                                                  17356099
170830     MOVE 'NO. OF  ERROR RECORDS - HUB '  TO                      17357099
170840                                              SUMMARY-DESC(09:25) 17358099
170850     MOVE     WS-TOTL-ERROR-CNT-HUB        TO SUMMARY-COUNT       17359099
170860     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17360099
170870                                                                  17361099
170880     MOVE LIT-TN-MINS-NOT-BOTH-HUB        TO                      17362099
170890                                              SUMMARY-DESC(09:25) 17363099
170900     MOVE     WS-TOTL-HUB-MIN-ERRORS       TO SUMMARY-COUNT       17364099
170910     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17365099
170920                                                                  17366099
170930     IF  WS-LEGIT-BILLER-ID-RESELLER                              17367099
170940       MOVE LIT-TN-MINS-ARE-HUB             TO                    17368099
170950                                              SUMMARY-DESC(09:25) 17369099
170960       MOVE     WS-TOTL-RESELLER-HUB-ERROR   TO SUMMARY-COUNT     17370099
170970       PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT     17371099
170980     END-IF                                                       17372099
170990                                                                  17373099
171000     MOVE LIT-TN-MINS-BILL-NOT-HUB        TO                      17374099
171010                                              SUMMARY-DESC(09:25) 17375099
171020     MOVE     WS-TOTL-HUB-MIN-ERRORS-BILL  TO SUMMARY-COUNT       17376099
171030     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17377099
171040                                                                  17378099
171050     MOVE LIT-TN-MINS-ETNI-NOT-HUB        TO                      17379099
171060                                              SUMMARY-DESC(09:25) 17380099
171070     MOVE     WS-TOTL-HUB-MIN-ERRORS-ETNI  TO SUMMARY-COUNT       17381099
171080     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17382099
171090                                                                  17383099
171100     MOVE 'Total Billing HUB MINs Detected ' TO                   17384099
171110                                              SUMMARY-DESC(09:25) 17385099
171120     MOVE     WS-TOTL-BILL-HUB-DETECTED    TO SUMMARY-COUNT       17386099
171130     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17387099
171140                                                                  17388099
171150     MOVE 'Total ETNI    HUB MINs Detected ' TO                   17389099
171160                                              SUMMARY-DESC(09:25) 17390099
171170     MOVE     WS-TOTL-ETNI-HUB-DETECTED    TO SUMMARY-COUNT       17391099
171180     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17392099
171190                                                                  17393099
171200     MOVE LIT-ADDED-FROM-BILLING             TO                   17394099
171210                                              SUMMARY-DESC(09:25) 17395099
171220     MOVE     WS-TOTL-HUB-ADD-ETNI-PER-BILL TO SUMMARY-COUNT      17396099
171230     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17397099
171240                                                                  17398099
171250     MOVE LIT-UPDATED-TO-AA                  TO                   17399099
171260                                              SUMMARY-DESC(09:25) 17400099
171270     MOVE     WS-TOTL-HUB-UPDATED-TO-AA    TO SUMMARY-COUNT       17401099
171280     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17402099
171290                                                                  17403099
171300     MOVE LIT-NOT-IN-ETNI                    TO                   17404099
171310                                              SUMMARY-DESC(09:25) 17405099
171320     MOVE     WS-TOTL-NOT-IN-ETNI          TO SUMMARY-COUNT       17406099
171330     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17407099
171340                                                                  17408099
171350     MOVE LIT-ERROR-AI                       TO                   17409099
171360                                              SUMMARY-DESC(09:25) 17410099
171370     MOVE     WS-TOTL-HUB-ERROR-AI         TO SUMMARY-COUNT       17411099
171380     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17412099
171390                                                                  17413099
171400     MOVE LIT-STATUS-ERROR                   TO                   17414099
171410                                              SUMMARY-DESC(09:25) 17415099
171420     MOVE     WS-TOTL-HUB-STATUS-ERROR     TO SUMMARY-COUNT       17416099
171430     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17417099
171440                                                                  17418099
171450     MOVE  LIT-TN-NH-NOT-UPDATED-HUB          TO                  17419099
171460                                              SUMMARY-DESC(09:25) 17420099
171470     MOVE     WS-TOTL-NH-HUB-ERRORS        TO SUMMARY-COUNT       17421099
171480     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17422099
171490                                                                  17423099
171500     MOVE     SPACES                         TO   SUMMARY-LINE    17424099
171510     MOVE  '--- HUB  SUMMARY  TOTALS ---' TO  SUMMARY-DESC(09:25) 17425099
171520     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17426099
171530                                                                  17427099
171540     MOVE     SPACES                         TO   SUMMARY-LINE    17428099
171550     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17429099
171560                                                                  17430099
171570                                                                  17431099
171580*  JA1109  - 4G                                       '           17432099
171590                                                                  17433099
171600     MOVE  '---4G SUMMARY TOTALS Start--'  TO                     17434099
171610                                              SUMMARY-DESC(09:28) 17435099
171620     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17436099
171640     MOVE  SPACES                          TO SUMMARY-DESC        17437099
171630                                                                  17438099
161330*  JA0912                                                         17439099
161330     MOVE  LIT-SIM-UPD  TO                    SUMMARY-DESC(09:25) 17440099
                                                                        17441099
161350     MOVE  WS-TOTL-SIM-UPD                 TO SUMMARY-COUNT       17442099
171680     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17443099
171630                                                                  17444099
171650     MOVE  LIT-SIM-MDN-MISMATCH  TO                               17445099
171660                                              SUMMARY-DESC(09:25) 17446099
171670     MOVE  WS-TOTL-SIM-MDN-ERR             TO SUMMARY-COUNT       17447099
171680     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17448099
171690                                                                  17449099
171700     MOVE  LIT-SIM-STATUS-MISMATCH  TO                            17450099
171710                                              SUMMARY-DESC(09:25) 17451099
171720     MOVE  WS-TOTL-SIM-STATUS-ERR          TO SUMMARY-COUNT       17452099
171730     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17453099
171740                                                                  17454099
171750     MOVE  LIT-SIM-ICCID-MISMATCH   TO                            17455099
171760                                              SUMMARY-DESC(09:25) 17456099
171770     MOVE  WS-TOTL-SIM-ICCID-ERR           TO SUMMARY-COUNT       17457099
171780     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17458099
171790                                                                  17459099
171800     MOVE  LIT-SIM-VORA-ERROR       TO                            17460099
171810                                              SUMMARY-DESC(09:25) 17461099
171820     MOVE  WS-TOTL-SIM-VORA-ERR            TO SUMMARY-COUNT       17462099
171830     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17463099
171840                                                                  17464099
171850     MOVE  LIT-VORA-STATUS-MISMATCH TO                            17465099
171860                                              SUMMARY-DESC(09:25) 17466099
171870     MOVE  WS-TOTL-VORA-STATUS-ERR         TO SUMMARY-COUNT       17467099
171880     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17468099
171890                                                                  17469099
171900     MOVE  LIT-VORA-IMSI-MISMATCH   TO                            17470099
171910                                              SUMMARY-DESC(09:25) 17471099
171920     MOVE  WS-TOTL-VORA-IMSI-ERR           TO SUMMARY-COUNT       17472099
171930     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17473099
171940                                                                  17474099
171950     MOVE  LIT-4G-NL-MISMATCH-RESELLER  TO                        17475099
171960                                              SUMMARY-DESC(09:25) 17476099
171970     MOVE  WS-TOTL-NL-MISMATCH-RESELLER    TO SUMMARY-COUNT       17477099
171980     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17478099
171990                                                                  17479099
172000     MOVE  LIT-BILL-ETNI-IMSI-MISMATCH  TO                        17480099
172010                                              SUMMARY-DESC(09:25) 17481099
172020     MOVE  WS-T-BILL-ETNI-IMSI-MISMATCH TO SUMMARY-COUNT          17482099
172030     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17483099
172040                                                                  17484099
172050     MOVE  LIT-BILL-ETNI-SIM-MISMATCH  TO                         17485099
172060                                              SUMMARY-DESC(09:25) 17486099
172070     MOVE  WS-T-BILL-ETNI-SIM-MISMATCH TO SUMMARY-COUNT           17487099
172080     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17488099
172090                                                                  17489099
172100     MOVE  LIT-TOTL-CDVC-GENERATED     TO     SUMMARY-DESC(09:25) 17490099
172110     MOVE  WS-TOTL-CDVC-GENERATED      TO SUMMARY-COUNT           17491099
172120     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17492099
172130                                                                  17493099
172140     MOVE     SPACES                         TO   SUMMARY-LINE    17494099
172150     MOVE  '---4G SUMMARY TOTALS End ---'  TO                     17495099
172160                                              SUMMARY-DESC(09:28) 17496099
172170     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17497099
172180                                                                  17498099
172190     MOVE     SPACES                         TO   SUMMARY-LINE    17499099
172200     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17500099
172210                                                                  17501099
172220     MOVE     SPACES                         TO   SUMMARY-LINE    17502099
172230     MOVE  '---- Grand Totals........---'  TO                     17503099
172240                                              SUMMARY-DESC(09:28) 17504099
172250     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17505099
172260                                                                  17506099
172270     MOVE     SPACES                         TO   SUMMARY-LINE    17507099
172280     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17508099
172290                                                                  17509099
172300     MOVE  LIT-TOTL-IUD-MQ             TO     SUMMARY-DESC(09:25) 17510099
172310     MOVE  WS-DISP-UPD-INS-DEL-MQ           TO  SUMMARY-COUNT     17511099
172320     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17512099
172330                                                                  17513099
172340     MOVE  LIT-TOTL-CHKPT              TO     SUMMARY-DESC(09:25) 17514099
172350     MOVE  WS-DISP-UPDATES-INSERTS-CHKPT    TO  SUMMARY-COUNT     17515099
172360     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17516099
172370                                                                  17517099
172380**  JA0907 -END                                                   17518099
172390                                                                  17519099
172400     MOVE     SPACES                         TO   SUMMARY-LINE    17520099
172410     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17521099
172420                                                                  17522099
172430     MOVE    '          ******* PROGRAM RUN INFORMATION  *******' 17523099
172440                                             TO   SUMMARY-DESC    17524099
172450     PERFORM  6600-WRITE-CONTROL-RPT         THRU 6600-EXIT       17525099
172460                                                                  17526099
172470     .                                                            17527099
172480 6420-EXIT.                                                       17528099
172490     EXIT.                                                        17529099
172500                                                                  17530099
172510 6500-WRITE-ERROR-RPT.                                            17531099
172520******************************************************************17532099
172530*                                                                 17533099
172540*   PARAGRAPH NAME:  6500-WRITE-ERROR-RPT                         17534099
172550*                                                                 17535099
172560*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   17536099
172570*             WRITE                                               17537099
172580*                                                                 17538099
172590*   PRIMARY PARAGRAPH FUNCTIONS:                                  17539099
172600*     - WRITE                                                     17540099
172610*                                                                 17541099
172620******************************************************************17542099
172630     MOVE '6500-WRITE-ERROR-RPT' TO WS-CURR-PARA                  17543099
172640                                                                  17544099
172650* _____________________________________                           17545099
172660* | Headings for the 3 error reports. |                           17546099
172670* |___________________________________|                           17547099
172680                                                                  17548099
172690*----print Headers for the "General" error reporting file---------17549099
172700                                                                  17550099
172710     IF WS-LINE-CTR-ERROR > WS-RPT-MAX-LINES                      17551099
172720        ADD     +1                  TO   WS-PAGE-CTR-ERROR        17552099
172730        MOVE    LIT-RPT-ID-ERROR    TO   HEADING-1-RPT-ID         17553099
172740        MOVE    LIT-RPT-TITLE-ERROR TO   HEADING-2-RPT-TITLE      17554099
172750        MOVE    WS-PAGE-CTR-ERROR   TO   HEADING-3-PAGE           17555099
172760        MOVE    WS-CC-PAGE          TO   WS-ERROR-REC-CC          17556099
172770        MOVE    WS-HEADING-1        TO   WS-ERROR-REC-DATA        17557099
172780        PERFORM 8870-WRITE-ERROROUT THRU 8870-EXIT                17558099
172790        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC          17559099
172800        MOVE    WS-HEADING-2        TO   WS-ERROR-REC-DATA        17560099
172810        PERFORM 8870-WRITE-ERROROUT THRU 8870-EXIT                17561099
172820        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC          17562099
172830        MOVE    WS-HEADING-3        TO   WS-ERROR-REC-DATA        17563099
172840        PERFORM 8870-WRITE-ERROROUT THRU 8870-EXIT                17564099
172850        MOVE    WS-CC-2-LINES       TO   WS-ERROR-REC-CC          17565099
172860        MOVE    WS-HEADING-4        TO   WS-ERROR-REC-DATA        17566099
172870        PERFORM 8870-WRITE-ERROROUT THRU 8870-EXIT                17567099
172880        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC          17568099
172890        MOVE    WS-HEADING-5        TO   WS-ERROR-REC-DATA        17569099
172900        PERFORM 8870-WRITE-ERROROUT THRU 8870-EXIT                17570099
172910        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC          17571099
172920        MOVE    WS-HEADING-6        TO   WS-ERROR-REC-DATA        17572099
172930        PERFORM 8870-WRITE-ERROROUT THRU 8870-EXIT                17573099
172940        MOVE    +7                  TO   WS-LINE-CTR-ERROR        17574099
172950     END-IF                                                       17575099
172960                                                                  17576099
172970*----print Headers for the "PREPAID ON HOLD: BYPASSED" error file-17577099
172980                                                                  17578099
172990     IF WS-LINE-CTR-ERROR-PREPAID > WS-RPT-MAX-LINES              17579099
173000        ADD     +1                  TO   WS-PAGE-CTR-ERROR-PREPAID17580099
173010        MOVE    LIT-RPT-ID-ERROR    TO   HEADING-1-RPT-ID         17581099
173020        MOVE    LIT-RPT-TITLE-ERROR TO   HEADING-2-RPT-TITLE      17582099
173030        MOVE    WS-PAGE-CTR-ERROR-PREPAID   TO   HEADING-3-PAGE   17583099
173040        MOVE    WS-CC-PAGE          TO   WS-ERROR-REC-CC          17584099
173050        MOVE    WS-HEADING-1        TO   WS-ERROR-REC-DATA        17585099
173060        PERFORM 8875-WRITE-PREPAID-ON-HOLD-RPT THRU 8875-EXIT     17586099
173070        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC          17587099
173080        MOVE    WS-HEADING-2        TO   WS-ERROR-REC-DATA        17588099
173090        PERFORM 8875-WRITE-PREPAID-ON-HOLD-RPT THRU 8875-EXIT     17589099
173100        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC          17590099
173110        MOVE    WS-HEADING-3        TO   WS-ERROR-REC-DATA        17591099
173120        PERFORM 8875-WRITE-PREPAID-ON-HOLD-RPT THRU 8875-EXIT     17592099
173130        MOVE    WS-CC-2-LINES       TO   WS-ERROR-REC-CC          17593099
173140        MOVE    WS-HEADING-4        TO   WS-ERROR-REC-DATA        17594099
173150        PERFORM 8875-WRITE-PREPAID-ON-HOLD-RPT THRU 8875-EXIT     17595099
173160        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC          17596099
173170        MOVE    WS-HEADING-5        TO   WS-ERROR-REC-DATA        17597099
173180        PERFORM 8875-WRITE-PREPAID-ON-HOLD-RPT THRU 8875-EXIT     17598099
173190        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC          17599099
173200        MOVE    WS-HEADING-6        TO   WS-ERROR-REC-DATA        17600099
173210        PERFORM 8875-WRITE-PREPAID-ON-HOLD-RPT THRU 8875-EXIT     17601099
173220        MOVE    +7                  TO   WS-LINE-CTR-ERROR-PREPAID17602099
173230     END-IF                                                       17603099
173240                                                                  17604099
173250*AGB 3/7/06                                                       17605099
173260*----print Headers for the "PORT-IND UPDT DISALLOWED" error file--17606099
173270                                                                  17607099
173280     IF WS-LINE-CTR-ERROR-PO > WS-RPT-MAX-LINES                   17608099
173290        ADD     +1                  TO   WS-PAGE-CTR-ERROR-PO     17609099
173300        IF WS-SAVE-HDR-BILLER-ID = 'I'                            17610099
173310           MOVE LIT-RPT-ID-PO-ERROR-I2KE TO HEADING-1-RPT-ID      17611099
173320           END-IF                                                 17612099
173330        IF WS-SAVE-HDR-BILLER-ID = 'K'                            17613099
173340           MOVE LIT-RPT-ID-PO-ERROR-I2KW TO HEADING-1-RPT-ID      17614099
173350           END-IF                                                 17615099
173360        IF WS-SAVE-HDR-BILLER-ID = 'V'                            17616099
173370           MOVE LIT-RPT-ID-PO-ERROR-VISE TO HEADING-1-RPT-ID      17617099
173380           END-IF                                                 17618099
173390        IF WS-SAVE-HDR-BILLER-ID = 'N'                            17619099
173400           MOVE LIT-RPT-ID-PO-ERROR-VISW TO HEADING-1-RPT-ID      17620099
173410           END-IF                                                 17621099
173420        IF WS-SAVE-HDR-BILLER-ID = 'A'                            17622099
173430           MOVE LIT-RPT-ID-PO-ERROR-VISA TO HEADING-1-RPT-ID      17623099
173440           END-IF                                                 17624099
173450        IF WS-SAVE-HDR-BILLER-ID = 'R'                            17625099
173460           MOVE LIT-RPT-ID-PO-ERROR-RSS  TO HEADING-1-RPT-ID      17626099
173470           END-IF                                                 17627099
173480        IF WS-SAVE-HDR-BILLER-ID = 'O'                            17628099
173490           MOVE LIT-RPT-ID-PO-ERROR-OPC  TO HEADING-1-RPT-ID      17629099
173500           END-IF                                                 17630099
173510        MOVE    LIT-RPT-TITLE-ERROR TO   HEADING-2-RPT-TITLE      17631099
173520        MOVE    WS-PAGE-CTR-ERROR-PO TO  HEADING-3-PAGE           17632099
173530        MOVE    WS-CC-PAGE          TO   WS-ERROR-REC-CC          17633099
173540        MOVE    WS-HEADING-1        TO   WS-ERROR-REC-DATA        17634099
173550        PERFORM 8877-WRITE-PORT-IND-DISALLOWED THRU 8877-EXIT     17635099
173560        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC          17636099
173570        MOVE    WS-HEADING-2        TO   WS-ERROR-REC-DATA        17637099
173580        PERFORM 8877-WRITE-PORT-IND-DISALLOWED THRU 8877-EXIT     17638099
173590        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC          17639099
173600        MOVE    WS-HEADING-3        TO   WS-ERROR-REC-DATA        17640099
173610        PERFORM 8877-WRITE-PORT-IND-DISALLOWED THRU 8877-EXIT     17641099
173620        MOVE    WS-CC-2-LINES       TO   WS-ERROR-REC-CC          17642099
173630        MOVE    WS-HEADING-4        TO   WS-ERROR-REC-DATA        17643099
173640        PERFORM 8877-WRITE-PORT-IND-DISALLOWED THRU 8877-EXIT     17644099
173650        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC          17645099
173660        MOVE    WS-HEADING-5        TO   WS-ERROR-REC-DATA        17646099
173670        PERFORM 8877-WRITE-PORT-IND-DISALLOWED THRU 8877-EXIT     17647099
173680        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC          17648099
173690        MOVE    WS-HEADING-6        TO   WS-ERROR-REC-DATA        17649099
173700        PERFORM 8877-WRITE-PORT-IND-DISALLOWED THRU 8877-EXIT     17650099
173710        MOVE    +7                  TO   WS-LINE-CTR-ERROR-PO     17651099
173720     END-IF                                                       17652099
173730                                                                  17653099
173740* _________________________________________                       17654099
173750* | Detail lines for the 3 error reports. |                       17655099
173760* |_______________________________________|                       17656099
173770                                                                  17657099
173780*----If the error being reported is "PREPAID ON HOLD: BYPASSED"---17658099
173790*----then write it to a seperate file from all other errors-------17659099
173800                                                                  17660099
173810     IF DETAIL-1-COMMENT = LIT-HELD-CONTRACT-RSV                  17661099
173820        MOVE WS-CC-1-LINE TO WS-ERROR-REC-CC                      17662099
173830        MOVE DETAIL-LINE-1 TO WS-ERROR-REC-DATA                   17663099
173840        PERFORM 8875-WRITE-PREPAID-ON-HOLD-RPT THRU 8875-EXIT     17664099
173850        ADD +1 TO WS-LINE-CTR-ERROR-PREPAID                       17665099
173860        ADD +1 TO WS-TOTL-ERROR-CNT                               17666099
173870        MOVE 'Y' TO WS-ERROR-ALREADY-REPORTED                     17667099
173880        GO TO 6500-EXIT                                           17668099
173890     END-IF                                                       17669099
173900                                                                  17670099
173910*AGB 3/7/06                                                       17671099
173920*----If the error being reported is "PORT-IND UPDT DISALLOWED"----17672099
173930*----then write it to a seperate file from all other errors-------17673099
173940     IF DETAIL-1-COMMENT = LIT-PORT-IND-CHANGE-ERROR              17674099
173950        MOVE WS-CC-1-LINE TO WS-ERROR-REC-CC                      17675099
173960        MOVE DETAIL-LINE-1 TO WS-ERROR-REC-DATA                   17676099
173970        PERFORM 8877-WRITE-PORT-IND-DISALLOWED THRU 8877-EXIT     17677099
173980        ADD +1 TO WS-LINE-CTR-ERROR-PO                            17678099
173990        ADD +1 TO WS-TOTL-ERROR-CNT                               17679099
174000        MOVE 'Y' TO WS-ERROR-ALREADY-REPORTED                     17680099
174010        GO TO 6500-EXIT                                           17681099
174020     END-IF                                                       17682099
174030                                                                  17683099
174040*----All other errors go into the "general" error report file-----17684099
174050     MOVE WS-CC-1-LINE TO WS-ERROR-REC-CC                         17685099
174060     MOVE DETAIL-LINE-1 TO WS-ERROR-REC-DATA                      17686099
174070     PERFORM 8870-WRITE-ERROROUT THRU 8870-EXIT                   17687099
174080     ADD +1 TO WS-LINE-CTR-ERROR                                  17688099
174090     ADD +1 TO WS-TOTL-ERROR-CNT                                  17689099
174100     MOVE 'Y' TO WS-ERROR-ALREADY-REPORTED                        17690099
174110                                                                  17691099
174120     .                                                            17692099
174130 6500-EXIT.                                                       17693099
174140      EXIT.                                                       17694099
174150                                                                  17695099
174160**  JA0602   -  Start                                             17696099
174170                                                                  17697099
174180 6510-WRITE-ERROR-RPT-HUB.                                        17698099
174190******************************************************************17699099
174200*                                                                 17700099
174210*   6510-WRITE-ERROR-RPT                                          17701099
174220*                                                                 17702099
174230*   WRITE  ERROR  REPORT  FOR  HUB                                17703099
174240*                                                                 17704099
174250******************************************************************17705099
174260     MOVE '6510-WRITE-ERROR-RPT-HUB' TO WS-CURR-PARA              17706099
174270                                                                  17707099
174280*----print Headers for the "General" error reporting file---------17708099
174290                                                                  17709099
174300     IF WS-LINE-CTR-ERROR-HUB  >  WS-RPT-MAX-LINES                17710099
174310        ADD     +1                   TO   WS-PAGE-CTR-ERROR-HUB   17711099
174320        MOVE    LIT-RPT-ID-ERROR-HUB TO   HEADING-1-RPT-ID-HUB    17712099
174330        MOVE    LIT-RPT-TITLE-ERROR-HUB  TO                       17713099
174340                                         HEADING-2-RPT-TITLE-HUB  17714099
174350        MOVE    WS-PAGE-CTR-ERROR-HUB TO HEADING-3-PAGE-HUB       17715099
174360        MOVE    WS-CC-PAGE          TO   WS-ERROR-REC-CC-HUB      17716099
174370        MOVE    WS-HEADING-1-HUB    TO   WS-ERROR-REC-DATA-HUB    17717099
174380        WRITE   ERRORHUB-RECORD    FROM  WS-ERROR-REC-HUB         17718099
174390                                                                  17719099
174400        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC-HUB      17720099
174410        MOVE    WS-HEADING-2-HUB    TO   WS-ERROR-REC-DATA-HUB    17721099
174420        WRITE   ERRORHUB-RECORD    FROM  WS-ERROR-REC-HUB         17722099
174430        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC-HUB      17723099
174440        MOVE    WS-HEADING-3-HUB    TO   WS-ERROR-REC-DATA-HUB    17724099
174450        WRITE   ERRORHUB-RECORD    FROM  WS-ERROR-REC-HUB         17725099
174460        MOVE    WS-CC-2-LINES       TO   WS-ERROR-REC-CC-HUB      17726099
174470        MOVE    WS-HEADING-4-HUB    TO   WS-ERROR-REC-DATA-HUB    17727099
174480        WRITE   ERRORHUB-RECORD    FROM  WS-ERROR-REC-HUB         17728099
174490        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC-HUB      17729099
174500        MOVE    WS-HEADING-5-HUB    TO   WS-ERROR-REC-DATA-HUB    17730099
174510        WRITE   ERRORHUB-RECORD    FROM  WS-ERROR-REC-HUB         17731099
174520        MOVE    WS-CC-1-LINE        TO   WS-ERROR-REC-CC-HUB      17732099
174530        MOVE    WS-HEADING-6-HUB    TO   WS-ERROR-REC-DATA-HUB    17733099
174540        WRITE   ERRORHUB-RECORD    FROM  WS-ERROR-REC-HUB         17734099
174550        MOVE    +7                  TO   WS-LINE-CTR-ERROR-HUB    17735099
174560     END-IF                                                       17736099
174570                                                                  17737099
174580**  DETAIL  ERROR  REPORT -                                       17738099
174590                                                                  17739099
174600     MOVE WS-CC-1-LINE TO WS-ERROR-REC-CC-HUB                     17740099
174610     MOVE DETAIL-LINE-1-HUB TO WS-ERROR-REC-DATA-HUB              17741099
174620     WRITE   ERRORHUB-RECORD    FROM  WS-ERROR-REC-HUB            17742099
174630     ADD +1 TO WS-LINE-CTR-ERROR-HUB                              17743099
174640     ADD +1 TO WS-TOTL-ERROR-CNT-HUB                              17744099
174650     MOVE 'Y' TO WS-ERROR-ALREADY-REPORTED-HUB                    17745099
174660     .                                                            17746099
174670 6510-EXIT.                                                       17747099
174680      EXIT.                                                       17748099
174690                                                                  17749099
174700**  JA0602   -  End                                               17750099
174710                                                                  17751099
174720 6600-WRITE-CONTROL-RPT.                                          17752099
174730******************************************************************17753099
174740*                                                                 17754099
174750*   PARAGRAPH NAME:  6600-WRITE-CONTROL-RPT                       17755099
174760*                                                                 17756099
174770*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   17757099
174780*             WRITE                                               17758099
174790*                                                                 17759099
174830******************************************************************17760099
174840     MOVE '6600-WRITE-CONTROL-RPT' TO WS-CURR-PARA                17761099
174850     IF WS-LINE-CTR-CNTRLRPT > WS-RPT-MAX-LINES                   17762099
174860        ADD     +1                  TO   WS-PAGE-CTR-CNTRLRPT     17763099
174870        MOVE    LIT-RPT-ID-CNTRLRPT TO   HEADING-1-RPT-ID         17764099
174880        MOVE    LIT-RPT-TITLE-CNTRLRPT TO HEADING-2-RPT-TITLE     17765099
174890        MOVE    WS-PAGE-CTR-CNTRLRPT TO  HEADING-3-PAGE           17766099
174900        MOVE    WS-CC-PAGE          TO   WS-CNTRLRPT-REC-CC       17767099
174910        MOVE    WS-HEADING-1        TO   WS-CNTRLRPT-REC-DATA     17768099
174920        PERFORM 8880-WRITE-CNTRLRPT THRU 8880-EXIT                17769099
174930        MOVE    WS-CC-1-LINE        TO   WS-CNTRLRPT-REC-CC       17770099
174940        MOVE    WS-HEADING-2        TO   WS-CNTRLRPT-REC-DATA     17771099
174950        PERFORM 8880-WRITE-CNTRLRPT THRU 8880-EXIT                17772099
174960        MOVE    WS-CC-1-LINE        TO   WS-CNTRLRPT-REC-CC       17773099
174970        MOVE    WS-HEADING-3        TO   WS-CNTRLRPT-REC-DATA     17774099
174980        PERFORM 8880-WRITE-CNTRLRPT THRU 8880-EXIT                17775099
174990        MOVE    WS-CC-1-LINE        TO   WS-CNTRLRPT-REC-CC       17776099
175000        MOVE    WS-BLANK-LINE       TO   WS-CNTRLRPT-REC-DATA     17777099
175010        PERFORM 8880-WRITE-CNTRLRPT THRU 8880-EXIT                17778099
175020        MOVE    +4                  TO   WS-LINE-CTR-CNTRLRPT     17779099
175030        END-IF                                                    17780099
175040                                                                  17781099
175050*----the first time this routine is executed, print a copy of-----17782099
175060*----the input MDNIN file Header (rec type 1) data fields---------17783099
175070     IF FIRST-TIME-THRU = 'Y'                                     17784099
175080        MOVE 'N' TO FIRST-TIME-THRU                               17785099
175090        MOVE WS-CC-1-LINE TO WS-CNTRLRPT-REC-CC                   17786099
175100        MOVE FILE-HEADER-LINE TO WS-CNTRLRPT-REC-DATA             17787099
175110        PERFORM 8880-WRITE-CNTRLRPT THRU 8880-EXIT                17788099
175120        ADD 1 TO WS-LINE-CTR-CNTRLRPT                             17789099
175130        ADD 1 TO WS-TOTL-CNTRLRPT-CNT                             17790099
175140        END-IF                                                    17791099
175150                                                                  17792099
175160     MOVE       WS-CC-1-LINE        TO   WS-CNTRLRPT-REC-CC       17793099
175170     MOVE       SUMMARY-LINE        TO   WS-CNTRLRPT-REC-DATA     17794099
175180     PERFORM    8880-WRITE-CNTRLRPT THRU 8880-EXIT                17795099
175190     ADD        +1                  TO   WS-LINE-CTR-CNTRLRPT     17796099
175200     ADD        +1                  TO   WS-TOTL-CNTRLRPT-CNT     17797099
175210     .                                                            17798099
175220 6600-EXIT.                                                       17799099
175230      EXIT.                                                       17800099
175240                                                                  17801099
175250*-----using data from incomming Parm and input Header record,-----17802099
175260*-----populate and write a 1 record Date Control file. This-------17803099
175270*-----file is read by ETNBC46, which performs LOGICAL deletes-----17804099
175280*-----on all RAPI-ERROR data older than the EFFECTIVE date below.-17805099
175290*-----Each Date Control rec is for 1 specific Biller and Date.----17806099
175300                                                                  17807099
175310 6700-WRITE-DTCTLOUT-RECORD.                                      17808099
175320******************************************************************17809099
175330*                                                                 17810099
175340*   PARAGRAPH NAME:  6700-WRITE-DTCTLOUT-RECORD                   17811099
175350*                                                                 17812099
175360*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   17813099
175370*             WRITE                                               17814099
175380*                                                                 17815099
175420******************************************************************17816099
175430      MOVE '6700-WRITE-DTCTLOUT-RECORD' TO WS-CURR-PARA           17817099
175440      MOVE WS-SAVE-HDR-BILLER-ID TO                               17818099
175450           BILLER-ID OF CA24-DATE-CONTROL-LAYOUT                  17819099
175460      MOVE WS-PARM-PROCESS-REQ TO                                 17820099
175470           RUN-MODE OF CA24-DATE-CONTROL-LAYOUT                   17821099
175480      MOVE WS-HDR-DATE-TIME-MINUS-1-CCYY TO                       17822099
175490           EFFECTIVE-YYYY OF CA24-DATE-CONTROL-LAYOUT             17823099
175500      MOVE WS-HDR-DATE-TIME-MINUS-1-MM TO                         17824099
175510           EFFECTIVE-MM OF CA24-DATE-CONTROL-LAYOUT               17825099
175520      MOVE WS-HDR-DATE-TIME-MINUS-1-DD TO                         17826099
175530           EFFECTIVE-DD OF CA24-DATE-CONTROL-LAYOUT               17827099
175540      MOVE WS-HDR-DATE-TIME-MINUS-1-HH TO                         17828099
175550           EFFECTIVE-HH OF CA24-DATE-CONTROL-LAYOUT               17829099
175560      MOVE WS-HDR-DATE-TIME-MINUS-1-MI TO                         17830099
175570           EFFECTIVE-MI OF CA24-DATE-CONTROL-LAYOUT               17831099
175580      MOVE WS-HDR-DATE-TIME-MINUS-1-SS TO                         17832099
175590           EFFECTIVE-SS OF CA24-DATE-CONTROL-LAYOUT               17833099
175600                                                                  17834099
175610      MOVE WS-CURR-DATE-TIME-CCYY TO                              17835099
175620           RUN-YYYY OF CA24-DATE-CONTROL-LAYOUT                   17836099
175630      MOVE WS-CURR-DATE-TIME-MM TO                                17837099
175640           RUN-MM OF CA24-DATE-CONTROL-LAYOUT                     17838099
175650      MOVE WS-CURR-DATE-TIME-DD TO                                17839099
175660           RUN-DD OF CA24-DATE-CONTROL-LAYOUT                     17840099
175670      MOVE WS-CURR-DATE-TIME-HH TO                                17841099
175680           RUN-HH OF CA24-DATE-CONTROL-LAYOUT                     17842099
175690      MOVE WS-CURR-DATE-TIME-MI TO                                17843099
175700           RUN-MI OF CA24-DATE-CONTROL-LAYOUT                     17844099
175710      MOVE WS-CURR-DATE-TIME-SS TO                                17845099
175720           RUN-SS OF CA24-DATE-CONTROL-LAYOUT                     17846099
175730                                                                  17847099
175740      MOVE 'RECON BILLER-ID=' TO                                  17848099
175750            FILLER-1 OF CA24-DATE-CONTROL-LAYOUT                  17849099
175760      MOVE ',MODE=' TO                                            17850099
175770            FILLER-2 OF CA24-DATE-CONTROL-LAYOUT                  17851099
175780      MOVE ',EFF-DT=' TO                                          17852099
175790            FILLER-3 OF CA24-DATE-CONTROL-LAYOUT                  17853099
175800      MOVE ',RUN-DT=' TO                                          17854099
175810            FILLER-4 OF CA24-DATE-CONTROL-LAYOUT                  17855099
175820      MOVE SPACE TO FILLER-5 OF CA24-DATE-CONTROL-LAYOUT          17856099
175830      WRITE DTCTLOUT-RECORD FROM CA24-DATE-CONTROL-LAYOUT         17857099
175840      CLOSE DTCTLOUT-FILE.                                        17858099
175850 6700-EXIT.                                                       17859099
175860      EXIT.                                                       17860099
175870                                                                  17861099
175880 6800-INSERT-LRN-UPD-REQT.                                        17862099
175890******************************************************************17863099
175900*C   PARAGRAPH NAME: 6800-INSERT-LRN-UPD-REQT                     17864099
175910*C                                                                17865099
175920*C   PURPOSE:                                                     17866099
175930*C       DELETE MESSAGE DET                                       17867099
175940******************************************************************17868099
175950                                                                  17869099
175960     INITIALIZE SQLCODE                                           17870099
175970                DCLLRN-UPD-REQT                                   17871099
175980                                                                  17872099
175990     MOVE  WS-CTNIN-CTN-TEXT(1:10)                                17873099
176000                               TO PORTED-NUM  OF DCLLRN-UPD-REQT  17874099
176010                                                                  17875099
176020*****MOVE  WS-CTNIN-NGP        TO LRN        OF  DCLLRN-UPD-REQT  17876099
176030                                                                  17877099
176040     MOVE  'U'              TO  PROCESS-IND  OF  DCLLRN-UPD-REQT  17878099
176050                                                                  17879099
176060     MOVE  'M'              TO  PROCESS-TYPE OF  DCLLRN-UPD-REQT  17880099
176070                                                                  17881099
176080     EXEC SQL                                                     17882099
176090        INSERT  INTO  LRN_UPD_REQT                                17883099
176100            (EFFECTIVE_DATE,                                      17884099
176110             NPANXX        ,                                      17885099
176120             BLOCK_IND     ,                                      17886099
176130             PORTED_NUM    ,                                      17887099
176140             LRN           ,                                      17888099
176150             NEW_LRN       ,                                      17889099
176160             RATE_CENTER   ,                                      17890099
176170             RC_STATE      ,                                      17891099
176180             ERROR_COMMENT ,                                      17892099
176190             USER_ID       ,                                      17893099
176200             PROCESS_IND   ,                                      17894099
176210             SYS_UPDATE_DATE   ,                                  17895099
176220             SYS_CREATION_DATE ,                                  17896099
176230             OPERATOR_ID   ,                                      17897099
176240             APPLICATION_ID ,                                     17898099
176250             PROCESS_TYPE   ,                                     17899099
176260             SPID           ,                                     17900099
176270             NEW_SPID)                                            17901099
176280        VALUES                                                    17902099
176290           (CURRENT DATE                   ,                      17903099
176300            :DCLLRN-UPD-REQT.NPANXX        ,                      17904099
176310            :DCLLRN-UPD-REQT.BLOCK-IND     ,                      17905099
176320            :DCLLRN-UPD-REQT.PORTED-NUM    ,                      17906099
176330            :DCLLRN-UPD-REQT.LRN           ,                      17907099
176340            :DCLLRN-UPD-REQT.NEW-LRN       ,                      17908099
176350            :DCLLRN-UPD-REQT.RATE-CENTER   ,                      17909099
176360            :DCLLRN-UPD-REQT.RC-STATE      ,                      17910099
176370            :DCLLRN-UPD-REQT.ERROR-COMMENT ,                      17911099
176380            :LIT-PGM-ID                    ,                      17912099
176390            :DCLLRN-UPD-REQT.PROCESS-IND   ,                      17913099
176400             CURRENT TIMESTAMP + :WS-HRS HOURS,                   17914099
176410             CURRENT TIMESTAMP + :WS-HRS HOURS,                   17915099
176420            :LIT-PGM-ID                    ,                      17916099
176430            :DCLLRN-UPD-REQT.APPLICATION-ID ,                     17917099
176440            :DCLLRN-UPD-REQT.PROCESS-TYPE   ,                     17918099
176450            :DCLLRN-UPD-REQT.SPID           ,                     17919099
176460            :DCLLRN-UPD-REQT.NEW-SPID)                            17920099
176470                                                                  17921099
176480     END-EXEC.                                                    17922099
176490                                                                  17923099
176500     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    17924099
176510     IF SQLCODE = +0                                              17925099
176520        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          17926099
176530     END-IF                                                       17927099
176540     .                                                            17928099
176550***********                                                       17929099
176560 6800-EXIT.                                                       17930099
176570***********                                                       17931099
176580      EXIT.                                                       17932099
176590                                                                  17933099
176600 7000-SELECT-CTN-INV.                                             17934099
176610******************************************************************17935099
176620*                                                                 17936099
176630*   PARAGRAPH NAME:  7000-SELECT-CTN-INV                          17937099
176640*                                                                 17938099
176650*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO DO                17939099
176660*             SELECT ROWS FROM CTN-INV TABLE.                     17940099
176670*                                                                 17941099
176720******************************************************************17942099
176730     MOVE '7000-SELECT-CTN-INV' TO WS-CURR-PARA                   17943099
176740     INITIALIZE DCLCTN-INV                                        17944099
176750                                                                  17945099
176760     MOVE  WS-MDN-LENGTH-IND    TO   CTN-LEN  IN  DCLCTN-INV      17946099
176770     MOVE  WS-MDN               TO  CTN-TEXT  IN  DCLCTN-INV      17947099
176780                                                                  17948099
176790     EXEC SQL                                                     17949099
176800        SELECT                                                    17950099
176810           CTN                                                    17951099
176820          ,SYS_CREATION_DATE                                      17952099
176830          ,SYS_UPDATE_DATE                                        17953099
176840          ,OPERATOR_ID                                            17954099
176850          ,APPLICATION_ID                                         17955099
176860          ,DL_SERVICE_CODE                                        17956099
176870          ,DL_UPDATE_STAMP                                        17957099
176880          ,LAST_TRX_DATE                                          17958099
176890          ,LAST_TRX_CODE                                          17959099
176900          ,CTN_STATUS                                             17960099
176910          ,LAST_TRX_UID                                           17961099
176920          ,NL                                                     17962099
176930          ,NGP                                                    17963099
176940          ,CONV_RUN_NO                                            17964099
176950          ,SPECIAL_TRX_DATE                                       17965099
176960          ,RUN_ID                                                 17966099
176970          ,HOLD_REASON                                            17967099
176980          ,PRODUCT_TYPE                                           17968099
176990          ,ICC_ID                                                 17969099
177000          ,PORT_IND                                               17970099
177010          ,MIN_NUM                                                17971099
177020          ,BILLER_ID                                              17972099
177030          ,STATUS_REASON_CD                                       17973099
177040          ,PREPAID_IND                                            17974099
177050          ,IMSI                                                   17975099
177060          ,ICC_ID_4G                                              17976099
177070        INTO                                                      17977099
177080           :DCLCTN-INV.CTN,                                       17978099
177090           :DCLCTN-INV.SYS-CREATION-DATE,                         17979099
177100           :DCLCTN-INV.SYS-UPDATE-DATE                            17980099
177110                 :DCLCTN-INV-NULL-INDS.SYS-UPDATE-DATE-NI,        17981099
177120           :DCLCTN-INV.OPERATOR-ID                                17982099
177130                 :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI,            17983099
177140           :DCLCTN-INV.APPLICATION-ID                             17984099
177150                 :DCLCTN-INV-NULL-INDS.APPLICATION-ID-NI,         17985099
177160           :DCLCTN-INV.DL-SERVICE-CODE,                           17986099
177170           :DCLCTN-INV.DL-UPDATE-STAMP                            17987099
177180                 :DCLCTN-INV-NULL-INDS.DL-UPDATE-STAMP-NI,        17988099
177190           :DCLCTN-INV.LAST-TRX-DATE,                             17989099
177200           :DCLCTN-INV.LAST-TRX-CODE,                             17990099
177210           :DCLCTN-INV.CTN-STATUS,                                17991099
177220           :DCLCTN-INV.LAST-TRX-UID,                              17992099
177230           :DCLCTN-INV.NL                                         17993099
177240                 :DCLCTN-INV-NULL-INDS.NL-NI,                     17994099
177250           :DCLCTN-INV.NGP,                                       17995099
177260           :DCLCTN-INV.CONV-RUN-NO                                17996099
177270                 :DCLCTN-INV-NULL-INDS.CONV-RUN-NO-NI,            17997099
177280           :DCLCTN-INV.SPECIAL-TRX-DATE                           17998099
177290                 :DCLCTN-INV-NULL-INDS.SPECIAL-TRX-DATE-NI,       17999099
177300           :DCLCTN-INV.RUN-ID                                     18000099
177310                 :DCLCTN-INV-NULL-INDS.RUN-ID-NI,                 18001099
177320           :DCLCTN-INV.HOLD-REASON                                18002099
177330                 :DCLCTN-INV-NULL-INDS.HOLD-REASON-NI,            18003099
177340           :DCLCTN-INV.PRODUCT-TYPE,                              18004099
177350           :DCLCTN-INV.ICC-ID                                     18005099
177360                 :DCLCTN-INV-NULL-INDS.ICC-ID-NI,                 18006099
177370           :DCLCTN-INV.PORT-IND,                                  18007099
177380           :DCLCTN-INV.MIN-NUM                                    18008099
177390                 :DCLCTN-INV-NULL-INDS.MIN-NUM-NI,                18009099
177400           :DCLCTN-INV.BILLER-ID                                  18010099
177410                 :DCLCTN-INV-NULL-INDS.BILLER-ID-NI,              18011099
177420           :DCLCTN-INV.STATUS-REASON-CD,                          18012099
177430           :DCLCTN-INV.PREPAID-IND                                18013099
177440                 :DCLCTN-INV-NULL-INDS.PREPAID-IND-NI,            18014099
177450           :DCLCTN-INV.IMSI,                                      18015099
177460           :DCLCTN-INV.ICC-ID-4G                                  18016099
177470        FROM                                                      18017099
177480           CTN_INV                                                18018099
177490        WHERE                                                     18019099
177500           CTN =:DCLCTN-INV.CTN                                   18020099
177510     END-EXEC                                                     18021099
177520     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    18022099
177530     .                                                            18023099
177540 7000-EXIT.                                                       18024099
177550      EXIT.                                                       18025099
177560                                                                  18026099
177570 7001-SELECT-CTN-INV.                                             18027099
177580******************************************************************18028099
177590*                                                                 18029099
177600*   PARAGRAPH NAME:  7000-SELECT-CTN-INV                          18030099
177610*                                                                 18031099
177620*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO DO                18032099
177630*             SELECT ROWS FROM CTN-INV TABLE.                     18033099
177680*                                                                 18034099
177690******************************************************************18035099
177700     MOVE '7001-SELECT-CTN-INV' TO WS-CURR-PARA                   18036099
177710     INITIALIZE DCLCTN-INV                                        18037099
177720     INITIALIZE FORCED-MDN-MATCH-FLAG                             18038099
177730                                                                  18039099
177740     EXEC SQL                                                     18040099
177750        SELECT                                                    18041099
177760           CTN                                                    18042099
177770          ,SYS_CREATION_DATE                                      18043099
177780          ,SYS_UPDATE_DATE                                        18044099
177790          ,OPERATOR_ID                                            18045099
177800          ,APPLICATION_ID                                         18046099
177810          ,DL_SERVICE_CODE                                        18047099
177820          ,DL_UPDATE_STAMP                                        18048099
177830          ,LAST_TRX_DATE                                          18049099
177840          ,LAST_TRX_CODE                                          18050099
177850          ,CTN_STATUS                                             18051099
177860          ,LAST_TRX_UID                                           18052099
177870          ,NL                                                     18053099
177880          ,NGP                                                    18054099
177890          ,CONV_RUN_NO                                            18055099
177900          ,SPECIAL_TRX_DATE                                       18056099
177910          ,RUN_ID                                                 18057099
177920          ,HOLD_REASON                                            18058099
177930          ,PRODUCT_TYPE                                           18059099
177940          ,ICC_ID                                                 18060099
177950          ,PORT_IND                                               18061099
177960          ,MIN_NUM                                                18062099
177970          ,BILLER_ID                                              18063099
177980          ,STATUS_REASON_CD                                       18064099
177990          ,PREPAID_IND                                            18065099
178000          ,IMSI                                                   18066099
178010          ,ICC_ID_4G                                              18067099
178020        INTO                                                      18068099
178030           :DCLCTN-INV.CTN,                                       18069099
178040           :DCLCTN-INV.SYS-CREATION-DATE,                         18070099
178050           :DCLCTN-INV.SYS-UPDATE-DATE                            18071099
178060                 :DCLCTN-INV-NULL-INDS.SYS-UPDATE-DATE-NI,        18072099
178070           :DCLCTN-INV.OPERATOR-ID                                18073099
178080                 :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI,            18074099
178090           :DCLCTN-INV.APPLICATION-ID                             18075099
178100                 :DCLCTN-INV-NULL-INDS.APPLICATION-ID-NI,         18076099
178110           :DCLCTN-INV.DL-SERVICE-CODE,                           18077099
178120           :DCLCTN-INV.DL-UPDATE-STAMP                            18078099
178130                 :DCLCTN-INV-NULL-INDS.DL-UPDATE-STAMP-NI,        18079099
178140           :DCLCTN-INV.LAST-TRX-DATE,                             18080099
178150           :DCLCTN-INV.LAST-TRX-CODE,                             18081099
178160           :DCLCTN-INV.CTN-STATUS,                                18082099
178170           :DCLCTN-INV.LAST-TRX-UID,                              18083099
178180           :DCLCTN-INV.NL                                         18084099
178190                 :DCLCTN-INV-NULL-INDS.NL-NI,                     18085099
178200           :DCLCTN-INV.NGP,                                       18086099
178210           :DCLCTN-INV.CONV-RUN-NO                                18087099
178220                 :DCLCTN-INV-NULL-INDS.CONV-RUN-NO-NI,            18088099
178230           :DCLCTN-INV.SPECIAL-TRX-DATE                           18089099
178240                 :DCLCTN-INV-NULL-INDS.SPECIAL-TRX-DATE-NI,       18090099
178250           :DCLCTN-INV.RUN-ID                                     18091099
178260                 :DCLCTN-INV-NULL-INDS.RUN-ID-NI,                 18092099
178270           :DCLCTN-INV.HOLD-REASON                                18093099
178280                 :DCLCTN-INV-NULL-INDS.HOLD-REASON-NI,            18094099
178290           :DCLCTN-INV.PRODUCT-TYPE,                              18095099
178300           :DCLCTN-INV.ICC-ID                                     18096099
178310                 :DCLCTN-INV-NULL-INDS.ICC-ID-NI,                 18097099
178320           :DCLCTN-INV.PORT-IND,                                  18098099
178330           :DCLCTN-INV.MIN-NUM                                    18099099
178340                 :DCLCTN-INV-NULL-INDS.MIN-NUM-NI,                18100099
178350           :DCLCTN-INV.BILLER-ID                                  18101099
178360                 :DCLCTN-INV-NULL-INDS.BILLER-ID-NI,              18102099
178370           :DCLCTN-INV.STATUS-REASON-CD,                          18103099
178380           :DCLCTN-INV.PREPAID-IND                                18104099
178390                 :DCLCTN-INV-NULL-INDS.PREPAID-IND-NI,            18105099
178400           :DCLCTN-INV.IMSI,                                      18106099
178410           :DCLCTN-INV.ICC-ID-4G                                  18107099
178420        FROM                                                      18108099
178430           CTN_INV                                                18109099
178440        WHERE                                                     18110099
178450           CTN =:WS-MDN AND                                       18111099
178460           CTN_STATUS = 'PO'                                      18112099
178470     END-EXEC                                                     18113099
178480                                                                  18114099
178490     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    18115099
178500     IF SQLCODE NOT = ZERO                                        18116099
178510        GO TO 7001-EXIT                                           18117099
178520     END-IF                                                       18118099
178530                                                                  18119099
178540*----(RSS recon but Biller is a core Biller, not RSS)             18120099
178550*----If found and this is an RSS recon but the CTN-INV Biller is--18121099
178560*----one of the core Billers (not "R"), exit and perform special--18122099
178570*----RSS 2100-MATCH logic-----------------------------------------18123099
178580**                                                                18124099
178590*  JA0402E  -  Below  Move  &  Legit                              18125099
178600                                                                  18126099
178610     MOVE WS-SAVE-HDR-BILLER-ID TO                                18127099
178620          WS-CHECK-BILLER-ID OF WS-COMMON-BILLERID                18128099
178630                                                                  18129099
178640     MOVE  BILLER-ID OF DCLCTN-INV   TO  WS-RESELLER-FLAG         18130099
178650                                                                  18131099
178660     IF  WS-LEGIT-BILLER-ID-RESELLER  AND                         18132099
178670         NOT  WS-RESELLER-TRUE  AND                               18133099
178680*-------NGP Extension Project:                                    18134099
178690*-------no longer get Biller from 1st pos of NGP in CTN-INV-------18135099
178700*-------but rather from new Biller-ID column in NUMBER-GROUP table18136099
178710        BILLER-ID OF DCLCTN-INV = WS-ETNDC38-BILLER               18137099
178720****    BILLER-ID OF DCLCTN-INV = NGP OF DCLCTN-INV(1:1)          18138099
178730        MOVE 'Y' TO FORCED-MDN-MATCH-FLAG                         18139099
178740        GO TO 7001-EXIT                                           18140099
178750     END-IF                                                       18141099
178760                                                                  18142099
178770*----(RSS recon and Biller is RSS)--------------------------------18143099
178780*----if found and this is an RSS recon and the CTN-INV Biller is--18144099
178790*----"R", do not set flag to prevent special RSS 2100-MATCH-------18145099
178800                                                                  18146099
178810*  JA0402E  -                                                     18147099
178820                                                                  18148099
178830     IF  WS-LEGIT-BILLER-ID-RESELLER  AND                         18149099
178840         WS-RESELLER-TRUE                                         18150099
178850         GO TO 7001-EXIT                                          18151099
178860     END-IF                                                       18152099
178870                                                                  18153099
178880*----(regular recon and Biller is RSS)----------------------------18154099
178890*----if found and this is a Core Biller recon and CTN-INV Biller--18155099
178900*----is "R", exit and perform special RSS 2100-MATCH logic--------18156099
178910                                                                  18157099
178920*  JA0402E  -  Below  Comment  &  Legit  &  WS-RESELLER-TRUE      18158099
178930*****IF WS-SAVE-MDNIN-BILLER-ID NOT = 'R' AND                     18159099
178940                                                                  18160099
178950     IF  NOT  WS-LEGIT-BILLER-ID-RESELLER  AND                    18161099
178960*-------NGP Extension Project:                                    18162099
178970*-------no longer get Biller from 1st pos of NGP in CTN-INV-------18163099
178980*-------but rather from new Biller-ID column in NUMBER-GROUP table18164099
178990        WS-SAVE-MDNIN-BILLER-ID = WS-ETNDC38-BILLER AND           18165099
179000****    WS-SAVE-MDNIN-BILLER-ID = NGP OF DCLCTN-INV(1:1) AND      18166099
179010******  BILLER-ID OF DCLCTN-INV = 'R'                             18167099
179020        WS-RESELLER-TRUE                                          18168099
179030        MOVE 'Y' TO FORCED-MDN-MATCH-FLAG                         18169099
179040        GO TO 7001-EXIT                                           18170099
179050     END-IF                                                       18171099
179060                                                                  18172099
179070*  JA0402E  -  Below  Commented  Out                              18173099
179080*----(regular recon but Biller is a regular Biller)---------------18174099
179090*----if found and this is a Core Biller recon and CTN-INV Biller--18175099
179100*----NOT "R", do not set flag to prevent special RSS 2100-MATCH---18176099
179110*****IF WS-SAVE-MDNIN-BILLER-ID NOT = 'R' AND                     18177099
179120*****   BILLER-ID OF DCLCTN-INV NOT = 'R'                         18178099
179130*****   GO TO 7001-EXIT                                           18179099
179140*****   END-IF                                                    18180099
179150     .                                                            18181099
179160 7001-EXIT.                                                       18182099
179170      EXIT.                                                       18183099
179180                                                                  18184099
179190 7002-MOVE-CTN-INV-TO-WS-CTNIN.                                   18185099
179200*-----this "artificial" filling of the input eTNI file's fields---18186099
179210*-----with CTN-INV data is ONLY done during "forced matches".-----18187099
179220*-----To be able to recall the real eTNI record that's being------18188099
179230*-----overlaid here, first we need to back it up to a save area---18189099
179240*-----for recall later at the start of the next MDN/CTN cycle-----18190099
179250      MOVE WS-CTNIN-RECORD TO WS-CTNIN-RECORD-SAVED               18191099
179260      INITIALIZE WS-CTNIN-RECORD                                  18192099
179270      MOVE CTN OF DCLCTN-INV TO WS-CTNIN-CTN                      18193099
179280      MOVE SYS-CREATION-DATE OF DCLCTN-INV TO                     18194099
179290           WS-CTNIN-SYS-CREATION-DATE                             18195099
179300      MOVE SYS-UPDATE-DATE OF DCLCTN-INV TO                       18196099
179310           WS-CTNIN-SYS-UPDATE-DATE                               18197099
179320      MOVE OPERATOR-ID OF DCLCTN-INV TO                           18198099
179330           WS-CTNIN-OPERATOR-ID                                   18199099
179340      MOVE APPLICATION-ID OF DCLCTN-INV TO                        18200099
179350           WS-CTNIN-APPLICATION-ID                                18201099
179360      MOVE DL-SERVICE-CODE OF DCLCTN-INV TO                       18202099
179370           WS-CTNIN-DL-SERVICE-CODE                               18203099
179380      MOVE DL-UPDATE-STAMP OF DCLCTN-INV TO                       18204099
179390           WS-CTNIN-DL-UPDATE-STAMP                               18205099
179400      MOVE LAST-TRX-DATE OF DCLCTN-INV TO                         18206099
179410           WS-CTNIN-LAST-TRX-DATE                                 18207099
179420      MOVE LAST-TRX-CODE OF DCLCTN-INV TO                         18208099
179430           WS-CTNIN-LAST-TRX-CODE                                 18209099
179440      MOVE CTN-STATUS OF DCLCTN-INV TO                            18210099
179450           WS-CTNIN-CTN-STATUS                                    18211099
179460      MOVE LAST-TRX-UID OF DCLCTN-INV TO                          18212099
179470           WS-CTNIN-LAST-TRX-UID                                  18213099
179480      MOVE NL OF DCLCTN-INV TO                                    18214099
179490           WS-CTNIN-NL                                            18215099
179500      MOVE NGP OF DCLCTN-INV TO                                   18216099
179510           WS-CTNIN-NGP                                           18217099
179520      MOVE CONV-RUN-NO OF DCLCTN-INV TO                           18218099
179530           WS-CTNIN-CONV-RUN-NO                                   18219099
179540      MOVE SPECIAL-TRX-DATE OF DCLCTN-INV TO                      18220099
179550           WS-CTNIN-SPECIAL-TRX-DATE                              18221099
179560      MOVE RUN-ID OF DCLCTN-INV TO                                18222099
179570           WS-CTNIN-RUN-ID                                        18223099
179580      MOVE HOLD-REASON OF DCLCTN-INV TO                           18224099
179590           WS-CTNIN-HOLD-REASON                                   18225099
179600      MOVE PRODUCT-TYPE OF DCLCTN-INV TO                          18226099
179610           WS-CTNIN-PRODUCT-TYPE                                  18227099
179620      MOVE ICC-ID OF DCLCTN-INV TO                                18228099
179630           WS-CTNIN-ICC-ID                                        18229099
179640      MOVE PORT-IND OF DCLCTN-INV TO                              18230099
179650           WS-CTNIN-PORT-IND                                      18231099
179660      MOVE MIN-NUM OF DCLCTN-INV TO                               18232099
179670           WS-CTNIN-MIN-NUM                                       18233099
179680      MOVE BILLER-ID OF DCLCTN-INV TO                             18234099
179690           WS-CTNIN-BILLER-ID                                     18235099
179700      MOVE STATUS-REASON-CD OF DCLCTN-INV TO                      18236099
179710           WS-CTNIN-STATUS-REASON-CD                              18237099
179720      MOVE PREPAID-IND OF DCLCTN-INV TO                           18238099
179730           WS-CTNIN-PREPAID-IND.                                  18239099
179740 7002-EXIT.                                                       18240099
179750      EXIT.                                                       18241099
179760                                                                  18242099
179770 7003-TRANSITIONAL-CTN-INV-UPD.                                   18243099
179780      MOVE '7003-TRANSITIONAL-CTN-INV-UPD' TO WS-CURR-PARA        18244099
179790      MOVE WS-CTNIN-CTN-TEXT (1:WS-CTNIN-CTN-LEN) TO WS-MDN       18245099
179800      MOVE WS-CTNIN-PRODUCT-TYPE TO WS-PRODUCT-TYPE               18246099
179810      MOVE 'PO' TO CTN-STATUS OF DCLCTN-INV                       18247099
179820*     when updating to NA or PO Status, set PrePaid Ind to Space  18248099
179830      IF CTN-STATUS OF DCLCTN-INV = 'NA' OR                       18249099
179840         CTN-STATUS OF DCLCTN-INV = 'PO'                          18250099
179850         MOVE SPACE TO PREPAID-IND OF DCLCTN-INV                  18251099
179860      END-IF                                                      18252099
179870                                                                  18253099
179880*----if eTNI Biller is "R" (RSS) and its status was reset by pgm--18254099
179890*----to NA (not assigned), reset the eTNI Biller back to its------18255099
179900*----original Biller as determined from 1st pos of NGP.-----------18256099
179910*----This will work regardless of eTNI already having a Status of-18257099
179920*----NA or Biller trying to change eTNI's Status to NA.-----------18258099
179930*----(first, default CTN-INV Biller to input Biller,      test)---18259099
179940     MOVE WS-CTNIN-BILLER-ID TO BILLER-ID OF DCLCTN-INV           18260099
179950     MOVE 0 TO BILLER-ID-NI OF DCLCTN-INV-NULL-INDS               18261099
179960                                                                  18262099
179970**  JA0402E  -  Below                                             18263099
179980                                                                  18264099
179990     IF  WS-LEGIT-BILLER-ID-RESELLER  AND                         18265099
180000         CTN-STATUS OF DCLCTN-INV = 'NA'                          18266099
180010*-------NGP Extension Project:                                    18267099
180020*-------no longer get Biller from 1st pos of NGP in CTN-INV-------18268099
180030*-------but rather from new Biller-ID column in NUMBER-GROUP table18269099
180040        MOVE WS-ETNDC38-BILLER TO BILLER-ID OF DCLCTN-INV         18270099
180050****    MOVE NGP OF DCLCTN-INV(1:1) TO BILLER-ID OF DCLCTN-INV    18271099
180060     END-IF                                                       18272099
180070                                                                  18273099
180080***   MOVE WS-TIMESTAMP TO SYS-UPDATE-DATE OF DCLCTN-INV          18274099
180090      MOVE WS-TIMESTAMP TO LAST-TRX-DATE   OF DCLCTN-INV          18275099
180100      MOVE LIT-OPERATOR-ID TO OPERATOR-ID  OF DCLCTN-INV          18276099
180110      PERFORM 2145-SET-CTNINV-NULL-INDS THRU 2145-EXIT            18277099
180120      MOVE -1 TO MIN-NUM-NI OF DCLCTN-INV-NULL-INDS               18278099
180130      MOVE LOW-VALUES TO MIN-NUM-TEXT OF DCLCTN-INV               18279099
180140      MOVE -1 TO NL-NI OF DCLCTN-INV-NULL-INDS                    18280099
180150      MOVE LOW-VALUES TO NL OF DCLCTN-INV                         18281099
180160      EXEC SQL                                                    18282099
180170           UPDATE CTN_INV                                         18283099
180180           SET                                                    18284099
180190*-----AGB 10/17/05---populate SYS_UPDATE_DATE with dynamic date---18285099
180200           SYS_UPDATE_DATE = CURRENT TIMESTAMP + :WS-HRS HOURS,   18286099
180210           OPERATOR_ID     = :DCLCTN-INV.OPERATOR-ID              18287099
180220                           :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI,  18288099
180230           BILLER_ID       = :DCLCTN-INV.BILLER-ID                18289099
180240                             :DCLCTN-INV-NULL-INDS.BILLER-ID-NI,  18290099
180250           LAST_TRX_DATE   = :DCLCTN-INV.LAST-TRX-DATE,           18291099
180260           LAST_TRX_CODE   = :DCLCTN-INV.LAST-TRX-CODE,           18292099
180270           CTN_STATUS      = :DCLCTN-INV.CTN-STATUS,              18293099
180280           NL              = :DCLCTN-INV.NL                       18294099
180290                             :DCLCTN-INV-NULL-INDS.NL-NI,         18295099
180300           MIN_NUM         = :DCLCTN-INV.MIN-NUM                  18296099
180310                             :DCLCTN-INV-NULL-INDS.MIN-NUM-NI,    18297099
180320           PREPAID_IND     = :DCLCTN-INV.PREPAID-IND              18298099
180330                             :DCLCTN-INV-NULL-INDS.PREPAID-IND-NI 18299099
180340       WHERE                                                      18300099
180350           CTN             = :WS-MDN                              18301099
180360       END-EXEC                                                   18302099
180370                                                                  18303099
180380     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    18304099
180390     IF SQL-SUCCESS                                               18305099
180400        ADD +1 TO WS-TOTL-ETNI-CTNINV-UPD-ST-CNT                  18306099
180410        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          18307099
180420     ELSE                                                         18308099
180430        SET WS-ERROR-FIELDS-FOUND TO TRUE                         18309099
180440        DISPLAY ' '                                               18310099
180450        DISPLAY '    In 7003-TRANSITIONAL-CTN-INV-UPD'            18311099
180460        DISPLAY '>>>> MDN/CTN at Abend Time: ' WS-MDN ' <<<<'     18312099
180470        DISPLAY ' '                                               18313099
180480        PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT               18314099
180490        MOVE    SQLCODE TO WS-ABEND-CODE                          18315099
180500        STRING 'FATAL SQL ERROR!!!  SQLCODE: '                    18316099
180510                WS-ABEND-CODE                                     18317099
180520                DELIMITED BY SIZE                                 18318099
180530                INTO WS-ABEND-TEXT                                18319099
180540        END-STRING                                                18320099
180550        PERFORM 9000-ABORT           THRU 9000-EXIT               18321099
180560     END-IF                                                       18322099
180570     .                                                            18323099
180580 7003-EXIT.                                                       18324099
180590      EXIT.                                                       18325099
180600                                                                  18326099
180610 7004-RE-PORTED-CTN-INV-UPD.                                      18327099
180620      MOVE '7004-RE-PORTED-CTN-INV-UPD' TO WS-CURR-PARA           18328099
180630      MOVE WS-CTNIN-CTN-TEXT(1:WS-CTNIN-CTN-LEN) TO WS-MDN        18329099
180640      MOVE WS-CTNIN-PRODUCT-TYPE TO WS-PRODUCT-TYPE               18330099
180650      MOVE 'PO' TO CTN-STATUS OF DCLCTN-INV                       18331099
180660      MOVE 'PO' TO PORT-IND OF DCLCTN-INV                         18332099
180670      MOVE SPACE TO PREPAID-IND OF DCLCTN-INV                     18333099
180680***   MOVE WS-TIMESTAMP TO SYS-UPDATE-DATE OF DCLCTN-INV          18334099
180690      MOVE WS-TIMESTAMP TO LAST-TRX-DATE   OF DCLCTN-INV          18335099
180700      MOVE LIT-OPERATOR-ID TO OPERATOR-ID  OF DCLCTN-INV          18336099
180710      PERFORM 2145-SET-CTNINV-NULL-INDS THRU 2145-EXIT            18337099
180720      MOVE -1 TO MIN-NUM-NI OF DCLCTN-INV-NULL-INDS               18338099
180730      MOVE LOW-VALUES TO MIN-NUM-TEXT OF DCLCTN-INV               18339099
180740      MOVE -1 TO NL-NI OF DCLCTN-INV-NULL-INDS                    18340099
180750      MOVE LOW-VALUES TO NL OF DCLCTN-INV                         18341099
180760      MOVE -1 TO HOLD-REASON-NI OF DCLCTN-INV-NULL-INDS           18342099
180770      MOVE LOW-VALUES TO HOLD-REASON OF DCLCTN-INV                18343099
180780      MOVE -1 TO ICC-ID-NI OF DCLCTN-INV-NULL-INDS                18344099
180790      MOVE LOW-VALUES TO ICC-ID OF DCLCTN-INV                     18345099
180800                                                                  18346099
180880      PERFORM 7550-CHECK-HIST-FOR-TRX-DATE THRU 7550-EXIT         18347099
180890                                                                  18348099
180900      EXEC SQL                                                    18349099
180910           UPDATE CTN_INV                                         18350099
180920           SET                                                    18351099
180930*-----AGB 10/17/05---populate SYS-UPDATE-DATE with dynamic date---18352099
180940           SYS_UPDATE_DATE = CURRENT TIMESTAMP + :WS-HRS HOURS,   18353099
180950           OPERATOR_ID     = :DCLCTN-INV.OPERATOR-ID              18354099
180960                             :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI,18355099
180970           LAST_TRX_DATE   = :DCLCTN-INV.LAST-TRX-DATE,           18356099
180980           CTN_STATUS      = :DCLCTN-INV.CTN-STATUS,              18357099
180990           PORT_IND        = :DCLCTN-INV.PORT-IND,                18358099
181000           NL              = :DCLCTN-INV.NL                       18359099
181010                             :DCLCTN-INV-NULL-INDS.NL-NI,         18360099
181020           MIN_NUM         = :DCLCTN-INV.MIN-NUM                  18361099
181030                             :DCLCTN-INV-NULL-INDS.MIN-NUM-NI,    18362099
181040           PREPAID_IND     = :DCLCTN-INV.PREPAID-IND              18363099
181050                             :DCLCTN-INV-NULL-INDS.PREPAID-IND-NI,18364099
181060           HOLD_REASON     = :DCLCTN-INV.HOLD-REASON              18365099
181070                             :DCLCTN-INV-NULL-INDS.HOLD-REASON-NI,18366099
181080           ICC_ID          = :DCLCTN-INV.ICC-ID                   18367099
181090                             :DCLCTN-INV-NULL-INDS.ICC-ID-NI      18368099
181100       WHERE                                                      18369099
181110           CTN             = :WS-MDN                              18370099
181120     END-EXEC                                                     18371099
181130                                                                  18372099
181140     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    18373099
181150     IF SQL-SUCCESS                                               18374099
181160        ADD +1 TO WS-TOTL-ETNI-CTNINV-UPD-ST-CNT                  18375099
181170        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          18376099
181180     ELSE                                                         18377099
181190        SET WS-ERROR-FIELDS-FOUND TO TRUE                         18378099
181200        DISPLAY ' '                                               18379099
181210        DISPLAY '    In 7004-RE-PORTED-CTN-INV-UPD'               18380099
181220        DISPLAY '>>>> MDN/CTN at Abend Time: ' WS-MDN ' <<<<'     18381099
181230        DISPLAY ' '                                               18382099
181240        PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT               18383099
181250        MOVE    SQLCODE TO WS-ABEND-CODE                          18384099
181260        STRING 'FATAL SQL ERROR!!!  SQLCODE: '                    18385099
181270                WS-ABEND-CODE                                     18386099
181280                DELIMITED BY SIZE                                 18387099
181290                INTO WS-ABEND-TEXT                                18388099
181300        END-STRING                                                18389099
181310        PERFORM 9000-ABORT           THRU 9000-EXIT               18390099
181320     END-IF                                                       18391099
181330     .                                                            18392099
181340 7004-EXIT.                                                       18393099
181350      EXIT.                                                       18394099
181360                                                                  18395099
181370 7005-SPLIT-CTN-INV-UPD.                                          18396099
181380      MOVE '7005-SPLIT-CTN-INV-UPD' TO WS-CURR-PARA               18397099
181390      MOVE WS-CTNIN-CTN-TEXT (1:WS-CTNIN-CTN-LEN) TO WS-MDN       18398099
181400      MOVE 'NH' TO CTN-STATUS OF DCLCTN-INV                       18399099
181410      MOVE 'SPLIT' TO HOLD-REASON OF DCLCTN-INV                   18400099
181420      MOVE 'CNV' TO LAST-TRX-CODE OF DCLCTN-INV                   18401099
181430***** MOVE 'RE' TO PORT-IND OF DCLCTN-INV ** Steve asking Sue <<< 18402099
181440***** MOVE WS-TIMESTAMP TO SYS-UPDATE-DATE OF DCLCTN-INV          18403099
181450      MOVE WS-TIMESTAMP TO LAST-TRX-DATE   OF DCLCTN-INV          18404099
181460      MOVE LIT-OPERATOR-ID TO OPERATOR-ID  OF DCLCTN-INV          18405099
181470      PERFORM 2145-SET-CTNINV-NULL-INDS THRU 2145-EXIT            18406099
181480      MOVE -1 TO MIN-NUM-NI OF DCLCTN-INV-NULL-INDS               18407099
181490      MOVE LOW-VALUES TO MIN-NUM-TEXT OF DCLCTN-INV               18408099
181500      MOVE -1 TO NL-NI OF DCLCTN-INV-NULL-INDS                    18409099
181510      MOVE LOW-VALUES TO NL OF DCLCTN-INV                         18410099
181590                                                                  18411099
181600      PERFORM 7550-CHECK-HIST-FOR-TRX-DATE THRU 7550-EXIT         18412099
181610                                                                  18413099
181620      EXEC SQL                                                    18414099
181630           UPDATE CTN_INV                                         18415099
181640           SET                                                    18416099
181650*-----AGB 10/17/05---populate SYS-UPDATE-DATE with dynamic date---18417099
181660           SYS_UPDATE_DATE = CURRENT TIMESTAMP + :WS-HRS HOURS,   18418099
181670           OPERATOR_ID     = :DCLCTN-INV.OPERATOR-ID              18419099
181680                           :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI,  18420099
181690           LAST_TRX_DATE   = :DCLCTN-INV.LAST-TRX-DATE,           18421099
181700           CTN_STATUS      = :DCLCTN-INV.CTN-STATUS,              18422099
181710           HOLD_REASON     = :DCLCTN-INV.HOLD-REASON,             18423099
181720           LAST_TRX_CODE   = :DCLCTN-INV.LAST-TRX-CODE,           18424099
181730           NL              = :DCLCTN-INV.NL                       18425099
181740                             :DCLCTN-INV-NULL-INDS.NL-NI,         18426099
181750           MIN_NUM         = :DCLCTN-INV.MIN-NUM                  18427099
181760                             :DCLCTN-INV-NULL-INDS.MIN-NUM-NI     18428099
181770       WHERE                                                      18429099
181780           CTN             = :WS-MDN                              18430099
181790       END-EXEC                                                   18431099
181800                                                                  18432099
181810     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    18433099
181820     IF SQL-SUCCESS                                               18434099
181830        ADD +1 TO WS-TOTL-ETNI-CTNINV-UPD-ST-CNT                  18435099
181840        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          18436099
181850     ELSE                                                         18437099
181860        SET WS-ERROR-FIELDS-FOUND TO TRUE                         18438099
181870        DISPLAY ' '                                               18439099
181880        DISPLAY '    In 7005-SPLIT-CTN-INV-UPD'                   18440099
181890        DISPLAY '>>>> MDN/CTN at Abend Time: ' WS-MDN ' <<<<'     18441099
181900        DISPLAY ' '                                               18442099
181910        PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT               18443099
181920        MOVE    SQLCODE TO WS-ABEND-CODE                          18444099
181930        STRING 'FATAL SQL ERROR!!!  SQLCODE: '                    18445099
181940                WS-ABEND-CODE                                     18446099
181950                DELIMITED BY SIZE                                 18447099
181960                INTO WS-ABEND-TEXT                                18448099
181970        END-STRING                                                18449099
181980        PERFORM 9000-ABORT           THRU 9000-EXIT               18450099
181990     END-IF                                                       18451099
182000     .                                                            18452099
182010 7005-EXIT.                                                       18453099
182020      EXIT.                                                       18454099
182030                                                                  18455099
182040 7006-SELECT-CTN-INV-MIN.                                         18456099
182050******************************************************************18457099
182060*                                                                 18458099
182070*   PARAGRAPH NAME:  7006-SELECT-CTN-INV-MIN                      18459099
182080*                                                                 18460099
182090*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO TRY TO DO         18461099
182100*             GET MIN OF CTN-INV                                  18462099
182110*                                                                 18463099
182150******************************************************************18464099
182160     MOVE '7006-SELECT-CTN-INV-MIN' TO WS-CURR-PARA               18465099
182170                                                                  18466099
182180*  JA0112  -  Eliminated  Senseless  Comment  -                   18467099
182190                                                                  18468099
182200     INITIALIZE  WS-CHECK-OLD-CTN-STATUS                          18469099
182210                 WS-CHECK-OLD-PORT-IND                            18470099
182220                                                                  18471099
182230     EXEC SQL                                                     18472099
182240          SELECT CTN_STATUS, PORT_IND                             18473099
182250          INTO :WS-CHECK-OLD-CTN-STATUS,                          18474099
182260               :WS-CHECK-OLD-PORT-IND                             18475099
182270          FROM CTN_INV                                            18476099
182280          WHERE MIN_NUM = :DCLCTN-INV.MIN-NUM                     18477099
182290          END-EXEC.                                               18478099
182300     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    18479099
182310     .                                                            18480099
182320 7006-EXIT.                                                       18481099
182330     EXIT.                                                        18482099
182340                                                                  18483099
182350 7007-SELECT-CTN-INV-MIN.                                         18484099
182360******************************************************************18485099
182370*                                                                 18486099
182380*   PARAGRAPH NAME:  7007-SELECT-CTN-INV-MIN                      18487099
182390*                                                                 18488099
182400*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO TRY TO DO         18489099
182410*             GET MIN OF CTN-INV                                  18490099
182420*                                                                 18491099
182460******************************************************************18492099
182470                                                                  18493099
182480*----any other CTNs in CTN-INV with the incomming Biller MIN?-----18494099
182490     MOVE '7007-SELECT-CTN-INV-MIN' TO WS-CURR-PARA               18495099
182500     INITIALIZE SHOULD-MIN-STATUS-BE-UPDATED                      18496099
182510     EXEC SQL                                                     18497099
182520          SELECT CTN                                              18498099
182530          INTO :WS-CTN-W-DUPE-MIN                                 18499099
182540          FROM CTN_INV                                            18500099
182550          WHERE MIN_NUM = :DCLCTN-INV.MIN-NUM AND                 18501099
182560                CTN <> :DCLCTN-INV.CTN                            18502099
182570          END-EXEC.                                               18503099
182580                                                                  18504099
182590*----if no other CTNs found with same MIN, that's a good thing!---18505099
182600     IF SQLCODE = 100                                             18506099
182610        MOVE 'Y' TO SHOULD-MIN-STATUS-BE-UPDATED                  18507099
182620        GO TO 7007-EXIT                                           18508099
182630        END-IF                                                    18509099
182640                                                                  18510099
182650*----if just 1 CTN found with same MIN, display it in message-----18511099
182660     IF SQLCODE = 0                                               18512099
182670        SET WS-ERROR-FIELDS-FOUND TO TRUE                         18513099
182680        MOVE 'THIS CTN HAS SAME MIN:' TO WS-COMMENT               18514099
182690        MOVE WS-CTN-W-DUPE-MIN-TEXT TO WS-ADDTL-INFO(1:10)        18515099
182700*  Changed  From  6000-MOVE  to  6010-MOVE  - JA1010              18516099
182710        PERFORM 6010-MOVE-ETNI-TO-RPT     THRU 6010-EXIT          18517099
182720        PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT               18518099
182730        GO TO 7007-EXIT                                           18519099
182740        END-IF                                                    18520099
182750                                                                  18521099
182760*----if many CTNs found with same MIN, display generic message----18522099
182770     IF SQLCODE = -811                                            18523099
182780        SET WS-ERROR-FIELDS-FOUND TO TRUE                         18524099
182790        MOVE 'MULTIPLE CTNS HAVE THIS MIN:' TO WS-COMMENT         18525099
182800        MOVE MIN-NUM-TEXT OF DCLCTN-INV TO WS-ADDTL-INFO(1:10)    18526099
182810*  Changed  From  6000-MOVE  to  6010-MOVE  - JA1010              18527099
182820        PERFORM 6010-MOVE-ETNI-TO-RPT     THRU 6010-EXIT          18528099
182830        PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT               18529099
182840        GO TO 7007-EXIT                                           18530099
182850        END-IF                                                    18531099
182860      .                                                           18532099
182870 7007-EXIT.                                                       18533099
182880      EXIT.                                                       18534099
182890                                                                  18535099
182900 7008-GET-PRODTYPE-FROM-MARKET.                                   18536099
182910      INITIALIZE DCLMARKET-NPA-NXX-LR                             18537099
182920      MOVE MDNIN-MDN(1:3) TO NPA OF DCLMARKET-NPA-NXX-LR          18538099
182930      MOVE MDNIN-MDN(4:3) TO NXX OF DCLMARKET-NPA-NXX-LR          18539099
182940      MOVE MDNIN-MDN(7:4) TO WS-HOLD-LINE                         18540099
182950                                                                  18541099
182960      EXEC SQL                                                    18542099
182970           SELECT                                                 18543099
182980                PRODUCT_TYPE                                      18544099
182990           INTO                                                   18545099
183000               :DCLMARKET-NPA-NXX-LR.PRODUCT-TYPE                 18546099
183010           FROM                                                   18547099
183020                MARKET_NPA_NXX_LR A                               18548099
183030           WHERE                                                  18549099
183040                A.NPA = :DCLMARKET-NPA-NXX-LR.NPA AND             18550099
183050                A.NXX = :DCLMARKET-NPA-NXX-LR.NXX AND             18551099
183060              (:WS-HOLD-LINE BETWEEN                              18552099
183070                   A.BEGIN_LINE_RANGE AND A.END_LINE_RANGE)       18553099
183080                AND                                               18554099
183090                A.EFFECTIVE_DATE =                                18555099
183100*---------------pick the row with the MAX Effective Date----------18556099
183110                    (SELECT MAX (EFFECTIVE_DATE)                  18557099
183120                     FROM                                         18558099
183130                     MARKET_NPA_NXX_LR B                          18559099
183140                     WHERE                                        18560099
183150                         B.NPA = :DCLMARKET-NPA-NXX-LR.NPA AND    18561099
183160                         B.NXX = :DCLMARKET-NPA-NXX-LR.NXX AND    18562099
183170                         (:WS-HOLD-LINE BETWEEN                   18563099
183180                         B.BEGIN_LINE_RANGE AND B.END_LINE_RANGE))18564099
183190           END-EXEC                                               18565099
183200                                                                  18566099
183210*-----if there's a problem finding it, use incomming Biller PT----18567099
183220      IF SQLCODE NOT = ZERO                                       18568099
183230         INITIALIZE SQLCODE                                       18569099
183240         MOVE MDNIN-PRODUCT-TYPE TO                               18570099
183250              PRODUCT-TYPE OF DCLMARKET-NPA-NXX-LR                18571099
183260         END-IF.                                                  18572099
183270 7008-EXIT.                                                       18573099
183280      EXIT.                                                       18574099
183290                                                                  18575099
183300*AGB 5/31/05                                                      18576099
183310 7009-NH-PENDING-CTN-INV-UPD.                                     18577099
183320      MOVE '7009-NH-PENDING-CTN-INV-UPD' TO WS-CURR-PARA          18578099
183330      MOVE WS-CTNIN-CTN-TEXT(1:WS-CTNIN-CTN-LEN) TO WS-MDN        18579099
183340      MOVE WS-CTNIN-PRODUCT-TYPE TO WS-PRODUCT-TYPE               18580099
183350***   MOVE WS-TIMESTAMP TO SYS-UPDATE-DATE OF DCLCTN-INV          18581099
183360      MOVE WS-TIMESTAMP TO LAST-TRX-DATE   OF DCLCTN-INV          18582099
183370      MOVE LIT-OPERATOR-ID TO OPERATOR-ID  OF DCLCTN-INV          18583099
183380      PERFORM 2145-SET-CTNINV-NULL-INDS THRU 2145-EXIT            18584099
183390      MOVE 'PENDASGN-R' TO HOLD-REASON OF DCLCTN-INV              18585099
183400      MOVE 0 TO HOLD-REASON-NI OF DCLCTN-INV-NULL-INDS            18586099
183410      MOVE ICC-ID-TEXT OF DCLCTN-INV(1:5) TO NL OF DCLCTN-INV     18587099
183420      MOVE 0 TO NL-NI OF DCLCTN-INV-NULL-INDS                     18588099
183430      MOVE NL OF DCLCTN-INV(1:1) TO BILLER-ID OF DCLCTN-INV       18589099
183440      MOVE 0 TO BILLER-ID-NI OF DCLCTN-INV-NULL-INDS              18590099
183450      INITIALIZE ICC-ID OF DCLCTN-INV                             18591099
183460      MOVE -1 TO ICC-ID-NI OF DCLCTN-INV-NULL-INDS                18592099
183470                                                                  18593099
183480*----NEW as of 11/18/04. To prevent possibility of LAST-TRX-DATE--18594099
183490*----duplicates ending up in CTN-INV-HISTORY when CTN-INV row is--18595099
183500*----later written to History, check to see if there's already----18596099
183510*----a History row from this CTN with the same LAST-TRX-DATE.-----18597099
183520*----If so, increment the LAST-TRX-DATE and replace it back into--18598099
183530*----CTN-INV Dclgen prior to update below. (tries up to 20 times)-18599099
183540                                                                  18600099
183550      PERFORM 7550-CHECK-HIST-FOR-TRX-DATE THRU 7550-EXIT         18601099
183560                                                                  18602099
183570      EXEC SQL                                                    18603099
183580           UPDATE CTN_INV                                         18604099
183590           SET                                                    18605099
183600*-----AGB 10/17/05---populate SYS-UPDATE-DATE with dynamic date---18606099
183610           SYS_UPDATE_DATE = CURRENT TIMESTAMP + :WS-HRS HOURS,   18607099
183620           OPERATOR_ID     = :DCLCTN-INV.OPERATOR-ID              18608099
183630                           :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI,  18609099
183640           LAST_TRX_DATE   = :DCLCTN-INV.LAST-TRX-DATE,           18610099
183650           NL              = :DCLCTN-INV.NL                       18611099
183660                             :DCLCTN-INV-NULL-INDS.NL-NI,         18612099
183670           PREPAID_IND     = :DCLCTN-INV.PREPAID-IND              18613099
183680                             :DCLCTN-INV-NULL-INDS.PREPAID-IND-NI,18614099
183690           HOLD_REASON     = :DCLCTN-INV.HOLD-REASON              18615099
183700                             :DCLCTN-INV-NULL-INDS.HOLD-REASON-NI,18616099
183710           BILLER_ID       = :DCLCTN-INV.BILLER-ID                18617099
183720                             :DCLCTN-INV-NULL-INDS.BILLER-ID-NI,  18618099
183730           ICC_ID          = :DCLCTN-INV.ICC-ID                   18619099
183740                             :DCLCTN-INV-NULL-INDS.ICC-ID-NI      18620099
183750       WHERE                                                      18621099
183760           CTN             = :WS-MDN                              18622099
183770     END-EXEC                                                     18623099
183780                                                                  18624099
183790     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    18625099
183800     IF SQL-SUCCESS                                               18626099
183810        ADD +1 TO WS-TOTL-ETNI-CTNINV-UPD-ST-CNT                  18627099
183820        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          18628099
183830     ELSE                                                         18629099
183840        SET WS-ERROR-FIELDS-FOUND TO TRUE                         18630099
183850        DISPLAY ' '                                               18631099
183860        DISPLAY '    In 7009-NH-PENDING-CTN-INV-UPD'              18632099
183870        DISPLAY '>>>> MDN/CTN at Abend Time: ' WS-MDN ' <<<<'     18633099
183880        DISPLAY ' '                                               18634099
183890        PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT               18635099
183900        MOVE    SQLCODE TO WS-ABEND-CODE                          18636099
183910        STRING 'FATAL SQL ERROR!!!  SQLCODE: '                    18637099
183920                WS-ABEND-CODE                                     18638099
183930                DELIMITED BY SIZE                                 18639099
183940                INTO WS-ABEND-TEXT                                18640099
183950        END-STRING                                                18641099
183960        PERFORM 9000-ABORT           THRU 9000-EXIT               18642099
183970     END-IF                                                       18643099
183980     .                                                            18644099
183990 7009-EXIT.                                                       18645099
184000      EXIT.                                                       18646099
184010                                                                  18647099
184020 7010-UPDATE-CTN-INV.                                             18648099
184030******************************************************************18649099
184040*                                                                 18650099
184050*   PARAGRAPH NAME:  7010-UPDATE-CTN-INV                          18651099
184060*                                                                 18652099
184070*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO TRY TO DO         18653099
184080*             COLUMN UPDATES                                      18654099
184090*                                                                 18655099
184130******************************************************************18656099
184140     PERFORM 2145-SET-CTNINV-NULL-INDS THRU 2145-EXIT             18657099
184150     MOVE '7010-UPDATE-CTN-INV' TO WS-CURR-PARA                   18658099
184160                                                                  18659099
184170*----if eTNI Biller is "R" (RSS) and its status was reset by pgm--18660099
184180*----to NA (not assigned), reset the eTNI Biller back to its------18661099
184190*----original Biller as determined from 1st pos of NGP.-----------18662099
184200*----This will work regardless of eTNI already having a Status of-18663099
184210*----NA or Biller trying to change eTNI's Status to NA.-----------18664099
184220*----(first, default CTN-INV Biller to input Biller,      test)---18665099
184230                                                                  18666099
184240     MOVE WS-CTNIN-BILLER-ID TO BILLER-ID OF DCLCTN-INV           18667099
184250     MOVE 0 TO BILLER-ID-NI OF DCLCTN-INV-NULL-INDS               18668099
184260                                                                  18669099
184270**  JA0402E  -  Below                                             18670099
184280*****IF WS-CTNIN-BILLER-ID = 'R' AND                              18671099
184290                                                                  18672099
184300     IF  WS-LEGIT-BILLER-ID-RESELLER  AND                         18673099
184310        CTN-STATUS OF DCLCTN-INV = 'NA'                           18674099
184320*-------NGP Extension Project:                                    18675099
184330*-------no longer get Biller from 1st pos of NGP in CTN-INV-------18676099
184340*-------but rather from new Biller-ID column in NUMBER-GROUP table18677099
184350        MOVE WS-ETNDC38-BILLER TO BILLER-ID OF DCLCTN-INV         18678099
184360***     MOVE NGP OF DCLCTN-INV(1:1) TO BILLER-ID OF DCLCTN-INV    18679099
184370     END-IF                                                       18680099
184380                                                                  18681099
184390*----if this is an MDN match, and only PORT-IND changed, but----  18682099
184400*----PORT-IND change was disallowed, do not update history.-----  18683099
184410*----This is for efficiency: prevents needless updates----------  18684099
184420     IF PORT-IND-IS-THE-ONLY-CHANGE = 'Y' AND                     18685099
184430        ALLOW-PORT-IND-CHG NOT = 'Y'                              18686099
184440        MOVE ZERO TO SQLCODE                                      18687099
184450        GO TO 7010-EXIT                                           18688099
184460     END-IF                                                       18689099
184470                                                                  18690099
184540     PERFORM 7550-CHECK-HIST-FOR-TRX-DATE THRU 7550-EXIT          18691099
184550                                                                  18692099
184560*----New as of 3/30/05. If we're updating CTN-INV as a result of--18693099
184570*----an RSS forced-MDN-match (see 2000-PROGRAM-MAIN), update the--18694099
184580*----CTN-INV row with the input Biller's file Biller-ID-----------18695099
184590     IF FORCED-MDN-MATCH-FLAG = 'Y'                               18696099
184600        MOVE WS-SAVE-MDNIN-BILLER-ID TO BILLER-ID OF DCLCTN-INV   18697099
184610     END-IF                                                       18698099
184620                                                                  18699099
184630     MOVE  LIT-PGM-ID  TO  OPERATOR-ID  IN  DCLCTN-INV            18700099
184640                                                                  18701099
184650*----New as of 5/31/05. If we're updating CTN-INV row that's in NH18702099
184660*----status with another status, null out the ICC-ID column which-18703099
184670*----contains the Hold-Description.-------------------------------18704099
184680     IF NULL-ICC-ID-FLAG = 'Y'                                    18705099
184690        MOVE SPACE TO NULL-ICC-ID-FLAG                            18706099
184700        MOVE -1 TO ICC-ID-NI OF DCLCTN-INV-NULL-INDS              18707099
184710        INITIALIZE ICC-ID OF DCLCTN-INV                           18708099
184720     END-IF                                                       18709099
184730                                                                  18710099
184740*  JA1011                                                         18711099
184750     IF  MDN-MATCH-FLAG  =  'Y'                                   18712099
184760        IF  MDNIN-MDN-STATUS  =  WS-CTNIN-CTN-STATUS              18713099
184770            MOVE  LAST-TRX-DATE OF DCLCTN-INV  TO                 18714099
184780                  WS-BILL-LAST-TRX-DATE-1                         18715099
184790            IF  WS-BILL-LAST-TRX-1-MS  NUMERIC  AND               18716099
184800                WS-BILL-LAST-TRX-1-MS  <  '999999'                18717099
184810                ADD  +1  TO   WS-BILL-LAST-TRX-1-MS9              18718099
184820            END-IF                                                18719099
184830            IF  WS-BILL-LAST-TRX-1-MS  NUMERIC  AND               18720099
184840                WS-BILL-LAST-TRX-1-MS  =  '999999'                18721099
184850                MOVE  0  TO   WS-BILL-LAST-TRX-1-MS9              18722099
184860                ADD  +1  TO   WS-BILL-LAST-TRX-1-MS9              18723099
184870            END-IF                                                18724099
184880            MOVE WS-BILL-LAST-TRX-DATE-1 TO                       18725099
184890                                   LAST-TRX-DATE OF DCLCTN-INV    18726099
184900        END-IF                                                    18727099
184910     END-IF                                                       18728099
184920                                                                  18729099
      *  JA0412                                                         18730099
           IF  MDN-NOT-IN-BILL-FLAG  =  'Y'                             18731099
             IF  VTS-MDN                                                18732099
               IF  WS-NEW-STATUS  =  'AA'                               18733099
                 MOVE  WS-BC16-VTS-NIB-DEFAULT  TO  NL  IN  DCLCTN-INV  18734099
                                                    WS-CTNIN-NL         18735099
                 MOVE  0                        TO  NL-NI  IN           18736099
                                                   DCLCTN-INV-NULL-INDS 18737099
               END-IF                                                   18738099
             END-IF                                                     18739099
           END-IF                                                       18740099
                                                                        18741099
           IF  MDN-NOT-IN-BILL-FLAG  =  'Y'                             18742099
             IF  5XX-MDN                                                18743099
               IF  WS-NEW-STATUS  =  'AA'                               18744099
                 MOVE  WS-BC16-5XX-NIB-DEFAULT  TO  NL  IN  DCLCTN-INV  18745099
                                                    WS-CTNIN-NL         18746099
                 MOVE  0                        TO  NL-NI  IN           18747099
                                                   DCLCTN-INV-NULL-INDS 18748099
               END-IF                                                   18749099
             END-IF                                                     18750099
           END-IF                                                       18751099
                                                                        18752099
185140                                                                  18753099
185150*=================================================================18754099
185160*----Based on 2 flags set earlier, the update of CTN-INV comes----18755099
185170*----in 4 different varieties:                                    18756099
185180                                                                  18757099
185190*   (1)                                                           18758099
185200*----Execute the update below if a PORT-IND change was allowed AND18759099
185210*----a MIN-NUM change was allowed (not I2K data)----------------- 18760099
185220     IF ALLOW-PORT-IND-CHG = 'Y' AND                              18761099
185230        IS-THIS-I2K-INPUT NOT = 'Y'                               18762099
185240        INITIALIZE CTN-HAS-VZW-SPID ALLOW-PORT-IND-CHG            18763099
185250        EXEC SQL                                                  18764099
185260        UPDATE CTN_INV                                            18765099
185270        SET                                                       18766099
185280*-----AGB 10/17/05---populate SYS-UPDATE-DATE with dynamic date---18767099
185290        SYS_UPDATE_DATE = CURRENT TIMESTAMP + :WS-HRS HOURS,      18768099
185300        BILLER_ID       = :DCLCTN-INV.BILLER-ID                   18769099
185310                          :DCLCTN-INV-NULL-INDS.BILLER-ID-NI,     18770099
185320        OPERATOR_ID     = :DCLCTN-INV.OPERATOR-ID                 18771099
185330                          :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI,   18772099
185340        LAST_TRX_DATE   = :DCLCTN-INV.LAST-TRX-DATE,              18773099
185350        LAST_TRX_CODE   = :DCLCTN-INV.LAST-TRX-CODE,              18774099
185360        CTN_STATUS      = :DCLCTN-INV.CTN-STATUS,                 18775099
185370        LAST_TRX_UID    = :DCLCTN-INV.LAST-TRX-UID,               18776099
185380        NL              = :DCLCTN-INV.NL                          18777099
185390                          :DCLCTN-INV-NULL-INDS.NL-NI,            18778099
185400        NGP             = :DCLCTN-INV.NGP,                        18779099
185410        ICC_ID          = :DCLCTN-INV.ICC-ID                      18780099
185420                          :DCLCTN-INV-NULL-INDS.ICC-ID-NI,        18781099
185430        HOLD_REASON     = :DCLCTN-INV.HOLD-REASON                 18782099
185440                          :DCLCTN-INV-NULL-INDS.HOLD-REASON-NI,   18783099
185450        PORT_IND        = :DCLCTN-INV.PORT-IND                    18784099
185460                          :DCLCTN-INV-NULL-INDS.PORT-IND-NI,      18785099
185470        MIN_NUM         = :DCLCTN-INV.MIN-NUM                     18786099
185480                          :DCLCTN-INV-NULL-INDS.MIN-NUM-NI,       18787099
185490        PREPAID_IND     = :DCLCTN-INV.PREPAID-IND                 18788099
185500                          :DCLCTN-INV-NULL-INDS.PREPAID-IND-NI,   18789099
185510        PRODUCT_TYPE    = :DCLCTN-INV.PRODUCT-TYPE                18790099
185520        WHERE                                                     18791099
185530          CTN           = :WS-MDN                                 18792099
185540      END-EXEC                                                    18793099
185550      GO TO 7010-CHECK-SQLCODE                                    18794099
185560      END-IF                                                      18795099
185570                                                                  18796099
185580*   (2)                                                           18797099
185590*----Execute the update below if a PORT-IND change was allowed AND18798099
185600*----a MIN-NUM change was NOT allowed (it's I2K data)-------------18799099
185610     IF ALLOW-PORT-IND-CHG = 'Y' AND                              18800099
185620        IS-THIS-I2K-INPUT = 'Y'                                   18801099
185630        INITIALIZE CTN-HAS-VZW-SPID ALLOW-PORT-IND-CHG            18802099
185640****    DISPLAY                                                   18803099
185650****    'MIN change Disallowed.  CTN: ' WS-CTNIN-CTN-TEXT(1:10)   18804099
185660****    '   Stays: ' WS-CTNIN-MIN-NUM-TEXT(1:10)                  18805099
185670        EXEC SQL                                                  18806099
185680        UPDATE CTN_INV                                            18807099
185690        SET                                                       18808099
185700*-----AGB 10/17/05---populate SYS-UPDATE-DATE with dynamic date---18809099
185710        SYS_UPDATE_DATE = CURRENT TIMESTAMP + :WS-HRS HOURS,      18810099
185720        BILLER_ID       = :DCLCTN-INV.BILLER-ID                   18811099
185730                          :DCLCTN-INV-NULL-INDS.BILLER-ID-NI,     18812099
185740        OPERATOR_ID     = :DCLCTN-INV.OPERATOR-ID                 18813099
185750                          :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI,   18814099
185760        LAST_TRX_DATE   = :DCLCTN-INV.LAST-TRX-DATE,              18815099
185770        LAST_TRX_CODE   = :DCLCTN-INV.LAST-TRX-CODE,              18816099
185780        CTN_STATUS      = :DCLCTN-INV.CTN-STATUS,                 18817099
185790        LAST_TRX_UID    = :DCLCTN-INV.LAST-TRX-UID,               18818099
185800        NL              = :DCLCTN-INV.NL                          18819099
185810                          :DCLCTN-INV-NULL-INDS.NL-NI,            18820099
185820        NGP             = :DCLCTN-INV.NGP,                        18821099
185830        ICC_ID          = :DCLCTN-INV.ICC-ID                      18822099
185840                          :DCLCTN-INV-NULL-INDS.ICC-ID-NI,        18823099
185850        HOLD_REASON     = :DCLCTN-INV.HOLD-REASON                 18824099
185860                          :DCLCTN-INV-NULL-INDS.HOLD-REASON-NI,   18825099
185870        PORT_IND        = :DCLCTN-INV.PORT-IND                    18826099
185880                          :DCLCTN-INV-NULL-INDS.PORT-IND-NI,      18827099
185890        PREPAID_IND     = :DCLCTN-INV.PREPAID-IND                 18828099
185900                          :DCLCTN-INV-NULL-INDS.PREPAID-IND-NI,   18829099
185910        PRODUCT_TYPE    = :DCLCTN-INV.PRODUCT-TYPE                18830099
185920        WHERE                                                     18831099
185930          CTN           = :WS-MDN                                 18832099
185940      END-EXEC                                                    18833099
185950      GO TO 7010-CHECK-SQLCODE                                    18834099
185960      END-IF                                                      18835099
185970                                                                  18836099
185980*   (3)                                                           18837099
185990*----Execute the update below if a PORT-IND change NOT allowed AND18838099
186000*----a MIN-NUM change was allowed (not I2K data)------------------18839099
186010     IF ALLOW-PORT-IND-CHG NOT = 'Y' AND                          18840099
186020        IS-THIS-I2K-INPUT NOT = 'Y'                               18841099
186030        INITIALIZE CTN-HAS-VZW-SPID ALLOW-PORT-IND-CHG            18842099
186040****    DISPLAY                                                   18843099
186050****    'MIN change allowed.  CTN: ' WS-CTNIN-CTN-TEXT(1:10)      18844099
186060****    '   From: ' WS-CTNIN-MIN-NUM-TEXT(1:10)                   18845099
186070****    '   To: ' MIN-NUM OF DCLCTN-INV(3:10)                     18846099
186080        EXEC SQL                                                  18847099
186090        UPDATE CTN_INV                                            18848099
186100        SET                                                       18849099
186110*-----AGB 10/17/05---populate SYS-UPDATE-DATE with dynamic date---18850099
186120        SYS_UPDATE_DATE = CURRENT TIMESTAMP + :WS-HRS HOURS,      18851099
186130        BILLER_ID       = :DCLCTN-INV.BILLER-ID                   18852099
186140                          :DCLCTN-INV-NULL-INDS.BILLER-ID-NI,     18853099
186150        OPERATOR_ID     = :DCLCTN-INV.OPERATOR-ID                 18854099
186160                          :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI,   18855099
186170        LAST_TRX_DATE   = :DCLCTN-INV.LAST-TRX-DATE,              18856099
186180        LAST_TRX_CODE   = :DCLCTN-INV.LAST-TRX-CODE,              18857099
186190        CTN_STATUS      = :DCLCTN-INV.CTN-STATUS,                 18858099
186200        LAST_TRX_UID    = :DCLCTN-INV.LAST-TRX-UID,               18859099
186210        NL              = :DCLCTN-INV.NL                          18860099
186220                          :DCLCTN-INV-NULL-INDS.NL-NI,            18861099
186230        NGP             = :DCLCTN-INV.NGP,                        18862099
186240        ICC_ID          = :DCLCTN-INV.ICC-ID                      18863099
186250                          :DCLCTN-INV-NULL-INDS.ICC-ID-NI,        18864099
186260        HOLD_REASON     = :DCLCTN-INV.HOLD-REASON                 18865099
186270                          :DCLCTN-INV-NULL-INDS.HOLD-REASON-NI,   18866099
186280        MIN_NUM         = :DCLCTN-INV.MIN-NUM                     18867099
186290                          :DCLCTN-INV-NULL-INDS.MIN-NUM-NI,       18868099
186300        PREPAID_IND     = :DCLCTN-INV.PREPAID-IND                 18869099
186310                          :DCLCTN-INV-NULL-INDS.PREPAID-IND-NI,   18870099
186320        PRODUCT_TYPE    = :DCLCTN-INV.PRODUCT-TYPE                18871099
186330        WHERE                                                     18872099
186340          CTN           = :WS-MDN                                 18873099
186350      END-EXEC                                                    18874099
186360      GO TO 7010-CHECK-SQLCODE                                    18875099
186370      END-IF                                                      18876099
186380                                                                  18877099
186390*   (4)                                                           18878099
186400*----Execute the update below if a PORT-IND change NOT allowed AND18879099
186410*----a MIN-NUM change was NOT allowed (it's I2K data)-------------18880099
186420     IF ALLOW-PORT-IND-CHG NOT = 'Y' AND                          18881099
186430        IS-THIS-I2K-INPUT = 'Y'                                   18882099
186440        INITIALIZE CTN-HAS-VZW-SPID ALLOW-PORT-IND-CHG            18883099
186450****    DISPLAY                                                   18884099
186460****    'MIN change Disallowed.  CTN: ' WS-CTNIN-CTN-TEXT(1:10)   18885099
186470****    '   Stays: ' WS-CTNIN-MIN-NUM-TEXT(1:10)                  18886099
186480        EXEC SQL                                                  18887099
186490        UPDATE CTN_INV                                            18888099
186500        SET                                                       18889099
186510*-----AGB 10/17/05---populate SYS-UPDATE-DATE with dynamic date---18890099
186520        SYS_UPDATE_DATE = CURRENT TIMESTAMP + :WS-HRS HOURS,      18891099
186530        BILLER_ID       = :DCLCTN-INV.BILLER-ID                   18892099
186540                          :DCLCTN-INV-NULL-INDS.BILLER-ID-NI,     18893099
186550        OPERATOR_ID     = :DCLCTN-INV.OPERATOR-ID                 18894099
186560                          :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI,   18895099
186570        LAST_TRX_DATE   = :DCLCTN-INV.LAST-TRX-DATE,              18896099
186580        LAST_TRX_CODE   = :DCLCTN-INV.LAST-TRX-CODE,              18897099
186590        CTN_STATUS      = :DCLCTN-INV.CTN-STATUS,                 18898099
186600        LAST_TRX_UID    = :DCLCTN-INV.LAST-TRX-UID,               18899099
186610        NL              = :DCLCTN-INV.NL                          18900099
186620                          :DCLCTN-INV-NULL-INDS.NL-NI,            18901099
186630        NGP             = :DCLCTN-INV.NGP,                        18902099
186640        ICC_ID          = :DCLCTN-INV.ICC-ID                      18903099
186650                          :DCLCTN-INV-NULL-INDS.ICC-ID-NI,        18904099
186660        HOLD_REASON     = :DCLCTN-INV.HOLD-REASON                 18905099
186670                          :DCLCTN-INV-NULL-INDS.HOLD-REASON-NI,   18906099
186680        PREPAID_IND     = :DCLCTN-INV.PREPAID-IND                 18907099
186690                          :DCLCTN-INV-NULL-INDS.PREPAID-IND-NI,   18908099
186700        PRODUCT_TYPE    = :DCLCTN-INV.PRODUCT-TYPE                18909099
186710        WHERE                                                     18910099
186720          CTN           = :WS-MDN                                 18911099
186730      END-EXEC                                                    18912099
186740      GO TO 7010-CHECK-SQLCODE                                    18913099
186750      END-IF.                                                     18914099
186760                                                                  18915099
186770 7010-CHECK-SQLCODE.                                              18916099
186780******************************************************************18917099
186790*                                                                 18918099
186800*   PARAGRAPH NAME:  7010-CHECK-SQLCODE                           18919099
186810*                                                                 18920099
186820*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO TRY TO DO         18921099
186830*                    FIGURE OUT SQLCODE RETURN BY DB2             18922099
186840*                                                                 18923099
186880******************************************************************18924099
186890                                                                  18925099
186900     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    18926099
186910                                                                  18927099
186920     IF SQL-SUCCESS                                               18928099
186930        ADD +1 TO WS-TOTL-ETNI-CTNINV-UPD-CNT                     18929099
186940        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          18930099
186950     ELSE                                                         18931099
186960        DISPLAY ' '                                               18932099
186970        DISPLAY '     In 7010-UPDATE-CTN-INV'                     18933099
186980        DISPLAY '>>>> MDN/CTN at Abend Time: ' WS-MDN ' <<<<'     18934099
186990        DISPLAY '>>>> Biller at Abend Time: '                     18935099
187000                 WS-SAVE-HDR-BILLER-ID ' <<<<'                    18936099
187010        DISPLAY ' '                                               18937099
187020        PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT               18938099
187030        MOVE    SQLCODE TO WS-ABEND-CODE                          18939099
187040        STRING 'FATAL SQL ERROR!!!  SQLCODE: '                    18940099
187050                WS-ABEND-CODE                                     18941099
187060                DELIMITED BY SIZE                                 18942099
187070                INTO WS-ABEND-TEXT                                18943099
187080        END-STRING                                                18944099
187090        PERFORM 9000-ABORT           THRU 9000-EXIT               18945099
187100     END-IF                                                       18946099
187110                                                                  18947099
187120     .                                                            18948099
187130 7010-EXIT.                                                       18949099
187140     EXIT.                                                        18950099
187150                                                                  18951099
187160 7015-UPDATE-CTN-INV-STATUS.                                      18952099
187170******************************************************************18953099
187180*                                                                 18954099
187190*   PARAGRAPH NAME:  7015-UPDATE-CTN-INV-STATUS                   18955099
187200*                                                                 18956099
187210*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO TRY TO DO         18957099
187220*                    UPDATE STATUS FOR                            18958099
187230*                    ROWS FROM CTN-INV         OF ETNI TABLE      18959099
187240*                                                                 18960099
187280******************************************************************18961099
187290     MOVE '7015-UPDATE-CTN-INV-STATUS' TO WS-CURR-PARA            18962099
187300                                                                  18963099
187310     MOVE WS-CTNIN-CTN-TEXT (1:WS-CTNIN-CTN-LEN) TO WS-MDN        18964099
187320     MOVE WS-CTNIN-PRODUCT-TYPE TO   WS-PRODUCT-TYPE              18965099
187330*--* #850803-2 LMS 4/21/2003 begin                                18966099
187340*--* Inserted code so that when MDN is in eTNI but not in billing 18967099
187350*--* system, status not to be updated to NA if the Port Indicator 18968099
187360*--* is PO or PI if the Run Mode is UPDDNA.                       18969099
187370*--* LMS 10/17/2003 begin added IO port ind to this code          18970099
187380     IF WS-CTNIN-PORT-IND = 'PO' OR 'PI' OR 'IO'                  18971099
187390*--* LMS 10/17/2003 end added IO port ind to this code            18972099
187400         MOVE WS-OLD-STATUS TO CTN-STATUS OF DCLCTN-INV           18973099
187410     ELSE                                                         18974099
187420*        (below moves for NON-Ported CTNs)                        18975099
187430         MOVE 'NA' TO CTN-STATUS OF DCLCTN-INV                    18976099
187440         MOVE -1 TO MIN-NUM-NI OF DCLCTN-INV-NULL-INDS            18977099
187450         MOVE LOW-VALUES TO MIN-NUM-TEXT OF DCLCTN-INV            18978099
187460         MOVE -1 TO NL-NI OF DCLCTN-INV-NULL-INDS                 18979099
187470         MOVE LOW-VALUES TO NL OF DCLCTN-INV                      18980099
187480     END-IF                                                       18981099
187490     MOVE 'CNV'                 TO LAST-TRX-CODE   OF DCLCTN-INV  18982099
187500     MOVE WS-TIMESTAMP          TO SYS-UPDATE-DATE OF DCLCTN-INV  18983099
187510     MOVE WS-TIMESTAMP          TO LAST-TRX-DATE   OF DCLCTN-INV  18984099
187520     MOVE LIT-OPERATOR-ID       TO OPERATOR-ID     OF DCLCTN-INV  18985099
187530     MOVE WS-CTNIN-NGP          TO NGP             OF DCLCTN-INV  18986099
187540*     when updating to NA or PO Status, set PrePaid Ind to Space  18987099
187550     IF CTN-STATUS OF DCLCTN-INV = 'NA' OR                        18988099
187560        CTN-STATUS OF DCLCTN-INV = 'PO'                           18989099
187570        MOVE SPACE TO PREPAID-IND OF DCLCTN-INV                   18990099
187580     END-IF                                                       18991099
187590                                                                  18992099
187600*  JA1011                                                         18993099
187610     IF  MDN-MATCH-FLAG  =  'Y'                                   18994099
187620        IF  MDNIN-MDN-STATUS  =  WS-CTNIN-CTN-STATUS              18995099
187630            MOVE  LAST-TRX-DATE OF DCLCTN-INV  TO                 18996099
187640                  WS-BILL-LAST-TRX-DATE-1                         18997099
187650            IF  WS-BILL-LAST-TRX-1-MS  NUMERIC  AND               18998099
187660                WS-BILL-LAST-TRX-1-MS  <  '999999'                18999099
187670                ADD  +1  TO   WS-BILL-LAST-TRX-1-MS9              19000099
187680            END-IF                                                19001099
187690            IF  WS-BILL-LAST-TRX-1-MS  NUMERIC  AND               19002099
187700                WS-BILL-LAST-TRX-1-MS  =  '999999'                19003099
187710                MOVE  0  TO   WS-BILL-LAST-TRX-1-MS9              19004099
187720                ADD  +1  TO   WS-BILL-LAST-TRX-1-MS9              19005099
187730            END-IF                                                19006099
187740            MOVE WS-BILL-LAST-TRX-DATE-1 TO                       19007099
187750                                   LAST-TRX-DATE OF DCLCTN-INV    19008099
187760        END-IF                                                    19009099
187770     END-IF                                                       19010099
187780                                                                  19011099
187790     PERFORM 2145-SET-CTNINV-NULL-INDS THRU 2145-EXIT             19012099
187800     MOVE '7015-UPDATE-CTN-INV-STATUS' TO WS-CURR-PARA            19013099
187810                                                                  19014099
187820*----AGB 12/11/2003: move null to MIN only for Ported Out CTNs----19015099
187830     IF WS-CTNIN-PORT-IND = 'PO' OR                               19016099
187840        WS-CTNIN-PORT-IND = 'IO'                                  19017099
187850        MOVE LOW-VALUES TO MIN-NUM-TEXT OF DCLCTN-INV             19018099
187860        MOVE -1 TO MIN-NUM-NI                                     19019099
187870     END-IF                                                       19020099
187880                                                                  19021099
187890*----AGB 5/31/05: when updating to NA, clear HOLD-REASON & ICC-ID-19022099
187900     IF CTN-STATUS OF DCLCTN-INV = 'NA'                           19023099
187910        MOVE SPACE TO HOLD-REASON OF DCLCTN-INV                   19024099
187920        MOVE -1 TO HOLD-REASON-NI OF DCLCTN-INV-NULL-INDS         19025099
187930        INITIALIZE ICC-ID OF DCLCTN-INV                           19026099
187940        MOVE -1 TO ICC-ID-NI OF DCLCTN-INV-NULL-INDS              19027099
187950     END-IF                                                       19028099
187960                                                                  19029099
187970*  JA1108  -  Split  Logic                                        19030099
187980     IF  WS-SPLIT                                                 19031099
187990         MOVE  'NH'     TO  CTN-STATUS   OF  DCLCTN-INV           19032099
188000         MOVE  0        TO  HOLD-REASON-NI  OF                    19033099
188010                                             DCLCTN-INV-NULL-INDS 19034099
188020         MOVE  'SPLIT'  TO  HOLD-REASON  OF  DCLCTN-INV           19035099
188030     END-IF                                                       19036099
188040                                                                  19037099
188050*----AGB 10/22/2004: ---------------------------------------------19038099
188060*----if eTNI Biller is "R" (RSS) and its status was reset by pgm--19039099
188070*----to NA (not assigned), reset the eTNI Biller back to its------19040099
188080*----original Biller as determined from 1st pos of NGP.-----------19041099
188090*----This will work regardless of eTNI already having a Status of-19042099
188100*----NA or Biller trying to change eTNI's Status to NA.-----------19043099
188110*----(first, default CTN-INV Biller to input Biller,      test)---19044099
188120                                                                  19045099
188130*    JA0320  -   Revision                                         19046099
188140                                                                  19047099
188150*----Now  For  VISION  &  RSS                                     19048099
188160*----reset the eTNI Biller back to its  Original  per  NGP        19049099
188170**** IF WS-CTNIN-BILLER-ID = 'R' AND   ****  per  Below  IF       19050099
188180                                                                  19051099
188190     MOVE WS-CTNIN-BILLER-ID TO BILLER-ID OF DCLCTN-INV           19052099
188200     MOVE 0 TO BILLER-ID-NI OF DCLCTN-INV-NULL-INDS               19053099
188210                                                                  19054099
188220**  JA0402  -   OPC  - Added  -                                   19055099
188230**** IF  (WS-VISION  OR  WS-RSS)  AND                             19056099
188240                                                                  19057099
188250*  JA1108  -  Split  Logic  Included  In  'NH'  Below             19058099
188260                                                                  19059099
188270     IF  WS-LEGIT-BILLER-ID-ALL   AND                             19060099
188280       (CTN-STATUS OF DCLCTN-INV = 'NA'  OR                       19061099
188290        CTN-STATUS OF DCLCTN-INV = 'NH')                          19062099
188300*-------NGP Extension Project:                                    19063099
188310*-------no longer get Biller from 1st pos of NGP in CTN-INV-------19064099
188320*-------but rather from new Biller-ID column in NUMBER-GROUP table19065099
188330        MOVE WS-ETNDC38-BILLER TO BILLER-ID OF DCLCTN-INV         19066099
188340***     MOVE NGP OF DCLCTN-INV(1:1) TO BILLER-ID OF DCLCTN-INV    19067099
188350     END-IF                                                       19068099
188360                                                                  19069099
188370*----NEW as of 11/18/04. To prevent possibility of LAST-TRX-DATE--19070099
188380*----duplicates ending up in CTN-INV-HISTORY when CTN-INV row is--19071099
188390*----later written to History, check to see if there's already----19072099
188400*----a History row from this CTN with the same LAST-TRX-DATE.-----19073099
188410*----If so, increment the LAST-TRX-DATE and replace it back into--19074099
188420*----CTN-INV Dclgen prior to update below. (tries up to 20 times)-19075099
188430                                                                  19076099
188440     PERFORM 7550-CHECK-HIST-FOR-TRX-DATE THRU 7550-EXIT          19077099
188450                                                                  19078099
188460*----AGB 5/31/05: when updating to NA, clear HOLD-REASON & ICC-ID-19079099
188470     IF CTN-STATUS OF DCLCTN-INV = 'NA'  OR                       19080099
188480        CTN-STATUS OF DCLCTN-INV = 'NH'                           19081099
188490**  JA1210  -  Clear  4G                                          19082099
188500        MOVE  SPACES  TO  ICC-ID-4G  OF DCLCTN-INV                19083099
188510                          IMSI       OF DCLCTN-INV                19084099
188520        EXEC SQL                                                  19085099
188530         UPDATE CTN_INV                                           19086099
188540         SET                                                      19087099
188550*-----AGB 10/17/05---populate SYS-UPDATE-DATE with dynamic date---19088099
188560         SYS_UPDATE_DATE = CURRENT TIMESTAMP + :WS-HRS HOURS,     19089099
188570         OPERATOR_ID     = :DCLCTN-INV.OPERATOR-ID                19090099
188580                           :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI,  19091099
188590         BILLER_ID       = :DCLCTN-INV.BILLER-ID                  19092099
188600                           :DCLCTN-INV-NULL-INDS.BILLER-ID-NI,    19093099
188610         LAST_TRX_DATE   = :DCLCTN-INV.LAST-TRX-DATE,             19094099
188620         LAST_TRX_CODE   = :DCLCTN-INV.LAST-TRX-CODE,             19095099
188630         CTN_STATUS      = :DCLCTN-INV.CTN-STATUS,                19096099
188640         NL              = :DCLCTN-INV.NL                         19097099
188650                           :DCLCTN-INV-NULL-INDS.NL-NI,           19098099
188660         HOLD_REASON     = :DCLCTN-INV.HOLD-REASON                19099099
188670                           :DCLCTN-INV-NULL-INDS.HOLD-REASON-NI,  19100099
188680         ICC_ID         =  :DCLCTN-INV.ICC-ID                     19101099
188690                           :DCLCTN-INV-NULL-INDS.ICC-ID-NI,       19102099
188700         MIN_NUM         = :DCLCTN-INV.MIN-NUM                    19103099
188710                           :DCLCTN-INV-NULL-INDS.MIN-NUM-NI,      19104099
188720         PREPAID_IND     = :DCLCTN-INV.PREPAID-IND                19105099
188730                           :DCLCTN-INV-NULL-INDS.PREPAID-IND-NI,  19106099
188740         IMSI            = :DCLCTN-INV.IMSI,                      19107099
188750         ICC_ID_4G       = :DCLCTN-INV.ICC-ID-4G                  19108099
188760     WHERE                                                        19109099
188770         CTN             = :WS-MDN                                19110099
188780     END-EXEC                                                     19111099
188790     ELSE                                                         19112099
188800     IF CTN-STATUS OF DCLCTN-INV NOT = 'NA'                       19113099
188810*----AGB 5/31/05: when updating to non-NA, keep Hold-Reason & ICC-19114099
188820     EXEC SQL                                                     19115099
188830         UPDATE CTN_INV                                           19116099
188840       SET                                                        19117099
188850*-----AGB 10/17/05---populate SYS-UPDATE-DATE with dynamic date---19118099
188860         SYS_UPDATE_DATE = CURRENT TIMESTAMP + :WS-HRS HOURS,     19119099
188870         OPERATOR_ID     = :DCLCTN-INV.OPERATOR-ID                19120099
188880                           :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI,  19121099
188890         BILLER_ID       = :DCLCTN-INV.BILLER-ID                  19122099
188900                           :DCLCTN-INV-NULL-INDS.BILLER-ID-NI,    19123099
188910         LAST_TRX_DATE   = :DCLCTN-INV.LAST-TRX-DATE,             19124099
188920         LAST_TRX_CODE   = :DCLCTN-INV.LAST-TRX-CODE,             19125099
188930         CTN_STATUS      = :DCLCTN-INV.CTN-STATUS,                19126099
188940         NL              = :DCLCTN-INV.NL                         19127099
188950                           :DCLCTN-INV-NULL-INDS.NL-NI,           19128099
188960         MIN_NUM         = :DCLCTN-INV.MIN-NUM                    19129099
188970                           :DCLCTN-INV-NULL-INDS.MIN-NUM-NI,      19130099
188980         PREPAID_IND     = :DCLCTN-INV.PREPAID-IND                19131099
188990                           :DCLCTN-INV-NULL-INDS.PREPAID-IND-NI   19132099
189000     WHERE                                                        19133099
189010         CTN             = :WS-MDN                                19134099
189020     END-EXEC                                                     19135099
189030     END-IF                                                       19136099
189040                                                                  19137099
189050     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    19138099
189060                                                                  19139099
189070     IF SQL-SUCCESS                                               19140099
189080        ADD +1 TO WS-TOTL-ETNI-CTNINV-UPD-ST-CNT                  19141099
189090        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          19142099
189100     ELSE                                                         19143099
189110        DISPLAY ' '                                               19144099
189120        DISPLAY '     In 7015-UPDATE-CTN-INV-STATUS'              19145099
189130        DISPLAY '>>>> MDN/CTN at Abend Time: ' WS-MDN ' <<<<'     19146099
189140        DISPLAY ' '                                               19147099
189150        PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT               19148099
189160        MOVE    SQLCODE TO WS-ABEND-CODE                          19149099
189170        STRING 'FATAL SQL ERROR!!!  SQLCODE: '                    19150099
189180                WS-ABEND-CODE                                     19151099
189190                DELIMITED BY SIZE                                 19152099
189200                INTO WS-ABEND-TEXT                                19153099
189210        END-STRING                                                19154099
189220        PERFORM 9000-ABORT           THRU 9000-EXIT               19155099
189230     END-IF                                                       19156099
189240     .                                                            19157099
189250 7015-EXIT.                                                       19158099
189260     EXIT.                                                        19159099
189270                                                                  19160099
189280 7019-UPDATE-CTN-INV-STATUS.                                      19161099
189290                                                                  19162099
189290**  JA1012  -  Below  Cond                                        19163099
189290                                                                  19164099
189580     IF  WS-CTNIN-NL(2:4)  NOT  =  'RTEL'                         19165099
189580         GO  TO  7019-EXIT                                        19166099
189580     END-IF                                                       19167099
189290                                                                  19168099
189300     MOVE  'AA'  TO  CTN-STATUS  OF  DCLCTN-INV                   19169099
189310                     WS-NEW-STATUS                                19170099
189320                                                                  19171099
189330     MOVE 'CNV'                 TO LAST-TRX-CODE   OF DCLCTN-INV  19172099
189340                                                                  19173099
189350     MOVE WS-TIMESTAMP          TO SYS-UPDATE-DATE OF DCLCTN-INV  19174099
189360                                   LAST-TRX-DATE   OF DCLCTN-INV  19175099
189370                                                                  19176099
189380     MOVE LIT-OPERATOR-ID       TO OPERATOR-ID     OF DCLCTN-INV  19177099
189390                                                                  19178099
189400**  Note:  BILLER-ID OF DCLCTN-INV, Is Sourced from:              19179099
189410**                                  Number-Group  table           19180099
189420                                                                  19181099
189430**  JA0809A  -  Permanent  Reserves,   Retail  Only      ***      19182099
189440***                                                      ***      19183099
189450***  IF  WS-SAVED-NL(1:2)  =  'H'                        ***      19184099
189460***      AND  WS-LEGIT-BILLER-ID-RETAIL                  ***      19185099
189470***                                                               19186099
189480                                                                  19187099
189490     MOVE  BILLER-ID OF DCLCTN-INV                                19188099
189500                               TO  NL        OF DCLCTN-INV(1:1)   19189099
189510                                                                  19190099
189520     MOVE 'RET '             TO  NL                               19191099
189530                                             OF DCLCTN-INV(2:4)   19192099
189540**  JA0312A  -                                                    19193099
189540**  JA0912   -                                                    19194099
057270*   JA1012  -  Below  Comment  VRTEL                              19195099
057270*   JA1012  -  Force  Biller-ID  back  to   'R'                   19196099
189550                                                                  19197099
           IF  WS-VISION                                                19198099
189570         IF  WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA   19199099
189580             IF  WS-CTNIN-NL(2:4)  =  'RTEL'                      19200099
189580******       IF  WS-CTNIN-NL       =  'VRTEL'                     19201099
189590                 IF  RELATED-NL  OF  DCLNUMBER-LOCATION  >  ' '   19202099
189600                     MOVE  RELATED-NL  OF  DCLNUMBER-LOCATION  TO 19203099
189610                                   NL        OF DCLCTN-INV        19204099
189780                     MOVE  'R'   TO        BILLER-ID              19205099
189780                                            OF  DCLCTN-INV        19206099
189620                 END-IF                                           19207099
189590                 IF  RELATED-NL  OF  DCLNUMBER-LOCATION  =  ' '   19208099
189600                     MOVE  WS-CTNIN-NL  TO                        19209099
189610                                   NL        OF DCLCTN-INV        19210099
189620                 END-IF                                           19211099
189620                 IF  MDN-NOT-IN-BILL-FLAG  =  'Y'                 19212099
189620                   IF  WS-CTNIN-CTN-STATUS                        19213099
189620                                        =  ('AG' or 'PA' or 'AR') 19214099
189620                       MOVE  'AA'  TO   CTN-STATUS  OF DCLCTN-INV 19215099
189630                   END-IF                                         19216099
189630                 END-IF                                           19217099
189630             END-IF                                               19218099
189640         END-IF                                                   19219099
189650     END-IF                                                       19220099
189660                                                                  19221099
189670**  JA0312A  -                                                    19222099
189680                                                                  19223099
189690     IF  WS-VISION                                                19224099
189700         IF  WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA   19225099
189710             IF  WS-CTNIN-NL(2:1)  =  'H'                         19226099
189720                     MOVE  WS-CTNIN-NL  TO  NL                    19227099
189730                                             OF DCLCTN-INV        19228099
189740             END-IF                                               19229099
189750         END-IF                                                   19230099
189760     END-IF                                                       19231099
189770                                                                  19232099
189780     MOVE  0     TO        BILLER-ID-NI  OF  DCLCTN-INV-NULL-INDS 19233099
189790                           NL-NI         OF  DCLCTN-INV-NULL-INDS 19234099
189800*  JA1210                                                         19235099
189810     MOVE  SPACES  TO      ICC-ID-4G     OF  DCLCTN-INV           19236099
189820                           IMSI          OF  DCLCTN-INV           19237099
189830                                                                  19238099
189840     EXEC SQL                                                     19239099
189850                                                                  19240099
189860       UPDATE CTN_INV                                             19241099
189870                                                                  19242099
189880         SET                                                      19243099
189890                                                                  19244099
189900         SYS_UPDATE_DATE  =   CURRENT TIMESTAMP + :WS-HRS HOURS,  19245099
189910         OPERATOR_ID      =  :DCLCTN-INV.OPERATOR-ID,             19246099
189920         LAST_TRX_DATE    =  :DCLCTN-INV.LAST-TRX-DATE,           19247099
189930         LAST_TRX_CODE    =  :DCLCTN-INV.LAST-TRX-CODE,           19248099
189940         CTN_STATUS       =  :DCLCTN-INV.CTN-STATUS,              19249099
189950         NL               =  :DCLCTN-INV.NL                       19250099
189960                             :DCLCTN-INV-NULL-INDS.NL-NI,         19251099
189970         BILLER_ID        =  :DCLCTN-INV.BILLER-ID                19252099
189980                             :DCLCTN-INV-NULL-INDS.BILLER-ID-NI,  19253099
189990         IMSI             =  :DCLCTN-INV.IMSI,                    19254099
190000         ICC_ID_4G        =  :DCLCTN-INV.ICC-ID-4G                19255099
190010                                                                  19256099
190020         WHERE   CTN      =  :WS-MDN                              19257099
190030                                                                  19258099
190040     END-EXEC                                                     19259099
190050                                                                  19260099
190060     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    19261099
190070                                                                  19262099
190080     IF SQL-SUCCESS                                               19263099
190090        ADD +1 TO WS-TOTL-ETNI-CTNINV-UPD-ST-CNT                  19264099
190100        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          19265099
190110     ELSE                                                         19266099
190120        DISPLAY ' '                                               19267099
190130        DISPLAY '     In 7019-UPDATE-CTN-INV-STATUS'              19268099
190140        DISPLAY '>>>> MDN/CTN at Abend Time: ' WS-MDN ' <<<<'     19269099
190150        DISPLAY ' '                                               19270099
190160        PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT               19271099
190170        MOVE    SQLCODE TO WS-ABEND-CODE                          19272099
190180        STRING 'FATAL SQL ERROR!!!  SQLCODE: '                    19273099
190190                WS-ABEND-CODE                                     19274099
190200                DELIMITED BY SIZE                                 19275099
190210                INTO WS-ABEND-TEXT                                19276099
190220        END-STRING                                                19277099
190230        PERFORM 9000-ABORT           THRU 9000-EXIT               19278099
190240     END-IF                                                       19279099
190250                                                                  19280099
190260     .                                                            19281099
190270 7019-EXIT.                                                       19282099
190280     EXIT.                                                        19283099
190290                                                                  19284099
190300 7020-INSERT-CTN-INV.                                             19285099
190310******************************************************************19286099
190320*                                                                 19287099
190330*   PARAGRAPH NAME:  7020-INSERT-CTN-INV                          19288099
190340*                                                                 19289099
190350*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO DO                19290099
190360*             INSERT ROWS INTO CTN-INV-HISTORY OF ETNI TABLE      19291099
190370*                                                                 19292099
190420******************************************************************19293099
190430     MOVE '7020-INSERT-CTN-INV' TO WS-CURR-PARA                   19294099
190440                                                                  19295099
190450*----NEW as of 11/18/04. To prevent possibility of LAST-TRX-DATE--19296099
190460*----duplicates ending up in CTN-INV-HISTORY when CTN-INV row is--19297099
190470*----later written to History, check to see if there's already----19298099
190480*----a History row from this CTN with the same LAST-TRX-DATE.-----19299099
190490*----If so, increment the LAST-TRX-DATE and replace it back into--19300099
190500*----CTN-INV Dclgen prior to update below. (tries up to 20 times)-19301099
190510                                                                  19302099
190520     PERFORM 7550-CHECK-HIST-FOR-TRX-DATE THRU 7550-EXIT          19303099
190530                                                                  19304099
190540* JK1008A - START                                                 19305099
190550*---- For non-VZHUB MDNs only:                                    19306099
190560*---- When MDN is in Billing & not in CTN_INV,                    19307099
190570*----     insert with PORT_IND=PI instead of RE.                  19308099
190580     IF  NOT  WS-HUB-BILL                                         19309099
190590        MOVE 'PI'                 TO PORT-IND       OF DCLCTN-INV 19310099
190600        END-IF                                                    19311099
190610* JK1008A -  END                                                  19312099
190620                                                                  19313099
190630     PERFORM 2145-SET-CTNINV-NULL-INDS THRU 2145-EXIT             19314099
190640                                                                  19315099
190650     EXEC SQL                                                     19316099
190660         INSERT INTO CTN_INV                                      19317099
190670          (CTN                                                    19318099
190680          ,SYS_CREATION_DATE                                      19319099
190690          ,SYS_UPDATE_DATE                                        19320099
190700          ,OPERATOR_ID                                            19321099
190710          ,APPLICATION_ID                                         19322099
190720          ,DL_SERVICE_CODE                                        19323099
190730          ,DL_UPDATE_STAMP                                        19324099
190740          ,LAST_TRX_DATE                                          19325099
190750          ,LAST_TRX_CODE                                          19326099
190760          ,CTN_STATUS                                             19327099
190770          ,LAST_TRX_UID                                           19328099
190780          ,NL                                                     19329099
190790          ,NGP                                                    19330099
190800          ,CONV_RUN_NO                                            19331099
190810          ,SPECIAL_TRX_DATE                                       19332099
190820          ,RUN_ID                                                 19333099
190830          ,HOLD_REASON                                            19334099
190840          ,PRODUCT_TYPE                                           19335099
190850          ,ICC_ID                                                 19336099
190860          ,PORT_IND                                               19337099
190870          ,MIN_NUM                                                19338099
190880          ,BILLER_ID                                              19339099
190890          ,STATUS_REASON_CD                                       19340099
190900          ,PREPAID_IND                                            19341099
190910          ,IMSI                                                   19342099
190920          ,ICC_ID_4G)                                             19343099
190930       VALUES                                                     19344099
190940          (:DCLCTN-INV.CTN                                        19345099
190950          ,:DCLCTN-INV.SYS-CREATION-DATE                          19346099
190960*-----AGB 10/17/05---populate SYS-UPDATE-DATE with dynamic date---19347099
190970          ,CURRENT TIMESTAMP + :WS-HRS HOURS                      19348099
190980          ,:DCLCTN-INV.OPERATOR-ID                                19349099
190990                 :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI             19350099
191000          ,:DCLCTN-INV.APPLICATION-ID                             19351099
191010                 :DCLCTN-INV-NULL-INDS.APPLICATION-ID-NI          19352099
191020          ,:DCLCTN-INV.DL-SERVICE-CODE                            19353099
191030          ,:DCLCTN-INV.DL-UPDATE-STAMP                            19354099
191040                 :DCLCTN-INV-NULL-INDS.DL-UPDATE-STAMP-NI         19355099
191050          ,:DCLCTN-INV.LAST-TRX-DATE                              19356099
191060          ,:DCLCTN-INV.LAST-TRX-CODE                              19357099
191070          ,:DCLCTN-INV.CTN-STATUS                                 19358099
191080          ,:DCLCTN-INV.LAST-TRX-UID                               19359099
191090          ,:DCLCTN-INV.NL                                         19360099
191100                 :DCLCTN-INV-NULL-INDS.NL-NI                      19361099
191110          ,:DCLCTN-INV.NGP                                        19362099
191120          ,:DCLCTN-INV.CONV-RUN-NO                                19363099
191130                 :DCLCTN-INV-NULL-INDS.CONV-RUN-NO-NI             19364099
191140          ,:DCLCTN-INV.SPECIAL-TRX-DATE                           19365099
191150                 :DCLCTN-INV-NULL-INDS.SPECIAL-TRX-DATE-NI        19366099
191160          ,:DCLCTN-INV.RUN-ID                                     19367099
191170                 :DCLCTN-INV-NULL-INDS.RUN-ID-NI                  19368099
191180          ,:DCLCTN-INV.HOLD-REASON                                19369099
191190                 :DCLCTN-INV-NULL-INDS.HOLD-REASON-NI             19370099
191200          ,:DCLCTN-INV.PRODUCT-TYPE                               19371099
191210          ,:DCLCTN-INV.ICC-ID                                     19372099
191220                 :DCLCTN-INV-NULL-INDS.ICC-ID-NI                  19373099
191230          ,:DCLCTN-INV.PORT-IND                                   19374099
191240          ,:DCLCTN-INV.MIN-NUM                                    19375099
191250                 :DCLCTN-INV-NULL-INDS.MIN-NUM-NI                 19376099
191260          ,:DCLCTN-INV.BILLER-ID                                  19377099
191270                 :DCLCTN-INV-NULL-INDS.BILLER-ID-NI               19378099
191280          ,:DCLCTN-INV.STATUS-REASON-CD                           19379099
191290          ,:DCLCTN-INV.PREPAID-IND                                19380099
191300                 :DCLCTN-INV-NULL-INDS.PREPAID-IND-NI             19381099
191310          ,:DCLCTN-INV.IMSI                                       19382099
191320          ,:DCLCTN-INV.ICC-ID-4G)                                 19383099
191330     END-EXEC.                                                    19384099
191340                                                                  19385099
191350                                                                  19386099
191360     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    19387099
191370                                                                  19388099
191380     EVALUATE TRUE                                                19389099
191390         WHEN SQL-SUCCESS                                         19390099
191400              ADD +1 TO WS-TOTL-ETNI-CTNINV-INS-CNT               19391099
191410              ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                    19392099
191420         WHEN SQL-DUP-INSERT                                      19393099
191430              ADD +1 TO WS-TOTL-ETNI-CTNINV-DUPINS                19394099
191440                        WS-TOTL-ERROR-CTNINV-DUPINS               19395099
191450     END-EVALUATE                                                 19396099
191460                                                                  19397099
191470     .                                                            19398099
191480 7020-EXIT.                                                       19399099
191490     EXIT.                                                        19400099
191500                                                                  19401099
191510 7030-DELETE-CTN-INV.                                             19402099
191520******************************************************************19403099
191530*                                                                 19404099
191540*   PARAGRAPH NAME:  7130-DELETE-CTN-INV                          19405099
191550*                                                                 19406099
191560*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO TRY TO DO         19407099
191570*             DELETE ROWS FROM CTN-INV         OF ETNI TABLE      19408099
191580*                                                                 19409099
191620******************************************************************19410099
191630     MOVE '7030-DELETE-CTN-INV' TO WS-CURR-PARA                   19411099
191640                                                                  19412099
191650*----add sensitivity to switch when delete is not needed----------19413099
191660                                                                  19414099
191670     IF NOT-DELETED-SW = 'Y'                                      19415099
191680        GO TO 7030-EXIT                                           19416099
191690     END-IF                                                       19417099
191700                                                                  19418099
191710     EXEC SQL                                                     19419099
191720         DELETE                                                   19420099
191730         FROM CTN_INV                                             19421099
191740         WHERE                                                    19422099
191750           CTN          =:WS-MDN                                  19423099
191760*--------#870803------------------------------------              19424099
191770********   PRODUCT-TYPE =:WS-PRODUCT-TYPE                         19425099
191780*--------#870803------------------------------------              19426099
191790     END-EXEC                                                     19427099
191800                                                                  19428099
191810     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    19429099
191820                                                                  19430099
191830     IF SQL-SUCCESS OR SQL-ROW-NOT-FOUND                          19431099
191840        ADD +1 TO WS-TOTL-ETNI-CTNINV-DLT-CNT                     19432099
191850        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          19433099
191860     END-IF                                                       19434099
191870     .                                                            19435099
191880 7030-EXIT.                                                       19436099
191890      EXIT.                                                       19437099
191900                                                                  19438099
191910**  JA0602   -  End                                               19439099
191920                                                                  19440099
191930**  JA0815   -  Re-Design  of  7035  & 7036- para's               19441099
191940                                                                  19442099
191950 7035-IS-IT-AN-ETNI-HUB.                                          19443099
191960**----------------------------------------------------------      19444099
191970**   PARAGRAPH NAME: 7035-IS-IT-AN-ETNI-HUB                       19445099
191980**                                                                19446099
191990**   PURPOSE:                                                     19447099
192000**     USING  ETNI  TRANSACTION DATA,  DETERMINE  IF  HUB         19448099
192010**       FOR  ETNI  DATA  w/  Array                               19449099
192020**----------------------------------------------------------      19450099
192030     MOVE '7035-IS-IT-AN-ETNI  ' TO WS-CURR-PARA                  19451099
192040                                                                  19452099
192050     IF  WS-CTNIN-MIN-NUM-TEXT(1:6)  =  WS-ETNI-MIN-BLK-SAVED     19453099
192060         GO  TO  7035-EXIT                                        19454099
192070     END-IF                                                       19455099
192080                                                                  19456099
192090     MOVE  WS-CTNIN-MIN-NUM-TEXT(1:6)  TO  WS-ETNI-MIN-BLK-SAVED  19457099
192100                                           WS-SEARCH-MIN-BLK      19458099
192110                                                                  19459099
192120     INITIALIZE  WS-HUB-ETNI-FLAG                                 19460099
192130                                                                  19461099
192140     PERFORM  VARYING   WS-MKT-MIN-LR-IDX  FROM  1  BY  1         19462099
192150         UNTIL  WS-MKT-MIN-LR-IDX > WS-MKT-MIN-LR-IDX-MAX         19463099
192160         OR                                                       19464099
192170         WS-SEARCH-MIN-BLK                                        19465099
192180                          =   WS-MARKET-MIN-LR(WS-MKT-MIN-LR-IDX) 19466099
192190          OR                                                      19467099
192200          WS-MARKET-MIN-LR(WS-MKT-MIN-LR-IDX)  >                  19468099
192210                                               WS-SEARCH-MIN-BLK  19469099
192220     END-PERFORM                                                  19470099
192230                                                                  19471099
192240     IF  WS-SEARCH-MIN-BLK                                        19472099
192250                          =   WS-MARKET-MIN-LR(WS-MKT-MIN-LR-IDX) 19473099
192260         SET  WS-HUB-ETNI  TO  TRUE                               19474099
192270         ADD  +1  TO  WS-TOTL-ETNI-HUB-DETECTED                   19475099
192280     END-IF                                                       19476099
192290                                                                  19477099
192300     .                                                            19478099
192310 7035-EXIT.                                                       19479099
192320     EXIT.                                                        19480099
192330                                                                  19481099
192340 7036-IS-IT-A-BILLING-HUB.                                        19482099
192350**----------------------------------------------------------      19483099
192360**   PARAGRAPH NAME: 7036-IS-IT-A-BILLING-HUB                     19484099
192370**                                                                19485099
192380**   PURPOSE:                                                     19486099
192390**     USING  BILLING  TRANSACTION DATA,  DETERMINE  IF  THIS     19487099
192400**       IS  A  HUB  TRANS.                                       19488099
192410**----------------------------------------------------------      19489099
192420     MOVE '7036-IS-IT-A-BILLING-HUB'  TO   WS-CURR-PARA           19490099
192430                                                                  19491099
192440     MOVE  MDNIN-MIN-NUM(1:6)  TO  WS-MIN-BLK                     19492099
192450                                                                  19493099
192460     IF  MDNIN-MIN-NUM(1:6)  =  WS-BILL-MIN-BLK-SAVED             19494099
192470         GO  TO  7036-EXIT                                        19495099
192480     END-IF                                                       19496099
192490                                                                  19497099
192500     MOVE  MDNIN-MIN-NUM(1:6)  TO  WS-BILL-MIN-BLK-SAVED          19498099
192510                                   WS-SEARCH-MIN-BLK              19499099
192520                                                                  19500099
192530     INITIALIZE  WS-HUB-BILL-FLAG                                 19501099
192540                                                                  19502099
192550     PERFORM  VARYING   WS-MKT-MIN-LR-IDX  FROM  1  BY  1         19503099
192560         UNTIL  WS-MKT-MIN-LR-IDX > WS-MKT-MIN-LR-IDX-MAX         19504099
192570         OR                                                       19505099
192580         WS-SEARCH-MIN-BLK                                        19506099
192590                          =   WS-MARKET-MIN-LR(WS-MKT-MIN-LR-IDX) 19507099
192600          OR                                                      19508099
192610          WS-MARKET-MIN-LR(WS-MKT-MIN-LR-IDX)  >                  19509099
192620                                               WS-SEARCH-MIN-BLK  19510099
192630     END-PERFORM                                                  19511099
192640                                                                  19512099
192650     IF  WS-SEARCH-MIN-BLK                                        19513099
192660                          =   WS-MARKET-MIN-LR(WS-MKT-MIN-LR-IDX) 19514099
192670         SET  WS-HUB-BILL  TO  TRUE                               19515099
192680         ADD  +1  TO  WS-TOTL-BILL-HUB-DETECTED                   19516099
192690     END-IF                                                       19517099
192700                                                                  19518099
192710     .                                                            19519099
192720 7036-EXIT.                                                       19520099
192730     EXIT.                                                        19521099
192740                                                                  19522099
192750 7037-HUB-MATCH.                                                  19523099
192760**----------------------------------------------------------      19524099
192770**   PARAGRAPH NAME: 7037-HUB-MATCH                               19525099
192780**                                                                19526099
192790**   PURPOSE:                                                     19527099
192800**     Process  a  HUB  Transaction  Match                        19528099
192810**----------------------------------------------------------      19529099
192820                                                                  19530099
192830     MOVE  +0  TO  WS-TOTL-HUB-ERRORS-THIS-TRANS                  19531099
192840                                                                  19532099
192850**  DETERMINE  IF  EXACT  MATCH  FOR  HUB  TRANSACTION            19533099
192860**    Y..Increment  Counter, Exit                                 19534099
192870                                                                  19535099
192880     IF  MDNIN-MIN-NUM        =  WS-CTNIN-MIN-NUM-TEXT  AND       19536099
192890         MDNIN-MDN-STATUS     =  WS-CTNIN-CTN-STATUS              19537099
192900         ADD  +1  TO  WS-TOTL-HUB-MATCHES                         19538099
192910         GO  TO  7037-EXIT                                        19539099
192920     END-IF                                                       19540099
192930                                                                  19541099
192940     IF MDNIN-MDN-STATUS(1:1)  = 'A'                              19542099
192950        AND  WS-CTNIN-CTN-STATUS = 'NH'                           19543099
192960         SET  WS-ERROR-FIELDS-FOUND TO TRUE                       19544099
192970         ADD  1  TO  WS-TOTL-NH-HUB-ERRORS                        19545099
192980         MOVE LIT-TN-NH-NOT-UPDATED-HUB  TO WS-COMMENT            19546099
192990         PERFORM  6000-MOVE-BILL-TO-RPT-HUB  THRU                 19547099
193000                  6000-EXIT-HUB                                   19548099
193010         PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU                 19549099
193020                  6510-EXIT                                       19550099
193030         PERFORM  6010-MOVE-ETNI-TO-RPT-HUB  THRU                 19551099
193040                  6010-EXIT-HUB                                   19552099
193050         PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU  6510-EXIT      19553099
193060         GO  TO  7037-EXIT                                        19554099
193070     END-IF                                                       19555099
193080                                                                  19556099
193090**  Store  Billing  data, First - then if changes - Update        19557099
193100**  DETERMINE  IF  BILLER-ID  CHG  FOR  HUB  TRANSACTION          19558099
193110**    Y..Attempt  Biller-ID  Swap, Exit                           19559099
193120                                                                  19560099
193130     MOVE  WS-CTNIN-MIN-NUM-TEXT  TO  WS-MDNIN-MIN-NUM-HUB        19561099
193140     MOVE  WS-CTNIN-CTN-STATUS    TO  WS-MDNIN-MDN-STATUS-HUB     19562099
193150     MOVE  SPACES                 TO  WS-HUB-UPDATE-SWITCH        19563099
193160                                                                  19564099
193170     IF  MDNIN-MIN-NUM        NOT  =  WS-CTNIN-MIN-NUM-TEXT       19565099
193180         MOVE  MDNIN-MIN-NUM    TO  WS-MDNIN-MIN-NUM-HUB          19566099
193190         MOVE  'Y'              TO  WS-HUB-UPDATE-SWITCH          19567099
193200     END-IF                                                       19568099
193210                                                                  19569099
193220     IF  MDNIN-MDN-STATUS     NOT  =  WS-CTNIN-CTN-STATUS         19570099
193230         MOVE  MDNIN-MDN-STATUS     TO  WS-MDNIN-MDN-STATUS-HUB   19571099
193240         MOVE  'Y'                  TO  WS-HUB-UPDATE-SWITCH      19572099
193250     END-IF                                                       19573099
193260                                                                  19574099
193270     IF  WS-HUB-UPDATE-SWITCH  =  'Y'                             19575099
193280         PERFORM  7038-HUB-UPDATE  THRU  7038-EXIT                19576099
193290         GO  TO  7037-EXIT                                        19577099
193300     END-IF                                                       19578099
193310                                                                  19579099
193320     MOVE  SPACES  TO  DETAIL-1-COMMENT-HUB                       19580099
193330*                                                                 19581099
193340**  AN  ERROR  OR  MULTIPLE  EXIST FOR  HUB  TRANSACTION          19582099
193350*                                                                 19583099
193360                                                                  19584099
193370     IF  MDNIN-NGP            NOT  =  WS-CTNIN-NGP                19585099
193380         MOVE  MDNIN-NGP            TO   WS-CTNIN-NGP             19586099
193390         ADD  +1  TO  WS-TOTL-HUB-ERRORS-THIS-TRANS               19587099
193400         MOVE  LIT-NGP-NOMATCH  TO  DETAIL-1-COMMENT-HUB          19588099
193410     END-IF                                                       19589099
193420                                                                  19590099
193430     IF  MDNIN-PORT-IND       NOT  =  WS-CTNIN-PORT-IND           19591099
193440         ADD  +1  TO  WS-TOTL-HUB-ERRORS-THIS-TRANS               19592099
193450         MOVE  LIT-PORT-IND-NGP-NOMATCH  TO  DETAIL-1-COMMENT-HUB 19593099
193460     END-IF                                                       19594099
193470                                                                  19595099
193480     IF  DETAIL-1-COMMENT-HUB  =  SPACES                          19596099
193490         GO  TO  7037-EXIT                                        19597099
193500     END-IF                                                       19598099
193510                                                                  19599099
193520     IF  WS-TOTL-HUB-ERRORS-THIS-TRANS  >  +1                     19600099
193530         MOVE  WS-MULTIPLE-HUB-ERRORS-EXIST  TO                   19601099
193540                                      DETAIL-1-ADDTL-INFO-HUB     19602099
193550         ADD  +1   TO  WS-TOTL-HUB-MULTI-ERRORS                   19603099
193560     END-IF                                                       19604099
193570                                                                  19605099
193580     PERFORM  6000-MOVE-BILL-TO-RPT-HUB  THRU                     19606099
193590              6000-EXIT-HUB                                       19607099
193600     PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU  6510-EXIT          19608099
193610                                                                  19609099
193620     PERFORM  6010-MOVE-ETNI-TO-RPT-HUB  THRU                     19610099
193630              6010-EXIT-HUB                                       19611099
193640     PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU  6510-EXIT          19612099
193650                                                                  19613099
193660     .                                                            19614099
193670 7037-EXIT.                                                       19615099
193680     EXIT.                                                        19616099
193690                                                                  19617099
193700 7038-HUB-UPDATE.                                                 19618099
193710**----------------------------------------------------------      19619099
193720**   PARAGRAPH NAME: 7038-HUB-UPDATE                              19620099
193730**                                                                19621099
193740**     Process  &  Update  a  HUB  Transaction  Match             19622099
193750**                                                                19623099
193760**     Update  MIN-INV,  If  Needed                               19624099
193770**     Update  CTN-INV-HISTORY                                    19625099
193780**     Update  CTN-INV                                            19626099
193790**     Create  Billing, Old ETNI  &  New  ETNI  Reports           19627099
193800**----------------------------------------------------------      19628099
193810                                                                  19629099
193820     MOVE  MDNIN-MDN TO SEARCH-MDN                                19630099
193830                            WS-MDN                                19631099
193840                                                                  19632099
193850     MOVE  MDNIN-MIN-NUM  TO  MIN-NUM-TEXT OF  DCLMIN-INV         19633099
193860     MOVE  10             TO  MIN-NUM-LEN  OF  DCLMIN-INV         19634099
193870                                                                  19635099
193880     IF  MDNIN-MIN-NUM  NOT   =  WS-CTNIN-MIN-NUM-TEXT  OR        19636099
193890         WS-CTNIN-CTN-STATUS  =  'AA'                             19637099
193900                                                                  19638099
193910         PERFORM  7805-SELECT-MIN-IN-CTN  THRU  7805-EXIT         19639099
193920                                                                  19640099
193930         IF  WS-CTN-INV-MIN-COUNT  >  +0                          19641099
193940             ADD   +1 TO WS-TOTL-ERROR-MIN-NUM-IN-CTN             19642099
193950             SET   WS-ERROR-FIELDS-FOUND TO TRUE                  19643099
193960             MOVE  LIT-MIN-NUM-IN-CTN    TO DETAIL-1-COMMENT-HUB  19644099
193970             MOVE  MDNIN-MIN-NUM         TO WS-ADDTL-INFO (1:10)  19645099
193980                                                                  19646099
193990             PERFORM  6010-MOVE-ETNI-TO-RPT-HUB  THRU             19647099
194000                      6010-EXIT-HUB                               19648099
194010             PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU  6510-EXIT  19649099
194020                                                                  19650099
194030             GO  TO  7038-EXIT                                    19651099
194040         END-IF                                                   19652099
194050                                                                  19653099
194060**  SEL  MIN-INV                                                  19654099
194070                                                                  19655099
194080       PERFORM  7810-SELECT-MIN-INV  THRU  7810-EXIT              19656099
194090                                                                  19657099
194100**  UPD  MIN-INV                                                  19658099
194110                                                                  19659099
194120       IF  SQL-SUCCESS                                            19660099
194130         CONTINUE                                                 19661099
194140       ELSE                                                       19662099
194150         ADD +1 TO WS-TOTL-ETNI-MININV-ERRS                       19663099
194160         MOVE  LIT-MIN-UPDATE-ERROR  TO  WS-COMMENT               19664099
194170         MOVE  SQLCODE  TO  WS-SQLCODE-DS                         19665099
194180         MOVE  SPACES              TO  WS-ADDTL-INFO              19666099
194190         MOVE  WS-SQLCODE-DS(3:4)  TO  WS-ADDTL-INFO(1:04)        19667099
194200         MOVE  'SQLERR '           TO  WS-ADDTL-INFO(6:07)        19668099
194210                                                                  19669099
194220         PERFORM  6000-MOVE-BILL-TO-RPT-HUB THRU 6000-EXIT-HUB    19670099
194230         PERFORM  6510-WRITE-ERROR-RPT-HUB  THRU 6510-EXIT        19671099
194240         PERFORM  6010-MOVE-ETNI-TO-RPT-HUB THRU                  19672099
194250                  6010-EXIT-HUB                                   19673099
194260         PERFORM  6510-WRITE-ERROR-RPT-HUB  THRU                  19674099
194270                  6510-EXIT                                       19675099
194280         GO  TO   7038-EXIT                                       19676099
194290        END-IF                                                    19677099
194300       MOVE  0  TO  SYS-UPDATE-DATE-NI OF  DCLMIN-INV-NULL-INDS   19678099
194310                    OPERATOR-ID-NI     OF  DCLMIN-INV-NULL-INDS   19679099
194320                                                                  19680099
194330       MOVE  10  TO  MIN-NUM-LEN OF DCLMIN-INV                    19681099
194340                                                                  19682099
194350       IF (MDNIN-MDN-STATUS   NOT  =  WS-CTNIN-CTN-STATUS  AND    19683099
194360           MDNIN-MDN-STATUS(1:1)   =  'A')  OR                    19684099
194370           WS-CTNIN-CTN-STATUS     =  'AA'                        19685099
194380           MOVE  'AI'  TO  MIN-STATUS      OF  DCLMIN-INV         19686099
194390       END-IF                                                     19687099
194400                                                                  19688099
194410       PERFORM 8000-GET-TIMEZONE THRU 8000-EXIT                   19689099
194420                                                                  19690099
194430       EXEC SQL                                                   19691099
194440           UPDATE MIN_INV                                         19692099
194450           SET MIN_STATUS = :DCLMIN-INV.MIN-STATUS,               19693099
194460               SYS_UPDATE_DATE = :WS-TIMESTAMP                    19694099
194470                        :DCLMIN-INV-NULL-INDS.SYS-UPDATE-DATE-NI, 19695099
194480               OPERATOR_ID     = :DCLMIN-INV.OPERATOR-ID          19696099
194490                        :DCLMIN-INV-NULL-INDS.OPERATOR-ID-NI      19697099
194500           WHERE                                                  19698099
194510               MIN_NUM = :DCLMIN-INV.MIN-NUM                      19699099
194520       END-EXEC                                                   19700099
194530                                                                  19701099
194540       IF  SQL-SUCCESS                                            19702099
194550         ADD +1 TO WS-TOTL-ETNI-MININV-UPD-CNT                    19703099
194560         ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                         19704099
194570       ELSE                                                       19705099
194580         ADD +1 TO WS-TOTL-ETNI-MININV-ERRS                       19706099
194590         MOVE  LIT-MIN-UPDATE-ERROR  TO  WS-COMMENT               19707099
194600         MOVE  SQLCODE  TO  WS-SQLCODE-DS                         19708099
194610         MOVE  SPACES              TO  WS-ADDTL-INFO              19709099
194620         MOVE  WS-SQLCODE-DS(3:4)  TO  WS-ADDTL-INFO(1:04)        19710099
194630         MOVE  'SQLERR '           TO  WS-ADDTL-INFO(6:07)        19711099
194640                                                                  19712099
194650         PERFORM  6000-MOVE-BILL-TO-RPT-HUB THRU 6000-EXIT-HUB    19713099
194660         PERFORM  6510-WRITE-ERROR-RPT-HUB  THRU 6510-EXIT        19714099
194670         PERFORM  6010-MOVE-ETNI-TO-RPT-HUB THRU                  19715099
194680                  6010-EXIT-HUB                                   19716099
194690         PERFORM  6510-WRITE-ERROR-RPT-HUB  THRU                  19717099
194700                  6510-EXIT                                       19718099
194710         GO  TO   7038-EXIT                                       19719099
194720        END-IF                                                    19720099
194730      END-IF                                                      19721099
194740                                                                  19722099
194750     PERFORM  7000-SELECT-CTN-INV  THRU  7000-EXIT                19723099
194760                                                                  19724099
194770     EXEC SQL                                                     19725099
194780     INSERT INTO CTN_INV_HISTORY                                  19726099
194790             ( CTN ,                                              19727099
194800               SYS_CREATION_DATE ,                                19728099
194810               SYS_UPDATE_DATE ,                                  19729099
194820               OPERATOR_ID ,                                      19730099
194830               APPLICATION_ID ,                                   19731099
194840               DL_SERVICE_CODE ,                                  19732099
194850               DL_UPDATE_STAMP,                                   19733099
194860               LAST_TRX_DATE ,                                    19734099
194870               LAST_TRX_CODE ,                                    19735099
194880               CTN_STATUS ,                                       19736099
194890               LAST_TRX_UID ,                                     19737099
194900               NL,                                                19738099
194910               NGP ,                                              19739099
194920               CONV_RUN_NO ,                                      19740099
194930               SPECIAL_TRX_DATE ,                                 19741099
194940               RUN_ID ,                                           19742099
194950               HOLD_REASON ,                                      19743099
194960               PRODUCT_TYPE,                                      19744099
194970               ICC_ID ,                                           19745099
194980               PORT_IND ,                                         19746099
194990               MIN_NUM ,                                          19747099
195000               BILLER_ID ,                                        19748099
195010               STATUS_REASON_CD,                                  19749099
195020               PREPAID_IND,                                       19750099
195030               IMSI,                                              19751099
195040               ICC_ID_4G)                                         19752099
195050       SELECT CTN ,                                               19753099
195060              SYS_CREATION_DATE ,                                 19754099
195070              SYS_UPDATE_DATE,                                    19755099
195080              OPERATOR_ID ,                                       19756099
195090              APPLICATION_ID ,                                    19757099
195100              DL_SERVICE_CODE ,                                   19758099
195110              DL_UPDATE_STAMP,                                    19759099
195120              LAST_TRX_DATE ,                                     19760099
195130              LAST_TRX_CODE ,                                     19761099
195140              CTN_STATUS ,                                        19762099
195150              LAST_TRX_UID ,                                      19763099
195160              NL,                                                 19764099
195170              NGP ,                                               19765099
195180              CONV_RUN_NO ,                                       19766099
195190              SPECIAL_TRX_DATE ,                                  19767099
195200              RUN_ID ,                                            19768099
195210              HOLD_REASON ,                                       19769099
195220              PRODUCT_TYPE,                                       19770099
195230              ICC_ID ,                                            19771099
195240              PORT_IND ,                                          19772099
195250              MIN_NUM ,                                           19773099
195260              BILLER_ID ,                                         19774099
195270              STATUS_REASON_CD ,                                  19775099
195280              PREPAID_IND,                                        19776099
195290              IMSI,                                               19777099
195300              ICC_ID_4G                                           19778099
195310      FROM CTN_INV                                                19779099
195320     WHERE CTN         = :SEARCH-MDN                              19780099
195330     END-EXEC                                                     19781099
195340                                                                  19782099
195350     MOVE SQLCODE TO WS-SQLCODE                                   19783099
195360                     WS-SQLCODE-DS                                19784099
195370                     SQL-STATUS-CODE                              19785099
195380                                                                  19786099
195390     EVALUATE TRUE                                                19787099
195400       WHEN SQL-SUCCESS                                           19788099
195410          ADD  +1  TO  WS-TOTL-ETNI-CTNHIST-INS-CNT               19789099
195420          ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                        19790099
195430          CONTINUE                                                19791099
195440       WHEN SQL-DUP-INSERT                                        19792099
195450          PERFORM 7052-CREATE-HISTORY-DUP                         19793099
195460             THRU 7052-EXIT                                       19794099
195470       WHEN OTHER                                                 19795099
195480         MOVE  SQLCODE  TO  WS-SQLCODE-DS                         19796099
195490         DISPLAY '*********************************************'  19797099
195500         DISPLAY '**                  ERROR                  **'  19798099
195520         DISPLAY '** 7038-HUB-UPDATE..01         '                19799099
195530         DISPLAY '**                                         **'  19800099
195540         DISPLAY 'INSERT CTN-INV-HISTORY FAILED'                  19801099
195550         DISPLAY 'SQLCODE CODE = ' WS-SQLCODE-DS                  19802099
195570         DISPLAY '**                                         **'  19803099
195580         DISPLAY 'CURRENT MDN RECORD = ' SEARCH-MDN               19804099
195590         DISPLAY '**                                         **'  19805099
195600         DISPLAY  ALL '-'                                         19806099
195610         DISPLAY '*********************************************'  19807099
195620         DISPLAY  ALL '-'                                         19808099
195630         DIVIDE  ZERO1  BY  ZERO2  GIVING  CORE-DUMP              19809099
195640     END-EVALUATE                                                 19810099
195650     .                                                            19811099
195660                                                                  19812099
195670     MOVE  0     TO       MIN-NUM-NI    OF  DCLCTN-INV-NULL-INDS  19813099
195680                          OPERATOR-ID-NI OF  DCLCTN-INV-NULL-INDS 19814099
195690                                                                  19815099
195700     EXEC SQL                                                     19816099
195710       UPDATE CTN_INV                                             19817099
195720                                                                  19818099
195730         SET                                                      19819099
195740                                                                  19820099
195750         SYS_UPDATE_DATE  =  CURRENT TIMESTAMP + :WS-HRS HOURS,   19821099
195760         OPERATOR_ID      =  :LIT-PGM-ID                          19822099
195770                            :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI, 19823099
195780         LAST_TRX_DATE    =  :DCLCTN-INV.LAST-TRX-DATE,           19824099
195790         LAST_TRX_CODE    =  :DCLCTN-INV.LAST-TRX-CODE,           19825099
195800         CTN_STATUS       =  :WS-MDNIN-MDN-STATUS-HUB,            19826099
195810         MIN_NUM          =  :WS-MDNIN-MIN-NUM-HUB                19827099
195820                             :DCLCTN-INV-NULL-INDS.MIN-NUM-NI     19828099
195830          WHERE                                                   19829099
195840               CTN =       :SEARCH-MDN                            19830099
195850     END-EXEC                                                     19831099
195860                                                                  19832099
195870     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    19833099
195880                                                                  19834099
195890     IF  SQLCODE  =  ZERO                                         19835099
195900         ADD +1 TO WS-TOTL-ETNI-CTNINV-UPD-ST-CNT                 19836099
195910         ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                         19837099
195920         CONTINUE                                                 19838099
195930        ELSE                                                      19839099
195940         MOVE  SQLCODE  TO  WS-SQLCODE-DS                         19840099
195950         DISPLAY '*********************************************'  19841099
195960         DISPLAY '**                  ERROR                  **'  19842099
195970         DISPLAY '**                                         **'  19843099
195980         DISPLAY '** 7038-HUB-UPDATE..02         '                19844099
195990         DISPLAY '**                                         **'  19845099
196000         DISPLAY 'UPDATE CTN-INV   - - - FAILED'                  19846099
196010         DISPLAY 'SQLCODE CODE = ' WS-SQLCODE-DS                  19847099
196020         DISPLAY '**                                         **'  19848099
196030         DISPLAY '**                                         **'  19849099
196040         DISPLAY 'CURRENT MDN RECORD = ' SEARCH-MDN               19850099
196050         DISPLAY '**                                         **'  19851099
196060         DISPLAY  ALL '-'                                         19852099
196070         DISPLAY '*********************************************'  19853099
196080         DISPLAY  ALL '-'                                         19854099
196090         DIVIDE  ZERO1  BY  ZERO2  GIVING  CORE-DUMP              19855099
196100         GO  TO  7038-EXIT                                        19856099
196110     END-IF                                                       19857099
196120                                                                  19858099
196130     PERFORM  6000-MOVE-BILL-TO-RPT-HUB  THRU                     19859099
196140              6000-EXIT-HUB                                       19860099
196150     PERFORM  6401-WRITE-RECON-RPT-HUB    THRU                    19861099
196160              6401-EXIT                                           19862099
196170                                                                  19863099
196180     MOVE   LIT-UPDATED-COMMENT   TO   WS-COMMENT                 19864099
196190     PERFORM  6010-MOVE-ETNI-TO-RPT-HUB  THRU                     19865099
196200              6010-EXIT-HUB                                       19866099
196210     PERFORM  6401-WRITE-RECON-RPT-HUB    THRU                    19867099
196220              6401-EXIT                                           19868099
196230                                                                  19869099
196240**   MOVE  WS-MDNIN-BILLER-ID-HUB   TO  WS-CTNIN-BILLER-ID        19870099
196250**   MOVE  WS-MDNIN-NL-HUB          TO  WS-CTNIN-NL               19871099
196260     MOVE  WS-MDNIN-MIN-NUM-HUB     TO  WS-CTNIN-MIN-NUM-TEXT     19872099
196270     MOVE  WS-MDNIN-MDN-STATUS-HUB  TO  WS-CTNIN-CTN-STATUS       19873099
196280                                                                  19874099
196290     MOVE   SPACES                TO   WS-COMMENT                 19875099
196300     PERFORM  6010-MOVE-ETNI-TO-RPT-HUB  THRU                     19876099
196310              6010-EXIT-HUB                                       19877099
196320     PERFORM  6401-WRITE-RECON-RPT-HUB    THRU                    19878099
196330              6401-EXIT                                           19879099
196340     .                                                            19880099
196350 7038-EXIT.                                                       19881099
196360     EXIT.                                                        19882099
196370                                                                  19883099
196380**  JA0602   -  End                                               19884099
196390                                                                  19885099
196400 7039-IS-IT-A-SPLIT.                                              19886099
196410**----------------------------------------------------------      19887099
196420**   PARAGRAPH NAME: 7039-IS-IT-A-SPLIT                           19888099
196430**                                                                19889099
196440**     Access  Market-Npa-Nxx-Lr  Table                           19890099
196450**                                                                19891099
196460**       To  Determine - If  this is a Split                      19892099
196470**----------------------------------------------------------      19893099
196480                                                                  19894099
196490     INITIALIZE  WS-SPLIT-FLAG                                    19895099
196500                 DCLMARKET-NPA-NXX-LR                             19896099
196510                                                                  19897099
196520     MOVE  WS-CTNIN-CTN-TEXT(1:3) TO  NPA OF DCLMARKET-NPA-NXX-LR 19898099
196530     MOVE  WS-CTNIN-CTN-TEXT(4:3) TO  NXX OF DCLMARKET-NPA-NXX-LR 19899099
196540     MOVE  WS-CTNIN-CTN-TEXT(7:4) TO  WS-HOLD-LINE-CTN            19900099
196550                                                                  19901099
196560     EXEC SQL SELECT                                              19902099
196570                NEW_NPA,                                          19903099
196580                NEW_NXX,                                          19904099
196590                EFFECTIVE_DATE,                                   19905099
196600                END_OF_SPLIT                                      19906099
196610           INTO                                                   19907099
196620               :DCLMARKET-NPA-NXX-LR.NEW-NPA                      19908099
196630               :DCLMARKET-NPA-NXX-LR-NULL-INDS.NEW-NPA-NI,        19909099
196640               :DCLMARKET-NPA-NXX-LR.NEW-NXX                      19910099
196650               :DCLMARKET-NPA-NXX-LR-NULL-INDS.NEW-NXX-NI,        19911099
196660               :DCLMARKET-NPA-NXX-LR.EFFECTIVE-DATE,              19912099
196670               :DCLMARKET-NPA-NXX-LR.END-OF-SPLIT                 19913099
196680               :DCLMARKET-NPA-NXX-LR-NULL-INDS.END-OF-SPLIT-NI    19914099
196690           FROM                                                   19915099
196700                MARKET_NPA_NXX_LR                                 19916099
196710           WHERE                                                  19917099
196720                 NPA = :DCLMARKET-NPA-NXX-LR.NPA AND              19918099
196730                 NXX = :DCLMARKET-NPA-NXX-LR.NXX AND              19919099
196740               :WS-HOLD-LINE-CTN BETWEEN                          19920099
196750                   BEGIN_LINE_RANGE AND END_LINE_RANGE            19921099
196760               FETCH FIRST ROW ONLY WITH UR                       19922099
196770           END-EXEC                                               19923099
196780                                                                  19924099
196790     IF  SQLCODE   <   ZERO                                       19925099
196800         SET  WS-ERROR-FIELDS-FOUND  TO  TRUE                     19926099
196810         ADD  +1  TO  WS-TOTL-MKT-NPANXX-ERR                      19927099
196820         MOVE  LIT-MKT-NPA-NXX-LR-ERROR  TO  WS-COMMENT           19928099
196830         MOVE  SPACES   TO  WS-ADDTL-INFO                         19929099
196840         MOVE  SQLCODE  TO  WS-SQLCODE-DS                         19930099
196850         PERFORM  6010-MOVE-ETNI-TO-RPT-HUB  THRU  6010-EXIT-HUB  19931099
196860         PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU  6510-EXIT      19932099
196870         GO  TO   7039-EXIT                                       19933099
196880     END-IF                                                       19934099
196890                                                                  19935099
196900     IF  SQLCODE   =   +100                                       19936099
196910         GO  TO   7039-EXIT                                       19937099
196920     END-IF                                                       19938099
196930                                                                  19939099
196940**  JA1108  -  Next  Cond                                         19940099
196950                                                                  19941099
196960**  Is  there  a  Current  Split  ?                               19942099
196970                                                                  19943099
196980     IF  NEW-NPA  OF DCLMARKET-NPA-NXX-LR  >  SPACES  AND         19944099
196990         EFFECTIVE-DATE  OF DCLMARKET-NPA-NXX-LR(1:10)  NOT  >    19945099
197000                                    WS-TIMESTAMP(1:10)            19946099
197010         SET  WS-SPLIT         TO TRUE                            19947099
197020         GO  TO   7039-EXIT                                       19948099
197030     END-IF                                                       19949099
197040                                                                  19950099
197050**  Is  there  an  Expired  Split  ?                              19951099
197060                                                                  19952099
197070     IF  NEW-NPA  OF DCLMARKET-NPA-NXX-LR  >  SPACES  AND         19953099
197080         END-OF-SPLIT    OF DCLMARKET-NPA-NXX-LR  >  WS-TIMESTAMP 19954099
197090         SET  WS-SPLIT-BYPASS  TO TRUE                            19955099
197100         GO  TO   7039-EXIT                                       19956099
197110     END-IF                                                       19957099
197120                                                                  19958099
197130     .                                                            19959099
197140 7039-EXIT.                                                       19960099
197150     EXIT.                                                        19961099
197160                                                                  19962099
197170*-----NGP Extension Project:                                      19963099
197180*-----no longer get Biller from 1st pos of NGP in CTN-INV---------19964099
197190*-----but rather from new Biller-ID column in NUMBER-GROUP table--19965099
197200                                                                  19966099
197210 7040-GET-BILLER-FROM-NGP-TABLE.                                  19967099
197220      INITIALIZE IN-DATA IN WS-ETNDC38-INTERFACE                  19968099
197230*     move saved NGP to the passarea of datalayer ETNDC38         19969099
197240      MOVE WS-HOLD-NGP TO                                         19970099
197250           NGP-ID IN IN-DATA IN WS-ETNDC38-INTERFACE              19971099
197260                                                                  19972099
197270*     move "select number group" to ETNDC38'S function            19973099
197280      SET ACT-SEL-NUMBER-GROUP                                    19974099
197290           IN WS-ETNDC38-INTERFACE TO TRUE                        19975099
197300                                                                  19976099
197310*     call ETNDC38 to return NGP, NGP DESC, REGION, BILLER-ID     19977099
197320      MOVE 'ETNDC38' TO WS-CALLED-PGM                             19978099
197330      CALL WS-CALLED-PGM USING WS-ETNDC38-INTERFACE               19979099
197340                                                                  19980099
197350      MOVE RETURN-SQLCODE IN WS-ETNDC38-INTERFACE TO              19981099
197360           WS-SQLCODE  SQL-STATUS-CODE                            19982099
197370      MOVE WS-SQLCODE TO WS-SQLCODE-DS                            19983099
197380      MOVE SPACE TO WS-SKIPPED-FLAG                               19984099
197390                                                                  19985099
197400*-----all ok, save returned Biller from NUMBER-GROUP in WS--------19986099
197410      IF WS-SQLCODE = ZERO                                        19987099
197420         MOVE BILLER-ID OF OUTPUT-AREA OF WS-ETNDC38-INTERFACE TO 19988099
197430              WS-ETNDC38-BILLER                                   19989099
197440              GO TO 7040-EXIT                                     19990099
197450              END-IF                                              19991099
197460                                                                  19992099
197470      IF WS-SQLCODE = 100                                         19993099
197480         MOVE 'Y' TO WS-SKIPPED-FLAG                              19994099
197490         ADD 1 TO WS-TOTL-ERROR-NGP-NOT-FOUND                     19995099
197500         MOVE 'ETNI' TO WS-SYSTEM                                 19996099
197510         MOVE 'CANT FIND NGP IN NGP TABL' TO WS-COMMENT           19997099
197520         MOVE NGP OF DCLCTN-INV TO WS-ADDTL-INFO                  19998099
197530         PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT             19999099
197540         PERFORM 6500-WRITE-ERROR-RPT  THRU 6500-EXIT             20000099
197550         GO TO 7040-EXIT                                          20001099
197560         END-IF                                                   20002099
197570                                                                  20003099
197580*-----otherwise, issue messages and abend-------------------------20004099
197590      SET WS-ERROR-FIELDS-FOUND TO TRUE                           20005099
197600      DISPLAY ' '                                                 20006099
197610      DISPLAY '    In 7040-GET-BILLER-FROM-NGP-TABLE'             20007099
197620      DISPLAY '                                     '             20008099
197630      DISPLAY                                                     20009099
197640      'A non-zero SQLCODE returned from called pgm ETNDC38.'      20010099
197650      DISPLAY ' '                                                 20011099
197660      DISPLAY 'Table where abend occured: NUMBER-GROUP'           20012099
197670      DISPLAY                                                     20013099
197680      '>>>> NGP at Abend Time: ' WS-HOLD-NGP ' <<<<'              20014099
197690      DISPLAY                                                     20015099
197700      '>>>> eTNI CTN at Abend Time:   ' WS-CTNIN-CTN-TEXT ' <<<<' 20016099
197710      DISPLAY                                                     20017099
197720      '>>>> Biller MDN at Abend Time: ' MDNIN-MDN         ' <<<<' 20018099
197730      DISPLAY ' '                                                 20019099
197740      PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT                 20020099
197750      MOVE RETURN-SQLCODE IN WS-ETNDC38-INTERFACE TO              20021099
197760           WS-ABEND-CODE                                          20022099
197770      STRING 'FATAL SQL ERROR!!!  SQLCODE: '                      20023099
197780              WS-ABEND-CODE                                       20024099
197790              DELIMITED BY SIZE                                   20025099
197800              INTO WS-ABEND-TEXT                                  20026099
197810      END-STRING                                                  20027099
197820      PERFORM 9000-ABORT THRU 9000-EXIT                           20028099
197830      .                                                           20029099
197840 7040-EXIT.                                                       20030099
197850      EXIT.                                                       20031099
197860                                                                  20032099
197870 7050-GET-CTN-INV-BILLER.                                         20033099
197880*-----use Biller file MDN to find CTN-INV row by CTN--------------20034099
197890      MOVE MDNIN-MDN TO SEARCH-MDN                                20035099
197900      EXEC SQL                                                    20036099
197910           SELECT                                                 20037099
197920                NL,                                               20038099
197930                BILLER_ID,                                        20039099
197940                CTN_STATUS,                                       20040099
197950                NGP                                               20041099
197960           INTO                                                   20042099
197970               :SEARCH-NL :SEARCH-NL-ID-NI,                       20043099
197980               :SEARCH-BILLER-ID :SEARCH-BILLER-ID-NI,            20044099
197990               :SEARCH-CTN-STATUS,                                20045099
198000               :SEARCH-NGP                                        20046099
198010           FROM                                                   20047099
198020                CTN_INV                                           20048099
198030           WHERE                                                  20049099
198040                CTN =:SEARCH-MDN                                  20050099
198050           END-EXEC                                               20051099
198060      IF SQLCODE NOT = ZERO OR SEARCH-BILLER-ID-NI < 0            20052099
198070         MOVE SPACE TO SEARCH-BILLER-ID                           20053099
198080         END-IF.                                                  20054099
198090 7050-EXIT.                                                       20055099
198100      EXIT.                                                       20056099
198110                                                                  20057099
198120 7051-SPECIAL-CTNINV-HIST-UPD.                                    20058099
198130**  JA1207  -  Start  -                                           20059099
198140*-----------------------------------------------------------      20060099
198150*                                                                 20061099
198160*  INSERT HISTORY RECORD INTO CTN-INV-HISTORY TABLE               20062099
198170*    FROM  CTN-INV                                                20063099
198180*                                                                 20064099
198190*-----------------------------------------------------------      20065099
198200                                                                  20066099
198210      MOVE  SPACES  TO  WS-PRIOR-CTN-STATUS                       20067099
198220                                                                  20068099
198230      MOVE  MDNIN-MDN TO SEARCH-MDN                               20069099
198240                             WS-MDN                               20070099
198250      MOVE  MDNIN-NL  OF  MDNIN-DETAIL-FIELDS  TO                 20071099
198260                       WS-MDNIN-DETAIL-NL                         20072099
198270      MOVE  MDNIN-BILLER-ID  OF  MDNIN-DETAIL-FIELDS  TO          20073099
198280          WS-MDNIN-DETAIL-NL(1:1)                                 20074099
198290                                                                  20075099
198300**  JA0411 -  Added  Cond.                                        20076099
198310                                                                  20077099
198320      IF  WS-VISION                                               20078099
198330         IF  MDNIN-MDN-STATUS  NOT  =  'AI'                       20079099
198340             ADD 1 TO WS-TOTL-ERROR-DUPE-BILLER                   20080099
198350             MOVE LIT-DUPE-BILLER-ID TO WS-COMMENT                20081099
198360             STRING                                               20082099
198370             'ETNI BILLER: '            DELIMITED BY SIZE         20083099
198380             SEARCH-BILLER-ID           DELIMITED BY SIZE         20084099
198390             INTO WS-ADDTL-INFO                                   20085099
198400             END-STRING                                           20086099
198410             MOVE 'BILL' TO WS-SYSTEM                             20087099
198420             PERFORM 6000-MOVE-BILL-MDN-TO-RPT THRU 6000-EXIT     20088099
198430             PERFORM 6500-WRITE-ERROR-RPT THRU 6500-EXIT          20089099
198440             GO  TO  7051-EXIT                                    20090099
198450         END-IF                                                   20091099
198460      END-IF                                                      20092099
198470                                                                  20093099
198480**  JA0308 -  Added  Cond.                                        20094099
198490                                                                  20095099
198500      IF  WS-VISION                                               20096099
198510          MOVE  'RET '  TO  WS-MDNIN-DETAIL-NL(2:4)               20097099
198520      END-IF                                                      20098099
198530                                                                  20099099
198540      PERFORM  7000-SELECT-CTN-INV  THRU  7000-EXIT               20100099
198550                                                                  20101099
198560      MOVE  CTN-STATUS  OF  DCLCTN-INV  TO  WS-PRIOR-CTN-STATUS   20102099
198570                                                                  20103099
198580     EXEC SQL                                                     20104099
198590     INSERT INTO CTN_INV_HISTORY                                  20105099
198600             ( CTN ,                                              20106099
198610               SYS_CREATION_DATE ,                                20107099
198620               SYS_UPDATE_DATE ,                                  20108099
198630               OPERATOR_ID ,                                      20109099
198640               APPLICATION_ID ,                                   20110099
198650               DL_SERVICE_CODE ,                                  20111099
198660               DL_UPDATE_STAMP,                                   20112099
198670               LAST_TRX_DATE ,                                    20113099
198680               LAST_TRX_CODE ,                                    20114099
198690               CTN_STATUS ,                                       20115099
198700               LAST_TRX_UID ,                                     20116099
198710               NL,                                                20117099
198720               NGP ,                                              20118099
198730               CONV_RUN_NO ,                                      20119099
198740               SPECIAL_TRX_DATE ,                                 20120099
198750               RUN_ID ,                                           20121099
198760               HOLD_REASON ,                                      20122099
198770               PRODUCT_TYPE,                                      20123099
198780               ICC_ID ,                                           20124099
198790               PORT_IND ,                                         20125099
198800               MIN_NUM ,                                          20126099
198810               BILLER_ID ,                                        20127099
198820               STATUS_REASON_CD,                                  20128099
198830               PREPAID_IND,                                       20129099
198840               IMSI,                                              20130099
198850               ICC_ID_4G)                                         20131099
198860       SELECT CTN ,                                               20132099
198870              SYS_CREATION_DATE ,                                 20133099
198880              SYS_UPDATE_DATE ,                                   20134099
198890              OPERATOR_ID ,                                       20135099
198900              APPLICATION_ID ,                                    20136099
198910              DL_SERVICE_CODE ,                                   20137099
198920              DL_UPDATE_STAMP,                                    20138099
198930              LAST_TRX_DATE ,                                     20139099
198940              LAST_TRX_CODE ,                                     20140099
198950              CTN_STATUS ,                                        20141099
198960              LAST_TRX_UID ,                                      20142099
198970              NL,                                                 20143099
198980              NGP ,                                               20144099
198990              CONV_RUN_NO ,                                       20145099
199000              SPECIAL_TRX_DATE ,                                  20146099
199010              RUN_ID ,                                            20147099
199020              HOLD_REASON ,                                       20148099
199030              PRODUCT_TYPE,                                       20149099
199040              ICC_ID ,                                            20150099
199050              PORT_IND ,                                          20151099
199060              MIN_NUM ,                                           20152099
199070              BILLER_ID ,                                         20153099
199080              STATUS_REASON_CD ,                                  20154099
199090              PREPAID_IND,                                        20155099
199100              IMSI,                                               20156099
199110              ICC_ID_4G                                           20157099
199120      FROM CTN_INV                                                20158099
199130     WHERE CTN         = :SEARCH-MDN                              20159099
199140     END-EXEC                                                     20160099
199150                                                                  20161099
199160     MOVE SQLCODE TO WS-SQLCODE                                   20162099
199170                     WS-SQLCODE-DS                                20163099
199180                     SQL-STATUS-CODE                              20164099
199190                                                                  20165099
199200     EVALUATE TRUE                                                20166099
199210       WHEN SQL-SUCCESS                                           20167099
199220          ADD  +1  to  WS-TOTL-ETNI-CTNHIST-INS-CNT               20168099
199230          ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                        20169099
199240          CONTINUE                                                20170099
199250       WHEN SQL-DUP-INSERT                                        20171099
199260          PERFORM 7052-CREATE-HISTORY-DUP                         20172099
199270             THRU 7052-EXIT                                       20173099
199280       WHEN OTHER                                                 20174099
199290         MOVE  SQLCODE  TO  WS-SQLCODE-DS                         20175099
199300         DISPLAY '*********************************************'  20176099
199310         DISPLAY '**                  ERROR                  **'  20177099
199320         DISPLAY '**                                         **'  20178099
199330         DISPLAY '** 7051-SPECIAL-CTNINV-HIST-UPD '               20179099
199340         DISPLAY '**                                         **'  20180099
199350         DISPLAY 'INSERT CTN-INV-HISTORY FAILED'                  20181099
199360         DISPLAY 'SQLCODE CODE = ' WS-SQLCODE-DS                  20182099
199370         DISPLAY '**                                         **'  20183099
199380         DISPLAY '**                                         **'  20184099
199390         DISPLAY 'CURRENT MDN RECORD = ' SEARCH-MDN               20185099
199400         DISPLAY '**                                         **'  20186099
199410         DISPLAY  ALL '-'                                         20187099
199420         DISPLAY '*********************************************'  20188099
199430         DISPLAY  ALL '-'                                         20189099
199440         DIVIDE  ZERO1  BY  ZERO2  GIVING  CORE-DUMP              20190099
199450     END-EVALUATE                                                 20191099
199460     .                                                            20192099
199470                                                                  20193099
199480**                                                                20194099
199490**  JA0308  -  Status  Update,  If  RSS - Only -                  20195099
199500**                                                                20196099
199510**  JA0402  - WS-LEGIT-BILLER-ID-RESELLER Added                   20197099
199520**                                                                20198099
199530      IF  WS-LEGIT-BILLER-ID-RESELLER                             20199099
199540          MOVE  MDNIN-MDN-STATUS  TO  SEARCH-CTN-STATUS           20200099
199550       ELSE                                                       20201099
199560          MOVE  CTN-STATUS  OF  DCLCTN-INV  TO  SEARCH-CTN-STATUS 20202099
199570      END-IF                                                      20203099
199580                                                                  20204099
199590**                                                                20205099
199600**  JA0411  - WS-VISION  Added                                    20206099
199610                                                                  20207099
199620     IF  WS-VISION                                                20208099
199630         IF  MDNIN-MDN-STATUS  =  'AI'                            20209099
199640             MOVE  MDNIN-MDN-STATUS  TO  SEARCH-CTN-STATUS        20210099
199650         END-IF                                                   20211099
199660     END-IF                                                       20212099
199670                                                                  20213099
199680     EXEC SQL  UPDATE                                             20214099
199690               CTN_INV                                            20215099
199700      SET                                                         20216099
199710                                                                  20217099
199720        BILLER_ID       =  :MDNIN-DETAIL-FIELDS.MDNIN-BILLER-ID   20218099
199730                           :DCLCTN-INV-NULL-INDS.BILLER-ID-NI,    20219099
199740        NL              =  :WS-MDNIN-DETAIL-NL,                   20220099
199750        CTN_STATUS      =  :SEARCH-CTN-STATUS,                    20221099
199760        SYS_UPDATE_DATE =  CURRENT TIMESTAMP + :WS-HRS HOURS,     20222099
199770        OPERATOR_ID     =  :LIT-PGM-ID                            20223099
199780                           :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI   20224099
199790          WHERE                                                   20225099
199800               CTN =       :SEARCH-MDN                            20226099
199810     END-EXEC                                                     20227099
199820                                                                  20228099
199830     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    20229099
199840                                                                  20230099
199850     IF  SQLCODE  NOT  =  ZERO                                    20231099
199860         GO  TO  7051-EXIT                                        20232099
199870     END-IF.                                                      20233099
199880                                                                  20234099
199890     ADD  +1  TO  WS-TOTL-V-TO-V-BILLER-UPD                       20235099
199900     ADD  +1  TO  WS-TOTL-ETNI-CTNINV-UPD-ST-CNT                  20236099
199910     ADD  +1  TO  WS-TOTL-UPD-INS-DEL-MQ                          20237099
199920                                                                  20238099
199930**   JA1207A.1  -  Below  Routine  Added                          20239099
199940                                                                  20240099
199950     PERFORM  7053-WRITE-RECON-RPT  THRU  7053-EXIT               20241099
199960                                                                  20242099
199970     .                                                            20243099
199980 7051-EXIT.                                                       20244099
199990      EXIT.                                                       20245099
200000                                                                  20246099
200010*-----------------------------------------------------------      20247099
200020 7052-CREATE-HISTORY-DUP.                                         20248099
200030*-----------------------------------------------------------      20249099
200040*                                                                 20250099
200050*  IN CASR IF CREATE HISTORY FAILED FOR SQL -803, ADD 1 SEC TO    20251099
200060*  LAST-TRX-DT & INSERT HISTORY RECORD INTO CTN-INV-HISTORY TABLE 20252099
200070*                                                                 20253099
200080*-----------------------------------------------------------      20254099
200090                                                                  20255099
200100     MOVE '7052-CREATE-HISTORY-DUP' TO  WS-CURR-PARA              20256099
200110                                                                  20257099
200120     INITIALIZE WS-ADD-TEN.                                       20258099
200130     MOVE  +999  TO  SQL-STATUS-CODE                              20259099
200140                                                                  20260099
200150     PERFORM VARYING IX01-IDX FROM 1 BY 1                         20261099
200160     UNTIL SQL-SUCCESS                                            20262099
200170        OR IX01-IDX > 10                                          20263099
200180                                                                  20264099
200190     ADD 10 TO WS-ADD-TEN                                         20265099
200200                                                                  20266099
200210     EXEC SQL                                                     20267099
200220     INSERT INTO CTN_INV_HISTORY                                  20268099
200230             ( CTN ,                                              20269099
200240               SYS_CREATION_DATE ,                                20270099
200250               SYS_UPDATE_DATE ,                                  20271099
200260               OPERATOR_ID ,                                      20272099
200270               APPLICATION_ID ,                                   20273099
200280               DL_SERVICE_CODE ,                                  20274099
200290               DL_UPDATE_STAMP,                                   20275099
200300               LAST_TRX_DATE ,                                    20276099
200310               LAST_TRX_CODE ,                                    20277099
200320               CTN_STATUS ,                                       20278099
200330               LAST_TRX_UID ,                                     20279099
200340               NL,                                                20280099
200350               NGP ,                                              20281099
200360               CONV_RUN_NO ,                                      20282099
200370               SPECIAL_TRX_DATE ,                                 20283099
200380               RUN_ID ,                                           20284099
200390               HOLD_REASON ,                                      20285099
200400               PRODUCT_TYPE,                                      20286099
200410               ICC_ID ,                                           20287099
200420               PORT_IND ,                                         20288099
200430               MIN_NUM ,                                          20289099
200440               BILLER_ID ,                                        20290099
200450               STATUS_REASON_CD,                                  20291099
200460               PREPAID_IND,                                       20292099
200470               IMSI,                                              20293099
200480               ICC_ID_4G)                                         20294099
200490       SELECT CTN ,                                               20295099
200500              SYS_CREATION_DATE ,                                 20296099
200510              SYS_UPDATE_DATE ,                                   20297099
200520              OPERATOR_ID ,                                       20298099
200530              APPLICATION_ID ,                                    20299099
200540              DL_SERVICE_CODE ,                                   20300099
200550              DL_UPDATE_STAMP,                                    20301099
200560            (TIMESTAMP(LAST_TRX_DATE) + :WS-ADD-TEN MICROSECONDS),20302099
200570              LAST_TRX_CODE ,                                     20303099
200580              CTN_STATUS ,                                        20304099
200590              LAST_TRX_UID ,                                      20305099
200600              NL,                                                 20306099
200610              NGP ,                                               20307099
200620              CONV_RUN_NO ,                                       20308099
200630              SPECIAL_TRX_DATE ,                                  20309099
200640              RUN_ID ,                                            20310099
200650              HOLD_REASON ,                                       20311099
200660              PRODUCT_TYPE,                                       20312099
200670              ICC_ID ,                                            20313099
200680              PORT_IND ,                                          20314099
200690              MIN_NUM ,                                           20315099
200700              BILLER_ID ,                                         20316099
200710              STATUS_REASON_CD ,                                  20317099
200720              PREPAID_IND,                                        20318099
200730              IMSI,                                               20319099
200740              ICC_ID_4G                                           20320099
200750      FROM CTN_INV                                                20321099
200760     WHERE CTN         = :SEARCH-MDN                              20322099
200770     END-EXEC                                                     20323099
200780                                                                  20324099
200790     MOVE SQLCODE TO WS-SQLCODE                                   20325099
200800                     WS-SQLCODE-DS                                20326099
200810                     SQL-STATUS-CODE                              20327099
200820                                                                  20328099
200830     EVALUATE TRUE                                                20329099
200840       WHEN SQL-SUCCESS                                           20330099
200850          ADD  +1  to  WS-TOTL-ETNI-CTNHIST-DUPINS                20331099
200860          ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                        20332099
200870          CONTINUE                                                20333099
200880       WHEN SQL-DUP-INSERT                                        20334099
200890        IF IX01-IDX < 10 THEN                                     20335099
200900           CONTINUE                                               20336099
200910        END-IF                                                    20337099
200920       WHEN OTHER                                                 20338099
200930         MOVE  SQLCODE  TO  WS-SQLCODE-DS                         20339099
200940         DISPLAY '*********************************************'  20340099
200950         DISPLAY '**                  ERROR                  **'  20341099
200960         DISPLAY '**                                         **'  20342099
200970         DISPLAY '** 7052-COPY-TO-HIST  '                         20343099
200980         DISPLAY '**                                         **'  20344099
200990         DISPLAY 'INSERT CTN-INV-HISTORY FAILED'                  20345099
201000         DISPLAY 'SQLCODE CODE = ' WS-SQLCODE-DS                  20346099
201010         DISPLAY '**                                         **'  20347099
201020         DISPLAY '**                                         **'  20348099
201030         DISPLAY 'CURRENT MDN RECORD = ' SEARCH-MDN               20349099
201040         DISPLAY '**                                         **'  20350099
201050         DISPLAY '*********************************************'  20351099
201060         DISPLAY  ALL '-'                                         20352099
201070         DIVIDE  ZERO1  BY  ZERO2  GIVING  CORE-DUMP              20353099
201080                                                                  20354099
201090       END-EVALUATE                                               20355099
201100     END-PERFORM                                                  20356099
201110     .                                                            20357099
201120 7052-EXIT.                                                       20358099
201130     EXIT.                                                        20359099
201140                                                                  20360099
201150 7053-WRITE-RECON-RPT.                                            20361099
201160                                                                  20362099
201170**  Process  BILLing  Report  Line                                20363099
201180                                                                  20364099
201190     MOVE   'BILL'              TO   WS-SYSTEM                    20365099
201200***  MOVE  SPACES               TO   WS-COMMENT                   20366099
201210***                                  WS-ADDTL-INFO                20367099
201220**                                                                20368099
201230**  JA0308  -  ADDED  COND's  Below  -                            20369099
201240**                                                                20370099
201250     IF  WS-VISION                                                20371099
201260         MOVE  LIT-V-TO-V-BILLER-ID-UPD  TO                       20372099
201270                                    WS-COMMENT                    20373099
201280     END-IF                                                       20374099
201290                                                                  20375099
201300     IF  WS-RSS                                                   20376099
201310         MOVE  LIT-V-TO-R-BILLER-ID-UPD  TO                       20377099
201320                                    WS-COMMENT                    20378099
201330     END-IF                                                       20379099
201340                                                                  20380099
201350     IF  WS-OPC                                                   20381099
201360         MOVE  LIT-V-TO-O-BILLER-ID-UPD  TO                       20382099
201370                                    WS-COMMENT                    20383099
201380     END-IF                                                       20384099
201390                                                                  20385099
201400     PERFORM  6000-MOVE-BILL-MDN-TO-RPT                           20386099
201410                                     THRU  6000-EXIT              20387099
201420     PERFORM  6400-WRITE-RECON-RPT                                20388099
201430                                   THRU 6400-EXIT                 20389099
201440                                                                  20390099
201450**  Process  eTNI  Report  Line                                   20391099
201460**    From  Old CTN-INV                                           20392099
201470                                                                  20393099
201480     MOVE   'ETNI'              TO   WS-SYSTEM                    20394099
201490                                     DETAIL-1-SYSTEM              20395099
201500     MOVE  SPACES               TO   WS-COMMENT                   20396099
201510                                     WS-ADDTL-INFO                20397099
201520                                     DETAIL-1-COMMENT             20398099
201530                                     DETAIL-1-ADDTL-INFO          20399099
201540                                                                  20400099
201550     MOVE  BILLER-ID  OF  DCLCTN-INV  TO                          20401099
201560                                        DETAIL-1-BILLER-ID        20402099
201570                                                                  20403099
      *  JA0912  -  Fix  Data  Bugs  in  L'  Indicator  of  MIN         20404099
      *             Note: L'  Indicator for Min-Num not correct for PO#s20405099
201570                                                                  20406099
201580     IF  MIN-NUM-TEXT  OF  DCLCTN-INV  >  ' '                     20407099
201590         MOVE  MIN-NUM-TEXT  OF  DCLCTN-INV  TO                   20408099
201600                                        DETAIL-1-MIN              20409099
201610        ELSE                                                      20410099
201620                                                                  20411099
201630         MOVE  SPACES  TO               DETAIL-1-MIN              20412099
201640     END-IF                                                       20413099
201650                                                                  20414099
201660     MOVE  CTN-STATUS OF  DCLCTN-INV  TO                          20415099
201670                                        DETAIL-1-CTN-STATUS       20416099
201680                                                                  20417099
201690     MOVE  NL  OF  DCLCTN-INV         TO  DETAIL-1-NL             20418099
201700                                                                  20419099
201710     MOVE  NGP OF  DCLCTN-INV         TO  DETAIL-1-NGP            20420099
201720                                                                  20421099
201730     MOVE  PORT-IND  OF  DCLCTN-INV   TO  DETAIL-1-PORT-IND       20422099
201740                                                                  20423099
201750     MOVE LAST-TRX-DATE  OF  DCLCTN-INV  TO                       20424099
201760                                      WS-CTNIN-LAST-TRX-DATE      20425099
201770                                                                  20426099
201780     PERFORM  2030-CONVERT-ETNI-DATE  THRU  2030-EXIT             20427099
201790                                                                  20428099
201800*  JA1011 - Below Comment / Replacement                           20429099
201810**   MOVE WS-ETNI-LAST-TRX-DATE-2-NUM  TO                         20430099
201820                                                                  20431099
201830     MOVE WS-ETNI-LAST-TRX-DATE-2      TO                         20432099
201840                                      DETAIL-1-LAST-TRX-DT        20433099
201850                                                                  20434099
201860     PERFORM  6400-WRITE-RECON-RPT                                20435099
201870                                     THRU 6400-EXIT               20436099
201880                                                                  20437099
201890**  Process  eTNI  Report  Line                                   20438099
201900**    From  Updates                                               20439099
201910                                                                  20440099
201920     MOVE   'ETNI'              TO   WS-SYSTEM                    20441099
201930                                     DETAIL-1-SYSTEM              20442099
201940                                                                  20443099
201950     MOVE  SPACES               TO   WS-COMMENT                   20444099
201960                                     WS-ADDTL-INFO                20445099
201970                                     DETAIL-1-COMMENT             20446099
201980                                     DETAIL-1-ADDTL-INFO          20447099
201990                                     DETAIL-1-MDN                 20448099
202000                                     DETAIL-1-MIN                 20449099
202010**                                   DETAIL-1-P-TYPE              20450099
202020                                     DETAIL-1-CTN-STATUS          20451099
202030                                     DETAIL-1-NGP                 20452099
202040                                     DETAIL-1-PORT-IND            20453099
202050                                     DETAIL-1-LAST-TRX-CD         20454099
202060                                                                  20455099
202070**                                                                20456099
202080**  JA0308  -  Status  Update,  If  RSS - Only -                  20457099
202090**                                                                20458099
202100**  JA0402  - WS-LEGIT-BILLER-ID-RESELLER added                   20459099
202110**                                                                20460099
202120     IF  WS-LEGIT-BILLER-ID-RESELLER                              20461099
202130         MOVE  MDNIN-MDN-STATUS  TO  DETAIL-1-CTN-STATUS          20462099
202140     END-IF                                                       20463099
202150                                                                  20464099
202160     MOVE   WS-TIMESTAMP  TO          WS-CTNIN-LAST-TRX-DATE      20465099
202170                                                                  20466099
202180     PERFORM  2030-CONVERT-ETNI-DATE  THRU  2030-EXIT             20467099
202190*  JA1011 - Below - Comment / Replace                             20468099
202200*    MOVE WS-BILL-LAST-TRX-DATE-2-NUM  TO                         20469099
202210     MOVE WS-ETNI-LAST-TRX-DATE-2      TO                         20470099
202220                                      DETAIL-1-LAST-TRX-DT        20471099
202230                                                                  20472099
202240     MOVE  MDNIN-BILLER-ID  OF  MDNIN-DETAIL-FIELDS  TO           20473099
202250                                        DETAIL-1-BILLER-ID        20474099
202260                                                                  20475099
202270     MOVE  WS-MDNIN-DETAIL-NL  TO  DETAIL-1-NL                    20476099
202280                                                                  20477099
202290     PERFORM  6400-WRITE-RECON-RPT                                20478099
202300                                     THRU 6400-EXIT               20479099
202310     .                                                            20480099
202320 7053-EXIT.                                                       20481099
202330      EXIT.                                                       20482099
202340                                                                  20483099
202350 7054-WRITE-ERROR-RPT.                                            20484099
202360                                                                  20485099
202370**  Process  eTNI  Report  Line                                   20486099
202380**    From  Old CTN-INV                                           20487099
202390                                                                  20488099
202400     MOVE   'ETNI'              TO   WS-SYSTEM                    20489099
202410                                     DETAIL-1-SYSTEM              20490099
202420     MOVE  SPACES               TO   WS-COMMENT                   20491099
202430                                     WS-ADDTL-INFO                20492099
202440                                     DETAIL-1-COMMENT             20493099
202450                                     DETAIL-1-ADDTL-INFO          20494099
202460                                                                  20495099
202470     MOVE  BILLER-ID  OF  DCLCTN-INV  TO                          20496099
202480                                        DETAIL-1-BILLER-ID        20497099
202490                                                                  20498099
202500     IF  MIN-NUM-LEN  OF  DCLCTN-INV  >  +0                       20499099
202510         MOVE  MIN-NUM-TEXT  OF  DCLCTN-INV  TO                   20500099
202520                                        DETAIL-1-MIN              20501099
202530        ELSE                                                      20502099
202540                                                                  20503099
202550         MOVE  SPACES  TO               DETAIL-1-MIN              20504099
202560     END-IF                                                       20505099
202570                                                                  20506099
202580     MOVE  CTN-STATUS OF  DCLCTN-INV  TO                          20507099
202590                                        DETAIL-1-CTN-STATUS       20508099
202600                                                                  20509099
202610     MOVE  NL  OF  DCLCTN-INV         TO  DETAIL-1-NL             20510099
202620                                                                  20511099
202630     MOVE  NGP OF  DCLCTN-INV         TO  DETAIL-1-NGP            20512099
202640                                                                  20513099
202650     MOVE  PORT-IND  OF  DCLCTN-INV   TO  DETAIL-1-PORT-IND       20514099
202660                                                                  20515099
202670     MOVE LAST-TRX-DATE  OF  DCLCTN-INV  TO                       20516099
202680                                      WS-CTNIN-LAST-TRX-DATE      20517099
202690                                                                  20518099
202700     PERFORM  2030-CONVERT-ETNI-DATE  THRU  2030-EXIT             20519099
202710                                                                  20520099
202720*  JA1011 - Below - Comment / Replace                             20521099
202730**   MOVE WS-ETNI-LAST-TRX-DATE-2-NUM  TO                         20522099
202740     MOVE WS-ETNI-LAST-TRX-DATE-2      TO                         20523099
202750                                      DETAIL-1-LAST-TRX-DT        20524099
202760                                                                  20525099
202770     PERFORM 6500-WRITE-ERROR-RPT      THRU 6500-EXIT             20526099
202780                                                                  20527099
202790     .                                                            20528099
202800 7054-EXIT.                                                       20529099
202810      EXIT.                                                       20530099
202820                                                                  20531099
202830 7075-IS-GATEWAY-INTRASERV-PORT.                                  20532099
202840      MOVE '7075-IS-GATEWAY-INTRASERV-PORT' TO WS-CURR-PARA       20533099
202850      MOVE MDNIN-MDN(1:3) TO WS-WORK-MDN-NPA                      20534099
202860      MOVE MDNIN-MDN(4:3) TO WS-WORK-MDN-NXX                      20535099
202870      MOVE MDNIN-MDN(7:4) TO WS-WORK-MDN-LINE                     20536099
202880      MOVE WS-WORK-MDN-WITH-DASHES TO                             20537099
202890           PORTED-NUM OF DCLGATEWAY-MSG-DET                       20538099
202900*-----this routine only executed for Port Outs (PORT-IND = "PO"), 20539099
202910*-----so it's safe to select only "PQ2" MSG-TYPE------------------20540099
202920      EXEC SQL                                                    20541099
202930      SELECT                                                      20542099
202940           REQ_NO                                                 20543099
202950      INTO                                                        20544099
202960          :DCLGATEWAY-MSG-DET.REQ-NO                              20545099
202970      FROM GATEWAY_MSG_DET A                                      20546099
202980      WHERE                                                       20547099
202990           A.PORTED_NUM = :DCLGATEWAY-MSG-DET.PORTED-NUM AND      20548099
203000           A.MSG_TYPE   = 'PQ2' AND                               20549099
203010           A.AUD_TIMESTAMP =                                      20550099
203020             (SELECT MAX(AUD_TIMESTAMP)                           20551099
203030              FROM  GATEWAY_MSG_DET B                             20552099
203040              WHERE B.PORTED_NUM = :DCLGATEWAY-MSG-DET.PORTED-NUM 20553099
203050              AND   B.MSG_TYPE   = 'PQ2')                         20554099
203060              END-EXEC                                            20555099
203070                                                                  20556099
203080*-----MDN not in Gateway Detail. It's not an Intraservice port----20557099
203090      IF SQLCODE = 100                                            20558099
203100         MOVE 'N' TO GATEWAY-INTRASERV-PORT                       20559099
203110         GO 7075-EXIT                                             20560099
203120         END-IF                                                   20561099
203130                                                                  20562099
203140      IF SQLCODE NOT = 100 AND SQLCODE NOT = 0                    20563099
203150         MOVE SQLCODE TO WS-SQLCODE                               20564099
203160         SET WS-ERROR-FIELDS-FOUND TO TRUE                        20565099
203170         DISPLAY ' '                                              20566099
203180         DISPLAY '    In 7075-IS-GATEWAY-INTRASERV-PORT'          20567099
203190         DISPLAY ' '                                              20568099
203200         DISPLAY '>>>> Table where abend occured: GATEWAY-MSG-DET'20569099
203210         DISPLAY '>>>> MDN/CTN at Abend Time: ' MDNIN-MDN ' <<<<' 20570099
203220         DISPLAY ' '                                              20571099
203230         PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT              20572099
203240         MOVE    SQLCODE TO WS-ABEND-CODE                         20573099
203250         STRING 'FATAL SQL ERROR!!!  SQLCODE: '                   20574099
203260                 WS-ABEND-CODE                                    20575099
203270                 DELIMITED BY SIZE                                20576099
203280                 INTO WS-ABEND-TEXT                               20577099
203290         END-STRING                                               20578099
203300         PERFORM 9000-ABORT THRU 9000-EXIT                        20579099
203310         GO TO 7075-EXIT                                          20580099
203320         END-IF                                                   20581099
203330                                                                  20582099
203340*-----if we found Detail, now check the Gateway Header to find----20583099
203350*-----New Network Serv Provider and the Old Network Serv Provider.20584099
203360*-----If they're both the same and they're both 6006 (VZW), then--20585099
203370*-----this is an Intra-Service Port-------------------------------20586099
203380                                                                  20587099
203390*-----this routine only executed for Port Outs (PORT-IND = "PO"), 20588099
203400*-----so it's safe to select only "PQ2" MSG-TYPE------------------20589099
203410      EXEC SQL                                                    20590099
203420      SELECT                                                      20591099
203430           NNSP,                                                  20592099
203440           ONSP                                                   20593099
203450      INTO                                                        20594099
203460          :DCLGATEWAY-MSG-HDR.NNSP,                               20595099
203470          :DCLGATEWAY-MSG-HDR.ONSP                                20596099
203480      FROM GATEWAY_MSG_HDR A                                      20597099
203490      WHERE                                                       20598099
203500           A.REQ_NO = :DCLGATEWAY-MSG-DET.REQ-NO AND              20599099
203510           A.MSG_TYPE   = 'PQ2' AND                               20600099
203520           A.TIMESTAMP =                                          20601099
203530              (SELECT MAX(TIMESTAMP)                              20602099
203540               FROM  GATEWAY_MSG_HDR B                            20603099
203550               WHERE B.REQ_NO = :DCLGATEWAY-MSG-DET.REQ-NO        20604099
203560               AND   B.MSG_TYPE   = 'PQ2')                        20605099
203570               END-EXEC                                           20606099
203580                                                                  20607099
203590*-----Can't find Gateway Header. It's not an Intraservice port----20608099
203600      IF SQLCODE = 100                                            20609099
203610         MOVE 'N' TO GATEWAY-INTRASERV-PORT                       20610099
203620         GO 7075-EXIT                                             20611099
203630         END-IF                                                   20612099
203640                                                                  20613099
203650      IF SQLCODE NOT = 100 AND SQLCODE NOT = 0                    20614099
203660         MOVE SQLCODE TO WS-SQLCODE                               20615099
203670         SET WS-ERROR-FIELDS-FOUND TO TRUE                        20616099
203680         DISPLAY ' '                                              20617099
203690         DISPLAY '    In 7075-IS-GATEWAY-INTRASERV-PORT'          20618099
203700         DISPLAY ' '                                              20619099
203710         DISPLAY '>>>> Table where abend occured: GATEWAY-MSG-HDR'20620099
203720         DISPLAY '>>>> MDN/CTN at Abend Time: ' MDNIN-MDN ' <<<<' 20621099
203730         DISPLAY ' '                                              20622099
203740         PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT              20623099
203750         MOVE    SQLCODE TO WS-ABEND-CODE                         20624099
203760         STRING 'FATAL SQL ERROR!!!  SQLCODE: '                   20625099
203770                 WS-ABEND-CODE                                    20626099
203780                 DELIMITED BY SIZE                                20627099
203790                 INTO WS-ABEND-TEXT                               20628099
203800         END-STRING                                               20629099
203810         PERFORM 9000-ABORT THRU 9000-EXIT                        20630099
203820         GO TO 7075-EXIT                                          20631099
203830         END-IF                                                   20632099
203840                                                                  20633099
203850*-----if New Network Service Provider same as Old one and they----20634099
203860*-----are BOTH 6006 (Verizon Wireless), it's an Intraserv port----20635099
203870      MOVE 'N' TO GATEWAY-INTRASERV-PORT                          20636099
203880      IF NNSP OF DCLGATEWAY-MSG-HDR = ONSP OF DCLGATEWAY-MSG-HDR  20637099
203890      AND                                                         20638099
203900         NNSP OF DCLGATEWAY-MSG-HDR = '6006'                      20639099
203910         MOVE 'Y' TO GATEWAY-INTRASERV-PORT                       20640099
203920         END-IF.                                                  20641099
203930 7075-EXIT.                                                       20642099
203940      EXIT.                                                       20643099
203950                                                                  20644099
203960 7080-CHECK-OWNERSHIP-LERG13.                                     20645099
203970      MOVE '7080-CHECK-OWNERSHIP-LERG13' TO WS-CURR-PARA          20646099
203980      MOVE MDNIN-MDN(1:3) TO NPA OF TNI-LERG-13                   20647099
203990      MOVE MDNIN-MDN(4:3) TO NXX OF TNI-LERG-13                   20648099
204000      MOVE MDNIN-MDN(7:4) TO WS-LINE                              20649099
204010      MOVE WS-LINE-NUMERIC TO WS-LINE-RANGE                       20650099
204020      EXEC SQL                                                    20651099
204030           SELECT                                                 20652099
204040           ADMIN_OCN,                                             20653099
204050           STATUS_CD                                              20654099
204060       INTO                                                       20655099
204070          :TNI-LERG-13.ADMIN-OCN                                  20656099
204080               :TNI-LERG-13-NULL-INDS.ADMIN-OCN-NI,               20657099
204090          :TNI-LERG-13.STATUS-CD                                  20658099
204100               :TNI-LERG-13-NULL-INDS.STATUS-CD-NI                20659099
204110       FROM TNI_LERG_13 A                                         20660099
204120       WHERE                                                      20661099
204130            A.NPA = :TNI-LERG-13.NPA AND                          20662099
204140            A.NXX = :TNI-LERG-13.NXX AND                          20663099
204150            A.BLOCK_IND = 'A' AND                                 20664099
204160            A.EFFECTIVE_DATE =                                    20665099
204170                    (SELECT MAX (EFFECTIVE_DATE)                  20666099
204180                            FROM  TNI_LERG_13 B                   20667099
204190                     WHERE  B.NPA = :TNI-LERG-13.NPA AND          20668099
204200                            B.NXX = :TNI-LERG-13.NXX AND          20669099
204210                            B.BLOCK_IND = 'A' AND                 20670099
204220                            B.EFFECTIVE_DATE <= :WS-EFF-DT)       20671099
204230            END-EXEC                                              20672099
204240                                                                  20673099
204250*-----if found at the Code Holder level, line range is 0 thru-----20674099
204260*-----9999, so it matches whatever the line is for this NPA/NXX---20675099
204270*-----Note that both the Code Holder level and Block holder level-20676099
204280*-----are checked for each NPA/NXX--------------------------------20677099
204290                                                                  20678099
204300      INITIALIZE WS-OWNERSHIP-VARIABLES                           20679099
204310                                                                  20680099
204320      MOVE SQLCODE TO WS-SQLCODE                                  20681099
204330      IF SQLCODE = ZERO AND                                       20682099
204340         STATUS-CD OF TNI-LERG-13 NOT = 'D'                       20683099
204350         MOVE 'Y' TO WS-FOUND-AS-CODE-HOLDER                      20684099
204360         IF ADMIN-OCN-NI OF TNI-LERG-13-NULL-INDS = -1            20685099
204370            MOVE SPACE TO ADMIN-OCN OF TNI-LERG-13                20686099
204380            END-IF                                                20687099
204390         IF ADMIN-OCN OF TNI-LERG-13 = 'G056'                     20688099
204400            MOVE 'Y' TO WS-VZW-OWNED-AS-CODE-HOLDER               20689099
204410            END-IF                                                20690099
204420      END-IF                                                      20691099
204430                                                                  20692099
204440*-----If found at the CodeHolder level and owner is VZW, check----20693099
204450*-----this NPA/NXX at Block-level (0 - 9)-------------------------20694099
204460*-----First, do a check to see if there are any at the Block Level20695099
204470*-----for ANY line-range for this NPA/NXX. If there are NONE,-----20696099
204480*-----then the CodeHolder level row was the only one and no-------20697099
204490*-----donated blocks exist for this NPA/NXX at BlockHolder level--20698099
204500                                                                  20699099
204510      MOVE ZERO TO EXISTANCE-FLAG                                 20700099
204520      IF SQLCODE = ZERO AND                                       20701099
204530         WS-FOUND-AS-CODE-HOLDER = 'Y' AND                        20702099
204540         WS-VZW-OWNED-AS-CODE-HOLDER = 'Y'                        20703099
204550         EXEC SQL                                                 20704099
204560              SELECT 1                                            20705099
204570         INTO                                                     20706099
204580              :EXISTANCE-FLAG                                     20707099
204590         FROM TNI_LERG_13 A                                       20708099
204600         WHERE                                                    20709099
204610             A.NPA = :TNI-LERG-13.NPA AND                         20710099
204620             A.NXX = :TNI-LERG-13.NXX AND                         20711099
204630             A.BLOCK_IND >= '0' AND                               20712099
204640             A.EFFECTIVE_DATE =                                   20713099
204650                 (SELECT MAX (EFFECTIVE_DATE)                     20714099
204660                  FROM  TNI_LERG_13 B                             20715099
204670                  WHERE B.NPA = :TNI-LERG-13.NPA AND              20716099
204680                        B.NXX = :TNI-LERG-13.NXX AND              20717099
204690                        B.BLOCK_IND = A.BLOCK_IND AND             20718099
204700                        B.EFFECTIVE_DATE <= :WS-EFF-DT)           20719099
204710                  END-EXEC                                        20720099
204720              MOVE SQLCODE TO WS-SQLCODE                          20721099
204730*-------------if not found at Block Level, it means that this-----20722099
204740*-------------NPA/NXX is Exclusively owned at Code level by-------20723099
204750*-------------VZW. There are NO donated blocks.-------------------20724099
204760              IF EXISTANCE-FLAG = 0 OR                            20725099
204770                 SQLCODE = 100                                    20726099
204780                 MOVE ZERO TO SQLCODE                             20727099
204790                 MOVE 'Y' TO WS-VZW-OWNED-AS-CODE-HOLDER-EX       20728099
204800                 GO TO 7080-EXIT                                  20729099
204810                 END-IF                                           20730099
204820*-------------if more than 1 row returned, reset sqlcode/exit-----20731099
204830*-------------and continue with further tests.--------------------20732099
204840*-------------This means there are BlockHolder rows for NPA/NXX---20733099
204850              IF SQLCODE = -811                                   20734099
204860                 MOVE ZERO TO SQLCODE                             20735099
204870                 END-IF                                           20736099
204880*-------------otherwise SQL code is bad and needs evaluation------20737099
204890              IF SQLCODE NOT = 100 AND                            20738099
204900                 SQLCODE NOT = ZERO                               20739099
204910                 GO TO 7080-EVALUATE-SQLCODE                      20740099
204920                 END-IF                                           20741099
204930          END-IF                                                  20742099
204940                                                                  20743099
204950*-----If row was found, it means there is a Block Holder of one---20744099
204960*-----or more of NPA/NXX's line-ranges. Search non-"A" Block-Ind--20745099
204970*-----rows to see if there is a Block Holder of this particular---20746099
204980*-----Line Range. since multiple rows can hold the results,-------20747099
204990*-----also check for Max Effective-Date---------------------------20748099
205000                                                                  20749099
205010      EXEC SQL                                                    20750099
205020           SELECT                                                 20751099
205030           ADMIN_OCN,                                             20752099
205040           STATUS_CD                                              20753099
205050      INTO                                                        20754099
205060          :TNI-LERG-13.ADMIN-OCN                                  20755099
205070               :TNI-LERG-13-NULL-INDS.ADMIN-OCN-NI,               20756099
205080          :TNI-LERG-13.STATUS-CD                                  20757099
205090               :TNI-LERG-13-NULL-INDS.STATUS-CD-NI                20758099
205100      FROM TNI_LERG_13 A                                          20759099
205110      WHERE                                                       20760099
205120           A.NPA = :TNI-LERG-13.NPA AND                           20761099
205130           A.NXX = :TNI-LERG-13.NXX AND                           20762099
205140           A.BLOCK_IND <> 'A' AND                                 20763099
205150          (:WS-LINE-RANGE BETWEEN A.LINES_FROM AND A.LINES_TO) AND20764099
205160           A.EFFECTIVE_DATE =                                     20765099
205170              (SELECT MAX (EFFECTIVE_DATE)                        20766099
205180               FROM  TNI_LERG_13 B                                20767099
205190               WHERE B.NPA = :TNI-LERG-13.NPA AND                 20768099
205200                     B.NXX = :TNI-LERG-13.NXX AND                 20769099
205210                     B.BLOCK_IND <> 'A' AND                       20770099
205220                   (:WS-LINE-RANGE BETWEEN B.LINES_FROM AND       20771099
205230                     B.LINES_TO) AND                              20772099
205240                     B.EFFECTIVE_DATE <= :WS-EFF-DT)              20773099
205250               END-EXEC                                           20774099
205260                                                                  20775099
205270      MOVE SQLCODE TO WS-SQLCODE                                  20776099
205280      IF SQLCODE = ZERO                                           20777099
205290         MOVE 'Y' TO WS-FOUND-AS-BLOCK-HOLDER                     20778099
205300         IF ADMIN-OCN-NI OF TNI-LERG-13-NULL-INDS = -1            20779099
205310            MOVE SPACE TO ADMIN-OCN OF TNI-LERG-13                20780099
205320            END-IF                                                20781099
205330                                                                  20782099
205340*--------if VZW ows Block level (and not deleted), add to accum---20783099
205350         IF ADMIN-OCN OF TNI-LERG-13 = 'G056' AND                 20784099
205360            STATUS-CD OF TNI-LERG-13 NOT = 'D'                    20785099
205370            MOVE 'Y' TO WS-VZW-OWNED-AS-BLOCK-HOLDER              20786099
205380            END-IF                                                20787099
205390                                                                  20788099
205400         END-IF.                                                  20789099
205410                                                                  20790099
205420 7080-EVALUATE-SQLCODE.                                           20791099
205430      IF SQLCODE = 100                                            20792099
205440         MOVE ZERO TO SQLCODE                                     20793099
205450         END-IF                                                   20794099
205460                                                                  20795099
205470      IF SQLCODE NOT = 100 AND SQLCODE NOT = 0                    20796099
205480         MOVE SQLCODE TO WS-SQLCODE                               20797099
205490         SET WS-ERROR-FIELDS-FOUND TO TRUE                        20798099
205500         DISPLAY ' '                                              20799099
205510         DISPLAY '    In 7080-CHECK-OWNERSHIP-LERG13'             20800099
205520         DISPLAY '>>>> MDN/CTN at Abend Time: ' MDNIN-MDN '<<<<'  20801099
205530         DISPLAY ' '                                              20802099
205540         PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT              20803099
205550         MOVE    SQLCODE TO WS-ABEND-CODE                         20804099
205560         STRING 'FATAL SQL ERROR!!!  SQLCODE: '                   20805099
205570                 WS-ABEND-CODE                                    20806099
205580                 DELIMITED BY SIZE                                20807099
205590                 INTO WS-ABEND-TEXT                               20808099
205600         END-STRING                                               20809099
205610         PERFORM 9000-ABORT THRU 9000-EXIT                        20810099
205620         END-IF.                                                  20811099
205630 7080-EXIT.                                                       20812099
205640      EXIT.                                                       20813099
205650                                                                  20814099
205660 7090-CHECK-FOR-OVRRIDE-AGING.                                    20815099
205670      INITIALIZE IS-THIS-RECENT-HISTORY                           20816099
205680      EXEC SQL                                                    20817099
205690           SELECT MAX(LAST_TRX_DATE)                              20818099
205700      INTO                                                        20819099
205710          :DCLCTN-INV-HISTORY.LAST-TRX-DATE                       20820099
205720      FROM CTN_INV_HISTORY                                        20821099
205730      WHERE                                                       20822099
205740           CTN = :WS-MDN-HISTORY                                  20823099
205750      END-EXEC                                                    20824099
205760                                                                  20825099
205770          MOVE LAST-TRX-DATE OF DCLCTN-INV-HISTORY(1:4) TO        20826099
205780               WS-HIST-LAST-TRX-DATE-CCYY                         20827099
205790          MOVE LAST-TRX-DATE OF DCLCTN-INV-HISTORY(6:2) TO        20828099
205800               WS-HIST-LAST-TRX-DATE-MM                           20829099
205810          MOVE LAST-TRX-DATE OF DCLCTN-INV-HISTORY(9:2) TO        20830099
205820               WS-HIST-LAST-TRX-DATE-DD                           20831099
205830          MOVE LAST-TRX-DATE OF DCLCTN-INV-HISTORY(12:2) TO       20832099
205840               WS-HIST-LAST-TRX-DATE-HH                           20833099
205850          MOVE LAST-TRX-DATE OF DCLCTN-INV-HISTORY(15:2) TO       20834099
205860               WS-HIST-LAST-TRX-DATE-MI                           20835099
205870          MOVE LAST-TRX-DATE OF DCLCTN-INV-HISTORY(18:2) TO       20836099
205880               WS-HIST-LAST-TRX-DATE-SS                           20837099
205890                                                                  20838099
205900*---------if the latest HISTORY date is more recent than Header---20839099
205910*---------date minus 1 day,      the HISTORY is recent------------20840099
205920          IF WS-HIST-LAST-TRX-DATE-NUM >                          20841099
205930             WS-HDR-DATE-TIME-MINUS-1DAY                          20842099
205940             MOVE 'Y' TO IS-THIS-RECENT-HISTORY                   20843099
205950             ADD 1 TO HISTORY-TOO-RECENT-COUNT                    20844099
205960             END-IF.                                              20845099
205970 7090-EXIT.                                                       20846099
205980      EXIT.                                                       20847099
205990                                                                  20848099
206000 7091-CHECK-CTN-INV.                                              20849099
206010                                                                  20850099
206020     EXEC SQL                                                     20851099
206030      SELECT COUNT(*)                                             20852099
206040        INTO                                                      20853099
206050        :WS-CTN-INV-NEW-COUNT                                     20854099
206060        FROM  CTN_INV                                             20855099
206070        WHERE CTN            = :WS-CTN-CHECK                      20856099
206080        AND   LAST_TRX_DATE  >  CURRENT  TIMESTAMP  -  1  DAY     20857099
206090     END-EXEC                                                     20858099
206100                                                                  20859099
206110     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    20860099
206120     .                                                            20861099
206130 7091-EXIT.                                                       20862099
206140      EXIT.                                                       20863099
206150                                                                  20864099
206160 7095-ATTEMPT-DELETE-BILLING-PR.                                  20865099
206170******************************************************************20866099
206180**                                                                20867099
206190**  Attempt  to  Delete  From  Billing-Profile-MDN  Table         20868099
206200**                                                                20869099
206210******************************************************************20870099
206220                                                                  20871099
206230**  JA1208A                                                       20872099
206240                                                                  20873099
206250     INITIALIZE  SQLCODE                                          20874099
206260                                                                  20875099
206270     EXEC SQL                                                     20876099
206280      DELETE FROM  BL_MDN_PROFILE                                 20877099
206290        WHERE MDN  = :MDNIN-MDN                                   20878099
206300     END-EXEC                                                     20879099
206310                                                                  20880099
206320     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    20881099
206330                                                                  20882099
206340     IF  SQLCODE  =   +0                                          20883099
206350         ADD  +1  TO  WS-TOTL-BL-MDN-PROFILE-DEL                  20884099
206360         ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                         20885099
206370     END-IF                                                       20886099
206380                                                                  20887099
206390     .                                                            20888099
206400 7095-EXIT.                                                       20889099
206410      EXIT.                                                       20890099
206420                                                                  20891099
206430 7097-SELECT-TNI-MDN-MIN.                                         20892099
206440******************************************************************20893099
206450*C  PARAGRAPH NAME:  7097-SELECT-TNI-MDN-MIN                      20894099
206460*C                                                                20895099
206470*C  PURPOSE:                                                      20896099
206480*C                                                                20897099
206490*C  SELECT TNI-MDN-MIN TABLE                                      20898099
206500*C                                                                20899099
206510*C  PRIMARY PROGRAM FUNCTIONS:                                    20900099
206520*C                                                                20901099
206530*C     - SELECT TNI-MDN-MIN                                       20902099
206540*C     - MOVE SQLCODE                                             20903099
206550******************************************************************20904099
206560     MOVE '7097-SELECT-TNI-MDN-MIN'  TO WS-CURR-PARA              20905099
206570                                                                  20906099
206580     INITIALIZE SQLCODE                                           20907099
206590                DCLTNI-MDN-MIN                                    20908099
206600                                                                  20909099
206610     MOVE  MDNIN-MDN  TO  WS-MDNIN-MDNX                           20910099
206620     MOVE  WS-MDNIN-MDN9  TO  WS-MDN-COMP-3                       20911099
206630                                                                  20912099
206640     MOVE  MDNIN-MIN-NUM  TO  WS-MIN-COMP-3                       20913099
206650                                                                  20914099
206660      EXEC SQL                                                    20915099
206670                                                                  20916099
206680         SELECT                                                   20917099
206690              IMSI,                                               20918099
206700              ICC_ID_4G                                           20919099
206710         INTO                                                     20920099
206720             :DCLTNI-MDN-MIN.IMSI,                                20921099
206730             :DCLTNI-MDN-MIN.ICC-ID-4G                            20922099
206740                                                                  20923099
206750         FROM TNI_MDN_MIN                                         20924099
206760                                                                  20925099
206770         WHERE                                                    20926099
206780             MDN = :WS-MDN-COMP-3                                 20927099
206790         AND MIN = :WS-MIN-COMP-3                                 20928099
206800                                                                  20929099
206810         WITH UR                                                  20930099
206820                                                                  20931099
206830      END-EXEC                                                    20932099
206840                                                                  20933099
206850     MOVE SQLCODE    TO WS-SQLCODE                                20934099
206860     MOVE WS-SQLCODE TO WS-SQLCODE-DS                             20935099
206870                                                                  20936099
206880     .                                                            20937099
206890**********                                                        20938099
206900 7097-EXIT.                                                       20939099
206910**********                                                        20940099
206920     EXIT.                                                        20941099
206930                                                                  20942099
206940 7100-INSERT-CTN-HIST.                                            20943099
206950******************************************************************20944099
206960*                                                                 20945099
206970*   PARAGRAPH NAME:  7100-INSERT-CTN-HIST                         20946099
206980*                                                                 20947099
206990*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO DO                20948099
207000*             INSERT ROWS INTO CTN-INV-HISTORY OF ETNI TABLE      20949099
207010*                                                                 20950099
207020*   PRIMARY PARAGRAPH FUNCTIONS:                                  20951099
207030*     - INSERT ROWS                                               20952099
207040*     - IR071503 PREVUDE PREPAID-IND                              20953099
207050*                                                                 20954099
207060******************************************************************20955099
207070     MOVE '7100-INSERT-CTN-HIST' TO WS-CURR-PARA                  20956099
207080     INITIALIZE SQLCODE                                           20957099
207090                                                                  20958099
207100*----if this is an MDN match, and only PORT-IND changed, but------20959099
207110*----PORT-IND change was disallowed, do not update history.-------20960099
207120*----This is for efficiency: prevents needless updates------------20961099
207130     IF PORT-IND-IS-THE-ONLY-CHANGE = 'Y' AND                     20962099
207140        ALLOW-PORT-IND-CHG NOT = 'Y'                              20963099
207150        MOVE ZERO TO SQLCODE                                      20964099
207160        GO TO 7100-EXIT                                           20965099
207170        END-IF                                                    20966099
207180                                                                  20967099
207190     EXEC SQL                                                     20968099
207200         INSERT                                                   20969099
207210          INTO CTN_INV_HISTORY                                    20970099
207220          (CTN,                                                   20971099
207230           LAST_TRX_DATE,                                         20972099
207240           SYS_CREATION_DATE,                                     20973099
207250           SYS_UPDATE_DATE,                                       20974099
207260           OPERATOR_ID,                                           20975099
207270           APPLICATION_ID,                                        20976099
207280           DL_SERVICE_CODE,                                       20977099
207290           DL_UPDATE_STAMP,                                       20978099
207300           LAST_TRX_CODE,                                         20979099
207310           CTN_STATUS,                                            20980099
207320           LAST_TRX_UID,                                          20981099
207330           NL,                                                    20982099
207340           NGP,                                                   20983099
207350           CONV_RUN_NO,                                           20984099
207360           SPECIAL_TRX_DATE,                                      20985099
207370           RUN_ID,                                                20986099
207380           HOLD_REASON,                                           20987099
207390           PRODUCT_TYPE,                                          20988099
207400           ICC_ID,                                                20989099
207410           PORT_IND,                                              20990099
207420           MIN_NUM,                                               20991099
207430           BILLER_ID,                                             20992099
207440           STATUS_REASON_CD,                                      20993099
207450           PREPAID_IND,                                           20994099
207460           IMSI,                                                  20995099
207470           ICC_ID_4G)                                             20996099
207480       VALUES                                                     20997099
207490          (:DCLCTN-INV-HISTORY.CTN                                20998099
207500          ,:DCLCTN-INV-HISTORY.LAST-TRX-DATE                      20999099
207510          ,:DCLCTN-INV-HISTORY.SYS-CREATION-DATE                  21000099
207520                                                                  21001099
207530*AGB052511 start                                                  21002099
207540          ,:DCLCTN-INV-HISTORY.SYS-UPDATE-DATE                    21003099
207550           :DCLCTN-INV-NULL-INDS.SYS-UPDATE-DATE-NI               21004099
207560********* ,CURRENT TIMESTAMP + :WS-HRS HOURS                      21005099
207570*AGB052511 end                                                    21006099
207580                                                                  21007099
207590          ,:DCLCTN-INV-HISTORY.OPERATOR-ID                        21008099
207600           :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI                   21009099
207610          ,:DCLCTN-INV-HISTORY.APPLICATION-ID                     21010099
207620           :DCLCTN-INV-NULL-INDS.APPLICATION-ID-NI                21011099
207630          ,:DCLCTN-INV-HISTORY.DL-SERVICE-CODE                    21012099
207640          ,:DCLCTN-INV-HISTORY.DL-UPDATE-STAMP                    21013099
207650           :DCLCTN-INV-NULL-INDS.DL-UPDATE-STAMP-NI               21014099
207660          ,:DCLCTN-INV-HISTORY.LAST-TRX-CODE                      21015099
207670          ,:DCLCTN-INV-HISTORY.CTN-STATUS                         21016099
207680          ,:DCLCTN-INV-HISTORY.LAST-TRX-UID                       21017099
207690          ,:DCLCTN-INV-HISTORY.NL                                 21018099
207700           :DCLCTN-INV-NULL-INDS.NL-NI                            21019099
207710          ,:DCLCTN-INV-HISTORY.NGP                                21020099
207720          ,:DCLCTN-INV-HISTORY.CONV-RUN-NO                        21021099
207730           :DCLCTN-INV-NULL-INDS.CONV-RUN-NO-NI                   21022099
207740          ,:DCLCTN-INV-HISTORY.SPECIAL-TRX-DATE                   21023099
207750           :DCLCTN-INV-NULL-INDS.SPECIAL-TRX-DATE-NI              21024099
207760          ,:DCLCTN-INV-HISTORY.RUN-ID                             21025099
207770           :DCLCTN-INV-NULL-INDS.RUN-ID-NI                        21026099
207780          ,:DCLCTN-INV-HISTORY.HOLD-REASON                        21027099
207790           :DCLCTN-INV-NULL-INDS.HOLD-REASON-NI                   21028099
207800          ,:DCLCTN-INV-HISTORY.PRODUCT-TYPE                       21029099
207810          ,:DCLCTN-INV-HISTORY.ICC-ID                             21030099
207820           :DCLCTN-INV-NULL-INDS.ICC-ID-NI                        21031099
207830          ,:DCLCTN-INV-HISTORY.PORT-IND                           21032099
207840          ,:DCLCTN-INV-HISTORY.MIN-NUM                            21033099
207850           :DCLCTN-INV-NULL-INDS.MIN-NUM-NI                       21034099
207860          ,:DCLCTN-INV-HISTORY.BILLER-ID                          21035099
207870           :DCLCTN-INV-NULL-INDS.BILLER-ID-NI                     21036099
207880          ,:DCLCTN-INV-HISTORY.STATUS-REASON-CD                   21037099
207890          ,:DCLCTN-INV-HISTORY.PREPAID-IND                        21038099
207900           :DCLCTN-INV-NULL-INDS.PREPAID-IND-NI                   21039099
207910          ,:DCLCTN-INV-HISTORY.IMSI                               21040099
207920          ,:DCLCTN-INV-HISTORY.ICC-ID-4G)                         21041099
207930      END-EXEC.                                                   21042099
207940      IF  SQLCODE  =  +0                                          21043099
207950          ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                        21044099
207960      END-IF                                                      21045099
207970      .                                                           21046099
207980 7100-EXIT.                                                       21047099
207990      EXIT.                                                       21048099
208000                                                                  21049099
208010*------#830803----------------------                              21050099
208020 7120-RETRY-UP-TO-10-TIMES.                                       21051099
208030******************************************************************21052099
208040*                                                                 21053099
208050*   PARAGRAPH NAME:  7120-RETRY-UP-TO-10-TIMES                    21054099
208060*                                                                 21055099
208070*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO TRY TO DO         21056099
208080*             INSERT ROWS INTO CTN-INV-HISTORY OF ETNI TABLE      21057099
208090*                                                                 21058099
208100*   PRIMARY PARAGRAPH FUNCTIONS:                                  21059099
208110*     - INSERT ROWS WHEN 7100-INSERT-CTN-HIST GET DUPLICATES      21060099
208120*     -    LAST-TRX-DATE + 1 MICROSECONDS                         21061099
208130*     - IR071503 INCLUDE PREPAID-IND                              21062099
208140*                                                                 21063099
208150******************************************************************21064099
208160      MOVE '7120-RETRY-UP-TO-10-TIMES' TO WS-CURR-PARA            21065099
208170*-----check sqlcode from 1st insert attempt: if not a dupe, exit--21066099
208180      PERFORM 7130-EVALUATE-SQLCODE THRU 7130-EXIT                21067099
208190      IF NOT SQL-DUP-INSERT                                       21068099
208200         GO TO 7120-EXIT                                          21069099
208210         END-IF                                                   21070099
208220                                                                  21071099
208230*----it's a dupe key, increment LAST-TRX-DATE milliseconds by 1 up21072099
208240*----to 10 times and re-try insert. If still fails, it's a dupe!--21073099
208250      PERFORM VARYING RETRY-SUB FROM 1 BY 1                       21074099
208260*-----loop until max tries or good sqlcode or Non-Dupe bad sqlcode21075099
208270          UNTIL                                                   21076099
208280            RETRY-SUB > 9 OR SQL-SUCCESS                          21077099
208290              PERFORM 7125-REINSERT-CTN-INV-HIST THRU 7125-EXIT   21078099
208300              PERFORM 7130-EVALUATE-SQLCODE THRU 7130-EXIT        21079099
208310      END-PERFORM.                                                21080099
208320 7120-EXIT.                                                       21081099
208330      EXIT.                                                       21082099
208340                                                                  21083099
208350 7125-REINSERT-CTN-INV-HIST.                                      21084099
208360******************************************************************21085099
208370*                                                                 21086099
208380*   PARAGRAPH NAME:  7125-REINSERT-CTN-INV-HIST                   21087099
208390*                                                                 21088099
208400*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO DO                21089099
208410*             INSERT ROWS INTO CTN-INV-HISTORY OF ETNI TABLE      21090099
208420*                                                                 21091099
208430*   PRIMARY PARAGRAPH FUNCTIONS:                                  21092099
208440*     - INSERT ROWS WHEN 7100-INSERT-CTN-HIST GET DUPLICATES      21093099
208450*     -    LAST-TRX-DATE + 1 MICROSECONDS                         21094099
208460*     - IR071503 INCLUDE PREPAID-IND                              21095099
208470*                                                                 21096099
208480******************************************************************21097099
208490     MOVE '7125-REINSERT-CTN-INV-HIST' TO WS-CURR-PARA            21098099
208500                                                                  21099099
208510*----for each iteration of this routine, increment the millisecond21100099
208520*----portion of the LAST-TRX-DATE to prevent duplicate keys-------21101099
208530                                                                  21102099
208540     MOVE LAST-TRX-DATE OF DCLCTN-INV-HISTORY TO                  21103099
208550          UNSTRING-LAST-TRX-DATE                                  21104099
208560     ADD 1 TO LAST-BYTES-TRX-DATE                                 21105099
208570     MOVE UNSTRING-LAST-TRX-DATE TO                               21106099
208580          LAST-TRX-DATE OF DCLCTN-INV-HISTORY                     21107099
208590                                                                  21108099
208600     INITIALIZE SQLCODE                                           21109099
208610     EXEC SQL                                                     21110099
208620         INSERT                                                   21111099
208630          INTO CTN_INV_HISTORY                                    21112099
208640          (CTN,                                                   21113099
208650           LAST_TRX_DATE,                                         21114099
208660           SYS_CREATION_DATE,                                     21115099
208670           SYS_UPDATE_DATE,                                       21116099
208680           OPERATOR_ID,                                           21117099
208690           APPLICATION_ID,                                        21118099
208700           DL_SERVICE_CODE,                                       21119099
208710           DL_UPDATE_STAMP,                                       21120099
208720           LAST_TRX_CODE,                                         21121099
208730           CTN_STATUS,                                            21122099
208740           LAST_TRX_UID,                                          21123099
208750           NL,                                                    21124099
208760           NGP,                                                   21125099
208770           CONV_RUN_NO,                                           21126099
208780           SPECIAL_TRX_DATE,                                      21127099
208790           RUN_ID,                                                21128099
208800           HOLD_REASON,                                           21129099
208810           PRODUCT_TYPE,                                          21130099
208820           ICC_ID,                                                21131099
208830           PORT_IND,                                              21132099
208840           MIN_NUM,                                               21133099
208850           BILLER_ID,                                             21134099
208860           STATUS_REASON_CD,                                      21135099
208870           PREPAID_IND,                                           21136099
208880           IMSI,                                                  21137099
208890           ICC_ID_4G)                                             21138099
208900       VALUES                                                     21139099
208910          (:DCLCTN-INV-HISTORY.CTN                                21140099
208920          ,:DCLCTN-INV-HISTORY.LAST-TRX-DATE                      21141099
208930          ,:DCLCTN-INV-HISTORY.SYS-CREATION-DATE                  21142099
208940                                                                  21143099
208950*AGB052511 start                                                  21144099
208960          ,:DCLCTN-INV-HISTORY.SYS-UPDATE-DATE                    21145099
208970           :DCLCTN-INV-NULL-INDS.SYS-UPDATE-DATE-NI               21146099
208980********* ,CURRENT TIMESTAMP + :WS-HRS HOURS                      21147099
208990*AGB052511 end                                                    21148099
209000                                                                  21149099
209010          ,:DCLCTN-INV-HISTORY.OPERATOR-ID                        21150099
209020           :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI                   21151099
209030          ,:DCLCTN-INV-HISTORY.APPLICATION-ID                     21152099
209040           :DCLCTN-INV-NULL-INDS.APPLICATION-ID-NI                21153099
209050          ,:DCLCTN-INV-HISTORY.DL-SERVICE-CODE                    21154099
209060          ,:DCLCTN-INV-HISTORY.DL-UPDATE-STAMP                    21155099
209070           :DCLCTN-INV-NULL-INDS.DL-UPDATE-STAMP-NI               21156099
209080          ,:DCLCTN-INV-HISTORY.LAST-TRX-CODE                      21157099
209090          ,:DCLCTN-INV-HISTORY.CTN-STATUS                         21158099
209100          ,:DCLCTN-INV-HISTORY.LAST-TRX-UID                       21159099
209110          ,:DCLCTN-INV-HISTORY.NL                                 21160099
209120           :DCLCTN-INV-NULL-INDS.NL-NI                            21161099
209130          ,:DCLCTN-INV-HISTORY.NGP                                21162099
209140          ,:DCLCTN-INV-HISTORY.CONV-RUN-NO                        21163099
209150           :DCLCTN-INV-NULL-INDS.CONV-RUN-NO-NI                   21164099
209160          ,:DCLCTN-INV-HISTORY.SPECIAL-TRX-DATE                   21165099
209170           :DCLCTN-INV-NULL-INDS.SPECIAL-TRX-DATE-NI              21166099
209180          ,:DCLCTN-INV-HISTORY.RUN-ID                             21167099
209190           :DCLCTN-INV-NULL-INDS.RUN-ID-NI                        21168099
209200          ,:DCLCTN-INV-HISTORY.HOLD-REASON                        21169099
209210           :DCLCTN-INV-NULL-INDS.HOLD-REASON-NI                   21170099
209220          ,:DCLCTN-INV-HISTORY.PRODUCT-TYPE                       21171099
209230          ,:DCLCTN-INV-HISTORY.ICC-ID                             21172099
209240           :DCLCTN-INV-NULL-INDS.ICC-ID-NI                        21173099
209250          ,:DCLCTN-INV-HISTORY.PORT-IND                           21174099
209260          ,:DCLCTN-INV-HISTORY.MIN-NUM                            21175099
209270           :DCLCTN-INV-NULL-INDS.MIN-NUM-NI                       21176099
209280          ,:DCLCTN-INV-HISTORY.BILLER-ID                          21177099
209290           :DCLCTN-INV-NULL-INDS.BILLER-ID-NI                     21178099
209300          ,:DCLCTN-INV-HISTORY.STATUS-REASON-CD                   21179099
209310          ,:DCLCTN-INV-HISTORY.PREPAID-IND                        21180099
209320           :DCLCTN-INV-NULL-INDS.PREPAID-IND-NI                   21181099
209330          ,:DCLCTN-INV-HISTORY.IMSI                               21182099
209340          ,:DCLCTN-INV-HISTORY.ICC-ID-4G)                         21183099
209350      END-EXEC.                                                   21184099
209360      IF  SQLCODE  =  +0                                          21185099
209370          ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                        21186099
209380      END-IF                                                      21187099
209390      .                                                           21188099
209400 7125-EXIT.                                                       21189099
209410      EXIT.                                                       21190099
209420                                                                  21191099
209430 7130-EVALUATE-SQLCODE.                                           21192099
209440******************************************************************21193099
209450*                                                                 21194099
209460*   PARAGRAPH NAME:  7130-EVALUATE-SQLCODE                        21195099
209470*                                                                 21196099
209480*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO TRY TO DO         21197099
209490*             FIGURE OUT THE SQLCODE RETURN BY DB2                21198099
209500*                                                                 21199099
209510*   PRIMARY PARAGRAPH FUNCTIONS:                                  21200099
209520*     - FIGURE OUT THE SQLCODE RETURN BY DB2                      21201099
209530*                                                                 21202099
209540******************************************************************21203099
209550     MOVE '7130-EVALUATE-SQLOCODE  ' TO WS-CURR-PARA              21204099
209560      PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                   21205099
209570      EVALUATE TRUE                                               21206099
209580          WHEN SQL-SUCCESS                                        21207099
209590               ADD +1 TO WS-TOTL-ETNI-CTNHIST-INS-CNT             21208099
209600          WHEN SQL-DUP-INSERT                                     21209099
209610               ADD +1 TO WS-TOTL-ETNI-CTNHIST-DUPINS              21210099
209620                         WS-TOTL-ERROR-CTNHIST-DUPINS             21211099
209630      END-EVALUATE.                                               21212099
209640 7130-EXIT.                                                       21213099
209650      EXIT.                                                       21214099
209660                                                                  21215099
209670                                                                  21216099
209680 7200-CHECK-SPID-IN-LSMS.                                         21217099
209690      MOVE '7200-CHECK-SPID-IN-LSMS' TO WS-CURR-PARA              21218099
209700      INITIALIZE DCLTVZW-LSMS                                     21219099
209710      MOVE NUMERIC-CTNIN-CTN TO MDN OF DCLTVZW-LSMS               21220099
209720      MOVE 'N' TO CTN-HAS-VZW-SPID                                21221099
209730                                                                  21222099
209740      EXEC SQL                                                    21223099
209750           SELECT SPID                                            21224099
209760           INTO :DCLTVZW-LSMS.SPID                                21225099
209770           FROM TVZW_LSMS                                         21226099
209780           WHERE                                                  21227099
209790           MDN = :DCLTVZW-LSMS.MDN                                21228099
209800      END-EXEC                                                    21229099
209810                                                                  21230099
209820      IF SQLCODE = ZERO AND                                       21231099
209830         SPID OF DCLTVZW-LSMS = '6006'                            21232099
209840         MOVE 'Y' TO CTN-HAS-VZW-SPID                             21233099
209850         END-IF                                                   21234099
209860      IF SQLCODE = ZERO AND                                       21235099
209870         SPID OF DCLTVZW-LSMS NOT = '6006'                        21236099
209880         MOVE 'N' TO CTN-HAS-VZW-SPID                             21237099
209890         END-IF                                                   21238099
209900      IF SQLCODE = 100                                            21239099
209910         MOVE '?' TO CTN-HAS-VZW-SPID                             21240099
209920         END-IF                                                   21241099
209930      PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                   21242099
209940      .                                                           21243099
209950 7200-EXIT.                                                       21244099
209960      EXIT.                                                       21245099
209970                                                                  21246099
209980 7300-SELECT-NUMBER-GROUP.                                        21247099
209990******************************************************************21248099
210000*                                                                 21249099
210010*   PARAGRAPH NAME:  7300-SELECT-NUMBER-GROUP                     21250099
210020*                                                                 21251099
210030*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   21252099
210040*             GET NGP                                             21253099
210050*                                                                 21254099
210090******************************************************************21255099
210100     MOVE '7300-SELECT-NUMBER-GROUP' TO WS-CURR-PARA              21256099
210110                                                                  21257099
210120     EXEC SQL                                                     21258099
210130        SELECT                                                    21259099
210140           NGP_ID                                                 21260099
210150        INTO                                                      21261099
210160           :DCLNUMBER-GROUP.NGP-ID                                21262099
210170        FROM NUMBER_GROUP                                         21263099
210180        WHERE                                                     21264099
210190           NGP_ID = :WS-NGP                                       21265099
210200     END-EXEC                                                     21266099
210210                                                                  21267099
210220     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    21268099
210230                                                                  21269099
210240     .                                                            21270099
210250 7300-EXIT.                                                       21271099
210260     EXIT.                                                        21272099
210270                                                                  21273099
210280 7305-SELECT-NUMBER-GROUP.                                        21274099
210290******************************************************************21275099
210300*                                                                 21276099
210310*   PARAGRAPH NAME:  7305-SELECT-NUMBER-GROUP                     21277099
210320*                                                                 21278099
210330*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   21279099
210340*             GET NGP                                             21280099
210350*                                                                 21281099
210360*   PRIMARY PARAGRAPH FUNCTIONS:                                  21282099
210370*     - NGP                                                       21283099
210380*                                                                 21284099
210390******************************************************************21285099
210400     MOVE '7305-SELECT-NUMBER-GROUP' TO WS-CURR-PARA              21286099
210420                                                                  21287099
210430     EXEC SQL                                                     21288099
210440        SELECT                                                    21289099
210450           NGP_ID,                                                21290099
210460           BILLER_ID                                              21291099
210470        INTO                                                      21292099
210480           :DCLNUMBER-GROUP.NGP-ID,                               21293099
210490           :DCLNUMBER-GROUP.BILLER-ID                             21294099
210500        FROM NUMBER_GROUP                                         21295099
210510        WHERE                                                     21296099
210520           NGP_ID     = :WS-NGP  AND                              21297099
210530           BILLER_ID  = :DCLNUMBER-GROUP.BILLER-ID                21298099
210540     END-EXEC                                                     21299099
210550                                                                  21300099
210560     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    21301099
210570                                                                  21302099
210580     .                                                            21303099
210590 7305-EXIT.                                                       21304099
210600     EXIT.                                                        21305099
210610                                                                  21306099
210620 7306-SELECT-NUMBER-GROUP.                                        21307099
210630******************************************************************21308099
210640*                                                                 21309099
210650*   PARAGRAPH NAME:  7306-SELECT-NUMBER-GROUP                     21310099
210660*                                                                 21311099
210670*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   21312099
210680*             GET NGP  -  PER  WS-CTNIN-RECORD                    21313099
210690*                                                                 21314099
210730******************************************************************21315099
210740     MOVE '7306-SELECT-NUMBER-GROUP' TO WS-CURR-PARA              21316099
210750                                                                  21317099
210760     EXEC SQL                                                     21318099
210770        SELECT                                                    21319099
210780           NGP_ID,                                                21320099
210790           BILLER_ID                                              21321099
210800        INTO                                                      21322099
210810           :DCLNUMBER-GROUP.NGP-ID,                               21323099
210820           :DCLNUMBER-GROUP.BILLER-ID                             21324099
210830        FROM NUMBER_GROUP                                         21325099
210840        WHERE                                                     21326099
210850           NGP_ID     = :WS-CTNIN-NGP                             21327099
210860     END-EXEC                                                     21328099
210870                                                                  21329099
210880     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    21330099
210890                                                                  21331099
210900     .                                                            21332099
210910 7306-EXIT.                                                       21333099
210920     EXIT.                                                        21334099
210930                                                                  21335099
210940 7400-SELECT-NUMBER-LOCATION.                                     21336099
210950******************************************************************21337099
210960*                                                                 21338099
210970*   PARAGRAPH NAME:  7400-SELECT-NUMBER-LOCATION                  21339099
210980*                                                                 21340099
210990******************************************************************21341099
211000     MOVE '7400-SELECT-NUMBER-LOCATION' TO WS-CURR-PARA           21342099
211010                                                                  21343099
211020*  JA0312A  -  Extended  Query  Adding  Related-NL                21344099
211030                                                                  21345099
211040     INITIALIZE  DCLNUMBER-LOCATION                               21346099
211050                                                                  21347099
211060     EXEC SQL                                                     21348099
211070        SELECT                                                    21349099
211080           NL_ID,                                                 21350099
211090           RELATED_NL                                             21351099
211100        INTO                                                      21352099
211110           :DCLNUMBER-LOCATION.NL-ID,                             21353099
211120           :DCLNUMBER-LOCATION.RELATED-NL                         21354099
211125           :DCLNL-NULL-INDS.RELATED-NL-NI                         21355099
211130        FROM NUMBER_LOCATION                                      21356099
211140        WHERE                                                     21357099
211150           NL_ID = :WS-NL                                         21358099
211160     END-EXEC                                                     21359099
211170                                                                  21360099
211180     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    21361099
211190                                                                  21362099
211200     .                                                            21363099
211210 7400-EXIT.                                                       21364099
211220     EXIT.                                                        21365099
211230                                                                  21366099
211240 7500-SELECT-NUMBER-GRP-LOC.                                      21367099
211250******************************************************************21368099
211260*                                                                 21369099
211270*   PARAGRAPH NAME:  7500-SELECT-NUMBER-GRP-LOC                   21370099
211280*                                                                 21371099
211290*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   21372099
211300*             GET NL GRP LOC                                      21373099
211310*                                                                 21374099
211320*   PRIMARY PARAGRAPH FUNCTIONS:                                  21375099
211330*     - NGP                                                       21376099
211340*                                                                 21377099
211350******************************************************************21378099
211360     MOVE '7500-SELECT-NUMBER-GRP-LOC' TO WS-CURR-PARA            21379099
211370*----all 3 columns selected below are not nullable----------------21380099
211380     EXEC SQL                                                     21381099
211390        SELECT                                                    21382099
211400           NL                                                     21383099
211410          ,NGP                                                    21384099
211420          ,PRODUCT_TYPE                                           21385099
211430        INTO                                                      21386099
211440           :DCLNGP-NL-ASSIGNMENT.NL                               21387099
211450          ,:DCLNGP-NL-ASSIGNMENT.NGP                              21388099
211460          ,:DCLNGP-NL-ASSIGNMENT.PRODUCT-TYPE                     21389099
211470        FROM NGP_NL_ASSIGNMENT                                    21390099
211480        WHERE                                                     21391099
211490           NL           = :WS-NL           AND                    21392099
211500           NGP          = :WS-NGP          AND                    21393099
211510           PRODUCT_TYPE = :WS-PRODUCT-TYPE                        21394099
211520     END-EXEC                                                     21395099
211530                                                                  21396099
211540     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    21397099
211550                                                                  21398099
211560     .                                                            21399099
211570 7500-EXIT.                                                       21400099
211580     EXIT.                                                        21401099
211590                                                                  21402099
211600 7510-SELECT-NGP-NL-ASSIGNMENT.                                   21403099
211610******************************************************************21404099
211620*                                                                 21405099
211630*   PARAGRAPH NAME:  7510-SELECT-NPG-NL-ASSIGNMENT                21406099
211640*                                                                 21407099
211650*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   21408099
211660*             GET NGP NL ASSIGNMENT                               21409099
211670*                                                                 21410099
211710******************************************************************21411099
211720     MOVE '7510-SELECT-NGP-NL-ASSIGNMENT' TO WS-CURR-PARA         21412099
211730                                                                  21413099
211740     INITIALIZE  DCLNGP-NL-ASSIGNMENT                             21414099
211750                                                                  21415099
211760     EXEC SQL                                                     21416099
211770       SELECT                                                     21417099
211780          AA_STS_CNT                                              21418099
211790       INTO                                                       21419099
211800          :DCLNGP-NL-ASSIGNMENT.AA-STS-CNT                        21420099
211810       FROM                                                       21421099
211820          NGP_NL_ASSIGNMENT                                       21422099
211830       WHERE                                                      21423099
211840          NL            = :WS-NL                   AND            21424099
211850          NGP           = :WS-NGP                  AND            21425099
211860          PRODUCT_TYPE  = :WS-PRODUCT-TYPE                        21426099
211870     END-EXEC                                                     21427099
211880                                                                  21428099
211890     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    21429099
211900     .                                                            21430099
211910 7510-EXIT.                                                       21431099
211920     EXIT.                                                        21432099
211930                                                                  21433099
211940 7520-UPDATE-NGP-NL-ASSIGNMENT.                                   21434099
211950******************************************************************21435099
211960*                                                                 21436099
211970*   PARAGRAPH NAME:  7520-UPDATE-NPG-NL-ASSIGNMENT                21437099
211980*                                                                 21438099
211990*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   21439099
212000*                 NGP NL ASSIGNMENT                               21440099
212010*                                                                 21441099
212050******************************************************************21442099
212060     MOVE '7520-UPDATE-NGP-NL-ASSIGNMENT' TO WS-CURR-PARA         21443099
212070                                                                  21444099
212080*    IF WS-TIMESTAMP = SPACE OR LOW-VALUES                        21445099
212090*       MOVE -1 TO SYS-UPDATE-DATE-NI OF                          21446099
212100*            DCLNGP-NL-ASSIGNMENT-NULL-INDS                       21447099
212110*    ELSE                                                         21448099
212120*       MOVE  0 TO SYS-UPDATE-DATE-NI OF                          21449099
212130*            DCLNGP-NL-ASSIGNMENT-NULL-INDS                       21450099
212140*       END-IF                                                    21451099
212150                                                                  21452099
212160     EXEC SQL                                                     21453099
212170          UPDATE NGP_NL_ASSIGNMENT                                21454099
212180       SET                                                        21455099
212190          AA_STS_CNT      = :WS-QTY,                              21456099
212200          SYS_UPDATE_DATE = CURRENT TIMESTAMP + :WS-HRS HOURS     21457099
212210*              :DCLNGP-NL-ASSIGNMENT-NULL-INDS.SYS-UPDATE-DATE-NI 21458099
212220       WHERE                                                      21459099
212230          NL              = :WS-NL           AND                  21460099
212240          NGP             = :WS-NGP          AND                  21461099
212250          PRODUCT_TYPE    = :WS-PRODUCT-TYPE                      21462099
212260     END-EXEC                                                     21463099
212270                                                                  21464099
212280     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    21465099
212290                                                                  21466099
212300**  JA0909  -  Allow for  SQL-ROW-NOT-FOUND                       21467099
212310                                                                  21468099
212320     IF SQL-ROW-NOT-FOUND                                         21469099
212330        GO  TO  7520-UPDATE-NGP-NL-ASSIGN-10                      21470099
212340     END-IF                                                       21471099
212350                                                                  21472099
212360     IF SQL-SUCCESS                                               21473099
212370        ADD +1 TO WS-TOTL-ETNI-NGPNLAS-UPD-CNT                    21474099
212380        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          21475099
212390                                                                  21476099
212400        CONTINUE                                                  21477099
212410     ELSE                                                         21478099
212420        PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT               21479099
212430        MOVE    SQLCODE TO WS-ABEND-CODE                          21480099
212440        STRING 'FATAL SQL ERROR!!!  SQLCODE: '                    21481099
212450                WS-ABEND-CODE                                     21482099
212460                DELIMITED BY SIZE                                 21483099
212470                INTO WS-ABEND-TEXT                                21484099
212480        END-STRING                                                21485099
212490        PERFORM 9000-ABORT           THRU 9000-EXIT               21486099
212500     END-IF                                                       21487099
212510                                                                  21488099
212520     .                                                            21489099
212530 7520-UPDATE-NGP-NL-ASSIGN-10.                                    21490099
212540                                                                  21491099
212550**  JA1207A -  Start                                              21492099
212560                                                                  21493099
212570      MOVE  WS-NL             TO  WS-NL-CURRENT                   21494099
212580      MOVE  WS-NGP            TO  WS-NGP-CURRENT                  21495099
212590      MOVE  WS-PRODUCT-TYPE   TO  WS-PRODUCT-CURRENT              21496099
212600                                                                  21497099
212610**  JA1207A -  End                                                21498099
212620     .                                                            21499099
212630 7520-EXIT.                                                       21500099
212640     EXIT.                                                        21501099
212650                                                                  21502099
212660 7550-CHECK-HIST-FOR-TRX-DATE.                                    21503099
212670*-----repeat select until > 30 tries or no matching TRX Date found21504099
212680      INITIALIZE SQLCODE                                          21505099
212690      PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 30 OR           21506099
212700                                            SQLCODE = 100         21507099
212710      INITIALIZE SQLCODE                                          21508099
212720      EXEC SQL                                                    21509099
212730           SELECT 1                                               21510099
212740           INTO  :WS-EXIST-FLAG                                   21511099
212750           FROM   CTN_INV_HISTORY                                 21512099
212760           WHERE  CTN = :WS-MDN  AND                              21513099
212770                  LAST_TRX_DATE = :DCLCTN-INV.LAST-TRX-DATE       21514099
212780           END-EXEC                                               21515099
212790                                                                  21516099
212800*----we've exceeded 30 tries: leave routine-----------------------21517099
212810      IF SUB > 30                                                 21518099
212820         GO TO 7550-EXIT                                          21519099
212830      END-IF                                                      21520099
212840                                                                  21521099
212850*----there is no such CTN/LAST-TRX-DATE in History. Just exit-----21522099
212860*----with LAST-TRX-DATE incremented & residing in CTN-INV dclgen--21523099
212870      IF SQLCODE = 100                                            21524099
212880         GO TO 7550-EXIT                                          21525099
212890      END-IF                                                      21526099
212900                                                                  21527099
212910*----there's already a HISTORY record with this LAST-TRX-DATE.----21528099
212920*----So, increment the millisecond portion and try again!---------21529099
212930      IF SQLCODE = ZERO                                           21530099
212940         MOVE LAST-TRX-DATE OF DCLCTN-INV TO                      21531099
212950              UNSTRING-LAST-TRX-DATE                              21532099
212960         ADD 1 TO LAST-BYTES-TRX-DATE                             21533099
212970         ADD 1 TO HAD-TO-INCREMENT-COUNT                          21534099
212980         MOVE UNSTRING-LAST-TRX-DATE TO                           21535099
212990              LAST-TRX-DATE OF DCLCTN-INV                         21536099
213000       END-IF                                                     21537099
213010      END-PERFORM                                                 21538099
213020      .                                                           21539099
213030 7550-EXIT.                                                       21540099
213040      EXIT.                                                       21541099
213060                                                                  21542099
213070*AGB021309 start                                                  21543099
213080 8000-GET-TIMEZONE.                                               21544099
213090******************************************************************21545099
213100*                                                                 21546099
213110*   PARAGRAPH NAME:  8000-GET-TIMEZONE                            21547099
213120*                                                                 21548099
213130*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   21549099
213140*                 TIMESTAMP                                       21550099
213150*                                                                 21551099
213160*   PRIMARY PARAGRAPH FUNCTIONS:                                  21552099
213170*     - NGP                                                       21553099
213180*                                                                 21554099
213190******************************************************************21555099
213200     MOVE '8000-GET-TIMEZONE' TO WS-CURR-PARA                     21556099
213210                                                                  21557099
213220*----call ETNDC43 to get timezone being executed in and the number21558099
213230*----of hours to add to current time to simulate Eastern time-----21559099
213240     MOVE 'ETNI'     TO PARAM-APL-ID IN WS-ETNDC43-CALL-RECORD    21560099
213250     MOVE 'WHEREAMI' TO PARAM-CD IN WS-ETNDC43-CALL-RECORD        21561099
213260     CALL WS-ETNDC43 USING WS-ETNDC43-CALL-RECORD                 21562099
213270          ON EXCEPTION                                            21563099
213280          MOVE                                                    21564099
213290         'ON EXCEPTION ERROR - CALL TO ETNDC43. FATAL ERROR.' TO  21565099
213300          WS-ABEND-TEXT                                           21566099
213310          PERFORM 9000-ABORT THRU 9000-EXIT                       21567099
213320     END-CALL                                                     21568099
213330                                                                  21569099
213340*----if bad result, default to Eastern Timezone and 0 hours-------21570099
213350     IF ETNDC43-SQLCD IN WS-ETNDC43-CALL-RECORD NOT = ZERO        21571099
213360        MOVE 'E' TO WS-TIME-ZONE                                  21572099
213370        MOVE 0   TO WS-HRS  WS-UNCOMP-PLUS-HRS                    21573099
213380     END-IF                                                       21574099
213390                                                                  21575099
213400*----call went OK. Fetch back the number of hours to increment----21576099
213410*----and the timezone program is running in-----------------------21577099
213420                                                                  21578099
213430     IF ETNDC43-SQLCD IN WS-ETNDC43-CALL-RECORD = ZERO            21579099
213440        MOVE PRM-VALUE IN WS-ETNDC43-CALL-RECORD(1:1) TO          21580099
213450             WS-HRS                                               21581099
213460        MOVE PRM-VALUE IN WS-ETNDC43-CALL-RECORD(2:1) TO          21582099
213470             WS-TIME-ZONE                                         21583099
213480        MOVE WS-HRS TO WS-UNCOMP-PLUS-HRS                         21584099
213490     END-IF                                                       21585099
213500                                                                  21586099
213510     IF WS-1ST-PASS = 'Y'                                         21587099
213520        DISPLAY ' ' DISPLAY ' '                                   21588099
213530        DISPLAY                                                   21589099
213540       '--------------------------------------------------------' 21590099
213550       IF WS-TIME-ZONE = 'E'                                      21591099
213560          DISPLAY 'Executing ETNBC16 in the Eastern time zone.'   21592099
213570       END-IF                                                     21593099
213580       IF WS-TIME-ZONE = 'C'                                      21594099
213590          DISPLAY 'Executing ETNBC16 in the Central time zone.'   21595099
213600       END-IF                                                     21596099
213610       IF WS-TIME-ZONE = 'M'                                      21597099
213620          DISPLAY 'Executing ETNBC16 in the Mountain time zone.'  21598099
213630       END-IF                                                     21599099
213640       IF WS-TIME-ZONE = 'P'                                      21600099
213650          DISPLAY 'Executing ETNBC16 in the Pacific time zone.'   21601099
213660       END-IF                                                     21602099
213670     END-IF                                                       21603099
213680                                                                  21604099
213690     IF WS-TIME-ZONE = 'E'                                        21605099
213700        EXEC SQL                                                  21606099
213710        SET :WS-TIMESTAMP = CURRENT TIMESTAMP,                    21607099
213720            :WS-TIMESTAMP-MINUS-1 = CURRENT TIMESTAMP - 1 DAY,    21608099
213730            :WS-TIMESTAMP-MINUS-5 = CURRENT TIMESTAMP - 5 DAYS    21609099
213740        END-EXEC                                                  21610099
213750        IF SQLCODE NOT = 0                                        21611099
213760           MOVE SQLCODE TO WS-ABEND-CODE                          21612099
213770           STRING                                                 21613099
213780          'ERROR GETTING TIMESTAMP. SQLCODE: ' DELIMITED BY SIZE  21614099
213790           WS-ABEND-CODE DELIMITED BY SIZE                        21615099
213800           INTO WS-ABEND-TEXT                                     21616099
213810           END-STRING                                             21617099
213820           PERFORM 9000-ABORT THRU 9000-EXIT                      21618099
213830        END-IF                                                    21619099
213840        IF WS-1ST-PASS = 'Y'                                      21620099
213850           DISPLAY ' '                                            21621099
213860           DISPLAY                                                21622099
213870          'Because this job is running in the Eastern time zone,' 21623099
213880           DISPLAY                                                21624099
213890          'no Timezone Conversion hours need to be added to'      21625099
213900           DISPLAY                                                21626099
213910          'timestamps. Current Eastern Time is ' WS-TIMESTAMP     21627099
213920           DISPLAY                                                21628099
213930        '--------------------------------------------------------'21629099
213940           DISPLAY ' ' DISPLAY ' '                                21630099
213950           MOVE 'N' TO WS-1ST-PASS                                21631099
213960        END-IF                                                    21632099
213970        GO TO 8000-EXIT                                           21633099
213980     END-IF                                                       21634099
213990                                                                  21635099
214000*----for non-Eastern time zones, need to convert to Eastern-------21636099
214010     IF WS-1ST-PASS = 'Y'                                         21637099
214020        DISPLAY ' '                                               21638099
214030        DISPLAY                                                   21639099
214040        'To convert all timestamps into the Eastern time zone,'   21640099
214050        DISPLAY                                                   21641099
214060        'ETNBC16 will add ' WS-UNCOMP-PLUS-HRS ' hours to them.'  21642099
214070                                                                  21643099
214080        EXEC SQL                                                  21644099
214090             SET :WS-TIMESTAMP = CURRENT TIMESTAMP                21645099
214100        END-EXEC                                                  21646099
214110                                                                  21647099
214120        IF SQLCODE NOT = 0                                        21648099
214130           MOVE SQLCODE TO WS-ABEND-CODE                          21649099
214140           STRING                                                 21650099
214150          'ERROR GETTING TIMESTAMP. SQLCODE: ' DELIMITED BY SIZE  21651099
214160           WS-ABEND-CODE DELIMITED BY SIZE                        21652099
214170           INTO WS-ABEND-TEXT                                     21653099
214180           END-STRING                                             21654099
214190           PERFORM 9000-ABORT THRU 9000-EXIT                      21655099
214200        END-IF                                                    21656099
214210                                                                  21657099
214220        DISPLAY ' '                                               21658099
214230        DISPLAY                                                   21659099
214240       'Current timestamp without hours added: '                  21660099
214250        WS-TIMESTAMP                                              21661099
214260     END-IF                                                       21662099
214270                                                                  21663099
214280     EXEC SQL                                                     21664099
214290     SET :WS-TIMESTAMP = CURRENT TIMESTAMP + :WS-HRS HOURS,       21665099
214300         :WS-TIMESTAMP-MINUS-1 =                                  21666099
214310            (CURRENT TIMESTAMP + :WS-HRS HOURS) - 1 DAY,          21667099
214320         :WS-TIMESTAMP-MINUS-5 =                                  21668099
214330            (CURRENT TIMESTAMP + :WS-HRS HOURS) - 5 DAYS          21669099
214340     END-EXEC                                                     21670099
214350     IF SQLCODE NOT = 0                                           21671099
214360        MOVE SQLCODE TO WS-ABEND-CODE                             21672099
214370        STRING                                                    21673099
214380       'ERROR GETTING TIMESTAMP. SQLCODE: ' DELIMITED BY SIZE     21674099
214390        WS-ABEND-CODE DELIMITED BY SIZE                           21675099
214400        INTO WS-ABEND-TEXT                                        21676099
214410        END-STRING                                                21677099
214420        PERFORM 9000-ABORT THRU 9000-EXIT                         21678099
214430     END-IF                                                       21679099
214440                                                                  21680099
214450     IF WS-1ST-PASS = 'Y'                                         21681099
214460        DISPLAY                                                   21682099
214470        'Current timestamp  WITH   hours added: '                 21683099
214480        WS-TIMESTAMP                                              21684099
214490        DISPLAY                                                   21685099
214500        '--------------------------------------------------------'21686099
214510        DISPLAY ' ' DISPLAY ' '                                   21687099
214520        MOVE 'N' TO WS-1ST-PASS                                   21688099
214530     END-IF.                                                      21689099
214540 8000-EXIT.                                                       21690099
214550      EXIT.                                                       21691099
214560                                                                  21692099
214570 7700-SELECT-NGP-COUNTERS.                                        21693099
214580******************************************************************21694099
214590*                                                                 21695099
214600*   PARAGRAPH NAME:  7700-SELECT-NGP-COUNTERS                     21696099
214610*                                                                 21697099
214620*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   21698099
214630*             NGP COUNTERS                                        21699099
214640*                                                                 21700099
214650*   PRIMARY PARAGRAPH FUNCTIONS:                                  21701099
214660*     - NGP                                                       21702099
214670*                                                                 21703099
214680******************************************************************21704099
214690     MOVE '7700-SELECT-NGP-COUNTERS' TO WS-CURR-PARA              21705099
214700                                                                  21706099
214710     EXEC SQL                                                     21707099
214720       SELECT                                                     21708099
214730            UNASG_HOLD_QTY,                                       21709099
214740            UNASG_PROD_QTY                                        21710099
214750       INTO                                                       21711099
214760           :DCLNGP-COUNTERS.UNASG-HOLD-QTY                        21712099
214770           :DCLNGP-COUNTERS-NULL-INDS.UNASG-HOLD-QTY-NI,          21713099
214780           :DCLNGP-COUNTERS.UNASG-PROD-QTY                        21714099
214790           :DCLNGP-COUNTERS-NULL-INDS.UNASG-PROD-QTY-NI           21715099
214800       FROM                                                       21716099
214810            NGP_COUNTERS                                          21717099
214820       WHERE                                                      21718099
214830            NGP_ID          = :WS-NGP          AND                21719099
214840            PRODUCT_TYPE    = :WS-PRODUCT-TYPE                    21720099
214850     END-EXEC                                                     21721099
214860                                                                  21722099
214870     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    21723099
214880                                                                  21724099
214890     .                                                            21725099
214900 7700-EXIT.                                                       21726099
214910     EXIT.                                                        21727099
214920                                                                  21728099
214930 7710-UPDATE-NGP-COUNTERS.                                        21729099
214940******************************************************************21730099
214950*                                                                 21731099
214960*   PARAGRAPH NAME:  7710-UPDATE-NGP-COUNTERS                     21732099
214970*                                                                 21733099
214980*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   21734099
214990*             NGP COUNTERS                                        21735099
215000*                                                                 21736099
215010*   PRIMARY PARAGRAPH FUNCTIONS:                                  21737099
215020*     - NGP                                                       21738099
215030*                                                                 21739099
215040******************************************************************21740099
215050     MOVE '7710-UPDATE-NGP-COUNTERS' TO WS-CURR-PARA              21741099
215060     MOVE -1 TO UNASG-HOLD-QTY-NI OF DCLNGP-COUNTERS-NULL-INDS    21742099
215070     MOVE -1 TO UNASG-PROD-QTY-NI OF DCLNGP-COUNTERS-NULL-INDS    21743099
215080                                                                  21744099
215090*----zero is a valid value for quantities. Don't set to null------21745099
215100     IF WS-QTY1 = ZERO OR                                         21746099
215110        WS-QTY1 > ZERO                                            21747099
215120        MOVE 0 TO UNASG-HOLD-QTY-NI OF DCLNGP-COUNTERS-NULL-INDS  21748099
215130        END-IF                                                    21749099
215140                                                                  21750099
215150     IF WS-QTY = ZERO OR                                          21751099
215160        WS-QTY > ZERO                                             21752099
215170        MOVE 0 TO UNASG-PROD-QTY-NI OF DCLNGP-COUNTERS-NULL-INDS  21753099
215180        END-IF                                                    21754099
215190                                                                  21755099
215200     IF WS-TIMESTAMP = SPACES OR LOW-VALUES                       21756099
215210        MOVE -1 TO SYS-UPDATE-DATE-NI OF DCLNGP-COUNTERS-NULL-INDS21757099
215220        ELSE                                                      21758099
215230        MOVE  0 TO SYS-UPDATE-DATE-NI OF DCLNGP-COUNTERS-NULL-INDS21759099
215240        END-IF                                                    21760099
215250                                                                  21761099
215260     EXEC SQL                                                     21762099
215270          UPDATE NGP_COUNTERS                                     21763099
215280       SET                                                        21764099
215290          UNASG_HOLD_QTY  = :WS-QTY1                              21765099
215300                     :DCLNGP-COUNTERS-NULL-INDS.UNASG-HOLD-QTY-NI,21766099
215310          UNASG_PROD_QTY  = :WS-QTY                               21767099
215320                     :DCLNGP-COUNTERS-NULL-INDS.UNASG-PROD-QTY-NI,21768099
215330          SYS_UPDATE_DATE = :WS-TIMESTAMP                         21769099
215340                     :DCLNGP-COUNTERS-NULL-INDS.SYS-UPDATE-DATE-NI21770099
215350       WHERE                                                      21771099
215360          NGP_ID          = :WS-NGP          AND                  21772099
215370          PRODUCT_TYPE    = :WS-PRODUCT-TYPE                      21773099
215380     END-EXEC                                                     21774099
215390                                                                  21775099
215400     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    21776099
215410                                                                  21777099
215420     IF SQL-SUCCESS                                               21778099
215430        ADD +1 TO WS-TOTL-ETNI-NGPCNTS-UPD-CNT                    21779099
215440        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          21780099
215450     ELSE                                                         21781099
215460        PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT               21782099
215470        MOVE    SQLCODE TO WS-ABEND-CODE                          21783099
215480        STRING 'FATAL SQL ERROR!!!  SQLCODE: '                    21784099
215490                WS-ABEND-CODE                                     21785099
215500                DELIMITED BY SIZE                                 21786099
215510                INTO WS-ABEND-TEXT                                21787099
215520        END-STRING                                                21788099
215530        PERFORM 9000-ABORT           THRU 9000-EXIT               21789099
215540     END-IF                                                       21790099
215560                                                                  21791099
215570**  JA1207A -  Start                                              21792099
215580                                                                  21793099
215590      MOVE  WS-CTNIN-NL       TO  WS-NL-CURRENT                   21794099
215600      MOVE  WS-NGP            TO  WS-NGP-CURRENT                  21795099
215610      MOVE  WS-PRODUCT-TYPE   TO  WS-PRODUCT-CURRENT              21796099
215620                                                                  21797099
215630**  JA1207A -  End                                                21798099
215640                                                                  21799099
215650     .                                                            21800099
215660 7710-EXIT.                                                       21801099
215670     EXIT.                                                        21802099
215680                                                                  21803099
215690 7800-SELECT-MIN-INV.                                             21804099
215700******************************************************************21805099
215710*                                                                 21806099
215720*   PARAGRAPH NAME:  7800-SELECT-MIN-INV                          21807099
215730*                                                                 21808099
215740*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   21809099
215750*             GET MIN                                             21810099
215760*                                                                 21811099
215800******************************************************************21812099
215810     MOVE '7800-SELECT-MIN-INV' TO WS-CURR-PARA                   21813099
215820                                                                  21814099
215830     EXEC SQL                                                     21815099
215840          SELECT 1                                                21816099
215850          INTO  :WS-EXIST-FLAG                                    21817099
215860          FROM   MIN_INV                                          21818099
215870          WHERE  MIN_NUM = :DCLMIN-INV.MIN-NUM                    21819099
215880     END-EXEC.                                                    21820099
215890                                                                  21821099
215900     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    21822099
215910                                                                  21823099
215920     .                                                            21824099
215930 7800-EXIT.                                                       21825099
215940     EXIT.                                                        21826099
215950                                                                  21827099
215960 7805-SELECT-MIN-IN-CTN.                                          21828099
215970******************************************************************21829099
215980*                                                                 21830099
215990*   PARAGRAPH NAME:  7805-SELECT-MIN-IN-CTN                       21831099
216000*                                                                 21832099
216010*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   21833099
216020*             GET MIN                                             21834099
216030*                                                                 21835099
216070******************************************************************21836099
216080     MOVE '7805-SELECT-MIN-IN-CTN' TO WS-CURR-PARA                21837099
216090**  JA0320   -  Modified  Below  To  Include:                     21838099
216100**              Initialization  of  WS-EXIST-FLAG                 21839099
216110**              Added  MDN  for  CTN  Select                      21840099
216120                                                                  21841099
216130                                                                  21842099
216140     MOVE  ZEROES             TO   WS-CTN-INV-MIN-COUNT           21843099
216150                                                                  21844099
216160**   JA0320  -   Removed  SQL  below  & replaced                  21845099
216170                                                                  21846099
216250     EXEC SQL                                                     21847099
216260      SELECT COUNT(*)                                             21848099
216270        INTO                                                      21849099
216280        :WS-CTN-INV-MIN-COUNT                                     21850099
216290        FROM   CTN_INV                                            21851099
216300          WHERE  MIN_NUM  = :DCLMIN-INV.MIN-NUM                   21852099
216310          AND    CTN     <> :MDNIN-MDN                            21853099
216320        WITH  UR                                                  21854099
216330                                                                  21855099
216340     END-EXEC.                                                    21856099
216360                                                                  21857099
216370     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    21858099
216380                                                                  21859099
216390     .                                                            21860099
216400 7805-EXIT.                                                       21861099
216410     EXIT.                                                        21862099
216420                                                                  21863099
216430**  JA0310  -  Below                                              21864099
216440 7806-SELECT-MIN-IN-CTN.                                          21865099
216450******************************************************************21866099
216460*                                                                 21867099
216470*   PARAGRAPH NAME:  7806-SELECT-MIN-IN-CTN                       21868099
216480*                                                                 21869099
216490*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   21870099
216500*             GET MIN                                             21871099
216550******************************************************************21872099
216560     MOVE '7806-SELECT-MIN-IN-CTN' TO WS-CURR-PARA                21873099
216570**  JA0320   -  Modified  Below  To  Include:                     21874099
216580**              Initialization  of  WS-EXIST-FLAG                 21875099
216590**              Added  MDN  for  CTN  Select                      21876099
216600                                                                  21877099
216610     MOVE  ZEROES             TO   WS-CTN-INV-MIN-COUNT           21878099
216620                                                                  21879099
216630     EXEC SQL                                                     21880099
216640      SELECT COUNT(*)                                             21881099
216650        INTO                                                      21882099
216660        :WS-CTN-INV-MIN-COUNT                                     21883099
216670        FROM   CTN_INV                                            21884099
216680          WHERE  MIN_NUM  = :DCLMIN-INV.MIN-NUM                   21885099
216690        WITH  UR                                                  21886099
216700                                                                  21887099
216710     END-EXEC.                                                    21888099
216720                                                                  21889099
216730     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    21890099
216740     .                                                            21891099
216750 7806-EXIT.                                                       21892099
216760     EXIT.                                                        21893099
216770**  JA1211  -  New  Access  to  CTN                               21894099
216780 7807-SELECT-IN-CTN.                                              21895099
216790******************************************************************21896099
216800*                                                                 21897099
216810*   PARAGRAPH NAME:  7807-SELECT-IN-CTN                           21898099
216820*                                                                 21899099
216830******************************************************************21900099
216840     MOVE '7807-SELECT-IN-CTN' TO WS-CURR-PARA                    21901099
216850                                                                  21902099
216860     MOVE  ZEROES             TO   WS-CTN-INV-MIN-COUNT           21903099
216870     MOVE  MDNIN-MDN  TO  WS-MDN                                  21904099
216880                                                                  21905099
216890     EXEC SQL                                                     21906099
216900      SELECT COUNT(*)                                             21907099
216910        INTO                                                      21908099
216920        :WS-CTN-INV-MIN-COUNT                                     21909099
216930        FROM   CTN_INV                                            21910099
216940          WHERE  CTN      = :WS-MDN                               21911099
216950        WITH  UR                                                  21912099
216960                                                                  21913099
216970     END-EXEC.                                                    21914099
216980                                                                  21915099
216990     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    21916099
217000     .                                                            21917099
217010 7807-EXIT.                                                       21918099
217020     EXIT.                                                        21919099
217030                                                                  21920099
217040 7810-SELECT-MIN-INV.                                             21921099
217050******************************************************************21922099
217060*                                                                 21923099
217070*   PARAGRAPH NAME:  7810-SELECT-MIN-INV                          21924099
217080*                                                                 21925099
217090*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   21926099
217100*             GET MIN                                             21927099
217150******************************************************************21928099
217160     MOVE '7810-SELECT-MIN-INV' TO WS-CURR-PARA                   21929099
217170                                                                  21930099
217180     EXEC SQL                                                     21931099
217190          SELECT                                                  21932099
217200            SYS_CREATION_DATE                                     21933099
217210           ,SYS_UPDATE_DATE                                       21934099
217220           ,OPERATOR_ID                                           21935099
217230           ,APPLICATION_ID                                        21936099
217240           ,DL_SERVICE_CODE                                       21937099
217250           ,DL_UPDATE_STAMP                                       21938099
217260           ,LAST_TRX_DATE                                         21939099
217270           ,LAST_TRX_CODE                                         21940099
217280           ,LAST_TRX_UID                                          21941099
217290           ,LRN                                                   21942099
217300           ,SUB_MARKET                                            21943099
217310           ,SID                                                   21944099
217320           ,MIN_STATUS                                            21945099
217330          INTO                                                    21946099
217340            :DCLMIN-INV.SYS-CREATION-DATE                         21947099
217350           ,:DCLMIN-INV.SYS-UPDATE-DATE                           21948099
217360            :DCLMIN-INV-NULL-INDS.SYS-UPDATE-DATE-NI              21949099
217370           ,:DCLMIN-INV.OPERATOR-ID                               21950099
217380            :DCLMIN-INV-NULL-INDS.OPERATOR-ID-NI                  21951099
217390           ,:DCLMIN-INV.APPLICATION-ID                            21952099
217400            :DCLMIN-INV-NULL-INDS.APPLICATION-ID-NI               21953099
217410           ,:DCLMIN-INV.DL-SERVICE-CODE                           21954099
217420           ,:DCLMIN-INV.DL-UPDATE-STAMP                           21955099
217430            :DCLMIN-INV-NULL-INDS.DL-UPDATE-STAMP-NI              21956099
217440           ,:DCLMIN-INV.LAST-TRX-DATE                             21957099
217450           ,:DCLMIN-INV.LAST-TRX-CODE                             21958099
217460           ,:DCLMIN-INV.LAST-TRX-UID                              21959099
217470           ,:DCLMIN-INV.LRN                                       21960099
217480            :DCLMIN-INV-NULL-INDS.LRN-NI                          21961099
217490           ,:DCLMIN-INV.SUB-MARKET                                21962099
217500            :DCLMIN-INV-NULL-INDS.SUB-MARKET-NI                   21963099
217510           ,:DCLMIN-INV.SID                                       21964099
217520            :DCLMIN-INV-NULL-INDS.SID-NI                          21965099
217530           ,:DCLMIN-INV.MIN-STATUS                                21966099
217540          FROM   MIN_INV                                          21967099
217550          WHERE  MIN_NUM = :DCLMIN-INV.MIN-NUM                    21968099
217560     END-EXEC.                                                    21969099
217570                                                                  21970099
217580     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    21971099
217590                                                                  21972099
217600     .                                                            21973099
217610 7810-EXIT.                                                       21974099
217620     EXIT.                                                        21975099
217630                                                                  21976099
217640 7820-UPDATE-MIN-INV.                                             21977099
217650******************************************************************21978099
217660*                                                                 21979099
217670*   PARAGRAPH NAME:  7820-UPDATE-MIN-INV                          21980099
217680*                                                                 21981099
217690*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   21982099
217700*             GET MIN                                             21983099
217710*                                                                 21984099
217750******************************************************************21985099
217760     MOVE '7820-UPDATE-MIN-INV' TO WS-CURR-PARA                   21986099
217770     IF SYS-UPDATE-DATE OF DCLMIN-INV = SPACE OR LOW-VALUES       21987099
217780        MOVE -1 TO SYS-UPDATE-DATE-NI OF DCLMIN-INV-NULL-INDS     21988099
217790      ELSE                                                        21989099
217800        MOVE  0 TO SYS-UPDATE-DATE-NI OF DCLMIN-INV-NULL-INDS     21990099
217810        END-IF                                                    21991099
217820                                                                  21992099
217830     IF OPERATOR-ID OF DCLMIN-INV = SPACE OR LOW-VALUES           21993099
217840        MOVE -1 TO OPERATOR-ID-NI OF DCLMIN-INV-NULL-INDS         21994099
217850      ELSE                                                        21995099
217860        MOVE  0 TO OPERATOR-ID-NI OF DCLMIN-INV-NULL-INDS         21996099
217870        END-IF                                                    21997099
217880                                                                  21998099
217890     EXEC SQL                                                     21999099
217900       UPDATE MIN_INV                                             22000099
217910       SET                                                        22001099
217920       SYS_UPDATE_DATE = :DCLMIN-INV.SYS-UPDATE-DATE              22002099
217930                         :DCLMIN-INV-NULL-INDS.SYS-UPDATE-DATE-NI,22003099
217940       OPERATOR_ID     = :DCLMIN-INV.OPERATOR-ID                  22004099
217950                         :DCLMIN-INV-NULL-INDS.OPERATOR-ID-NI,    22005099
217960       LAST_TRX_DATE   = :DCLMIN-INV.LAST-TRX-DATE,               22006099
217970       LAST_TRX_CODE   = :DCLMIN-INV.LAST-TRX-CODE,               22007099
217980       LAST_TRX_UID    = :DCLMIN-INV.LAST-TRX-UID,                22008099
217990       MIN_STATUS      = :DCLMIN-INV.MIN-STATUS                   22009099
218000       WHERE                                                      22010099
218010       MIN_NUM         = :DCLMIN-INV.MIN-NUM                      22011099
218020     END-EXEC                                                     22012099
218030                                                                  22013099
218040     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    22014099
218050     MOVE SQLCODE TO WS-SQLCODE                                   22015099
218060     MOVE WS-SQLCODE TO WS-SQLCODE-DS                             22016099
218070     IF SQL-SUCCESS                                               22017099
218080        ADD +1 TO WS-TOTL-ETNI-MININV-UPD-CNT                     22018099
218090        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          22019099
218100     ELSE                                                         22020099
218110        PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT               22021099
218120        MOVE    SQLCODE TO WS-ABEND-CODE                          22022099
218130        STRING 'FATAL SQL ERROR!!!  SQLCODE: '                    22023099
218140                WS-ABEND-CODE                                     22024099
218150                DELIMITED BY SIZE                                 22025099
218160                INTO WS-ABEND-TEXT                                22026099
218170        END-STRING                                                22027099
218180        PERFORM 9000-ABORT           THRU 9000-EXIT               22028099
218190     END-IF                                                       22029099
218200     .                                                            22030099
218210 7820-EXIT.                                                       22031099
218220     EXIT.                                                        22032099
218230                                                                  22033099
218240*   _______________________________________________               22034099
218250*   |  UPDATE MIN-INV STATUS FOR O*L*D MIN NUM.   |               22035099
218260*   | (when there's no Biller MDN, just eTNI CTN) |               22036099
218270*   |_____________________________________________|               22037099
218280*                                                                 22038099
218290 7830-UPDATE-MIN-INV-STATUS.                                      22039099
218300******************************************************************22040099
218310*                                                                 22041099
218320*   PARAGRAPH NAME:  7830-UPDATE-MIN-INV-STATUS                   22042099
218330*                                                                 22043099
218340*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   22044099
218350*             MIN STATUS                                          22045099
218360*                                                                 22046099
218370*   PRIMARY PARAGRAPH FUNCTIONS:                                  22047099
218380*     - MIN STATUS                                                22048099
218390*                                                                 22049099
218400******************************************************************22050099
218410     MOVE '7830-UPDATE-MIN-INV-STATUS' TO WS-CURR-PARA            22051099
218420                                                                  22052099
218430     UNSTRING WS-CTNIN-MIN-NUM-TEXT                               22053099
218440              DELIMITED BY SPACE                                  22054099
218450              INTO         MIN-NUM-TEXT OF DCLMIN-INV             22055099
218460              DELIMITER IN WS-DELIMITER                           22056099
218470              COUNT     IN MIN-NUM-LEN  OF DCLMIN-INV             22057099
218480     END-UNSTRING                                                 22058099
218490                                                                  22059099
218500*----based on status of eTNI CTN, change its MIN status-----------22060099
218510                                                                  22061099
218520     IF WS-OLD-STATUS NOT = 'AI' AND                              22062099
218530        WS-OLD-STATUS NOT = 'AG' AND                              22063099
218540        WS-OLD-STATUS NOT = 'AR' AND                              22064099
218550        WS-OLD-STATUS NOT = 'AT' AND                              22065099
218560        WS-OLD-STATUS NOT = 'AA' AND                              22066099
218570        WS-OLD-STATUS NOT = 'PA' AND                              22067099
218580**  JA0507  -  ABOVE  1  LINE  ADDED  'PA'                        22068099
218590        WS-OLD-STATUS NOT = 'NA' AND                              22069099
218600        WS-OLD-STATUS NOT = 'NH'                                  22070099
218610        GO TO 7830-EXIT                                           22071099
218620        END-IF                                                    22072099
218630                                                                  22073099
218640     IF WS-OLD-STATUS = 'AI' OR 'AG' OR 'AR' OR 'AT'              22074099
218650        MOVE 'AI' TO MIN-STATUS OF DCLMIN-INV                     22075099
218660        END-IF                                                    22076099
218670                                                                  22077099
218680     IF WS-OLD-STATUS = 'AA'  OR  'PA'                            22078099
218690**  JA0507  -  ABOVE  1  LINE  ADDED  'PA'                        22079099
218700        MOVE 'AM' TO MIN-STATUS OF DCLMIN-INV                     22080099
218710        END-IF                                                    22081099
218720                                                                  22082099
218730     IF WS-OLD-STATUS = 'NA' OR 'NH'                              22083099
218740        MOVE 'AA' TO MIN-STATUS OF DCLMIN-INV                     22084099
218750        END-IF                                                    22085099
218760                                                                  22086099
218770     IF WS-CTNIN-PORT-IND = 'RE'                                  22087099
218780        MOVE 'AA' TO MIN-STATUS OF DCLMIN-INV                     22088099
218790        END-IF                                                    22089099
218800                                                                  22090099
218810     MOVE WS-TIMESTAMP       TO SYS-UPDATE-DATE OF DCLMIN-INV     22091099
218820     MOVE LIT-OPERATOR-ID    TO OPERATOR-ID     OF DCLMIN-INV     22092099
218830                                                                  22093099
218840     IF SYS-UPDATE-DATE OF DCLMIN-INV = SPACE OR LOW-VALUES       22094099
218850        MOVE -1 TO SYS-UPDATE-DATE-NI OF DCLMIN-INV-NULL-INDS     22095099
218860      ELSE                                                        22096099
218870        MOVE  0 TO SYS-UPDATE-DATE-NI OF DCLMIN-INV-NULL-INDS     22097099
218880        END-IF                                                    22098099
218890                                                                  22099099
218900     IF OPERATOR-ID OF DCLMIN-INV = SPACE OR LOW-VALUES           22100099
218910        MOVE -1 TO OPERATOR-ID-NI OF DCLMIN-INV-NULL-INDS         22101099
218920      ELSE                                                        22102099
218930        MOVE  0 TO OPERATOR-ID-NI OF DCLMIN-INV-NULL-INDS         22103099
218940        END-IF                                                    22104099
218950                                                                  22105099
218960     EXEC SQL                                                     22106099
218970        UPDATE MIN_INV                                            22107099
218980        SET MIN_STATUS      = :DCLMIN-INV.MIN-STATUS,             22108099
218990            SYS_UPDATE_DATE = :WS-TIMESTAMP                       22109099
219000                        :DCLMIN-INV-NULL-INDS.SYS-UPDATE-DATE-NI, 22110099
219010            OPERATOR_ID     = :DCLMIN-INV.OPERATOR-ID             22111099
219020                        :DCLMIN-INV-NULL-INDS.OPERATOR-ID-NI      22112099
219030        WHERE MIN_NUM = :DCLMIN-INV.MIN-NUM                       22113099
219040     END-EXEC                                                     22114099
219050                                                                  22115099
219060     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    22116099
219070                                                                  22117099
219080     IF SQL-SUCCESS                                               22118099
219090        ADD +1 TO WS-TOTL-ETNI-MININV-UPD-ST-CNT                  22119099
219100        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          22120099
219110     ELSE                                                         22121099
219120        IF SQL-ROW-NOT-FOUND                                      22122099
219130           CONTINUE                                               22123099
219140        ELSE                                                      22124099
219150           PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT            22125099
219160           MOVE    SQLCODE TO WS-ABEND-CODE                       22126099
219170           STRING 'FATAL SQL ERROR!!!  SQLCODE: '                 22127099
219180                   WS-ABEND-CODE                                  22128099
219190                   DELIMITED BY SIZE                              22129099
219200                   INTO WS-ABEND-TEXT                             22130099
219210           END-STRING                                             22131099
219220           PERFORM 9000-ABORT           THRU 9000-EXIT            22132099
219230        END-IF                                                    22133099
219240     END-IF                                                       22134099
219250     .                                                            22135099
219260 7830-EXIT.                                                       22136099
219270     EXIT.                                                        22137099
219280                                                                  22138099
219290 7900-SELECT-TRX-CODES.                                           22139099
219300******************************************************************22140099
219310*                                                                 22141099
219320*   PARAGRAPH NAME:  7900-SELECT-TRX-CODE                         22142099
219330*                                                                 22143099
219340*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   22144099
219350*             TRX CODE                                            22145099
219400******************************************************************22146099
219410     MOVE '7900-SELECT-TRX-CODES' TO WS-CURR-PARA                 22147099
219420                                                                  22148099
219430     EXEC SQL                                                     22149099
219440          SELECT 1                                                22150099
219450          INTO  :WS-EXIST-FLAG                                    22151099
219460          FROM   NM_TRX_CODES                                     22152099
219470          WHERE  TRX_CODE = :WS-TRANS-CODE                        22153099
219480     END-EXEC                                                     22154099
219490                                                                  22155099
219500     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    22156099
219510     .                                                            22157099
219520 7900-EXIT.                                                       22158099
219530     EXIT.                                                        22159099
219540                                                                  22160099
219550 7910-SELECT-TRX-VALID-STS.                                       22161099
219560******************************************************************22162099
219570*                                                                 22163099
219580*   PARAGRAPH NAME:  7910-SELECT-TRX-VALID-STS                    22164099
219590*                                                                 22165099
219600*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   22166099
219610*             TRX CODE                                            22167099
219660******************************************************************22168099
219670     MOVE '7910-SELECT-TRX-VALID-STS' TO WS-CURR-PARA             22169099
219680                                                                  22170099
219690     EXEC SQL                                                     22171099
219700          SELECT 1                                                22172099
219710          INTO  :WS-EXIST-FLAG                                    22173099
219720          FROM   NM_TRX_VALID_STS                                 22174099
219730          WHERE  TRX_CODE        = :WS-TRANS-CODE                 22175099
219740            AND  TRX_FROM_STATUS = :WS-OLD-STATUS                 22176099
219750            AND  TRX_TO_STATUS   = :WS-NEW-STATUS                 22177099
219760     END-EXEC.                                                    22178099
219770                                                                  22179099
219780     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    22180099
219790     .                                                            22181099
219800 7910-EXIT.                                                       22182099
219810     EXIT.                                                        22183099
219820                                                                  22184099
219830                                                                  22185099
219840*** #870803 SDL BEGIN   ADDED 7A00-                               22186099
219850                                                                  22187099
219860 7A00-SEL-TNI-NPANXX-MDN.                                         22188099
219870******************************************************************22189099
219880*                                                                 22190099
219890*   PARAGRAPH NAME:  7A00-SEL-TNI-NPANXX-MDN                      22191099
219900*                                                                 22192099
219910*   PURPOSE:  THE PURPOSE OF THIS ROUTINE IS TO                   22193099
219920*             NPA NXX                                             22194099
219930*                                                                 22195099
219940*   PRIMARY PARAGRAPH FUNCTIONS:                                  22196099
219950*     - GET                                                       22197099
219960*                                                                 22198099
219970******************************************************************22199099
219980     MOVE '7A00-SEL-TNI-NPANXX-MDN'   TO WS-CURR-PARA             22200099
219990                                                                  22201099
220000     MOVE SPACE TO  WS-COMINGLED-IND                              22202099
220010                                                                  22203099
220020     EXEC SQL                                                     22204099
220030          SELECT COMINGLED_IND                                    22205099
220040          INTO  :WS-COMINGLED-IND                                 22206099
220050          FROM   TNI_NPANXX_MDN                                   22207099
220060          WHERE  NPA_NXX_NUM = :DCLTNI-NPANXX-MDN.NPA-NXX-NUM     22208099
220070          AND    COMINGLED_IND = 'Y'                              22209099
220080     END-EXEC                                                     22210099
220090                                                                  22211099
220100     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    22212099
220110     .                                                            22213099
220120 7A00-EXIT.                                                       22214099
220130     EXIT.                                                        22215099
220140                                                                  22216099
220150                                                                  22217099
220160 8100-READ-NEXT-BILL-RECORD.                                      22218099
220170******************************************************************22219099
220180*   PARAGRAPH NAME:   8100-READ-NEXT-BILL-RECORD                  22220099
220190*                                                                 22221099
220200*   PURPOSE:                                                      22222099
220210*     THIS PARAGRAPH READS THE NEXT RECORD ON THE INPUT           22223099
220220*   MDN FILE AND INCREMENTS RECS READ COUNTER.                    22224099
220230******************************************************************22225099
220240     MOVE '8100-READ-NEXT-BILL-RECORD' TO WS-CURR-PARA            22226099
220250                                                                  22227099
220260     INITIALIZE MDNIN-RECORD                                      22228099
220270                DCLCTN-INV                                        22229099
220280                DCLCTN-INV-HISTORY                                22230099
220290                                                                  22231099
220300     IF SEQ-OPEN-IND(NMMDNINP-SUB) = YES-VALUE                    22232099
220310        MOVE SEQREAD TO SEQ-FUNCTION                              22233099
220320        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         22234099
220330        CALL SYS-CALL-PGM-ID  USING                               22235099
220340            DFHCOMMAREA                                           22236099
220350            SEQ-RETURN-CODE-DATA                                  22237099
220360            SEQ-DDNAME-TXT(NMMDNINP-SUB)                          22238099
220370            MDNIN-RECORD                                          22239099
220380                                                                  22240099
220390*       IF FILE IS BEING RESTARTED WHEN THE FILE WAS              22241099
220400*       ALREADY AT AN EOF, FORCE THE RETURN CODE TO EOF           22242099
220410        IF SYS-RESTART-IND = YES-VALUE AND                        22243099
220420           SEQ-READ-PAST-EOF                                      22244099
220430           MOVE +104 TO SEQ-RET-CODE                              22245099
220440        END-IF                                                    22246099
220450        IF SEQ-ERROR                                              22247099
220460           MOVE SEQ-RET-CODE TO                                   22248099
220470                SEQ-RET-CODE-DISPLAY                              22249099
220480           STRING                                                 22250099
220490              'SEQUENTIAL I/O READ ERROR, RC: '                   22251099
220500              SEQ-RET-CODE-DISPLAY                                22252099
220510              ' FOR DDNAME: NMMDNINP'                             22253099
220520                 DELIMITED BY SIZE                                22254099
220530              INTO WS-ABEND-TEXT                                  22255099
220540           END-STRING                                             22256099
220550           PERFORM 9000-ABORT       THRU                          22257099
220560                   9000-EXIT                                      22258099
220570        ELSE                                                      22259099
220580           IF NOT SEQ-END-OF-FILE                                 22260099
220590              ADD +1 TO SEQ-CNTL-REC-COUNT(NMMDNINP-SUB)          22261099
220600                        WS-TOTL-BILL-RECS-READ                    22262099
220610           ELSE                                                   22263099
220620              MOVE YES-VALUE TO WS-END-OF-FILE-BILL               22264099
220630           END-IF                                                 22265099
220640        END-IF                                                    22266099
220650     ELSE                                                         22267099
220660       STRING                                                     22268099
220670          'SEQUENTIAL I/O READ ERROR FOR '                        22269099
220680           'DDNAME: NMMDNINP'                                     22270099
220690           ' - FILE NOT OPENED'                                   22271099
220700              DELIMITED BY SIZE                                   22272099
220710           INTO WS-ABEND-TEXT                                     22273099
220720       END-STRING                                                 22274099
220730       PERFORM 9000-ABORT       THRU                              22275099
220740               9000-EXIT                                          22276099
220750     END-IF                                                       22277099
220760                                                                  22278099
220770     MOVE MDNIN-RECORD-TYPE TO WS-MDNIN-RECORD-TYPE               22279099
220780                                                                  22280099
220790*----do a pre-clean of Prepaid-Indicator to make sure that it-----22281099
220800*----contains only "Y", "N" or space. (only on Detail records!)---22282099
220810                                                                  22283099
220820**  JA1207B - Added  PREPAID-IND Valid,  below  'X'               22284099
220830                                                                  22285099
220840     IF MDNIN-RECORD-TYPE = '5' AND                               22286099
220850        MDNIN-PREPAID-IND NOT = 'Y' AND                           22287099
220860        MDNIN-PREPAID-IND NOT = 'N' AND                           22288099
220870        MDNIN-PREPAID-IND NOT = 'X' AND                           22289099
220880        MDNIN-PREPAID-IND NOT = SPACE                             22290099
220890        MOVE SPACE TO MDNIN-PREPAID-IND                           22291099
220900     END-IF                                                       22292099
220910                                                                  22293099
220920*  JA1007 - Start                                                 22294099
220930**          Bypass  Biller  Input  if  We  Receive  'NA'  Status  22295099
220940                                                                  22296099
220950     IF MDNIN-RECORD-TYPE = '5' AND                               22297099
220960        MDNIN-MDN-STATUS  = 'NA'                                  22298099
220970        GO  TO  8100-READ-NEXT-BILL-RECORD                        22299099
220980     END-IF                                                       22300099
220990                                                                  22301099
221000*  JA1007 - End                                                   22302099
221010     .                                                            22303099
221020***********                                                       22304099
221030 8100-EXIT.                                                       22305099
221040***********                                                       22306099
221050     EXIT.                                                        22307099
221060                                                                  22308099
221070 8110-READ-NEXT-ETNI-RECORD.                                      22309099
221080******************************************************************22310099
221090*   PARAGRAPH NAME:   8110-READ-NEXT-ETNI-RECORD                  22311099
221100*                                                                 22312099
221110*   PURPOSE:                                                      22313099
221120*     THIS PARAGRAPH READS THE NEXT RECORD ON THE INPUT           22314099
221130*   CTN-INV FILE AND INCREMENTS RECS READ COUNTER.                22315099
221140******************************************************************22316099
221150     MOVE '8110-READ-NEXT-ETNI-RECORD' TO WS-CURR-PARA            22317099
221160     INITIALIZE WS-CTNIN-RECORD                                   22318099
221170                DCLCTN-INV                                        22319099
221180                DCLCTN-INV-HISTORY                                22320099
221190                                                                  22321099
221200     IF SEQ-OPEN-IND(NMCTNINP-SUB) = YES-VALUE                    22322099
221210        MOVE SEQREAD TO SEQ-FUNCTION                              22323099
221220        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         22324099
221230        CALL SYS-CALL-PGM-ID  USING                               22325099
221240            DFHCOMMAREA                                           22326099
221250            SEQ-RETURN-CODE-DATA                                  22327099
221260            SEQ-DDNAME-TXT(NMCTNINP-SUB)                          22328099
221270            WS-CTNIN-RECORD                                       22329099
221280                                                                  22330099
221290*       IF FILE IS BEING RESTARTED WHEN THE FILE WAS              22331099
221300*       ALREADY AT AN EOF, FORCE THE RETURN CODE TO EOF           22332099
221310        IF SYS-RESTART-IND = YES-VALUE AND                        22333099
221320           SEQ-READ-PAST-EOF                                      22334099
221330           MOVE +104 TO SEQ-RET-CODE                              22335099
221340        END-IF                                                    22336099
221350        IF SEQ-ERROR                                              22337099
221360           MOVE SEQ-RET-CODE TO                                   22338099
221370                SEQ-RET-CODE-DISPLAY                              22339099
221380           STRING                                                 22340099
221390              'SEQUENTIAL I/O READ ERROR, RC: '                   22341099
221400              SEQ-RET-CODE-DISPLAY                                22342099
221410              ' FOR DDNAME: NMCTNINP'                             22343099
221420                 DELIMITED BY SIZE                                22344099
221430              INTO WS-ABEND-TEXT                                  22345099
221440           END-STRING                                             22346099
221450           PERFORM 9000-ABORT       THRU                          22347099
221460                   9000-EXIT                                      22348099
221470        ELSE                                                      22349099
221480           IF NOT SEQ-END-OF-FILE                                 22350099
221490              ADD +1 TO SEQ-CNTL-REC-COUNT(NMCTNINP-SUB)          22351099
221500                        WS-TOTL-ETNI-RECS-READ                    22352099
221510           ELSE                                                   22353099
221520              MOVE YES-VALUE TO WS-END-OF-FILE-ETNI               22354099
221530           END-IF                                                 22355099
221540        END-IF                                                    22356099
221550     ELSE                                                         22357099
221560       STRING                                                     22358099
221570          'SEQUENTIAL I/O READ ERROR FOR '                        22359099
221580           'DDNAME: NMCTNINP'                                     22360099
221590           ' - FILE NOT OPENED'                                   22361099
221600              DELIMITED BY SIZE                                   22362099
221610           INTO WS-ABEND-TEXT                                     22363099
221620       END-STRING                                                 22364099
221630       PERFORM 9000-ABORT       THRU                              22365099
221640               9000-EXIT                                          22366099
221650     END-IF                                                       22367099
221660                                                                  22368099
221670*----at EOF for eTNI file? Bypass tests below---------------------22369099
221680     IF WS-NO-MORE-RECORD-ETNI                                    22370099
221690        GO TO 8110-EXIT                                           22371099
221700     END-IF                                                       22372099
221710                                                                  22373099
221720* AGB 3/21/06                                                     22374099
221730*----capture eTNI's MIN-NUM as soon as record is read-------------22375099
221740     MOVE WS-CTNIN-MIN-NUM-TEXT TO WS-OLD-MIN-NUM                 22376099
221750                                                                  22377099
221760*----do a pre-clean of Prepaid-Indicator to make sure that it-----22378099
221770*----contains only "Y", "N" or space------------------------------22379099
221780*----                       or "X"                                22380099
221790**  JA1207B - Added  "X"  as Valid                                22381099
221800     IF WS-CTNIN-PREPAID-IND NOT = 'Y' AND                        22382099
221810        WS-CTNIN-PREPAID-IND NOT = 'N' AND                        22383099
221820        WS-CTNIN-PREPAID-IND NOT = 'X' AND                        22384099
221830        WS-CTNIN-PREPAID-IND NOT = SPACE                          22385099
221840        MOVE SPACE TO WS-CTNIN-PREPAID-IND                        22386099
221850     END-IF                                                       22387099
221860     .                                                            22388099
221870***********                                                       22389099
221880 8110-EXIT.                                                       22390099
221890***********                                                       22391099
221900     EXIT.                                                        22392099
221910                                                                  22393099
221920 8200-CALL-UPDATE-AVAIL.                                          22394099
221930******************************************************************22395099
221940*    PARAGRAPH NAME:      8200-CALL-UPDATE-AVAIL                  22396099
221950*                                                                 22397099
221960*    PURPOSE:                                                     22398099
221970*       ETNSC50 WILL UPDATE THE AA-STS-CNT FIELD ON THE           22399099
221980*       NPANXX-AVAIL TABLE (INCREMENT THE COUNTER BY +1).         22400099
221990*                                                                 22401099
222000******************************************************************22402099
222010*                                                                 22403099
222020     MOVE '8200-CALL-UPDATE-AVAIL' TO WS-CURR-PARA                22404099
222030     INITIALIZE WS-CTN-NUMERIC                                    22405099
222040     MOVE WS-MDN TO WS-CTN-NUMERIC                                22406099
222050     .                                                            22407099
222060 8200-EXIT.                                                       22408099
222070     EXIT.                                                        22409099
222080                                                                  22410099
222090 8500-CHECK-COMMIT.                                               22411099
222100******************************************************************22412099
222110*   PARAGRAPH NAME:   8500-CHECK-COMMIT                           22413099
222120*                                                                 22414099
222130*   PURPOSE:                                                      22415099
222140*     THIS PARAGRAPH CHECKS IF A COMMIT SHOULD BE PERFORMED.      22416099
222150*                                                                 22417099
222160*   PRIMARY PARAGRAPH FUNCTIONS:                                  22418099
222170*   - DETERMINE IF THE NUMBER OF RECORDS PROCESSED IS AN EXACT    22419099
222180*     MULTIPLE OF WS-COMMIT-FREQ IF IT IS,THEN A COMMIT SHOULD BE 22420099
222190*     PERFORMED. OTHERWISE SKIP THE REST OF THE CODES.            22421099
222200*   - TO PERFORM A COMMIT:                                        22422099
222210*       -ISSUE A COMMIT WORK SQL STATEMENT                        22423099
222220*       -INSERT/UPDATE THE TNI-CHKPT-CNTRL TABLE TO SAVE THE      22424099
222230*        CURRENT NUMBER OF RECORDS PROCESSED.                     22425099
222240******************************************************************22426099
222250     MOVE '8500-CHECK-COMMIT' TO  WS-CURR-PARA                    22427099
222260                                                                  22428099
222270     DIVIDE WS-TOTL-BILL-RECS-READ BY WS-COMMIT-FREQ              22429099
222280            GIVING WS-QUO REMAINDER WS-REM                        22430099
222290                                                                  22431099
222300     IF WS-REM NOT = 0                                            22432099
222310        GO TO 8500-EXIT                                           22433099
222320     END-IF                                                       22434099
222330                                                                  22435099
222340*  JA0322  -  Manage  Inserts / Updates  Based  Upon  Actual      22436099
222350*             Inserts / Updates & Deletes                         22437099
222360                                                                  22438099
222370     IF  WS-SAVE-UPD-INS-DEL-MQ           =  0                    22439099
222380         MOVE  WS-TOTL-UPD-INS-DEL-MQ           TO                22440099
222390               WS-SAVE-UPD-INS-DEL-MQ                             22441099
222400     END-IF                                                       22442099
222410                                                                  22443099
222420     IF  WS-TOTL-UPD-INS-DEL-MQ           =                       22444099
222430         WS-SAVE-UPD-INS-DEL-MQ                                   22445099
222440         GO TO 8500-EXIT                                          22446099
222450     END-IF                                                       22447099
222460                                                                  22448099
222470     MOVE  WS-TOTL-UPD-INS-DEL-MQ           TO                    22449099
222480           WS-SAVE-UPD-INS-DEL-MQ                                 22450099
222490                                                                  22451099
222500*SAVE COUNTS                                                      22452099
222510     MOVE WS-TOTL-BILL-RECS-READ                                  22453099
222520       TO WS-SAVE-BILL-RECS-READ                                  22454099
222530     MOVE WS-TOTL-ETNI-RECS-READ                                  22455099
222540       TO WS-SAVE-ETNI-RECS-READ                                  22456099
222550     MOVE WS-TOTL-BILL-ETNI-MATCH-CNT                             22457099
222560       TO WS-SAVE-BILL-ETNI-MATCH-CNT                             22458099
222570     MOVE WS-TOTL-BILL-ETNI-MATCH-NEW                             22459099
222580       TO WS-SAVE-BILL-ETNI-MATCH-NEW                             22460099
222590     MOVE WS-TOTL-BILL-ETNI-MATCH-PP                              22461099
222600       TO WS-SAVE-BILL-ETNI-MATCH-PP                              22462099
222610     MOVE WS-TOTL-BILL-ETNI-MATCH-NH                              22463099
222620       TO WS-SAVE-BILL-ETNI-MATCH-NH                              22464099
222630     MOVE WS-TOTL-PP-BLANK-MATCH-ALL                              22465099
222640       TO WS-SAVE-PP-BLANK-MATCH-ALL                              22466099
222650     MOVE WS-TOTL-BILL-ETNI-MATCH-OK                              22467099
222660       TO WS-SAVE-BILL-ETNI-MATCH-OK                              22468099
222670     MOVE WS-TOTL-BILL-ETNI-DIFF-CNT                              22469099
222680       TO WS-SAVE-BILL-ETNI-DIFF-CNT                              22470099
222690     MOVE WS-TOTL-BILL-NOT-IN-ETNI-CNT                            22471099
222700       TO WS-SAVE-BILL-NOT-IN-ETNI-CNT                            22472099
222710     MOVE WS-TOTL-BILL-NOT-IN-ETNI-NEW                            22473099
222720       TO WS-SAVE-BILL-NOT-IN-ETNI-NEW                            22474099
222730     MOVE WS-TOTL-BILL-NOT-IN-ETNI-PROC                           22475099
222740       TO WS-SAVE-BILL-NOT-IN-ETNI-PROC                           22476099
222750     MOVE WS-TOTL-ETNI-NOT-IN-BILL-CNT                            22477099
222760       TO WS-SAVE-ETNI-NOT-IN-BILL-CNT                            22478099
222770     MOVE WS-PO-IN-ETNI-NOT-IN-BILL                               22479099
222780       TO WS-SAVE-PO-IN-ETNI-NOT-IN-BILL                          22480099
222790     MOVE WS-TOTL-ETNI-NOT-IN-BILL-NEW                            22481099
222800       TO WS-SAVE-ETNI-NOT-IN-BILL-NEW                            22482099
222810     MOVE WS-TOTL-ETNI-NOT-IN-BILL-PROC                           22483099
222820       TO WS-SAVE-ETNI-NOT-IN-BILL-PROC                           22484099
222830     MOVE WS-TOTL-ETNI-NA-NH-CNT                                  22485099
222840       TO WS-SAVE-ETNI-NA-NH-CNT                                  22486099
222850     MOVE WS-TOTL-ETNI-MININV-UPD-CNT                             22487099
222860       TO WS-SAVE-ETNI-MININV-UPD-CNT                             22488099
222870     MOVE WS-TOTL-ETNI-MININV-UPD-ST-CNT                          22489099
222880       TO WS-SAVE-ETNI-MININV-UPD-ST-CNT                          22490099
222890     MOVE WS-TOTL-ETNI-CTNINV-UPD-CNT                             22491099
222900       TO WS-SAVE-ETNI-CTNINV-UPD-CNT                             22492099
222910     MOVE WS-TOTL-ETNI-CTNINV-UPD-ST-CNT                          22493099
222920       TO WS-SAVE-ETNI-CTNINV-UPD-ST-CNT                          22494099
222930     MOVE WS-TOTL-ETNI-CTNINV-INS-CNT                             22495099
222940       TO WS-SAVE-ETNI-CTNINV-INS-CNT                             22496099
222950     MOVE WS-TOTL-ETNI-CTNINV-DUPINS                              22497099
222960       TO WS-SAVE-ETNI-CTNINV-DUPINS                              22498099
222970     MOVE WS-TOTL-ETNI-CTNINV-DLT-CNT                             22499099
222980       TO WS-SAVE-ETNI-CTNINV-DLT-CNT                             22500099
222990     MOVE WS-TOTL-ETNI-CTNHIST-INS-CNT                            22501099
223000       TO WS-SAVE-ETNI-CTNHIST-INS-CNT                            22502099
223010     MOVE WS-TOTL-ETNI-CTNHIST-DUPINS                             22503099
223020       TO WS-SAVE-ETNI-CTNHIST-DUPINS                             22504099
223030     MOVE WS-TOTL-ETNI-NGPCNTS-UPD-CNT                            22505099
223040       TO WS-SAVE-ETNI-NGPCNTS-UPD-CNT                            22506099
223050     MOVE WS-TOTL-ETNI-NGPNLAS-UPD-CNT                            22507099
223060       TO WS-SAVE-ETNI-NGPNLAS-UPD-CNT                            22508099
223070     MOVE WS-TOTL-ERROR-CNT                                       22509099
223080       TO WS-SAVE-ERROR-CNT                                       22510099
223090     MOVE WS-TOTL-ERROR-CTNINV-NOTFND                             22511099
223100       TO WS-SAVE-ERROR-CTNINV-NOTFND                             22512099
223110     MOVE WS-TOTL-ERROR-CTNINV-DUPINS                             22513099
223120       TO WS-SAVE-ERROR-CTNINV-DUPINS                             22514099
223130     MOVE WS-TOTL-ERROR-CTNHIST-DUPINS                            22515099
223140       TO WS-SAVE-ERROR-CTNHIST-DUPINS                            22516099
223150     MOVE WS-TOTL-ERROR-BILLER-NOTMTCH                            22517099
223160       TO WS-SAVE-ERROR-BILLER-NOTMTCH                            22518099
223170     MOVE WS-TOTL-ERROR-LERG6-NOTFND                              22519099
223180       TO WS-SAVE-ERROR-LERG6-NOTFND                              22520099
223190     MOVE WS-TOTL-ERROR-NUMLOC-NOTFND                             22521099
223200       TO WS-SAVE-ERROR-NUMLOC-NOTFND                             22522099
223210     MOVE WS-TOTL-ERROR-NUMGRP-NOTFND                             22523099
223220       TO WS-SAVE-ERROR-NUMGRP-NOTFND                             22524099
223230     MOVE WS-TOTL-ERROR-GRPLOC-NOTFND                             22525099
223240       TO WS-SAVE-ERROR-GRPLOC-NOTFND                             22526099
223250     MOVE WS-TOTL-ERROR-NGPCNT-NOTFND                             22527099
223260       TO WS-SAVE-ERROR-NGPCNT-NOTFND                             22528099
223270     MOVE WS-TOTL-ERROR-NGPNL-NOTFND                              22529099
223280       TO WS-SAVE-ERROR-NGPNL-NOTFND                              22530099
223290     MOVE WS-TOTL-ERROR-DATE-INVALID                              22531099
223300       TO WS-SAVE-ERROR-DATE-INVALID                              22532099
223310     MOVE WS-TOTL-ERROR-TRX-CODE-NOTFND                           22533099
223320       TO WS-SAVE-ERROR-TRX-CODE-NOTFND                           22534099
223330     MOVE WS-TOTL-ERROR-TRX-STAT-NOTFND                           22535099
223340       TO WS-SAVE-ERROR-TRX-STAT-NOTFND                           22536099
223350     MOVE WS-TOTL-ERROR-STATUS-INVALID                            22537099
223360       TO WS-SAVE-ERROR-STATUS-INVALID                            22538099
223370     MOVE WS-TOTL-ERROR-HOLD-REASON                               22539099
223380       TO WS-SAVE-ERROR-HOLD-REASON                               22540099
223390     MOVE WS-TOTL-ERROR-MIN-NUM-NOTFND                            22541099
223400       TO WS-SAVE-ERROR-MIN-NUM-NOTFND                            22542099
223410     MOVE WS-TOTL-ERROR-MIN-NUM-IN-CTN                            22543099
223420       TO WS-SAVE-ERROR-MIN-NUM-IN-CTN                            22544099
223430     MOVE WS-TOTL-ERROR-MIN-NUM-NOTFND-S                          22545099
223440       TO WS-SAVE-ERROR-MIN-NUM-NOTFND-S                          22546099
223450     MOVE WS-TOTL-ERROR-PORT-IND-CHANGED                          22547099
223460       TO WS-SAVE-ERROR-PORT-IND-CHANGED                          22548099
223470*** #870803 SDL BEGIN                                             22549099
223480     MOVE WS-TOTL-ERROR-PRDTYP-MISMATCH                           22550099
223490       TO WS-SAVE-ERROR-PRDTYP-MISMATCH                           22551099
223500*** #870803 SDL END                                               22552099
223510     MOVE WS-TOTL-ERROR-NOT-NUMERIC                               22553099
223520       TO WS-SAVE-ERROR-NOT-NUMERIC                               22554099
223530     MOVE WS-TOTL-CNTRLRPT-CNT                                    22555099
223540       TO WS-SAVE-CNTRLRPT-CNT                                    22556099
223550                                                                  22557099
223560     MOVE WS-TOTL-ERROR-POPO-MISMATCH                             22558099
223570       TO WS-SAVE-ERROR-POPO-MISMATCH                             22559099
223580     MOVE WS-TOTL-ERROR-POIO-MISMATCH                             22560099
223590       TO WS-SAVE-ERROR-POIO-MISMATCH                             22561099
223600     MOVE WS-TOTL-ERROR-DUPE-BILLER                               22562099
223610       TO WS-SAVE-ERROR-DUPE-BILLER                               22563099
223620     MOVE WS-TOTL-ERROR-NGP-NOT-FOUND                             22564099
223630       TO WS-SAVE-ERROR-NGP-NOT-FOUND                             22565099
223640     MOVE WS-TOTL-ERROR-NGP-ARE-EMPTY                             22566099
223650       TO WS-SAVE-ERROR-NGP-ARE-EMPTY                             22567099
223660                                                                  22568099
223670     MOVE WS-PAGE-CTR-RECON    TO WS-SAVE-PAGE-CTR-RECON          22569099
223680     MOVE WS-PAGE-CTR-ERROR    TO WS-SAVE-PAGE-CTR-ERROR          22570099
223690     MOVE WS-PAGE-CTR-ERROR-PREPAID TO                            22571099
223700          WS-SAVE-PAGE-CTR-ERROR-PREPAID                          22572099
223710     MOVE WS-PAGE-CTR-ERROR-PREPAID TO                            22573099
223720          WS-SAVE-PAGE-CTR-ERROR-PO                               22574099
223730                                                                  22575099
223740     MOVE WS-PAGE-CTR-CNTRLRPT TO WS-SAVE-PAGE-CTR-CNTRLRPT       22576099
223750                                                                  22577099
223760     PERFORM C300-CHECKPOINT-DATA THRU C300-EXIT                  22578099
223770                                                                  22579099
223780     PERFORM 8000-GET-TIMEZONE THRU 8000-EXIT                     22580099
223790                                                                  22581099
223800**  JA1207A -  Start  /   Below  Cond.                            22582099
223810                                                                  22583099
223820     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        22584099
223830        INITIALIZE  WS-SEQ-NUMBERING-AREA                         22585099
223840        MOVE  LIT-PGM-ID  TO  OPERATOR-ID  OF                     22586099
223850                                           WS-SEQ-NUMBERING-AREA  22587099
223860                                                                  22588099
223870        PERFORM  8510-CALL-ETNSC58   THRU                         22589099
223880                 8510-EXIT                                        22590099
223890                 VARYING  WS-NGP-NL-A-IDX  FROM  +1  BY  +1       22591099
223900                 UNTIL    WS-NGP-NL-A-IDX  >                      22592099
223910                          WS-NGP-NL-A-IDX-MAX                     22593099
223920                 OR       WS-NGP-ENTRY (WS-NGP-NL-A-IDX)  =       22594099
223930                          SPACES                                  22595099
223940                                                                  22596099
223950        MOVE  SPACES  TO  WS-NGP-NL-AREA                          22597099
223960                                                                  22598099
223970     END-IF                                                       22599099
223980                                                                  22600099
223990**  JA1207A -  End                                                22601099
224010                                                                  22602099
224020      .                                                           22603099
224030 8500-EXIT.                                                       22604099
224040      EXIT.                                                       22605099
224050                                                                  22606099
224060 8510-CALL-ETNSC58.                                               22607099
224070******************************************************************22608099
224080*  Routine  Catches  Up  ETNSC58  per  What  ETNBC16  has  just   22609099
224090*  Committed.                                                     22610099
224100******************************************************************22611099
224110     MOVE  LIT-PGM-ID  TO  OPERATOR-ID  OF  WS-SEQ-NUMBERING-AREA 22612099
224120                                                                  22613099
224130     MOVE  WS-NGP-ENTRY (WS-NGP-NL-A-IDX)  TO                     22614099
224140                       NUMBER-GROUP OF  WS-SEQ-NUMBERING-AREA     22615099
224150                                                                  22616099
224160     MOVE  WS-NL-ENTRY  (WS-NGP-NL-A-IDX)  TO                     22617099
224170                       NUMBER-LOCATION                            22618099
224180                                    OF  WS-SEQ-NUMBERING-AREA     22619099
224190                                                                  22620099
224200     MOVE  WS-PRODUCT-ENTRY  (WS-NGP-NL-A-IDX)  TO                22621099
224210                       PRODUCT-TYPE OF  WS-SEQ-NUMBERING-AREA     22622099
224220                                                                  22623099
224230     CALL WS-ETNSC58       USING                                  22624099
224240                           WS-SEQ-NUMBERING-AREA                  22625099
224250                                                                  22626099
224260**  Asynchronous, therefore  No  Checking  of  R/C                22627099
224270                                                                  22628099
224280     .                                                            22629099
224290 8510-EXIT.  EXIT.                                                22630099
224300                                                                  22631099
224310                                                                  22632099
224320 8810-OPEN-NMMDNINP-FILE.                                         22633099
224330******************************************************************22634099
224340*   PARAGRAPH NAME:   8810-OPEN-NMMDNINP-FILE                     22635099
224350*                                                                 22636099
224360*   PURPOSE:                                                      22637099
224370*     THIS PARAGRAPH OPENS A RESTARTABLE MDN FILE.                22638099
224380******************************************************************22639099
224390     MOVE '8810-OPEN-NMMDNINP-FILE' TO WS-CURR-PARA               22640099
224400                                                                  22641099
224410     IF NMMDNINP-SUB = 0                                          22642099
224420        ADD +1 TO SEQ-CNTL-ARRAY-ALLOCATED                        22643099
224430        MOVE SEQ-CNTL-ARRAY-ALLOCATED TO                          22644099
224440           NMMDNINP-SUB                                           22645099
224450        IF NMMDNINP-SUB > SEQ-CNTL-MAX-FILES                      22646099
224460           STRING 'SEQUENTIAL I/O OPEN ERROR FOR '                22647099
224470                  'DDNAME: NMMDNINP'                              22648099
224480                  ' - MAXIMUM FILES ALREADY DEFINED'              22649099
224490                  DELIMITED BY SIZE                               22650099
224500                 INTO WS-ABEND-TEXT                               22651099
224510           END-STRING                                             22652099
224520           PERFORM 9000-ABORT                                     22653099
224530              THRU 9000-EXIT                                      22654099
224540        END-IF                                                    22655099
224550     END-IF                                                       22656099
224560                                                                  22657099
224570     IF SEQ-CNTL-DDNAME(NMMDNINP-SUB) = SPACES                    22658099
224580         CONTINUE                                                 22659099
224590     ELSE                                                         22660099
224600         STRING 'SEQUENTIAL I/O OPEN ERROR FOR '                  22661099
224610                'DDNAME: NMMDNINP'                                22662099
224620                ' - FILE ALREADY OPENED'                          22663099
224630                DELIMITED BY SIZE                                 22664099
224640                INTO WS-ABEND-TEXT                                22665099
224650         END-STRING                                               22666099
224660         PERFORM 9000-ABORT                                       22667099
224670            THRU 9000-EXIT                                        22668099
224680     END-IF                                                       22669099
224690                                                                  22670099
224700     INITIALIZE SEQ-CNTL-ARRAY(NMMDNINP-SUB)                      22671099
224710     MOVE LOW-VALUES  TO SEQ-FD-AREA(NMMDNINP-SUB)                22672099
224720     MOVE 'NMMDNINP' TO                                           22673099
224730        SEQ-CNTL-DDNAME(NMMDNINP-SUB)                             22674099
224740     MOVE YES-VALUE                                               22675099
224750        TO SEQ-RESTART-IND (NMMDNINP-SUB)                         22676099
224760                                                                  22677099
224770     IF SYS-RESTART-IND = YES-VALUE                               22678099
224780        ADD +1 TO WS-CHKPT-SEQ-SUB                                22679099
224790        MOVE SAVE-SEQ-DATA (WS-CHKPT-SEQ-SUB) TO                  22680099
224800             SEQ-INFO-AREA (NMMDNINP-SUB)                         22681099
224810                                                                  22682099
224820        MOVE SEQRESTRT TO SEQ-FUNCTION                            22683099
224830        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         22684099
224840        CALL SYS-CALL-PGM-ID  USING                               22685099
224850            DFHCOMMAREA                                           22686099
224860            SEQ-RETURN-CODE-DATA                                  22687099
224870            SEQ-DDNAME-TXT(NMMDNINP-SUB)                          22688099
224880                                                                  22689099
224890        IF SEQ-BUFF-SIZE-DIFF OR                                  22690099
224900           SEQ-REPOS-CLOSED                                       22691099
224910           MOVE ZERO TO SEQ-RET-CODE                              22692099
224920        ELSE                                                      22693099
224930        IF SEQ-SYSOUT-START OR                                    22694099
224940           SEQ-RSTRT-FILE-NOT-READ                                22695099
224950             INITIALIZE                                           22696099
224960                SEQ-CNTL-ARRAY(NMMDNINP-SUB)                      22697099
224970             MOVE LOW-VALUES                                      22698099
224980               TO SEQ-FD-AREA(NMMDNINP-SUB)                       22699099
224990             MOVE 'NMMDNINP' TO                                   22700099
225000                SEQ-CNTL-DDNAME(NMMDNINP-SUB)                     22701099
225010             MOVE YES-VALUE                                       22702099
225020               TO SEQ-RESTART-IND (NMMDNINP-SUB)                  22703099
225030                                                                  22704099
225040           MOVE SEQOPENI TO SEQ-FUNCTION                          22705099
225050           MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                      22706099
225060           CALL SYS-CALL-PGM-ID  USING                            22707099
225070               DFHCOMMAREA                                        22708099
225080               SEQ-RETURN-CODE-DATA                               22709099
225090               SEQ-DDNAME-TXT(NMMDNINP-SUB)                       22710099
225100                                                                  22711099
225110        END-IF                                                    22712099
225120     ELSE                                                         22713099
225130        MOVE SEQOPENI TO SEQ-FUNCTION                             22714099
225140        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         22715099
225150        CALL SYS-CALL-PGM-ID USING                                22716099
225160            DFHCOMMAREA                                           22717099
225170            SEQ-RETURN-CODE-DATA                                  22718099
225180            SEQ-DDNAME-TXT(NMMDNINP-SUB)                          22719099
225190     END-IF                                                       22720099
225200                                                                  22721099
225210     IF SEQ-ERROR                                                 22722099
225220        MOVE SEQ-RET-CODE TO                                      22723099
225230             SEQ-RET-CODE-DISPLAY                                 22724099
225240        STRING                                                    22725099
225250           'SEQUENTIAL I/O OPEN ERROR, RC: '                      22726099
225260           SEQ-RET-CODE-DISPLAY                                   22727099
225270           ' FOR DDNAME: NMMDNINP'                                22728099
225280              DELIMITED BY SIZE                                   22729099
225290           INTO WS-ABEND-TEXT                                     22730099
225300        END-STRING                                                22731099
225310        PERFORM 9000-ABORT                                        22732099
225320           THRU 9000-EXIT                                         22733099
225330     ELSE                                                         22734099
225340        MOVE 'I' TO                                               22735099
225350           SEQ-CNTL-ACCESS-METHOD-IND(NMMDNINP-SUB)               22736099
225360        MOVE YES-VALUE TO                                         22737099
225370           SEQ-OPEN-IND(NMMDNINP-SUB)                             22738099
225380     END-IF                                                       22739099
225390                                                                  22740099
225400      .                                                           22741099
225410 8810-EXIT.                                                       22742099
225420      EXIT.                                                       22743099
225430                                                                  22744099
225440 8820-OPEN-NMCTNINP-FILE.                                         22745099
225450******************************************************************22746099
225460*   PARAGRAPH NAME:   8820-OPEN-NMCTNINP-FILE                     22747099
225470*                                                                 22748099
225480*   PURPOSE:                                                      22749099
225490*     THIS PARAGRAPH OPENS A RESTARTABLE CTN-INV FILE.            22750099
225500******************************************************************22751099
225510     MOVE '8820-OPEN-NMCTNINP-FILE' TO WS-CURR-PARA               22752099
225520                                                                  22753099
225530     IF NMCTNINP-SUB = 0                                          22754099
225540        ADD +1 TO SEQ-CNTL-ARRAY-ALLOCATED                        22755099
225550        MOVE SEQ-CNTL-ARRAY-ALLOCATED TO                          22756099
225560           NMCTNINP-SUB                                           22757099
225570        IF NMCTNINP-SUB > SEQ-CNTL-MAX-FILES                      22758099
225580           STRING 'SEQUENTIAL I/O OPEN ERROR FOR '                22759099
225590                  'DDNAME: NMCTNINP'                              22760099
225600                  ' - MAXIMUM FILES ALREADY DEFINED'              22761099
225610                  DELIMITED BY SIZE                               22762099
225620                 INTO WS-ABEND-TEXT                               22763099
225630           END-STRING                                             22764099
225640           PERFORM 9000-ABORT                                     22765099
225650              THRU 9000-EXIT                                      22766099
225660        END-IF                                                    22767099
225670     END-IF                                                       22768099
225680                                                                  22769099
225690     IF SEQ-CNTL-DDNAME(NMCTNINP-SUB) = SPACES                    22770099
225700         CONTINUE                                                 22771099
225710     ELSE                                                         22772099
225720         STRING 'SEQUENTIAL I/O OPEN ERROR FOR '                  22773099
225730                'DDNAME: NMCTNINP'                                22774099
225740                ' - FILE ALREADY OPENED'                          22775099
225750                DELIMITED BY SIZE                                 22776099
225760                INTO WS-ABEND-TEXT                                22777099
225770         END-STRING                                               22778099
225780         PERFORM 9000-ABORT                                       22779099
225790            THRU 9000-EXIT                                        22780099
225800     END-IF                                                       22781099
225810                                                                  22782099
225820     INITIALIZE SEQ-CNTL-ARRAY(NMCTNINP-SUB)                      22783099
225830     MOVE LOW-VALUES  TO SEQ-FD-AREA(NMCTNINP-SUB)                22784099
225840     MOVE 'NMCTNINP' TO                                           22785099
225850        SEQ-CNTL-DDNAME(NMCTNINP-SUB)                             22786099
225860     MOVE YES-VALUE                                               22787099
225870        TO SEQ-RESTART-IND (NMCTNINP-SUB)                         22788099
225880                                                                  22789099
225890     IF SYS-RESTART-IND = YES-VALUE                               22790099
225900        ADD +1 TO WS-CHKPT-SEQ-SUB                                22791099
225910        MOVE SAVE-SEQ-DATA (WS-CHKPT-SEQ-SUB) TO                  22792099
225920             SEQ-INFO-AREA (NMCTNINP-SUB)                         22793099
225930                                                                  22794099
225940        MOVE SEQRESTRT TO SEQ-FUNCTION                            22795099
225950        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         22796099
225960        CALL SYS-CALL-PGM-ID  USING                               22797099
225970            DFHCOMMAREA                                           22798099
225980            SEQ-RETURN-CODE-DATA                                  22799099
225990            SEQ-DDNAME-TXT(NMCTNINP-SUB)                          22800099
226000                                                                  22801099
226010        IF SEQ-BUFF-SIZE-DIFF OR                                  22802099
226020           SEQ-REPOS-CLOSED                                       22803099
226030           MOVE ZERO TO SEQ-RET-CODE                              22804099
226040        ELSE                                                      22805099
226050        IF SEQ-SYSOUT-START OR                                    22806099
226060           SEQ-RSTRT-FILE-NOT-READ                                22807099
226070             INITIALIZE                                           22808099
226080                SEQ-CNTL-ARRAY(NMCTNINP-SUB)                      22809099
226090             MOVE LOW-VALUES                                      22810099
226100               TO SEQ-FD-AREA(NMCTNINP-SUB)                       22811099
226110             MOVE 'NMCTNINP' TO                                   22812099
226120                SEQ-CNTL-DDNAME(NMCTNINP-SUB)                     22813099
226130             MOVE YES-VALUE                                       22814099
226140               TO SEQ-RESTART-IND (NMCTNINP-SUB)                  22815099
226150                                                                  22816099
226160           MOVE SEQOPENI TO SEQ-FUNCTION                          22817099
226170           MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                      22818099
226180           CALL SYS-CALL-PGM-ID  USING                            22819099
226190               DFHCOMMAREA                                        22820099
226200               SEQ-RETURN-CODE-DATA                               22821099
226210               SEQ-DDNAME-TXT(NMCTNINP-SUB)                       22822099
226220                                                                  22823099
226230        END-IF                                                    22824099
226240     ELSE                                                         22825099
226250        MOVE SEQOPENI TO SEQ-FUNCTION                             22826099
226260        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         22827099
226270        CALL SYS-CALL-PGM-ID USING                                22828099
226280            DFHCOMMAREA                                           22829099
226290            SEQ-RETURN-CODE-DATA                                  22830099
226300            SEQ-DDNAME-TXT(NMCTNINP-SUB)                          22831099
226310     END-IF                                                       22832099
226320                                                                  22833099
226330     IF SEQ-ERROR                                                 22834099
226340        MOVE SEQ-RET-CODE TO                                      22835099
226350             SEQ-RET-CODE-DISPLAY                                 22836099
226360        STRING                                                    22837099
226370           'SEQUENTIAL I/O OPEN ERROR, RC: '                      22838099
226380           SEQ-RET-CODE-DISPLAY                                   22839099
226390           ' FOR DDNAME: NMCTNINP'                                22840099
226400              DELIMITED BY SIZE                                   22841099
226410           INTO WS-ABEND-TEXT                                     22842099
226420        END-STRING                                                22843099
226430        PERFORM 9000-ABORT                                        22844099
226440           THRU 9000-EXIT                                         22845099
226450     ELSE                                                         22846099
226460        MOVE 'I' TO                                               22847099
226470           SEQ-CNTL-ACCESS-METHOD-IND(NMCTNINP-SUB)               22848099
226480        MOVE YES-VALUE TO                                         22849099
226490           SEQ-OPEN-IND(NMCTNINP-SUB)                             22850099
226500     END-IF                                                       22851099
226510                                                                  22852099
226520      .                                                           22853099
226530 8820-EXIT.                                                       22854099
226540      EXIT.                                                       22855099
226550                                                                  22856099
226560 8830-OPEN-RECONOUT-FILE.                                         22857099
226570******************************************************************22858099
226580*   PARAGRAPH NAME:   8830-OPEN-RECONOUT-FILE                     22859099
226590*                                                                 22860099
226600*   PURPOSE:                                                      22861099
226610*     THIS PARAGRAPH OPENS A RESTARTABLE RECONOUT OUTPUT FILE.    22862099
226620*   PRIMARY PARAGRAPH FUNCTIONS:                                  22863099
226630******************************************************************22864099
226640     MOVE '8830-OPEN-RECONOUT-FILE' TO WS-CURR-PARA               22865099
226650                                                                  22866099
226660     IF RECONOUT-SUB = 0                                          22867099
226670        ADD 1 TO SEQ-CNTL-ARRAY-ALLOCATED                         22868099
226680        MOVE SEQ-CNTL-ARRAY-ALLOCATED TO                          22869099
226690           RECONOUT-SUB                                           22870099
226700        IF RECONOUT-SUB > SEQ-CNTL-MAX-FILES                      22871099
226710           STRING 'SEQUENTIAL I/O OPEN ERROR FOR '                22872099
226720                  'DDNAME: RECONOUT'                              22873099
226730                  ' - MAXIMUM FILES ALREADY DEFINED'              22874099
226740                  DELIMITED BY SIZE                               22875099
226750                  INTO WS-ABEND-TEXT                              22876099
226760           END-STRING                                             22877099
226770           PERFORM 9000-ABORT THRU                                22878099
226780                   9000-EXIT                                      22879099
226790        END-IF                                                    22880099
226800     END-IF                                                       22881099
226810     IF SEQ-CNTL-DDNAME(RECONOUT-SUB) = SPACES                    22882099
226820         CONTINUE                                                 22883099
226830     ELSE                                                         22884099
226840         STRING 'SEQUENTIAL I/O OPEN ERROR FOR '                  22885099
226850                'DDNAME: RECONOUT - FILE ALREADY OPENED'          22886099
226860                DELIMITED BY SIZE                                 22887099
226870                INTO WS-ABEND-TEXT                                22888099
226880         END-STRING                                               22889099
226890         PERFORM 9000-ABORT                                       22890099
226900            THRU 9000-EXIT                                        22891099
226910     END-IF                                                       22892099
226920                                                                  22893099
226930     INITIALIZE SEQ-CNTL-ARRAY(RECONOUT-SUB)                      22894099
226940     MOVE LOW-VALUES  TO SEQ-FD-AREA(RECONOUT-SUB)                22895099
226950     MOVE 'RECONOUT' TO                                           22896099
226960        SEQ-CNTL-DDNAME(RECONOUT-SUB)                             22897099
226970     MOVE YES-VALUE                                               22898099
226980        TO SEQ-RESTART-IND (RECONOUT-SUB)                         22899099
226990     IF SYS-RESTART-IND = YES-VALUE                               22900099
227000        ADD +1 TO WS-CHKPT-SEQ-SUB                                22901099
227010        MOVE SAVE-SEQ-DATA (WS-CHKPT-SEQ-SUB) TO                  22902099
227020             SEQ-INFO-AREA (RECONOUT-SUB)                         22903099
227030                                                                  22904099
227040        MOVE SEQRESTRT TO SEQ-FUNCTION                            22905099
227050        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         22906099
227060        CALL SYS-CALL-PGM-ID  USING                               22907099
227070            DFHCOMMAREA                                           22908099
227080            SEQ-RETURN-CODE-DATA                                  22909099
227090            SEQ-DDNAME-TXT(RECONOUT-SUB)                          22910099
227100                                                                  22911099
227110        IF SEQ-BUFF-SIZE-DIFF OR                                  22912099
227120           SEQ-REPOS-CLOSED                                       22913099
227130           MOVE ZERO TO SEQ-RET-CODE                              22914099
227140        ELSE                                                      22915099
227150        IF SEQ-SYSOUT-START OR                                    22916099
227160           SEQ-RSTRT-FILE-NOT-READ                                22917099
227170             INITIALIZE                                           22918099
227180                SEQ-CNTL-ARRAY(RECONOUT-SUB)                      22919099
227190             MOVE LOW-VALUES                                      22920099
227200               TO SEQ-FD-AREA(RECONOUT-SUB)                       22921099
227210             MOVE 'RECONOUT' TO                                   22922099
227220                SEQ-CNTL-DDNAME(RECONOUT-SUB)                     22923099
227230             MOVE YES-VALUE                                       22924099
227240               TO SEQ-RESTART-IND (RECONOUT-SUB)                  22925099
227250                                                                  22926099
227260           MOVE SEQOPENO TO SEQ-FUNCTION                          22927099
227270           MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                      22928099
227280           CALL SYS-CALL-PGM-ID  USING                            22929099
227290               DFHCOMMAREA                                        22930099
227300               SEQ-RETURN-CODE-DATA                               22931099
227310               SEQ-DDNAME-TXT(RECONOUT-SUB)                       22932099
227320        END-IF                                                    22933099
227330     ELSE                                                         22934099
227340        MOVE SEQOPENO TO SEQ-FUNCTION                             22935099
227350        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         22936099
227360        CALL SYS-CALL-PGM-ID USING                                22937099
227370            DFHCOMMAREA                                           22938099
227380            SEQ-RETURN-CODE-DATA                                  22939099
227390            SEQ-DDNAME-TXT(RECONOUT-SUB)                          22940099
227400     END-IF                                                       22941099
227410                                                                  22942099
227420     IF SEQ-ERROR                                                 22943099
227430        MOVE SEQ-RET-CODE TO                                      22944099
227440             SEQ-RET-CODE-DISPLAY                                 22945099
227450        STRING                                                    22946099
227460             'SEQUENTIAL I/O OPEN ERROR, RC: '                    22947099
227470           SEQ-RET-CODE-DISPLAY                                   22948099
227480           ' FOR DDNAME: RECONOUT'                                22949099
227490              DELIMITED BY SIZE                                   22950099
227500           INTO WS-ABEND-TEXT                                     22951099
227510        END-STRING                                                22952099
227520        PERFORM 9000-ABORT                                        22953099
227530           THRU 9000-EXIT                                         22954099
227540     ELSE                                                         22955099
227550        MOVE 'O' TO                                               22956099
227560           SEQ-CNTL-ACCESS-METHOD-IND(RECONOUT-SUB)               22957099
227570        MOVE YES-VALUE TO                                         22958099
227580           SEQ-OPEN-IND(RECONOUT-SUB)                             22959099
227590     END-IF                                                       22960099
227600     .                                                            22961099
227610 8830-EXIT.                                                       22962099
227620      EXIT.                                                       22963099
227630                                                                  22964099
227640 8840-OPEN-ERROROUT-FILE.                                         22965099
227650******************************************************************22966099
227660*   PARAGRAPH NAME:   8840-OPEN-ERROROUT-FILE                     22967099
227670*                                                                 22968099
227680*   PURPOSE:                                                      22969099
227690*     THIS PARAGRAPH OPENS A RESTARTABLE REJECT OUTPUT FILE.      22970099
227700******************************************************************22971099
227710     MOVE '8840-OPEN-ERROROUT-FILE' TO WS-CURR-PARA               22972099
227720                                                                  22973099
227730     IF ERROROUT-SUB = 0                                          22974099
227740        ADD 1 TO SEQ-CNTL-ARRAY-ALLOCATED                         22975099
227750        MOVE SEQ-CNTL-ARRAY-ALLOCATED TO                          22976099
227760           ERROROUT-SUB                                           22977099
227770        IF ERROROUT-SUB > SEQ-CNTL-MAX-FILES                      22978099
227780           STRING 'SEQUENTIAL I/O OPEN ERROR FOR '                22979099
227790                  'DDNAME: ERROROUT'                              22980099
227800                  ' - MAXIMUM FILES ALREADY DEFINED'              22981099
227810                  DELIMITED BY SIZE                               22982099
227820                  INTO WS-ABEND-TEXT                              22983099
227830           END-STRING                                             22984099
227840           PERFORM 9000-ABORT THRU                                22985099
227850                   9000-EXIT                                      22986099
227860        END-IF                                                    22987099
227870     END-IF                                                       22988099
227880     IF SEQ-CNTL-DDNAME(ERROROUT-SUB) = SPACES                    22989099
227890         CONTINUE                                                 22990099
227900     ELSE                                                         22991099
227910         STRING 'SEQUENTIAL I/O OPEN ERROR FOR '                  22992099
227920                'DDNAME: ERROROUT - FILE ALREADY OPENED'          22993099
227930                DELIMITED BY SIZE                                 22994099
227940                INTO WS-ABEND-TEXT                                22995099
227950         END-STRING                                               22996099
227960         PERFORM 9000-ABORT                                       22997099
227970            THRU 9000-EXIT                                        22998099
227980     END-IF                                                       22999099
227990                                                                  23000099
228000     INITIALIZE SEQ-CNTL-ARRAY(ERROROUT-SUB)                      23001099
228010     MOVE LOW-VALUES  TO SEQ-FD-AREA(ERROROUT-SUB)                23002099
228020     MOVE 'ERROROUT' TO                                           23003099
228030        SEQ-CNTL-DDNAME(ERROROUT-SUB)                             23004099
228040     MOVE YES-VALUE                                               23005099
228050        TO SEQ-RESTART-IND (ERROROUT-SUB)                         23006099
228060     IF SYS-RESTART-IND = YES-VALUE                               23007099
228070        ADD +1 TO WS-CHKPT-SEQ-SUB                                23008099
228080        MOVE SAVE-SEQ-DATA (WS-CHKPT-SEQ-SUB) TO                  23009099
228090             SEQ-INFO-AREA (ERROROUT-SUB)                         23010099
228100                                                                  23011099
228110        MOVE SEQRESTRT TO SEQ-FUNCTION                            23012099
228120        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         23013099
228130        CALL SYS-CALL-PGM-ID  USING                               23014099
228140            DFHCOMMAREA                                           23015099
228150            SEQ-RETURN-CODE-DATA                                  23016099
228160            SEQ-DDNAME-TXT(ERROROUT-SUB)                          23017099
228170                                                                  23018099
228180        IF SEQ-BUFF-SIZE-DIFF OR                                  23019099
228190           SEQ-REPOS-CLOSED                                       23020099
228200           MOVE ZERO TO SEQ-RET-CODE                              23021099
228210        ELSE                                                      23022099
228220        IF SEQ-SYSOUT-START OR                                    23023099
228230           SEQ-RSTRT-FILE-NOT-READ                                23024099
228240             INITIALIZE                                           23025099
228250                SEQ-CNTL-ARRAY(ERROROUT-SUB)                      23026099
228260             MOVE LOW-VALUES                                      23027099
228270               TO SEQ-FD-AREA(ERROROUT-SUB)                       23028099
228280             MOVE 'ERROROUT' TO                                   23029099
228290                SEQ-CNTL-DDNAME(ERROROUT-SUB)                     23030099
228300             MOVE YES-VALUE                                       23031099
228310               TO SEQ-RESTART-IND (ERROROUT-SUB)                  23032099
228320                                                                  23033099
228330           MOVE SEQOPENO TO SEQ-FUNCTION                          23034099
228340           MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                      23035099
228350           CALL SYS-CALL-PGM-ID  USING                            23036099
228360               DFHCOMMAREA                                        23037099
228370               SEQ-RETURN-CODE-DATA                               23038099
228380               SEQ-DDNAME-TXT(ERROROUT-SUB)                       23039099
228390        END-IF                                                    23040099
228400     ELSE                                                         23041099
228410        MOVE SEQOPENO TO SEQ-FUNCTION                             23042099
228420        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         23043099
228430        CALL SYS-CALL-PGM-ID USING                                23044099
228440            DFHCOMMAREA                                           23045099
228450            SEQ-RETURN-CODE-DATA                                  23046099
228460            SEQ-DDNAME-TXT(ERROROUT-SUB)                          23047099
228470     END-IF                                                       23048099
228480                                                                  23049099
228490     IF SEQ-ERROR                                                 23050099
228500        MOVE SEQ-RET-CODE TO                                      23051099
228510             SEQ-RET-CODE-DISPLAY                                 23052099
228520        STRING                                                    23053099
228530             'SEQUENTIAL I/O OPEN ERROR, RC: '                    23054099
228540           SEQ-RET-CODE-DISPLAY                                   23055099
228550           ' FOR DDNAME: ERROROUT'                                23056099
228560              DELIMITED BY SIZE                                   23057099
228570           INTO WS-ABEND-TEXT                                     23058099
228580        END-STRING                                                23059099
228590        PERFORM 9000-ABORT                                        23060099
228600           THRU 9000-EXIT                                         23061099
228610     ELSE                                                         23062099
228620        MOVE 'O' TO                                               23063099
228630           SEQ-CNTL-ACCESS-METHOD-IND(ERROROUT-SUB)               23064099
228640        MOVE YES-VALUE TO                                         23065099
228650           SEQ-OPEN-IND(ERROROUT-SUB)                             23066099
228660     END-IF                                                       23067099
228670     .                                                            23068099
228680 8840-EXIT.                                                       23069099
228690      EXIT.                                                       23070099
228700                                                                  23071099
228710 8845-OPEN-ERROROUT2-FILE.                                        23072099
228720      OPEN OUTPUT ERROROUT2-FILE                                  23073099
228730      IF ERROROUT2-STATUS NOT = ZERO                              23074099
228740         MOVE 'SEQUENTIAL OUTPUT OPEN ERROR FOR ERROROUT2.'       23075099
228750               TO WS-ABEND-TEXT                                   23076099
228760         PERFORM 9000-ABORT THRU 9000-EXIT                        23077099
228770      END-IF.                                                     23078099
228780 8845-EXIT.                                                       23079099
228790      EXIT.                                                       23080099
228800                                                                  23081099
228810 8847-OPEN-ERROROUT3-FILE.                                        23082099
228820      OPEN OUTPUT ERROROUT3-FILE                                  23083099
228830      IF ERROROUT3-STATUS NOT = ZERO                              23084099
228840         MOVE 'SEQUENTIAL OUTPUT OPEN ERROR FOR ERROROUT3.'       23085099
228850               TO WS-ABEND-TEXT                                   23086099
228860         PERFORM 9000-ABORT THRU 9000-EXIT                        23087099
228870      END-IF.                                                     23088099
228880 8847-EXIT.                                                       23089099
228890      EXIT.                                                       23090099
228900                                                                  23091099
228910 8848-OPEN-ERROROUT4-FILE.                                        23092099
228920      OPEN OUTPUT ERROROUT4-FILE                                  23093099
228930      IF ERROROUT4-STATUS NOT = ZERO                              23094099
228940         MOVE 'SEQUENTIAL OUTPUT OPEN ERROR FOR ERROROUT4.'       23095099
228950               TO WS-ABEND-TEXT                                   23096099
228960         PERFORM 9000-ABORT THRU 9000-EXIT                        23097099
228970      END-IF.                                                     23098099
228980 8848-EXIT.                                                       23099099
228990      EXIT.                                                       23100099
229000                                                                  23101099
229010 8850-OPEN-CNTRLRPT-FILE.                                         23102099
229020******************************************************************23103099
229030*   PARAGRAPH NAME:   8850-OPEN-CNTRLRPT-FILE                     23104099
229040*                                                                 23105099
229050*   PURPOSE:                                                      23106099
229060*     THIS PARAGRAPH OPENS A RESTARTABLE CONTROL REPORT FILE.     23107099
229070******************************************************************23108099
229080     MOVE '8850-OPEN-CNTRLRPT-FILE' TO WS-CURR-PARA               23109099
229090                                                                  23110099
229100     IF CNTRLRPT-SUB = 0                                          23111099
229110        ADD 1 TO SEQ-CNTL-ARRAY-ALLOCATED                         23112099
229120        MOVE SEQ-CNTL-ARRAY-ALLOCATED TO                          23113099
229130           CNTRLRPT-SUB                                           23114099
229140        IF CNTRLRPT-SUB > SEQ-CNTL-MAX-FILES                      23115099
229150           STRING 'SEQUENTIAL I/O OPEN ERROR FOR '                23116099
229160                  'DDNAME: CNTRLRPT'                              23117099
229170                  ' - MAXIMUM FILES ALREADY DEFINED'              23118099
229180                  DELIMITED BY SIZE                               23119099
229190                  INTO WS-ABEND-TEXT                              23120099
229200           END-STRING                                             23121099
229210           PERFORM 9000-ABORT THRU                                23122099
229220                   9000-EXIT                                      23123099
229230        END-IF                                                    23124099
229240     END-IF                                                       23125099
229250     IF SEQ-CNTL-DDNAME(CNTRLRPT-SUB) = SPACES                    23126099
229260         CONTINUE                                                 23127099
229270     ELSE                                                         23128099
229280         STRING 'SEQUENTIAL I/O OPEN ERROR FOR '                  23129099
229290                'DDNAME: CNTRLRPT - FILE ALREADY OPENED'          23130099
229300                DELIMITED BY SIZE                                 23131099
229310                INTO WS-ABEND-TEXT                                23132099
229320         END-STRING                                               23133099
229330         PERFORM 9000-ABORT                                       23134099
229340            THRU 9000-EXIT                                        23135099
229350     END-IF                                                       23136099
229360                                                                  23137099
229370     INITIALIZE SEQ-CNTL-ARRAY(CNTRLRPT-SUB)                      23138099
229380     MOVE LOW-VALUES  TO SEQ-FD-AREA(CNTRLRPT-SUB)                23139099
229390     MOVE 'CNTRLRPT' TO                                           23140099
229400        SEQ-CNTL-DDNAME(CNTRLRPT-SUB)                             23141099
229410     MOVE YES-VALUE                                               23142099
229420        TO SEQ-RESTART-IND (CNTRLRPT-SUB)                         23143099
229430     IF SYS-RESTART-IND = YES-VALUE                               23144099
229440        ADD +1 TO WS-CHKPT-SEQ-SUB                                23145099
229450        MOVE SAVE-SEQ-DATA (WS-CHKPT-SEQ-SUB) TO                  23146099
229460             SEQ-INFO-AREA (CNTRLRPT-SUB)                         23147099
229470                                                                  23148099
229480        MOVE SEQRESTRT TO SEQ-FUNCTION                            23149099
229490        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         23150099
229500        CALL SYS-CALL-PGM-ID  USING                               23151099
229510            DFHCOMMAREA                                           23152099
229520            SEQ-RETURN-CODE-DATA                                  23153099
229530            SEQ-DDNAME-TXT(CNTRLRPT-SUB)                          23154099
229540                                                                  23155099
229550        IF SEQ-BUFF-SIZE-DIFF OR                                  23156099
229560           SEQ-REPOS-CLOSED                                       23157099
229570           MOVE ZERO TO SEQ-RET-CODE                              23158099
229580        ELSE                                                      23159099
229590        IF SEQ-SYSOUT-START OR                                    23160099
229600           SEQ-RSTRT-FILE-NOT-READ                                23161099
229610             INITIALIZE                                           23162099
229620                SEQ-CNTL-ARRAY(CNTRLRPT-SUB)                      23163099
229630             MOVE LOW-VALUES                                      23164099
229640               TO SEQ-FD-AREA(CNTRLRPT-SUB)                       23165099
229650             MOVE 'CNTRLRPT' TO                                   23166099
229660                SEQ-CNTL-DDNAME(CNTRLRPT-SUB)                     23167099
229670             MOVE YES-VALUE                                       23168099
229680               TO SEQ-RESTART-IND (CNTRLRPT-SUB)                  23169099
229690                                                                  23170099
229700           MOVE SEQOPENO TO SEQ-FUNCTION                          23171099
229710           MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                      23172099
229720           CALL SYS-CALL-PGM-ID  USING                            23173099
229730               DFHCOMMAREA                                        23174099
229740               SEQ-RETURN-CODE-DATA                               23175099
229750               SEQ-DDNAME-TXT(CNTRLRPT-SUB)                       23176099
229760        END-IF                                                    23177099
229770     ELSE                                                         23178099
229780        MOVE SEQOPENO TO SEQ-FUNCTION                             23179099
229790        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         23180099
229800        CALL SYS-CALL-PGM-ID USING                                23181099
229810            DFHCOMMAREA                                           23182099
229820            SEQ-RETURN-CODE-DATA                                  23183099
229830            SEQ-DDNAME-TXT(CNTRLRPT-SUB)                          23184099
229840     END-IF                                                       23185099
229850                                                                  23186099
229860     IF SEQ-ERROR                                                 23187099
229870        MOVE SEQ-RET-CODE TO                                      23188099
229880             SEQ-RET-CODE-DISPLAY                                 23189099
229890        STRING                                                    23190099
229900             'SEQUENTIAL I/O OPEN ERROR, RC: '                    23191099
229910           SEQ-RET-CODE-DISPLAY                                   23192099
229920           ' FOR DDNAME: CNTRLRPT'                                23193099
229930              DELIMITED BY SIZE                                   23194099
229940           INTO WS-ABEND-TEXT                                     23195099
229950        END-STRING                                                23196099
229960        PERFORM 9000-ABORT                                        23197099
229970           THRU 9000-EXIT                                         23198099
229980     ELSE                                                         23199099
229990        MOVE 'O' TO                                               23200099
230000           SEQ-CNTL-ACCESS-METHOD-IND(CNTRLRPT-SUB)               23201099
230010        MOVE YES-VALUE TO                                         23202099
230020           SEQ-OPEN-IND(CNTRLRPT-SUB)                             23203099
230030     END-IF                                                       23204099
230040     .                                                            23205099
230050 8850-EXIT.                                                       23206099
230060      EXIT.                                                       23207099
230070                                                                  23208099
230080 8855-OPEN-DTCTLOUT-FILE.                                         23209099
230090      OPEN OUTPUT DTCTLOUT-FILE.                                  23210099
230100 8855-EXIT.                                                       23211099
230110      EXIT.                                                       23212099
230120                                                                  23213099
230130 8860-WRITE-RECONOUT.                                             23214099
230140*************************************************************     23215099
230150*   PARAGRAPH NAME:   8860-WRITE-RECONOUT                         23216099
230160*                                                                 23217099
230170*   PURPOSE:                                                      23218099
230180*     THIS PARAGRAPH WRITES THE RECORDS INTO THE RECON FILE       23219099
230190*************************************************************     23220099
230200     MOVE '8860-WRITE-RECONOUT' TO WS-CURR-PARA                   23221099
230210                                                                  23222099
230220     IF SEQ-OPEN-IND(RECONOUT-SUB) = YES-VALUE                    23223099
230230        MOVE SEQWRITE TO SEQ-FUNCTION                             23224099
230240        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         23225099
230250        CALL SYS-CALL-PGM-ID     USING                            23226099
230260            DFHCOMMAREA                                           23227099
230270            SEQ-RETURN-CODE-DATA                                  23228099
230280            SEQ-DDNAME-TXT(RECONOUT-SUB)                          23229099
230290            WS-RECON-REC                                          23230099
230300                                                                  23231099
230310        IF SEQ-ERROR                                              23232099
230320           MOVE SEQ-RET-CODE TO                                   23233099
230330                SEQ-RET-CODE-DISPLAY                              23234099
230340           STRING                                                 23235099
230350                 'SEQUENTIAL I/O WRITE ERROR, RC: '               23236099
230360                 SEQ-RET-CODE-DISPLAY                             23237099
230370                 ' FOR DDNAME: RECONOUT'                          23238099
230380                    DELIMITED BY SIZE                             23239099
230390                 INTO WS-ABEND-TEXT                               23240099
230400              END-STRING                                          23241099
230410              PERFORM 9000-ABORT       THRU                       23242099
230420                      9000-EXIT                                   23243099
230430        ELSE                                                      23244099
230440           IF NOT SEQ-END-OF-FILE                                 23245099
230450              ADD 1 TO                                            23246099
230460                  SEQ-CNTL-REC-COUNT(RECONOUT-SUB)                23247099
230470           END-IF                                                 23248099
230480        END-IF                                                    23249099
230490     ELSE                                                         23250099
230500        STRING                                                    23251099
230510           'SEQUENTIAL I/O WRITE ERROR FOR '                      23252099
230520            'DDNAME: RECONOUT - FILE NOT OPENED'                  23253099
230530            DELIMITED BY SIZE                                     23254099
230540            INTO WS-ABEND-TEXT                                    23255099
230550        END-STRING                                                23256099
230560        PERFORM 9000-ABORT       THRU                             23257099
230570                9000-EXIT                                         23258099
230580     END-IF                                                       23259099
230590                                                                  23260099
230600     .                                                            23261099
230610 8860-EXIT.                                                       23262099
230620      EXIT.                                                       23263099
230630                                                                  23264099
230640 8870-WRITE-ERROROUT.                                             23265099
230650*************************************************************     23266099
230660*   PARAGRAPH NAME:   8870-WRITE-ERROROUT                         23267099
230670*                                                                 23268099
230680*   PURPOSE:                                                      23269099
230690*     THIS PARAGRAPH WRITES THE RECORDS INTO THE ERROR FILE       23270099
230700*************************************************************     23271099
230710     MOVE '8870-WRITE-ERROROUT' TO WS-CURR-PARA                   23272099
230720                                                                  23273099
230730     IF SEQ-OPEN-IND(ERROROUT-SUB) = YES-VALUE                    23274099
230740        MOVE SEQWRITE TO SEQ-FUNCTION                             23275099
230750        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         23276099
230760        CALL SYS-CALL-PGM-ID     USING                            23277099
230770            DFHCOMMAREA                                           23278099
230780            SEQ-RETURN-CODE-DATA                                  23279099
230790            SEQ-DDNAME-TXT(ERROROUT-SUB)                          23280099
230800            WS-ERROR-REC                                          23281099
230810                                                                  23282099
230820        IF SEQ-ERROR                                              23283099
230830           MOVE SEQ-RET-CODE TO                                   23284099
230840                SEQ-RET-CODE-DISPLAY                              23285099
230850           STRING                                                 23286099
230860                 'SEQUENTIAL I/O WRITE ERROR, RC: '               23287099
230870                 SEQ-RET-CODE-DISPLAY                             23288099
230880                 ' FOR DDNAME: ERROROUT'                          23289099
230890                    DELIMITED BY SIZE                             23290099
230900                 INTO WS-ABEND-TEXT                               23291099
230910              END-STRING                                          23292099
230920              PERFORM 9000-ABORT       THRU                       23293099
230930                      9000-EXIT                                   23294099
230940        ELSE                                                      23295099
230950           IF NOT SEQ-END-OF-FILE                                 23296099
230960              ADD 1 TO                                            23297099
230970                  SEQ-CNTL-REC-COUNT(ERROROUT-SUB)                23298099
230980           END-IF                                                 23299099
230990        END-IF                                                    23300099
231000     ELSE                                                         23301099
231010        STRING                                                    23302099
231020           'SEQUENTIAL I/O WRITE ERROR FOR '                      23303099
231030            'DDNAME: ERROROUT - FILE NOT OPENED'                  23304099
231040            DELIMITED BY SIZE                                     23305099
231050            INTO WS-ABEND-TEXT                                    23306099
231060        END-STRING                                                23307099
231070        PERFORM 9000-ABORT       THRU                             23308099
231080                9000-EXIT                                         23309099
231090     END-IF                                                       23310099
231100                                                                  23311099
231110**  JA0410 / JA0312                                               23312099
231120**   MOVE  SPACES  TO  DETAIL-1-ADDTL-INFO                        23313099
231130                                                                  23314099
231140     .                                                            23315099
231150 8870-EXIT.                                                       23316099
231160      EXIT.                                                       23317099
231170                                                                  23318099
231180*-----WRITE ALL "PREPAID ON HOLD:BYPASSED" ERRORS TO THIS FILE----23319099
231190                                                                  23320099
231200 8875-WRITE-PREPAID-ON-HOLD-RPT.                                  23321099
231210      MOVE '8875-WRITE-PREPAID-ON-HOLD-RPT' TO WS-CURR-PARA       23322099
231220      WRITE ERROR2-RECORD FROM WS-ERROR-REC                       23323099
231230      IF ERROROUT2-STATUS NOT = ZERO                              23324099
231240         MOVE 'SEQUENTIAL OUTPUT WRITE ERROR FOR ERROROUT2.'      23325099
231250               TO WS-ABEND-TEXT                                   23326099
231260         PERFORM 9000-ABORT THRU 9000-EXIT                        23327099
231270      END-IF.                                                     23328099
231280 8875-EXIT.                                                       23329099
231290      EXIT.                                                       23330099
231300                                                                  23331099
231310*AGB 3/7/06                                                       23332099
231320*-----WRITE ALL "PORT IND UPDATE DISALLOWED" ERRORS TO THIS FILE--23333099
231330                                                                  23334099
231340 8877-WRITE-PORT-IND-DISALLOWED.                                  23335099
231350      MOVE '8877-WRITE-PORT-IND-DISALLOWED' TO WS-CURR-PARA       23336099
231360      WRITE ERROR3-RECORD FROM WS-ERROR-REC                       23337099
231370      IF ERROROUT3-STATUS NOT = ZERO                              23338099
231380         MOVE 'SEQUENTIAL OUTPUT WRITE ERROR FOR ERROROUT3.'      23339099
231390               TO WS-ABEND-TEXT                                   23340099
231400         PERFORM 9000-ABORT THRU 9000-EXIT                        23341099
231410      END-IF.                                                     23342099
231420 8877-EXIT.                                                       23343099
231430      EXIT.                                                       23344099
231490                                                                  23345099
231460*-----AGB 5/08/06                                                 23346099
231470*-----when eTNI/Biller pair is not processed, write both records--23347099
231480*-----to this audit trail output file-----------------------------23348099
231490                                                                  23349099
231500 8878-WRITE-NOT-PROCESSED-FILE.                                   23350099
231510*-----1st time thru: write meanings of each Error Reason to file--23351099
231520*-----as documentation--------------------------------------------23352099
231530      IF WS-8878-FIRST-PASS = 'Y'                                 23353099
231540         MOVE SPACE TO WS-8878-FIRST-PASS                         23354099
231550         MOVE SPACE TO ERROR4-RECORD                              23355099
231560         MOVE WS-LIT-ERROR4-DASHES   TO ERROR4-RECORD             23356099
231570         WRITE ERROR4-RECORD                                      23357099
231580         MOVE SPACE TO ERROR4-RECORD                              23358099
231590         MOVE WS-LIT-ERROR4-REASON-1 TO ERROR4-RECORD             23359099
231600         WRITE ERROR4-RECORD                                      23360099
231610         MOVE WS-LIT-ERROR4-REASON-2 TO ERROR4-RECORD             23361099
231620         WRITE ERROR4-RECORD                                      23362099
231630         MOVE WS-LIT-ERROR4-REASON-3 TO ERROR4-RECORD             23363099
231640         WRITE ERROR4-RECORD                                      23364099
231650         MOVE WS-LIT-ERROR4-REASON-4 TO ERROR4-RECORD             23365099
231660         WRITE ERROR4-RECORD                                      23366099
231670         MOVE WS-LIT-ERROR4-REASON-5 TO ERROR4-RECORD             23367099
231680         WRITE ERROR4-RECORD                                      23368099
231690         MOVE WS-LIT-ERROR4-DASHES   TO ERROR4-RECORD             23369099
231700         WRITE ERROR4-RECORD                                      23370099
231710         MOVE SPACE TO ERROR4-RECORD                              23371099
231720         WRITE ERROR4-RECORD                                      23372099
231730         MOVE SPACE TO ERROR4-RECORD                              23373099
231740      END-IF                                                      23374099
231750                                                                  23375099
231760*-----which Error Reason was passed to this routine?--------------23376099
231770      MOVE SPACE TO ERROR4-RECORD                                 23377099
231780      MOVE WS-ERROR4-REASON TO ERROR4-REASON OF ERROR4-RECORD     23378099
231790                                                                  23379099
231800*-----Error Reason 1 & 2: write both Biller and eTNI records------23380099
231810      IF ERROR4-REASON OF ERROR4-RECORD = '001' OR                23381099
231820         ERROR4-REASON OF ERROR4-RECORD = '002'                   23382099
231830         MOVE LIT-BILLER TO ERROR4-ETNI-OR-BILLER                 23383099
231840         MOVE WS-MDNIN-RECORD TO ERROR4-CTN-BILLER-DATA           23384099
231850         WRITE ERROR4-RECORD                                      23385099
231860         MOVE SPACE TO ERROR4-RECORD                              23386099
231870         MOVE WS-ERROR4-REASON TO ERROR4-REASON OF ERROR4-RECORD  23387099
231880         MOVE LIT-ETNI TO ERROR4-ETNI-OR-BILLER                   23388099
231890         MOVE WS-CTNIN-RECORD(2:282) TO ERROR4-CTN-BILLER-DATA    23389099
231900         WRITE ERROR4-RECORD                                      23390099
231910         MOVE SPACE TO ERROR4-RECORD                              23391099
231920         WRITE ERROR4-RECORD                                      23392099
231930         IF ERROROUT4-STATUS NOT = ZERO                           23393099
231940            MOVE 'SEQUENTIAL OUTPUT WRITE ERROR FOR ERROROUT4.'   23394099
231950            TO WS-ABEND-TEXT                                      23395099
231960            PERFORM 9000-ABORT THRU 9000-EXIT                     23396099
231970            GO TO 8878-EXIT                                       23397099
231980            END-IF                                                23398099
231990         GO TO 8878-EXIT                                          23399099
232000      END-IF                                                      23400099
232010                                                                  23401099
232020*-----Error Reason 3: write only the Biller record----------------23402099
232030      IF ERROR4-REASON OF ERROR4-RECORD = '003'                   23403099
232040         MOVE LIT-BILLER TO ERROR4-ETNI-OR-BILLER                 23404099
232050         MOVE WS-MDNIN-RECORD TO ERROR4-CTN-BILLER-DATA           23405099
232060         WRITE ERROR4-RECORD                                      23406099
232070         MOVE SPACE TO ERROR4-RECORD                              23407099
232080         WRITE ERROR4-RECORD                                      23408099
232090         IF ERROROUT4-STATUS NOT = ZERO                           23409099
232100            MOVE 'SEQUENTIAL OUTPUT WRITE ERROR FOR ERROROUT4.'   23410099
232110            TO WS-ABEND-TEXT                                      23411099
232120            PERFORM 9000-ABORT THRU 9000-EXIT                     23412099
232130            GO TO 8878-EXIT                                       23413099
232140            END-IF                                                23414099
232150         GO TO 8878-EXIT                                          23415099
232160      END-IF                                                      23416099
232170                                                                  23417099
232180*-----Error Reason 4 & 5: write only the eTNI record--------------23418099
232190      IF ERROR4-REASON OF ERROR4-RECORD = '004'                   23419099
232200**  JA1208  -  Below  Commented                                   23420099
232210*******  ERROR4-REASON OF ERROR4-RECORD = '005'                   23421099
232220         MOVE LIT-ETNI TO ERROR4-ETNI-OR-BILLER                   23422099
232230         MOVE WS-CTNIN-RECORD(2:282) TO ERROR4-CTN-BILLER-DATA    23423099
232240         WRITE ERROR4-RECORD                                      23424099
232250         MOVE SPACE TO ERROR4-RECORD                              23425099
232260         WRITE ERROR4-RECORD                                      23426099
232270         IF ERROROUT4-STATUS NOT = ZERO                           23427099
232280            MOVE 'SEQUENTIAL OUTPUT WRITE ERROR FOR ERROROUT4.'   23428099
232290            TO WS-ABEND-TEXT                                      23429099
232300            PERFORM 9000-ABORT THRU 9000-EXIT                     23430099
232310            GO TO 8878-EXIT                                       23431099
232320            END-IF                                                23432099
232330         GO TO 8878-EXIT                                          23433099
232340      END-IF.                                                     23434099
232350 8878-EXIT.                                                       23435099
232360      EXIT.                                                       23436099
232370                                                                  23437099
232380 8880-WRITE-CNTRLRPT.                                             23438099
232390*************************************************************     23439099
232400*   PARAGRAPH NAME:   8880-WRITE-CNTRLRPT                         23440099
232410*                                                                 23441099
232420*   PURPOSE:                                                      23442099
232430*     THIS PARAGRAPH WRITES THE RECORDS INTO THE CONTROL RPT      23443099
232440*************************************************************     23444099
232450     MOVE '8880-WRITE-CNTRLRPT' TO WS-CURR-PARA                   23445099
232460                                                                  23446099
232470     IF SEQ-OPEN-IND(CNTRLRPT-SUB) = YES-VALUE                    23447099
232480        MOVE SEQWRITE TO SEQ-FUNCTION                             23448099
232490        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         23449099
232500        CALL SYS-CALL-PGM-ID     USING                            23450099
232510            DFHCOMMAREA                                           23451099
232520            SEQ-RETURN-CODE-DATA                                  23452099
232530            SEQ-DDNAME-TXT(CNTRLRPT-SUB)                          23453099
232540            WS-CNTRLRPT-REC                                       23454099
232550                                                                  23455099
232560        IF SEQ-ERROR                                              23456099
232570           MOVE SEQ-RET-CODE TO                                   23457099
232580                SEQ-RET-CODE-DISPLAY                              23458099
232590           STRING                                                 23459099
232600                 'SEQUENTIAL I/O WRITE ERROR, RC: '               23460099
232610                 SEQ-RET-CODE-DISPLAY                             23461099
232620                 ' FOR DDNAME: CNTRLRPT'                          23462099
232630                    DELIMITED BY SIZE                             23463099
232640                 INTO WS-ABEND-TEXT                               23464099
232650              END-STRING                                          23465099
232660              PERFORM 9000-ABORT       THRU                       23466099
232670                      9000-EXIT                                   23467099
232680        ELSE                                                      23468099
232690           IF NOT SEQ-END-OF-FILE                                 23469099
232700              ADD 1 TO                                            23470099
232710                  SEQ-CNTL-REC-COUNT(CNTRLRPT-SUB)                23471099
232720           END-IF                                                 23472099
232730        END-IF                                                    23473099
232740     ELSE                                                         23474099
232750        STRING                                                    23475099
232760           'SEQUENTIAL I/O WRITE ERROR FOR '                      23476099
232770            'DDNAME: CNTRLRPT - FILE NOT OPENED'                  23477099
232780            DELIMITED BY SIZE                                     23478099
232790            INTO WS-ABEND-TEXT                                    23479099
232800        END-STRING                                                23480099
232810        PERFORM 9000-ABORT       THRU                             23481099
232820                9000-EXIT                                         23482099
232830     END-IF                                                       23483099
232840                                                                  23484099
232850     .                                                            23485099
232860 8880-EXIT.                                                       23486099
232870      EXIT.                                                       23487099
232880                                                                  23488099
232890 8910-CLOSE-NMMDNINP-FILE.                                        23489099
232900******************************************************************23490099
232910*   PARAGRAPH NAME:   8910-CLOSE-NMMDNINP-FILE                    23491099
232920*                                                                 23492099
232930*   PURPOSE:                                                      23493099
232940*     THIS PARAGRAPH CLOSES THE NMMDNINP FILE                     23494099
232950******************************************************************23495099
232960     MOVE '8910-CLOSE-NMMDNINP-FILE' TO WS-CURR-PARA              23496099
232970                                                                  23497099
232980     IF SEQ-OPEN-IND(NMMDNINP-SUB) = YES-VALUE                    23498099
232990        MOVE SEQCLOSE TO SEQ-FUNCTION                             23499099
233000        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         23500099
233010        CALL SYS-CALL-PGM-ID  USING                               23501099
233020            DFHCOMMAREA                                           23502099
233030            SEQ-RETURN-CODE-DATA                                  23503099
233040            SEQ-DDNAME-TXT(NMMDNINP-SUB)                          23504099
233050                                                                  23505099
233060        IF SEQ-ERROR                                              23506099
233070           MOVE SEQ-RET-CODE TO                                   23507099
233080                SEQ-RET-CODE-DISPLAY                              23508099
233090           STRING                                                 23509099
233100              'SEQUENTIAL I/O CLOSE ERROR, RC: '                  23510099
233110              SEQ-RET-CODE-DISPLAY                                23511099
233120              ' FOR DDNAME: NMMDNINP'                             23512099
233130              DELIMITED BY SIZE                                   23513099
233140              INTO WS-ABEND-TEXT                                  23514099
233150           END-STRING                                             23515099
233160           PERFORM 9000-ABORT THRU                                23516099
233170                   9000-EXIT                                      23517099
233180        ELSE                                                      23518099
233190           MOVE SPACES TO                                         23519099
233200               SEQ-CNTL-DDNAME(NMMDNINP-SUB)                      23520099
233210        END-IF                                                    23521099
233220     ELSE                                                         23522099
233230        STRING                                                    23523099
233240           'SEQUENTIAL I/O CLOSE ERROR FOR '                      23524099
233250            'DDNAME: NMMDNINP'                                    23525099
233260            ' - FILE NOT OPENED'                                  23526099
233270               DELIMITED BY SIZE                                  23527099
233280            INTO WS-ABEND-TEXT                                    23528099
233290        END-STRING                                                23529099
233300        PERFORM 9000-ABORT       THRU                             23530099
233310                9000-EXIT                                         23531099
233320     END-IF                                                       23532099
233330     .                                                            23533099
233340 8910-EXIT.                                                       23534099
233350      EXIT.                                                       23535099
233360                                                                  23536099
233370 8920-CLOSE-NMCTNINP-FILE.                                        23537099
233380******************************************************************23538099
233390*   PARAGRAPH NAME:   8920-CLOSE-NMCTNINP-FILE                    23539099
233400*                                                                 23540099
233410*   PURPOSE:                                                      23541099
233420*     THIS PARAGRAPH CLOSES THE NMCTNINP FILE                     23542099
233430******************************************************************23543099
233440     MOVE '8920-CLOSE-NMCTNINP-FILE' TO WS-CURR-PARA              23544099
233450                                                                  23545099
233460     IF SEQ-OPEN-IND(NMCTNINP-SUB) = YES-VALUE                    23546099
233470        MOVE SEQCLOSE TO SEQ-FUNCTION                             23547099
233480        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         23548099
233490        CALL SYS-CALL-PGM-ID  USING                               23549099
233500            DFHCOMMAREA                                           23550099
233510            SEQ-RETURN-CODE-DATA                                  23551099
233520            SEQ-DDNAME-TXT(NMCTNINP-SUB)                          23552099
233530                                                                  23553099
233540        IF SEQ-ERROR                                              23554099
233550           MOVE SEQ-RET-CODE TO                                   23555099
233560                SEQ-RET-CODE-DISPLAY                              23556099
233570           STRING                                                 23557099
233580              'SEQUENTIAL I/O CLOSE ERROR, RC: '                  23558099
233590              SEQ-RET-CODE-DISPLAY                                23559099
233600              ' FOR DDNAME: NMCTNINP'                             23560099
233610              DELIMITED BY SIZE                                   23561099
233620              INTO WS-ABEND-TEXT                                  23562099
233630           END-STRING                                             23563099
233640           PERFORM 9000-ABORT THRU                                23564099
233650                   9000-EXIT                                      23565099
233660        ELSE                                                      23566099
233670           MOVE SPACES TO                                         23567099
233680               SEQ-CNTL-DDNAME(NMCTNINP-SUB)                      23568099
233690        END-IF                                                    23569099
233700     ELSE                                                         23570099
233710        STRING                                                    23571099
233720           'SEQUENTIAL I/O CLOSE ERROR FOR '                      23572099
233730            'DDNAME: NMCTNINP'                                    23573099
233740            ' - FILE NOT OPENED'                                  23574099
233750               DELIMITED BY SIZE                                  23575099
233760            INTO WS-ABEND-TEXT                                    23576099
233770        END-STRING                                                23577099
233780        PERFORM 9000-ABORT       THRU                             23578099
233790                9000-EXIT                                         23579099
233800     END-IF                                                       23580099
233810     .                                                            23581099
233820 8920-EXIT.                                                       23582099
233830      EXIT.                                                       23583099
233840                                                                  23584099
233850 8930-CLOSE-RECONOUT-FILE.                                        23585099
233860******************************************************************23586099
233870*   PARAGRAPH NAME:   8930-CLOSE-RECONOUT-FILE                    23587099
233880*                                                                 23588099
233890*   PURPOSE:                                                      23589099
233900*     THIS PARAGRAPH CLOSES THE RECONOUT FILE                     23590099
233910******************************************************************23591099
233920     MOVE '8930-CLOSE-RECONOUT-FILE' TO WS-CURR-PARA              23592099
233930                                                                  23593099
233940     IF SEQ-OPEN-IND(RECONOUT-SUB) = YES-VALUE                    23594099
233950        MOVE SEQCLOSE TO SEQ-FUNCTION                             23595099
233960        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         23596099
233970        CALL SYS-CALL-PGM-ID  USING                               23597099
233980            DFHCOMMAREA                                           23598099
233990            SEQ-RETURN-CODE-DATA                                  23599099
234000            SEQ-DDNAME-TXT(RECONOUT-SUB)                          23600099
234010                                                                  23601099
234020        IF SEQ-ERROR                                              23602099
234030           MOVE SEQ-RET-CODE TO                                   23603099
234040                SEQ-RET-CODE-DISPLAY                              23604099
234050           STRING                                                 23605099
234060              'SEQUENTIAL I/O CLOSE ERROR, RC: '                  23606099
234070              SEQ-RET-CODE-DISPLAY                                23607099
234080              ' FOR DDNAME: RECONOUT'                             23608099
234090              DELIMITED BY SIZE                                   23609099
234100              INTO WS-ABEND-TEXT                                  23610099
234110           END-STRING                                             23611099
234120           PERFORM 9000-ABORT THRU                                23612099
234130                   9000-EXIT                                      23613099
234140        ELSE                                                      23614099
234150           MOVE SPACES TO                                         23615099
234160               SEQ-CNTL-DDNAME(RECONOUT-SUB)                      23616099
234170        END-IF                                                    23617099
234180     ELSE                                                         23618099
234190        STRING                                                    23619099
234200           'SEQUENTIAL I/O CLOSE ERROR FOR '                      23620099
234210            'DDNAME: RECONOUT'                                    23621099
234220            ' - FILE NOT OPENED'                                  23622099
234230               DELIMITED BY SIZE                                  23623099
234240            INTO WS-ABEND-TEXT                                    23624099
234250        END-STRING                                                23625099
234260        PERFORM 9000-ABORT       THRU                             23626099
234270                9000-EXIT                                         23627099
234280     END-IF                                                       23628099
234290     .                                                            23629099
234300                                                                  23630099
234310 8930-EXIT.                                                       23631099
234320      EXIT.                                                       23632099
234330                                                                  23633099
234340 8940-CLOSE-ERROROUT-FILE.                                        23634099
234350******************************************************************23635099
234360*   PARAGRAPH NAME:   8940-CLOSE-ERROROUT-FILE                    23636099
234370*                                                                 23637099
234380*   PURPOSE:                                                      23638099
234390*     THIS PARAGRAPH CLOSES THE ERROROUT FILE                     23639099
234400******************************************************************23640099
234410     MOVE '8940-CLOSE-ERROROUT-FILE' TO WS-CURR-PARA              23641099
234420                                                                  23642099
234430     IF SEQ-OPEN-IND(ERROROUT-SUB) = YES-VALUE                    23643099
234440        MOVE SEQCLOSE TO SEQ-FUNCTION                             23644099
234450        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         23645099
234460        CALL SYS-CALL-PGM-ID  USING                               23646099
234470            DFHCOMMAREA                                           23647099
234480            SEQ-RETURN-CODE-DATA                                  23648099
234490            SEQ-DDNAME-TXT(ERROROUT-SUB)                          23649099
234500                                                                  23650099
234510        IF SEQ-ERROR                                              23651099
234520           MOVE SEQ-RET-CODE TO                                   23652099
234530                SEQ-RET-CODE-DISPLAY                              23653099
234540           STRING                                                 23654099
234550              'SEQUENTIAL I/O CLOSE ERROR, RC: '                  23655099
234560              SEQ-RET-CODE-DISPLAY                                23656099
234570              ' FOR DDNAME: ERROROUT'                             23657099
234580              DELIMITED BY SIZE                                   23658099
234590              INTO WS-ABEND-TEXT                                  23659099
234600           END-STRING                                             23660099
234610           PERFORM 9000-ABORT THRU                                23661099
234620                   9000-EXIT                                      23662099
234630        ELSE                                                      23663099
234640           MOVE SPACES TO                                         23664099
234650               SEQ-CNTL-DDNAME(ERROROUT-SUB)                      23665099
234660        END-IF                                                    23666099
234670     ELSE                                                         23667099
234680        STRING                                                    23668099
234690           'SEQUENTIAL I/O CLOSE ERROR FOR '                      23669099
234700            'DDNAME: ERROROUT'                                    23670099
234710            ' - FILE NOT OPENED'                                  23671099
234720               DELIMITED BY SIZE                                  23672099
234730            INTO WS-ABEND-TEXT                                    23673099
234740        END-STRING                                                23674099
234750        PERFORM 9000-ABORT       THRU                             23675099
234760                9000-EXIT                                         23676099
234770     END-IF                                                       23677099
234780     .                                                            23678099
234790 8940-EXIT.                                                       23679099
234800      EXIT.                                                       23680099
234810                                                                  23681099
234830 8945-CLOSE-ERROROUT2-FILE.                                       23682099
234840      CLOSE ERROROUT2-FILE                                        23683099
234850      IF ERROROUT2-STATUS NOT = ZERO                              23684099
234860         MOVE 'SEQUENTIAL OUTPUT CLOSE ERROR FOR ERROROUT2.'      23685099
234870               TO WS-ABEND-TEXT                                   23686099
234880         PERFORM 9000-ABORT THRU 9000-EXIT                        23687099
234890         END-IF.                                                  23688099
234900 8945-EXIT.                                                       23689099
234910      EXIT.                                                       23690099
234930                                                                  23691099
234940 8947-CLOSE-ERROROUT3-FILE.                                       23692099
234950      CLOSE ERROROUT3-FILE                                        23693099
234960      IF ERROROUT3-STATUS NOT = ZERO                              23694099
234970         MOVE 'SEQUENTIAL OUTPUT CLOSE ERROR FOR ERROROUT3.'      23695099
234980               TO WS-ABEND-TEXT                                   23696099
234990         PERFORM 9000-ABORT THRU 9000-EXIT                        23697099
235000         END-IF.                                                  23698099
235010 8947-EXIT.                                                       23699099
235020      EXIT.                                                       23700099
235030                                                                  23701099
235040 8948-CLOSE-ERROROUT4-FILE.                                       23702099
235050      CLOSE ERROROUT4-FILE                                        23703099
235060      IF ERROROUT4-STATUS NOT = ZERO                              23704099
235070         MOVE 'SEQUENTIAL OUTPUT CLOSE ERROR FOR ERROROUT4.'      23705099
235080               TO WS-ABEND-TEXT                                   23706099
235090         PERFORM 9000-ABORT THRU 9000-EXIT                        23707099
235100         END-IF.                                                  23708099
235110 8948-EXIT.                                                       23709099
235120      EXIT.                                                       23710099
235130                                                                  23711099
235140 8950-CLOSE-CNTRLRPT-FILE.                                        23712099
235150******************************************************************23713099
235160*   PARAGRAPH NAME:   8950-CLOSE-CNTRLRPT-FILE                    23714099
235170*                                                                 23715099
235180*   PURPOSE:                                                      23716099
235190*     THIS PARAGRAPH CLOSES THE CNTRLRPT FILE                     23717099
235200******************************************************************23718099
235210     MOVE '8950-CLOSE-CNTRLRPT-FILE' TO WS-CURR-PARA              23719099
235220                                                                  23720099
235230     IF SEQ-OPEN-IND(CNTRLRPT-SUB) = YES-VALUE                    23721099
235240        MOVE SEQCLOSE TO SEQ-FUNCTION                             23722099
235250        MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                         23723099
235260        CALL SYS-CALL-PGM-ID  USING                               23724099
235270            DFHCOMMAREA                                           23725099
235280            SEQ-RETURN-CODE-DATA                                  23726099
235290            SEQ-DDNAME-TXT(CNTRLRPT-SUB)                          23727099
235300                                                                  23728099
235310        IF SEQ-ERROR                                              23729099
235320           MOVE SEQ-RET-CODE TO                                   23730099
235330                SEQ-RET-CODE-DISPLAY                              23731099
235340           STRING                                                 23732099
235350              'SEQUENTIAL I/O CLOSE ERROR, RC: '                  23733099
235360              SEQ-RET-CODE-DISPLAY                                23734099
235370              ' FOR DDNAME: CNTRLRPT'                             23735099
235380              DELIMITED BY SIZE                                   23736099
235390              INTO WS-ABEND-TEXT                                  23737099
235400           END-STRING                                             23738099
235410           PERFORM 9000-ABORT THRU                                23739099
235420                   9000-EXIT                                      23740099
235430        ELSE                                                      23741099
235440           MOVE SPACES TO                                         23742099
235450               SEQ-CNTL-DDNAME(CNTRLRPT-SUB)                      23743099
235460        END-IF                                                    23744099
235470     ELSE                                                         23745099
235480        STRING                                                    23746099
235490           'SEQUENTIAL I/O CLOSE ERROR FOR '                      23747099
235500            'DDNAME: CNTRLRPT'                                    23748099
235510            ' - FILE NOT OPENED'                                  23749099
235520               DELIMITED BY SIZE                                  23750099
235530            INTO WS-ABEND-TEXT                                    23751099
235540        END-STRING                                                23752099
235550        PERFORM 9000-ABORT       THRU                             23753099
235560                9000-EXIT                                         23754099
235570     END-IF                                                       23755099
235580     .                                                            23756099
235590 8950-EXIT.                                                       23757099
235600      EXIT.                                                       23758099
235610                                                                  23759099
235620 9000-ABORT.                                                      23760099
235630******************************************************************23761099
235640*   PARAGRAPH NAME:   9000-ABORT                                  23762099
235650*                                                                 23763099
235660*   PURPOSE:                                                      23764099
235670*     THIS PARAGRAPH ABORTS THE PROGRAM.                          23765099
235680*                                                                 23766099
235690*   PRIMARY PARAGRAPH FUNCTIONS:                                  23767099
235700*   - DISPLAY MESSAGE TO INFORM USER THAT AN ABNORMAL TERMINATION 23768099
235710*     OF THE PROGRAM IS PERFORMED.                                23769099
235720*   - DISPLAY THE ABEND INFORMATION                               23770099
235730*   - DIVIDE A NUMBER BY ZERO TO FORCE THE PROGRAM TO ABEND.      23771099
235740******************************************************************23772099
235750      DISPLAY '*************************************************' 23773099
235760              '*************************'                         23774099
235770      DISPLAY '         ABNORMAL TERMINATION HAS OCCURRED     '   23775099
235780      DISPLAY ' '                                                 23776099
235790      DISPLAY ' ETNBC16 HAS PURPOSEFULLY PERFORMED A DIVISION '   23777099
235800      DISPLAY ' BY ZERO TO ABEND. A MAJOR PROBLEM WAS FOUND...'   23778099
235810      DISPLAY ' '                                                 23779099
235820      DISPLAY ' LAST PARAGRAPH  : ', WS-CURR-PARA                 23780099
235830      DISPLAY ' ABEND MESSAGE   : ', WS-ABEND-TEXT                23781099
235840      DISPLAY '                   ', WS-ABEND-TEXT-2              23782099
235850      DISPLAY ' WS-ABEND-CODE   : ', WS-ABEND-CODE                23783099
235860      DISPLAY ' WS-SQLCODE      : ', WS-SQLCODE                   23784099
235870      DISPLAY '*************************************************' 23785099
235880              '*************************'                         23786099
235890                                                                  23787099
235900     CALL 'DSNTIAR' USING SQLCA ERROR-MSG ERROR-TEXT-LEN.         23788099
235910                                                                  23789099
235920     IF  ERROR-TEXT(1)  >  SPACES                                 23790099
235930         CONTINUE                                                 23791099
235940        ELSE                                                      23792099
235950         GO  TO  9000-EXIT                                        23793099
235960     END-IF.                                                      23794099
235970                                                                  23795099
235980     MOVE  ERROR-TEXT(1)  TO  WS-ETNI-WK-LOG                      23796099
235990                                                                  23797099
236000     DISPLAY  WS-ETNI-WK-LOG                                      23798099
236010                                                                  23799099
236020     MOVE  ERROR-TEXT(2)  TO  WS-ETNI-WK-LOG                      23800099
236030                                                                  23801099
236040     DISPLAY  WS-ETNI-WK-LOG                                      23802099
236050                                                                  23803099
236060     MOVE  ERROR-TEXT(3)  TO  WS-ETNI-WK-LOG                      23804099
236070                                                                  23805099
236080     DISPLAY  WS-ETNI-WK-LOG                                      23806099
236090                                                                  23807099
236100      PERFORM 3010-DISPLAY-PROGRAM-RUN-INFO                       23808099
236110         THRU 3010-EXIT                                           23809099
236120                                                                  23810099
236130      COMPUTE WS-SUB = 1 / WS-ZERO                                23811099
236140      .                                                           23812099
236150***********                                                       23813099
236160 9000-EXIT.                                                       23814099
236170***********                                                       23815099
236180      EXIT.                                                       23816099
236190                                                                  23817099
236200 9150-CHECK-SQLCODE.                                              23818099
236210******************************************************************23819099
236220*   PARAGRAPH NAME : 9150-CHECK-SQLCODE                           23820099
236230*   DESCRIPTION:                                                  23821099
236240*     PROCESESS THE SQL RETURN CODE FIELD AFTER EACH              23822099
236250*     SQL COMMAND IS EXECUTED.                                    23823099
236260******************************************************************23824099
236280                                                                  23825099
236290     IF SQLCODE = -305                                            23826099
236270        DISPLAY ' From:  '  WS-CURR-PARA                          23827099
236300        DISPLAY                                                   23828099
236310       '9150-CHECK-SQLCODE routine detected a -305. No Null Ind.' 23829099
236320     END-IF                                                       23830099
236330                                                                  23831099
236340     MOVE SQLCODE TO SQL-STATUS-CODE                              23832099
236350                     WS-ABEND-CODE                                23833099
236360*IR071503 -RSS BEG                                                23834099
236370     MOVE SQLCODE    TO WS-SQLCODE                                23835099
236380     MOVE WS-SQLCODE TO WS-SQLCODE-DS                             23836099
236390*TST DISPLAY '9150-CHECK-SQLCODE:' WS-SQLCODE-DS                  23837099
236400     EVALUATE TRUE                                                23838099
236410*IR071503 WHEN SQLCODE >= +0                                      23839099
236420         WHEN SQLCODE  = +0                                       23840099
236430         WHEN SQLCODE  = +100                                     23841099
236440         WHEN SQLCODE  = -305                                     23842099
236450         WHEN SQLCODE  = -803                                     23843099
236460         WHEN SQLCODE  = -811                                     23844099
236470              CONTINUE                                            23845099
236480         WHEN OTHER                                               23846099
236490              PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT         23847099
236500              MOVE    SQLCODE TO WS-ABEND-CODE                    23848099
236510              STRING 'FATAL SQL ERROR!!!  SQLCODE: '              23849099
236520                      WS-ABEND-CODE                               23850099
236530                      DELIMITED BY SIZE                           23851099
236540                      INTO WS-ABEND-TEXT                          23852099
236550              END-STRING                                          23853099
236560               PERFORM 9000-ABORT                                 23854099
236570                  THRU 9000-EXIT                                  23855099
236580     END-EVALUATE                                                 23856099
236590                                                                  23857099
236600     .                                                            23858099
236610***********                                                       23859099
236620 9150-EXIT.                                                       23860099
236630***********                                                       23861099
236640      EXIT.                                                       23862099
236650                                                                  23863099
236660 9160-DISPLAY-SQL-ERR.                                            23864099
236670                                                                  23865099
236680      CALL 'DSNTIAR' USING SQLCA                                  23866099
236690                           WS05-INTF-MESSAGE                      23867099
236700                           CO01-SQL-ERROR-LINE-LENGTH             23868099
236710                                                                  23869099
236720      PERFORM VARYING WS05-ERROR-INDEX                            23870099
236730              FROM 1 BY 1                                         23871099
236740              UNTIL WS05-ERROR-INDEX > 12                         23872099
236750                 OR WS05-INTF-MSG(WS05-ERROR-INDEX) = SPACE       23873099
236760              DISPLAY '*' WS05-INTF-MSG(WS05-ERROR-INDEX)         23874099
236770      END-PERFORM                                                 23875099
236780                                                                  23876099
236790     .                                                            23877099
236800***********                                                       23878099
236810 9160-EXIT.                                                       23879099
236820***********                                                       23880099
236830      EXIT.                                                       23881099
236840                                                                  23882099
236850 9170-READ-PORTIN-MDN-TDS.                                        23883099
236860      INITIALIZE DCLPORTIN-MDN-TDS                                23884099
236870      MOVE WS-CTNIN-CTN-TEXT(1:6) TO WS-ALPHA-NPA-NXX             23885099
236880      MOVE WS-ALPHA-NPA-NXX-NUM TO WS-ALPHA-NPA-NXX-SIGN-COMP3    23886099
236890      MOVE WS-ALPHA-NPA-NXX-SIGN-COMP3 TO                         23887099
236900           NPA-NXX-NUM OF DCLPORTIN-MDN-TDS                       23888099
236910      MOVE WS-CTNIN-CTN-TEXT(7:4) TO WS-ALPHA-LINE                23889099
236920      MOVE WS-TIMESTAMP(1:10) TO WS-TIMESTAMP-JUST-DATE           23890099
236930                                                                  23891099
236940      EXEC SQL SELECT                                             23892099
236950           PDP_START,                                             23893099
236960           PDP_END,                                               23894099
236970           OLD_NEW_NPA                                            23895099
236980        INTO                                                      23896099
236990           :DCLPORTIN-MDN-TDS.PDP-START,                          23897099
237000           :DCLPORTIN-MDN-TDS.PDP-END,                            23898099
237010           :DCLPORTIN-MDN-TDS.OLD-NEW-NPA                         23899099
237020        FROM                                                      23900099
237030           PORTIN_MDN_TDS A                                       23901099
237040        WHERE                                                     23902099
237050           A.NPA_NXX_NUM = :DCLPORTIN-MDN-TDS.NPA-NXX-NUM         23903099
237060        AND                                                       23904099
237070         (:WS-ALPHA-LINE BETWEEN                                  23905099
237080             A.BEGIN_LINE_RANGE AND A.END_LINE_RANGE)             23906099
237090        AND                                                       23907099
237100          A.OLD_NEW_NPA > :WS-THREE-BYTES-OF-SPACE                23908099
237110        AND                                                       23909099
237120         (:WS-TIMESTAMP-JUST-DATE BETWEEN                         23910099
237130              A.PDP_START AND A.PDP_END)                          23911099
237140*----subselect to fetch row with MAX effective date--             23912099
237150        AND A.EFFECTIVE_DATE =                                    23913099
237160            (SELECT MAX (EFFECTIVE_DATE)                          23914099
237170             FROM   PORTIN_MDN_TDS B                              23915099
237180             WHERE                                                23916099
237190                    B.NPA_NXX_NUM = :DCLPORTIN-MDN-TDS.NPA-NXX-NUM23917099
237200             AND                                                  23918099
237210                  (:WS-ALPHA-LINE BETWEEN                         23919099
237220                    B.BEGIN_LINE_RANGE AND B.END_LINE_RANGE)      23920099
237230             AND                                                  23921099
237240                    B.OLD_NEW_NPA > :WS-THREE-BYTES-OF-SPACE      23922099
237250             AND                                                  23923099
237260                  (:WS-TIMESTAMP-JUST-DATE BETWEEN                23924099
237270                    B.PDP_START AND B.PDP_END))                   23925099
237280        END-EXEC                                                  23926099
237290                                                                  23927099
237300*-------if found, cannot issue disconnect-------------------------23928099
237310        IF SQLCODE = 0                                            23929099
237320           MOVE 'N' TO SHOULD-WE-DISCONNECT-FLAG                  23930099
237330           GO TO 9170-EXIT                                        23931099
237340        END-IF                                                    23932099
237350                                                                  23933099
237360*-------if not found, its OK to issue disconnect------------------23934099
237370        IF SQLCODE = 100                                          23935099
237380           MOVE 'Y' TO SHOULD-WE-DISCONNECT-FLAG                  23936099
237390           GO TO 9170-EXIT                                        23937099
237400        END-IF                                                    23938099
237410                                                                  23939099
237420*-------SQL  ERROR                                                23940099
237430        DISPLAY ' '                                               23941099
237440        DISPLAY '     In 9170-READ-PORTIN-MDN-TDS'                23942099
237450        DISPLAY '>>>> CTN at Abend Time: ' WS-CTNIN-CTN-TEXT '<<<'23943099
237460        DISPLAY ' '                                               23944099
237470        PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT               23945099
237480        MOVE    SQLCODE TO WS-ABEND-CODE                          23946099
237490        STRING 'FATAL SQL ERROR!!!  SQLCODE: '                    23947099
237500                WS-ABEND-CODE                                     23948099
237510                DELIMITED BY SIZE                                 23949099
237520                INTO WS-ABEND-TEXT                                23950099
237530                END-STRING                                        23951099
237540        PERFORM 9000-ABORT THRU 9000-EXIT.                        23952099
237550 9170-EXIT.                                                       23953099
237560      EXIT.                                                       23954099
237580                                                                  23955099
237590 9180-SEND-ASGN-RAPI.                                             23956099
237600      MOVE '9180-SEND-ASGN-RAPI' TO WS-CURR-PARA                  23957099
237610*-----fill non-array part of Notif que rec with CTN-INV data------23958099
237620*-----(this sends these values to the NEW Biller derived from-----23959099
237630*-----earlier move of ICC-ID to NL to Biller)---------------------23960099
237640      INITIALIZE CA3-INPUT-AREA OF WS-NOTIFY-RECORD               23961099
237650      INITIALIZE CA3-OUTPUT-AREA OF WS-NOTIFY-RECORD              23962099
237660      MOVE 'ASGN' TO API-ID OF WS-NOTIFY-RECORD                   23963099
237670      MOVE BILLER-ID OF DCLCTN-INV TO                             23964099
237680           BILLER-ID OF WS-NOTIFY-RECORD                          23965099
237690      MOVE WS-CTNIN-PRODUCT-TYPE TO                               23966099
237700           PRODUCT-TYPE OF WS-NOTIFY-RECORD                       23967099
237710      MOVE NL OF DCLCTN-INV TO                                    23968099
237720           NL OF WS-NOTIFY-RECORD                                 23969099
237730      MOVE SPACE TO                                               23970099
237740           OLD-NL OF WS-NOTIFY-RECORD                             23971099
237750      MOVE LIT-OPERATOR-ID TO                                     23972099
237760           OPERATOR-ID OF WS-NOTIFY-RECORD                        23973099
237770      MOVE WS-TIMESTAMP TO                                        23974099
237780           ORIGINATION-DT-TM OF WS-NOTIFY-RECORD                  23975099
237790      MOVE 000 TO                                                 23976099
237800           RETRY-CTR OF WS-NOTIFY-RECORD                          23977099
237810      MOVE ' ' TO                                                 23978099
237820           BACKOUT-IND OF WS-NOTIFY-RECORD                        23979099
237830      MOVE ' ' TO                                                 23980099
237840           INTERNAL-PORT OF WS-NOTIFY-RECORD                      23981099
237850      MOVE ' ' TO                                                 23982099
237860           ACCT-TYP-IND  OF WS-NOTIFY-RECORD                      23983099
237870                                                                  23984099
237880*-----move the one MDN to be sent to Biller to 1st array row------23985099
237890      MOVE 1 TO MDN-CNT OF WS-NOTIFY-RECORD                       23986099
237900      MOVE WS-CTNIN-CTN-TEXT TO                                   23987099
237910           MDN OF MDN-ROW OF WS-NOTIFY-RECORD(1)                  23988099
237920      MOVE WS-CTNIN-NGP TO                                        23989099
237930           NGP OF MDN-ROW OF WS-NOTIFY-RECORD(1)                  23990099
237940      MOVE WS-CTNIN-MIN-NUM-TEXT TO                               23991099
237950           MIN-OR-LRN OF MDN-ROW OF WS-NOTIFY-RECORD(1)           23992099
237960                                                                  23993099
237970*-----now write the NOTIFICATION queue record filled above--------23994099
237980      MOVE WS-NOTI-QUE-LNKG TO LS-Q-LNKG                          23995099
237990      MOVE 2505 TO LS-Q-BUFFER-LENGTH                             23996099
238000      SET Q-PUT TO TRUE                                           23997099
238010      MOVE WS-NOTI-QUE-NAME TO LS-Q-NAME                          23998099
238020      MOVE MQPMO-NONE TO LS-Q-OPTIONS                             23999099
238030      PERFORM 9190-DEFINE-CORRELATION-ID THRU 9190-EXIT           24000099
238040      MOVE WS-CORRELATION-ID TO LS-Q-CORRELID                     24001099
238050      INITIALIZE MQ-NOTIFY-RECORD                                 24002099
238060      MOVE WS-NOTIFY-RECORD TO MQ-NOTIFY-RECORD                   24003099
238070      CALL WS-MQ-SUB USING LS-Q-LNKG,                             24004099
238080                           MQ-NOTIFY-RECORD                       24005099
238090      IF NOT Q-SUCCESS                                            24006099
238100         DISPLAY ' '                                              24007099
238110         DISPLAY '     IN 9180-SEND-ASGN-RAPI'                    24008099
238120         DISPLAY '>>> CTN AT ABEND TIME: ' WS-CTNIN-CTN-TEXT '<<<'24009099
238130         DISPLAY ' '                                              24010099
238140         MOVE '9180'       TO WS-ERR-LOCATION                     24011099
238150         MOVE 'MQ NOTIF QUE PUT FAILURE'                          24012099
238160                            TO WS-ERR-REASON                      24013099
238170                               WS-ABEND-TEXT                      24014099
238180         MOVE 'A'           TO WS-ERR-ACTION                      24015099
238190         DISPLAY 'COMPLETION  CODE = ' LS-Q-COMP-CD               24016099
238200         DISPLAY 'REASON      CODE = ' LS-Q-REAS-CD               24017099
238210         DISPLAY 'FUNCTION    CODE = ' LS-Q-FUNCTION              24018099
238220         DISPLAY 'Q MANAGER ID     = ' LS-Q-MGR-ID                24019099
238230         PERFORM 9000-ABORT THRU 9000-EXIT                        24020099
238240      END-IF                                                      24021099
238250                                                                  24022099
238260*-----and write the TRIGGER queue---------------------------------24023099
238270      MOVE WS-TRIG-QUE-LNKG TO LS-Q-LNKG                          24024099
238280      MOVE 55 TO LS-Q-BUFFER-LENGTH                               24025099
238290      SET Q-PUT TO TRUE                                           24026099
238300      MOVE WS-TRIG-QUE-NAME TO LS-Q-NAME                          24027099
238310      MOVE MQPMO-NONE TO LS-Q-OPTIONS                             24028099
238320      MOVE WS-CORRELATION-ID TO LS-Q-CORRELID                     24029099
238330      CALL WS-MQ-SUB USING LS-Q-LNKG,                             24030099
238340                           MQ-TRIGGER-RECORD                      24031099
238350      IF NOT Q-SUCCESS                                            24032099
238360         DISPLAY ' '                                              24033099
238370         DISPLAY '     IN 9180-SEND-ASGN-RAPI'                    24034099
238380         DISPLAY '>>> CTN AT ABEND TIME: ' WS-CTNIN-CTN-TEXT '<<<'24035099
238390         DISPLAY ' '                                              24036099
238400         MOVE '9180'       TO WS-ERR-LOCATION                     24037099
238410         MOVE 'MQ TRIGGER QUE PUT FAILURE'                        24038099
238420                            TO WS-ERR-REASON                      24039099
238430                               WS-ABEND-TEXT                      24040099
238440         MOVE 'A'           TO WS-ERR-ACTION                      24041099
238450         DISPLAY 'COMPLETION  CODE = ' LS-Q-COMP-CD               24042099
238460         DISPLAY 'REASON      CODE = ' LS-Q-REAS-CD               24043099
238470         DISPLAY 'FUNCTION    CODE = ' LS-Q-FUNCTION              24044099
238480         DISPLAY 'Q MANAGER ID     = ' LS-Q-MGR-ID                24045099
238490         PERFORM 9000-ABORT THRU 9000-EXIT                        24046099
238500      END-IF                                                      24047099
238510      ADD 1 TO NOTIFICATION-MSG-COUNTER.                          24048099
238520*  JA0511  -  Log  MQ  Update                                     24049099
238530          ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                        24050099
238540      .                                                           24051099
238550 9180-EXIT.                                                       24052099
238560      EXIT.                                                       24053099
238570                                                                  24054099
238580 9190-DEFINE-CORRELATION-ID.                                      24055099
238590      EXEC SQL                                                    24056099
238600      SET :WS-CORRELATION-ID = CURRENT TIMESTAMP                  24057099
238610      END-EXEC                                                    24058099
238620      INSPECT WS-CORRELATION-ID REPLACING ALL '/' BY '0'.         24059099
238630 9190-EXIT.                                                       24060099
238640      EXIT.                                                       24061099
238650                                                                  24062099
238660**  JA0602   -  Start                                             24063099
238670 10000-PROCESS-HUB-001.                                           24064099
238680*---------------------------------------------------------------- 24065099
238690*   Process  HUB  001  Routine  Will:                             24066099
238700*    (for  an  ETNI  Trans.  "Not  In  Billing")                  24067099
238710                                                                  24068099
238720*   Update  an  'AR'  Transaction  to  'AA'                       24069099
238730                                                                  24070099
238740*   Update  CTN-INV-HISTORY  FROM  CTN-INV                        24071099
238750*   Update  WS-CTNIN-RECORD  I-O Area                             24072099
238760*   Update  CTN-INV   Biller-Id, CTN-Status, NL - byte  1, MIN    24073099
238770*   Update  MIN-INV   Setting  MIN  Back  to  'AA'                24074099
238780*                                                                 24075099
238790*---------------------------------------------------------------- 24076099
238800                                                                  24077099
238810**  Prior  SQL  Call  was  to  ETNDC38                            24078099
238820                                                                  24079099
238830     IF  RETURN-SQLCODE IN WS-ETNDC38-INTERFACE  =  ZERO          24080099
238840         MOVE  WS-ETNDC38-BILLER   TO  WS-CTNIN-NL(1:1)           24081099
238850                                       WS-CTNIN-BILLER-ID         24082099
238860     END-IF                                                       24083099
238870                                                                  24084099
238880     MOVE  WS-CTNIN-MIN-NUM  TO  MIN-NUM  OF  DCLMIN-INV          24085099
238890     PERFORM  10100-CTN-HISTORY-UPDATE  THRU  10100-EXIT          24086099
238900                                                                  24087099
238910     MOVE  'AA'  TO  WS-CTNIN-CTN-STATUS                          24088099
238920                                                                  24089099
238930     MOVE  'VHUB'               TO  WS-CTNIN-NL(2:4)              24090099
238940                                                                  24091099
238950     MOVE  0       TO  WS-CTNIN-MIN-NUM-LEN                       24092099
238960     MOVE  SPACES  TO  WS-CTNIN-MIN-NUM-TEXT                      24093099
238970     MOVE  -1    TO    MIN-NUM-NI  OF  DCLCTN-INV-NULL-INDS       24094099
238980                                                                  24095099
238990     PERFORM 8000-GET-TIMEZONE THRU 8000-EXIT                     24096099
239000                                                                  24097099
239010     MOVE  WS-TIMESTAMP  TO  WS-CTNIN-SYS-UPDATE-DATE             24098099
239020                             WS-CTNIN-LAST-TRX-DATE               24099099
239030                                                                  24100099
239040     MOVE  LIT-PGM-ID    TO  WS-CTNIN-OPERATOR-ID                 24101099
239050                                                                  24102099
239060     MOVE  0     TO        BILLER-ID-NI  OF  DCLCTN-INV-NULL-INDS 24103099
239070                           NL-NI         OF  DCLCTN-INV-NULL-INDS 24104099
239080                                                                  24105099
239090     EXEC SQL                                                     24106099
239100       UPDATE CTN_INV                                             24107099
239110                                                                  24108099
239120         SET                                                      24109099
239130                                                                  24110099
239140         SYS_UPDATE_DATE  =  :WS-TIMESTAMP,                       24111099
239150         OPERATOR_ID      =  :WS-CTNIN-OPERATOR-ID,               24112099
239160         LAST_TRX_DATE    =  :WS-TIMESTAMP,                       24113099
239170         CTN_STATUS       =  :WS-CTNIN-CTN-STATUS,                24114099
239180         NL               =  :WS-CTNIN-NL                         24115099
239190                             :DCLCTN-INV-NULL-INDS.NL-NI,         24116099
239200         MIN_NUM          =  :WS-CTNIN-MIN-NUM                    24117099
239210                             :DCLCTN-INV-NULL-INDS.MIN-NUM-NI,    24118099
239220         BILLER_ID        =  :WS-CTNIN-BILLER-ID                  24119099
239230                             :DCLCTN-INV-NULL-INDS.BILLER-ID-NI   24120099
239240                                                                  24121099
239250         WHERE   CTN      =  :WS-CTNIN-CTN                        24122099
239260                                                                  24123099
239270     END-EXEC                                                     24124099
239280                                                                  24125099
239290     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    24126099
239300                                                                  24127099
239310     IF SQL-SUCCESS                                               24128099
239320        ADD +1 TO WS-TOTL-ETNI-CTNINV-UPD-ST-CNT                  24129099
239330        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          24130099
239340     ELSE                                                         24131099
239350        DISPLAY ' '                                               24132099
239360        DISPLAY '     In 10000-PROCESS-HUB-001  '                 24133099
239370        DISPLAY '>>>> MDN/CTN at Abend Time: ' WS-CTNIN-CTN-TEXT  24134099
239380        DISPLAY ' '                                               24135099
239390        PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT               24136099
239400        MOVE    SQLCODE TO WS-ABEND-CODE                          24137099
239410        STRING 'FATAL SQL ERROR!!!  SQLCODE: '                    24138099
239420                WS-ABEND-CODE                                     24139099
239430                DELIMITED BY SIZE                                 24140099
239440                INTO WS-ABEND-TEXT                                24141099
239450        END-STRING                                                24142099
239460        PERFORM 9000-ABORT           THRU 9000-EXIT               24143099
239470     END-IF                                                       24144099
239480                                                                  24145099
239490**  UPDATE  MIN-INV                                               24146099
239500                                                                  24147099
239510     MOVE  'AA'  TO  MIN-STATUS  OF  DCLMIN-INV                   24148099
239520                                                                  24149099
239530     MOVE WS-TIMESTAMP       TO  SYS-UPDATE-DATE OF DCLMIN-INV    24150099
239540     MOVE  LIT-PGM-ID        TO  OPERATOR-ID     OF DCLMIN-INV    24151099
239550     MOVE  10                TO  MIN-NUM-LEN     OF DCLMIN-INV    24152099
239560                                                                  24153099
239570     IF SYS-UPDATE-DATE OF DCLMIN-INV = SPACE OR LOW-VALUES       24154099
239580        MOVE -1 TO SYS-UPDATE-DATE-NI OF DCLMIN-INV-NULL-INDS     24155099
239590      ELSE                                                        24156099
239600        MOVE  0 TO SYS-UPDATE-DATE-NI OF DCLMIN-INV-NULL-INDS     24157099
239610     END-IF                                                       24158099
239620                                                                  24159099
239630     IF OPERATOR-ID OF DCLMIN-INV = SPACE OR LOW-VALUES           24160099
239640        MOVE -1 TO OPERATOR-ID-NI OF DCLMIN-INV-NULL-INDS         24161099
239650      ELSE                                                        24162099
239660        MOVE  0 TO OPERATOR-ID-NI OF DCLMIN-INV-NULL-INDS         24163099
239670     END-IF                                                       24164099
239680                                                                  24165099
239690     PERFORM 8000-GET-TIMEZONE THRU 8000-EXIT                     24166099
239700                                                                  24167099
239710      EXEC SQL                                                    24168099
239720           UPDATE MIN_INV                                         24169099
239730           SET MIN_STATUS = :DCLMIN-INV.MIN-STATUS,               24170099
239740               SYS_UPDATE_DATE = :WS-TIMESTAMP                    24171099
239750                        :DCLMIN-INV-NULL-INDS.SYS-UPDATE-DATE-NI, 24172099
239760               OPERATOR_ID     = :DCLMIN-INV.OPERATOR-ID          24173099
239770                        :DCLMIN-INV-NULL-INDS.OPERATOR-ID-NI      24174099
239780           WHERE                                                  24175099
239790               MIN_NUM = :DCLMIN-INV.MIN-NUM                      24176099
239800           END-EXEC                                               24177099
239810                                                                  24178099
239820     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    24179099
239830                                                                  24180099
239840     IF SQL-SUCCESS                                               24181099
239850        ADD +1 TO WS-TOTL-ETNI-MININV-UPD-ST-CNT                  24182099
239860        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          24183099
239870     ELSE                                                         24184099
239880        IF SQL-ROW-NOT-FOUND                                      24185099
239890           CONTINUE                                               24186099
239900        ELSE                                                      24187099
239910           PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT            24188099
239920           MOVE    SQLCODE TO WS-ABEND-CODE                       24189099
239930           STRING 'FATAL SQL ERROR!!!  SQLCODE: '                 24190099
239940                   WS-ABEND-CODE                                  24191099
239950                   DELIMITED BY SIZE                              24192099
239960                   INTO WS-ABEND-TEXT                             24193099
239970           END-STRING                                             24194099
239980           PERFORM 9000-ABORT           THRU 9000-EXIT            24195099
239990        END-IF                                                    24196099
240000     END-IF                                                       24197099
240010     .                                                            24198099
240020 10000-EXIT.                                                      24199099
240030      EXIT.                                                       24200099
240040                                                                  24201099
240050 10100-CTN-HISTORY-UPDATE.                                        24202099
240060*-----------------------------------------------------------------24203099
240070*  Process  History  Updates  for  HUB                            24204099
240080*                                                                 24205099
240090*    If Duplicate encountered, Handle                             24206099
240100*                                                                 24207099
240110*-----------------------------------------------------------------24208099
240120                                                                  24209099
240130     EXEC SQL                                                     24210099
240140     INSERT INTO CTN_INV_HISTORY                                  24211099
240150             ( CTN ,                                              24212099
240160               SYS_CREATION_DATE ,                                24213099
240170               SYS_UPDATE_DATE ,                                  24214099
240180               OPERATOR_ID ,                                      24215099
240190               APPLICATION_ID ,                                   24216099
240200               DL_SERVICE_CODE ,                                  24217099
240210               DL_UPDATE_STAMP,                                   24218099
240220               LAST_TRX_DATE ,                                    24219099
240230               LAST_TRX_CODE ,                                    24220099
240240               CTN_STATUS ,                                       24221099
240250               LAST_TRX_UID ,                                     24222099
240260               NL,                                                24223099
240270               NGP ,                                              24224099
240280               CONV_RUN_NO ,                                      24225099
240290               SPECIAL_TRX_DATE ,                                 24226099
240300               RUN_ID ,                                           24227099
240310               HOLD_REASON ,                                      24228099
240320               PRODUCT_TYPE,                                      24229099
240330               ICC_ID ,                                           24230099
240340               PORT_IND ,                                         24231099
240350               MIN_NUM ,                                          24232099
240360               BILLER_ID ,                                        24233099
240370               STATUS_REASON_CD,                                  24234099
240380               PREPAID_IND,                                       24235099
240390               IMSI,                                              24236099
240400               ICC_ID_4G)                                         24237099
240410       SELECT CTN ,                                               24238099
240420              SYS_CREATION_DATE ,                                 24239099
240430              SYS_UPDATE_DATE ,                                   24240099
240440              OPERATOR_ID ,                                       24241099
240450              APPLICATION_ID ,                                    24242099
240460              DL_SERVICE_CODE ,                                   24243099
240470              DL_UPDATE_STAMP,                                    24244099
240480              LAST_TRX_DATE ,                                     24245099
240490              LAST_TRX_CODE ,                                     24246099
240500              CTN_STATUS ,                                        24247099
240510              LAST_TRX_UID ,                                      24248099
240520              NL,                                                 24249099
240530              NGP ,                                               24250099
240540              CONV_RUN_NO ,                                       24251099
240550              SPECIAL_TRX_DATE ,                                  24252099
240560              RUN_ID ,                                            24253099
240570              HOLD_REASON ,                                       24254099
240580              PRODUCT_TYPE,                                       24255099
240590              ICC_ID ,                                            24256099
240600              PORT_IND ,                                          24257099
240610              MIN_NUM ,                                           24258099
240620              BILLER_ID ,                                         24259099
240630              STATUS_REASON_CD ,                                  24260099
240640              PREPAID_IND,                                        24261099
240650              IMSI,                                               24262099
240660              ICC_ID_4G                                           24263099
240670      FROM CTN_INV                                                24264099
240680     WHERE CTN         = :WS-CTNIN-CTN                            24265099
240690     END-EXEC                                                     24266099
240700                                                                  24267099
240710     MOVE SQLCODE TO WS-SQLCODE                                   24268099
240720                     WS-SQLCODE-DS                                24269099
240730                     SQL-STATUS-CODE                              24270099
240740                                                                  24271099
240750     EVALUATE TRUE                                                24272099
240760       WHEN SQL-SUCCESS                                           24273099
240770          ADD  +1  to  WS-TOTL-ETNI-CTNHIST-INS-CNT               24274099
240780          ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                        24275099
240790          CONTINUE                                                24276099
240800       WHEN SQL-DUP-INSERT                                        24277099
240810          PERFORM 10110-CREATE-HISTORY-DUP                        24278099
240820             THRU 10110-EXIT                                      24279099
240830       WHEN OTHER                                                 24280099
240840         MOVE  SQLCODE  TO  WS-SQLCODE-DS                         24281099
240850         DISPLAY '*********************************************'  24282099
240860         DISPLAY '**                  ERROR                  **'  24283099
240870         DISPLAY '**                                         **'  24284099
240880         DISPLAY '** 10100-CTN-HISTORY-UPDATE     '               24285099
240890         DISPLAY '**                                         **'  24286099
240900         DISPLAY 'INSERT CTN-INV-HISTORY FAILED'                  24287099
240910         DISPLAY 'SQLCODE CODE = ' WS-SQLCODE-DS                  24288099
240920         DISPLAY '**                                         **'  24289099
240930         DISPLAY '**                                         **'  24290099
240940         DISPLAY 'CURRENT MDN RECORD = ' SEARCH-MDN               24291099
240950         DISPLAY '**                                         **'  24292099
240960         DISPLAY  ALL '-'                                         24293099
240970         DISPLAY '*********************************************'  24294099
240980         DISPLAY  ALL '-'                                         24295099
240990         DIVIDE  ZERO1  BY  ZERO2  GIVING  CORE-DUMP              24296099
241000     END-EVALUATE                                                 24297099
241010     .                                                            24298099
241020                                                                  24299099
241030 10100-EXIT.  EXIT.                                               24300099
241040                                                                  24301099
241050 10110-CREATE-HISTORY-DUP.                                        24302099
241060*-----------------------------------------------------------------24303099
241070*  Process  History  Updates  for  HUB                            24304099
241080*                                                                 24305099
241090*    Duplicate encountered, Handle                                24306099
241100*                                                                 24307099
241110*-----------------------------------------------------------------24308099
241120                                                                  24309099
241130*  JA0110  -  modified  where  clause,  which was in error below  24310099
241140*                                                                 24311099
241150                                                                  24312099
241160     MOVE '10110-CREATE-HISTORY-DUP'  TO  WS-CURR-PARA            24313099
241170                                                                  24314099
241180     INITIALIZE WS-ADD-TEN.                                       24315099
241190     MOVE  +999  TO  SQL-STATUS-CODE                              24316099
241200                                                                  24317099
241210     PERFORM VARYING IX01-IDX FROM 1 BY 1                         24318099
241220     UNTIL SQL-SUCCESS                                            24319099
241230        OR IX01-IDX > 10                                          24320099
241240                                                                  24321099
241250     ADD 10 TO WS-ADD-TEN                                         24322099
241260                                                                  24323099
241270     EXEC SQL                                                     24324099
241280     INSERT INTO CTN_INV_HISTORY                                  24325099
241290             ( CTN ,                                              24326099
241300               SYS_CREATION_DATE ,                                24327099
241310               SYS_UPDATE_DATE ,                                  24328099
241320               OPERATOR_ID ,                                      24329099
241330               APPLICATION_ID ,                                   24330099
241340               DL_SERVICE_CODE ,                                  24331099
241350               DL_UPDATE_STAMP,                                   24332099
241360               LAST_TRX_DATE ,                                    24333099
241370               LAST_TRX_CODE ,                                    24334099
241380               CTN_STATUS ,                                       24335099
241390               LAST_TRX_UID ,                                     24336099
241400               NL,                                                24337099
241410               NGP ,                                              24338099
241420               CONV_RUN_NO ,                                      24339099
241430               SPECIAL_TRX_DATE ,                                 24340099
241440               RUN_ID ,                                           24341099
241450               HOLD_REASON ,                                      24342099
241460               PRODUCT_TYPE,                                      24343099
241470               ICC_ID ,                                           24344099
241480               PORT_IND ,                                         24345099
241490               MIN_NUM ,                                          24346099
241500               BILLER_ID ,                                        24347099
241510               STATUS_REASON_CD,                                  24348099
241520               PREPAID_IND,                                       24349099
241530               IMSI,                                              24350099
241540               ICC_ID_4G)                                         24351099
241550       SELECT CTN ,                                               24352099
241560              SYS_CREATION_DATE ,                                 24353099
241570              SYS_UPDATE_DATE ,                                   24354099
241580              OPERATOR_ID ,                                       24355099
241590              APPLICATION_ID ,                                    24356099
241600              DL_SERVICE_CODE ,                                   24357099
241610              DL_UPDATE_STAMP,                                    24358099
241620            (TIMESTAMP(LAST_TRX_DATE) + :WS-ADD-TEN MICROSECONDS),24359099
241630              LAST_TRX_CODE ,                                     24360099
241640              CTN_STATUS ,                                        24361099
241650              LAST_TRX_UID ,                                      24362099
241660              NL,                                                 24363099
241670              NGP ,                                               24364099
241680              CONV_RUN_NO ,                                       24365099
241690              SPECIAL_TRX_DATE ,                                  24366099
241700              RUN_ID ,                                            24367099
241710              HOLD_REASON ,                                       24368099
241720              PRODUCT_TYPE,                                       24369099
241730              ICC_ID ,                                            24370099
241740              PORT_IND ,                                          24371099
241750              MIN_NUM ,                                           24372099
241760              BILLER_ID ,                                         24373099
241770              STATUS_REASON_CD ,                                  24374099
241780              PREPAID_IND,                                        24375099
241790              IMSI,                                               24376099
241800              ICC_ID_4G                                           24377099
241810      FROM CTN_INV                                                24378099
241820     WHERE CTN         = :WS-CTNIN-CTN                            24379099
241830     END-EXEC                                                     24380099
241840                                                                  24381099
241850     MOVE SQLCODE TO WS-SQLCODE                                   24382099
241860                     WS-SQLCODE-DS                                24383099
241870                     SQL-STATUS-CODE                              24384099
241880                                                                  24385099
241890     EVALUATE TRUE                                                24386099
241900       WHEN SQL-SUCCESS                                           24387099
241910          ADD  +1  to  WS-TOTL-ETNI-CTNHIST-DUPINS                24388099
241920          ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                        24389099
241930          CONTINUE                                                24390099
241940       WHEN SQL-DUP-INSERT                                        24391099
241950        IF IX01-IDX < 10 THEN                                     24392099
241960           CONTINUE                                               24393099
241970        END-IF                                                    24394099
241980       WHEN OTHER                                                 24395099
241990         MOVE  SQLCODE  TO  WS-SQLCODE-DS                         24396099
242000         DISPLAY '*********************************************'  24397099
242010         DISPLAY '**                  ERROR                  **'  24398099
242020         DISPLAY '**                                         **'  24399099
242030         DISPLAY '** 10110-CREATE-HISTORY-DUP '                   24400099
242040         DISPLAY '**                                         **'  24401099
242050         DISPLAY 'INSERT CTN-INV-HISTORY FAILED'                  24402099
242060         DISPLAY 'SQLCODE CODE = ' WS-SQLCODE-DS                  24403099
242070         DISPLAY '**                                         **'  24404099
242080         DISPLAY '**                                         **'  24405099
242090         DISPLAY 'CURRENT MDN RECORD = ' SEARCH-MDN               24406099
242100         DISPLAY '**                                         **'  24407099
242110         DISPLAY '*********************************************'  24408099
242120         DISPLAY  ALL '-'                                         24409099
242130         DIVIDE  ZERO1  BY  ZERO2  GIVING  CORE-DUMP              24410099
242140                                                                  24411099
242150       END-EVALUATE                                               24412099
242160     END-PERFORM                                                  24413099
242170     .                                                            24414099
242180 10110-EXIT.                                                      24415099
242190     EXIT.                                                        24416099
242200                                                                  24417099
242210 11000-ATTEMPT-ADD-TO-ETNI.                                       24418099
242220******************************************************************24419099
242230**                                                                24420099
242240**   Confirm  MIN  From  BILLING  is  Not  in  CTN-INV  Already   24421099
242250**                                                                24422099
242260**   Add  MIN  From  BILLING                                      24423099
242270**   Add  CTN-INV  From  BILLING                                  24424099
242280**                                                                24425099
242290******************************************************************24426099
242300                                                                  24427099
242310     MOVE  '11000-ATTEMPT-ADD-TO-ETNI'  TO  WS-CURR-PARA          24428099
242320                                                                  24429099
242330     MOVE  'N'  TO  CTN-HAS-VZW-SPID                              24430099
242340     MOVE  'N'  TO  ALLOW-PORT-IND-CHG                            24431099
242350                                                                  24432099
242360     MOVE 10 TO MIN-NUM-LEN OF DCLMIN-INV                         24433099
242370     MOVE MDNIN-MIN-NUM TO MIN-NUM-TEXT OF DCLMIN-INV             24434099
242380     MOVE 10 TO CTN-LEN OF DCLCTN-INV                             24435099
242390     MOVE MDNIN-MDN TO CTN-TEXT OF DCLCTN-INV                     24436099
242400                                                                  24437099
242410     INITIALIZE  WS-CTN-INV-MIN-COUNT                             24438099
242420**                                                                24439099
242430     PERFORM  7806-SELECT-MIN-IN-CTN  THRU  7806-EXIT             24440099
242440                                                                  24441099
242450*----if no other CTNs found with same MIN, that's a good thing!---24442099
242460     IF WS-CTN-INV-MIN-COUNT  =  +0                               24443099
242470         MOVE 'Y' TO SHOULD-MIN-STATUS-BE-UPDATED                 24444099
242480     END-IF                                                       24445099
242490                                                                  24446099
242500*----if just 1 CTN found with same MIN, display it in message-----24447099
242510     IF WS-CTN-INV-MIN-COUNT  >  +0                               24448099
242520         ADD   +1 TO WS-TOTL-ERROR-MIN-NUM-IN-CTN                 24449099
242530         SET WS-ERROR-FIELDS-FOUND TO TRUE                        24450099
242540         MOVE 'THIS CTN HAS SAME MIN:' TO WS-COMMENT              24451099
242550         MOVE  MDNIN-MIN-NUM  TO WS-ADDTL-INFO(1:10)              24452099
242560         PERFORM 6000-MOVE-BILL-TO-RPT-HUB THRU 6000-EXIT-HUB     24453099
242570         PERFORM 6510-WRITE-ERROR-RPT-HUB  THRU 6510-EXIT         24454099
242580         GO  TO  11000-EXIT                                       24455099
242590      END-IF                                                      24456099
242600                                                                  24457099
242610*----if many CTNs found with same MIN, display generic message----24458099
242620     IF  SQLCODE = -811                                           24459099
242630         ADD   +1 TO WS-TOTL-ERROR-MIN-NUM-IN-CTN                 24460099
242640         SET WS-ERROR-FIELDS-FOUND TO TRUE                        24461099
242650         MOVE 'MULTIPLE CTNS HAVE THIS MIN:' TO WS-COMMENT        24462099
242660         MOVE  MDNIN-MIN-NUM  TO WS-ADDTL-INFO(1:10)              24463099
242670         PERFORM 6000-MOVE-BILL-TO-RPT-HUB THRU 6000-EXIT-HUB     24464099
242680         PERFORM 6510-WRITE-ERROR-RPT-HUB  THRU 6510-EXIT         24465099
242690         GO  TO  11000-EXIT                                       24466099
242700     END-IF                                                       24467099
242710                                                                  24468099
242720     IF  SHOULD-MIN-STATUS-BE-UPDATED   =  'Y'                    24469099
242730         CONTINUE                                                 24470099
242740        ELSE                                                      24471099
242750         ADD   +1 TO WS-TOTL-ERROR-MIN-NUM-IN-CTN                 24472099
242760         SET WS-ERROR-FIELDS-FOUND TO TRUE                        24473099
242770         MOVE 'SQLCODE ERROR:' TO WS-COMMENT                      24474099
242780         MOVE  SQLCODE     TO  WS-SQLCODE-DS                      24475099
242790         MOVE  WS-SQLCODE-DS  TO  WS-COMMENT(15:6)                24476099
242800         MOVE  MDNIN-MIN-NUM  TO WS-ADDTL-INFO(1:10)              24477099
242810         PERFORM  6000-MOVE-BILL-TO-RPT-HUB  THRU  6000-EXIT-HUB  24478099
242820         PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU  6510-EXIT      24479099
242830         GO  TO  11000-EXIT                                       24480099
242840     END-IF                                                       24481099
242850                                                                  24482099
242860**  UPDATE  MIN-INV                                               24483099
242870                                                                  24484099
242880     MOVE  'AI'  TO  MIN-STATUS  OF  DCLMIN-INV                   24485099
242890                                                                  24486099
242900     MOVE  LIT-PGM-ID        TO  OPERATOR-ID     OF DCLMIN-INV    24487099
242910                                                                  24488099
242920     MOVE  0  TO SYS-UPDATE-DATE-NI OF DCLMIN-INV-NULL-INDS       24489099
242930     MOVE 10 TO MIN-NUM-LEN OF DCLMIN-INV                         24490099
242940     MOVE  MDNIN-MIN-NUM   TO  MIN-NUM-TEXT  OF DCLMIN-INV        24491099
242950                                                                  24492099
242960     IF OPERATOR-ID OF DCLMIN-INV = SPACE OR LOW-VALUES           24493099
242970        MOVE -1 TO OPERATOR-ID-NI OF DCLMIN-INV-NULL-INDS         24494099
242980      ELSE                                                        24495099
242990        MOVE  0 TO OPERATOR-ID-NI OF DCLMIN-INV-NULL-INDS         24496099
243000     END-IF                                                       24497099
243010                                                                  24498099
243020     PERFORM 8000-GET-TIMEZONE THRU 8000-EXIT                     24499099
243030                                                                  24500099
243040      EXEC SQL                                                    24501099
243050           UPDATE MIN_INV                                         24502099
243060           SET MIN_STATUS = :DCLMIN-INV.MIN-STATUS,               24503099
243070               SYS_UPDATE_DATE = :WS-TIMESTAMP                    24504099
243080                        :DCLMIN-INV-NULL-INDS.SYS-UPDATE-DATE-NI, 24505099
243090               OPERATOR_ID     = :DCLMIN-INV.OPERATOR-ID          24506099
243100                        :DCLMIN-INV-NULL-INDS.OPERATOR-ID-NI      24507099
243110           WHERE                                                  24508099
243120               MIN_NUM = :DCLMIN-INV.MIN-NUM                      24509099
243130           END-EXEC                                               24510099
243140                                                                  24511099
243150     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    24512099
243160**                                                                24513099
243170     IF SQL-SUCCESS                                               24514099
243180        ADD +1 TO WS-TOTL-HUB-ADD-ETNI-PER-BILL                   24515099
243190        ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                          24516099
243200        ELSE                                                      24517099
243210        ADD +1 TO WS-TOTL-ETNI-MININV-ERRS                        24518099
243220        SET WS-ERROR-FIELDS-FOUND TO TRUE                         24519099
243230        MOVE  LIT-MIN-UPDATE-ERROR  TO  WS-COMMENT                24520099
243240        MOVE  SQLCODE  TO  WS-SQLCODE-DS                          24521099
243250        MOVE  SPACES              TO  WS-ADDTL-INFO               24522099
243260        MOVE  WS-SQLCODE-DS(3:4)  TO  WS-ADDTL-INFO(1:04)         24523099
243270        MOVE  'SQLERR '           TO  WS-ADDTL-INFO(6:07)         24524099
243280                                                                  24525099
243290        PERFORM 6000-MOVE-BILL-TO-RPT-HUB THRU 6000-EXIT-HUB      24526099
243300        PERFORM 6510-WRITE-ERROR-RPT-HUB  THRU 6510-EXIT          24527099
243310        GO  TO  11000-EXIT                                        24528099
243320     END-IF                                                       24529099
243330                                                                  24530099
243340     MOVE  MDNIN-BILLER-ID  OF  MDNIN-DETAIL-FIELDS               24531099
243350                            TO  MDNIN-NL(1:1)                     24532099
243360     IF  WS-HUB-BILL                                              24533099
243370         MOVE  'VHUB'           TO  MDNIN-NL(2:4)                 24534099
243380        ELSE                                                      24535099
243390         MOVE  'RET '           TO  MDNIN-NL(2:4)                 24536099
243400     END-IF                                                       24537099
243410                                                                  24538099
243420     PERFORM  2220-POPULATE-CTN             THRU 2220-EXIT        24539099
243430     PERFORM  7020-INSERT-CTN-INV           THRU 7020-EXIT        24540099
243440                                                                  24541099
243450     IF  SQL-DUP-INSERT                                           24542099
243460         SET WS-ERROR-FIELDS-FOUND TO TRUE                        24543099
243470         MOVE    LIT-CTN-INV-INSERT-ERROR   TO   WS-COMMENT       24544099
243480         MOVE    CTN-TEXT     OF DCLCTN-INV                       24545099
243490                                        TO WS-ADDTL-INFO (1:10)   24546099
243500         MOVE    PRODUCT-TYPE OF DCLCTN-INV                       24547099
243510                                        TO WS-ADDTL-INFO (12:1)   24548099
243520         PERFORM  6000-MOVE-BILL-TO-RPT-HUB  THRU  6000-EXIT-HUB  24549099
243530         PERFORM  6510-WRITE-ERROR-RPT-HUB   THRU  6510-EXIT      24550099
243540         GO  TO  11000-EXIT                                       24551099
243550     END-IF                                                       24552099
243560                                                                  24553099
243570     .                                                            24554099
243580 11000-EXIT.                                                      24555099
243590     EXIT.                                                        24556099
243600                                                                  24557099
243610**  JA0602   -  End                                               24558099
243620                                                                  24559099
243630 C100-INIT-CHKPT-RSTRT.                                           24560099
243640******************************************************************24561099
243650*   THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS :             24562099
243660*           - RETRIEVE JOB NAME, JOB STEP, AND PROC               24563099
243670*             STEP                                                24564099
243680*           - ATTEMPT TO RETRIEVE THE CHECKPOINT                  24565099
243690*             CONTROL RECORD                                      24566099
243700*           - IF NOT FOUND, INITIALIZE CHECKPOINT REC             24567099
243710*             AND RETRIEVE COMMIT FREQUENCY PARAMETER.            24568099
243720*           - IF FOUND THE PROGRAM IS TO BE RESTARTED SO          24569099
243730*             RESTORE WORKING STORAGE FROM THE CHECKPOINT         24570099
243740*             CONTROL RECORD.                                     24571099
243750*   6/9/94  - MOVE COMMIT FREQ TO WS-COMMIT-INIT ON A             24572099
243760*             RESTART (S.BONENFANT)                               24573099
243770******************************************************************24574099
243780     MOVE 'C100-INIT-CHKPT-RSTRT' TO WS-CURR-PARA                 24575099
243790                                                                  24576099
243800     INITIALIZE DCLTCHKPT-CNTRL                                   24577099
243810                WS-CHKPT-INFO-AREA                                24578099
243820                                                                  24579099
243830     MOVE 'ICOSA17' TO SYS-CALL-PGM-ID                            24580099
243840     CALL SYS-CALL-PGM-ID  USING                                  24581099
243850          DFHCOMMAREA                                             24582099
243860          WS-JOB-INFO                                             24583099
243870                                                                  24584099
243880     MOVE WS-JOB-ID      TO CHK-JOB-ID    OF DCLTCHKPT-CNTRL      24585099
243890     MOVE WS-JOB-STEP    TO CHK-JOB-STEP  OF DCLTCHKPT-CNTRL      24586099
243900     MOVE WS-PROC-STEP   TO CHK-PROC-STEP OF DCLTCHKPT-CNTRL      24587099
243910     MOVE LIT-PGM-ID     TO CHK-PGM-ID    OF DCLTCHKPT-CNTRL      24588099
243920     MOVE '1'            TO SEQ-NUM       OF DCLTCHKPT-CNTRL      24589099
243930*                                                                 24590099
243940     EXEC SQL                                                     24591099
243950       SELECT                                                     24592099
243960          CHK_JOB_ID,                                             24593099
243970          CHK_JOB_STEP,                                           24594099
243980          CHK_PROC_STEP,                                          24595099
243990          CHK_PGM_ID,                                             24596099
244000          SEQ_NUM,                                                24597099
244010          CHK_DATE,                                               24598099
244020          CHK_TIME,                                               24599099
244030          CHK_FREQ,                                               24600099
244040          CHK_CNT,                                                24601099
244050          CHK_SAVE_01,                                            24602099
244060          CHK_SAVE_02,                                            24603099
244070          CHK_SAVE_03,                                            24604099
244080          CHK_SAVE_04,                                            24605099
244090          CHK_SAVE_05,                                            24606099
244100          CHK_SAVE_06,                                            24607099
244110          CHK_SAVE_07,                                            24608099
244120          CHK_SAVE_08,                                            24609099
244130          CHK_SAVE_09,                                            24610099
244140          CHK_SAVE_10,                                            24611099
244150          CHK_SAVE_11,                                            24612099
244160          CHK_SAVE_12,                                            24613099
244170          CHK_SAVE_13,                                            24614099
244180          CHK_SAVE_14,                                            24615099
244190          CHK_SAVE_15,                                            24616099
244200          CHK_SAVE_16                                             24617099
244210       INTO                                                       24618099
244220          :DCLTCHKPT-CNTRL.CHK-JOB-ID,                            24619099
244230          :DCLTCHKPT-CNTRL.CHK-JOB-STEP,                          24620099
244240          :DCLTCHKPT-CNTRL.CHK-PROC-STEP,                         24621099
244250          :DCLTCHKPT-CNTRL.CHK-PGM-ID,                            24622099
244260          :DCLTCHKPT-CNTRL.SEQ-NUM,                               24623099
244270          :DCLTCHKPT-CNTRL.CHK-DATE,                              24624099
244280          :DCLTCHKPT-CNTRL.CHK-TIME,                              24625099
244290          :DCLTCHKPT-CNTRL.CHK-FREQ,                              24626099
244300          :DCLTCHKPT-CNTRL.CHK-CNT,                               24627099
244310          :DCLTCHKPT-CNTRL.CHK-SAVE-01,                           24628099
244320          :DCLTCHKPT-CNTRL.CHK-SAVE-02,                           24629099
244330          :DCLTCHKPT-CNTRL.CHK-SAVE-03,                           24630099
244340          :DCLTCHKPT-CNTRL.CHK-SAVE-04,                           24631099
244350          :DCLTCHKPT-CNTRL.CHK-SAVE-05,                           24632099
244360          :DCLTCHKPT-CNTRL.CHK-SAVE-06,                           24633099
244370          :DCLTCHKPT-CNTRL.CHK-SAVE-07,                           24634099
244380          :DCLTCHKPT-CNTRL.CHK-SAVE-08,                           24635099
244390          :DCLTCHKPT-CNTRL.CHK-SAVE-09,                           24636099
244400          :DCLTCHKPT-CNTRL.CHK-SAVE-10,                           24637099
244410          :DCLTCHKPT-CNTRL.CHK-SAVE-11,                           24638099
244420          :DCLTCHKPT-CNTRL.CHK-SAVE-12,                           24639099
244430          :DCLTCHKPT-CNTRL.CHK-SAVE-13,                           24640099
244440          :DCLTCHKPT-CNTRL.CHK-SAVE-14,                           24641099
244450          :DCLTCHKPT-CNTRL.CHK-SAVE-15,                           24642099
244460          :DCLTCHKPT-CNTRL.CHK-SAVE-16                            24643099
244470       FROM TCHKPT_CNTRL                                          24644099
244480       WHERE                                                      24645099
244490         CHK_JOB_ID    = :DCLTCHKPT-CNTRL.CHK-JOB-ID AND          24646099
244500         CHK_JOB_STEP  = :DCLTCHKPT-CNTRL.CHK-JOB-STEP AND        24647099
244510         CHK_PROC_STEP = :DCLTCHKPT-CNTRL.CHK-PROC-STEP AND       24648099
244520         CHK_PGM_ID    = :DCLTCHKPT-CNTRL.CHK-PGM-ID AND          24649099
244530         SEQ_NUM       = :DCLTCHKPT-CNTRL.SEQ-NUM                 24650099
244540     END-EXEC                                                     24651099
244550                                                                  24652099
244560     PERFORM 9150-CHECK-SQLCODE THRU                              24653099
244570             9150-EXIT                                            24654099
244580*                                                                 24655099
244590     IF SQL-ROW-NOT-FOUND OR NOT SQL-SUCCESS                      24656099
244600        MOVE NO-VALUE  TO SYS-RESTART-IND                         24657099
244610                          WS-COMMIT-ON-IND                        24658099
244620        MOVE YES-VALUE TO WS-CHKPT-INSERT-IND                     24659099
244630                                                                  24660099
244640        IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR                    24661099
244650           WS-PARM-UPDDNA OR WS-PARM-UPDDNX OR                    24662099
244660           WS-PARM-UPDATX OR WS-PARM-UPDDEX                       24663099
244670           EXEC SQL                                               24664099
244680                SELECT CHK_FREQ                                   24665099
244690                INTO :DCLCHKPT-FREQ.CHK-FREQ                      24666099
244700                FROM CHKPT_FREQ                                   24667099
244710                WHERE PGM_ID = 'ETNBC16'                          24668099
244720           END-EXEC                                               24669099
244730        ELSE                                                      24670099
244740           IF WS-PARM-REPORT OR WS-PARM-REPORX                    24671099
244750              EXEC SQL                                            24672099
244760                   SELECT CHK_FREQ                                24673099
244770                   INTO :DCLCHKPT-FREQ.CHK-FREQ                   24674099
244780                   FROM CHKPT_FREQ                                24675099
244790                   WHERE PGM_ID = 'ETNBC16R'                      24676099
244800              END-EXEC                                            24677099
244810           END-IF                                                 24678099
244820        END-IF                                                    24679099
244830                                                                  24680099
244840        IF SQLCODE = ZERO                                         24681099
244850           MOVE CHK-FREQ OF DCLCHKPT-FREQ TO WS-COMMIT-FREQ       24682099
244860        ELSE                                                      24683099
244870           MOVE 1                         TO WS-COMMIT-FREQ       24684099
244880        END-IF                                                    24685099
244890        DISPLAY 'Check for COMMIT-FREQ IS: ' WS-COMMIT-FREQ       24686099
244900        DISPLAY ' '                                               24687099
244910        MOVE WS-COMMIT-FREQ TO  CHK-FREQ OF DCLTCHKPT-CNTRL       24688099
244920     ELSE                                                         24689099
244930        MOVE YES-VALUE TO SYS-RESTART-IND                         24690099
244940                          WS-COMMIT-ON-IND                        24691099
244950        MOVE CHK-SAVE-01 OF DCLTCHKPT-CNTRL                       24692099
244960          TO WS-CHKPT-SAVE-1                                      24693099
244970        MOVE CHK-SAVE-02 OF DCLTCHKPT-CNTRL                       24694099
244980          TO WS-CHKPT-SAVE-2                                      24695099
244990        MOVE CHK-SAVE-03 OF DCLTCHKPT-CNTRL                       24696099
245000          TO WS-CHKPT-SAVE-3                                      24697099
245010        MOVE CHK-SAVE-04 OF DCLTCHKPT-CNTRL                       24698099
245020          TO WS-CHKPT-SAVE-4                                      24699099
245030        MOVE CHK-SAVE-05 OF DCLTCHKPT-CNTRL                       24700099
245040          TO WS-CHKPT-SAVE-5                                      24701099
245050        MOVE CHK-SAVE-06 OF DCLTCHKPT-CNTRL                       24702099
245060          TO WS-CHKPT-SAVE-6                                      24703099
245070        MOVE CHK-SAVE-07 OF DCLTCHKPT-CNTRL                       24704099
245080          TO WS-CHKPT-SAVE-7                                      24705099
245090        MOVE CHK-SAVE-08 OF DCLTCHKPT-CNTRL                       24706099
245100          TO WS-CHKPT-SAVE-8                                      24707099
245110        MOVE CHK-SAVE-09 OF DCLTCHKPT-CNTRL                       24708099
245120          TO WS-CHKPT-SAVE-9                                      24709099
245130        MOVE CHK-SAVE-10 OF DCLTCHKPT-CNTRL                       24710099
245140          TO WS-CHKPT-SAVE-10                                     24711099
245150        MOVE CHK-SAVE-11 OF DCLTCHKPT-CNTRL                       24712099
245160          TO WS-CHKPT-SAVE-11                                     24713099
245170        MOVE CHK-SAVE-12 OF DCLTCHKPT-CNTRL                       24714099
245180          TO WS-CHKPT-SAVE-12                                     24715099
245190        MOVE CHK-SAVE-13 OF DCLTCHKPT-CNTRL                       24716099
245200          TO WS-CHKPT-SAVE-13                                     24717099
245210        MOVE CHK-SAVE-14 OF DCLTCHKPT-CNTRL                       24718099
245220          TO WS-CHKPT-SAVE-14                                     24719099
245230        MOVE CHK-SAVE-15 OF DCLTCHKPT-CNTRL                       24720099
245240          TO WS-CHKPT-SAVE-15                                     24721099
245250        MOVE CHK-SAVE-16 OF DCLTCHKPT-CNTRL                       24722099
245260          TO WS-CHKPT-SAVE-16                                     24723099
245270        MOVE WS-CHKPT-SAVE-DATA                                   24724099
245280          TO WS-CHKPT-SAVE-APPL-DATA                              24725099
245290        MOVE SAVE-APPL-DATA-1                                     24726099
245300          TO WS-RESTART-VARIABLES                                 24727099
245310                                                                  24728099
245320        MOVE CHK-CNT   OF DCLTCHKPT-CNTRL TO WS-COMMIT-CNT        24729099
245330        MOVE CHK-TIME  OF DCLTCHKPT-CNTRL TO WS-COMMIT-TIME       24730099
245340        MOVE CHK-FREQ  OF DCLTCHKPT-CNTRL TO WS-COMMIT-FREQ       24731099
245350                                             WS-COMMIT-INIT       24732099
245360        MOVE '2'       TO SEQ-NUM OF DCLTCHKPT-CNTRL              24733099
245370                                                                  24734099
245380          EXEC SQL                                                24735099
245390          SELECT                                                  24736099
245400             CHK_JOB_ID,                                          24737099
245410             CHK_JOB_STEP,                                        24738099
245420             CHK_PROC_STEP,                                       24739099
245430             CHK_PGM_ID,                                          24740099
245440             SEQ_NUM,                                             24741099
245450             CHK_DATE,                                            24742099
245460             CHK_TIME,                                            24743099
245470             CHK_FREQ,                                            24744099
245480             CHK_CNT,                                             24745099
245490             CHK_SAVE_01,                                         24746099
245500             CHK_SAVE_02,                                         24747099
245510             CHK_SAVE_03,                                         24748099
245520             CHK_SAVE_04,                                         24749099
245530             CHK_SAVE_05,                                         24750099
245540             CHK_SAVE_06,                                         24751099
245550             CHK_SAVE_07,                                         24752099
245560             CHK_SAVE_08,                                         24753099
245570             CHK_SAVE_09,                                         24754099
245580             CHK_SAVE_10,                                         24755099
245590             CHK_SAVE_11,                                         24756099
245600             CHK_SAVE_12,                                         24757099
245610             CHK_SAVE_13,                                         24758099
245620             CHK_SAVE_14,                                         24759099
245630             CHK_SAVE_15,                                         24760099
245640             CHK_SAVE_16                                          24761099
245650          INTO                                                    24762099
245660             :DCLTCHKPT-CNTRL.CHK-JOB-ID,                         24763099
245670             :DCLTCHKPT-CNTRL.CHK-JOB-STEP,                       24764099
245680             :DCLTCHKPT-CNTRL.CHK-PROC-STEP,                      24765099
245690             :DCLTCHKPT-CNTRL.CHK-PGM-ID,                         24766099
245700             :DCLTCHKPT-CNTRL.SEQ-NUM,                            24767099
245710             :DCLTCHKPT-CNTRL.CHK-DATE,                           24768099
245720             :DCLTCHKPT-CNTRL.CHK-TIME,                           24769099
245730             :DCLTCHKPT-CNTRL.CHK-FREQ,                           24770099
245740             :DCLTCHKPT-CNTRL.CHK-CNT,                            24771099
245750             :DCLTCHKPT-CNTRL.CHK-SAVE-01,                        24772099
245760             :DCLTCHKPT-CNTRL.CHK-SAVE-02,                        24773099
245770             :DCLTCHKPT-CNTRL.CHK-SAVE-03,                        24774099
245780             :DCLTCHKPT-CNTRL.CHK-SAVE-04,                        24775099
245790             :DCLTCHKPT-CNTRL.CHK-SAVE-05,                        24776099
245800             :DCLTCHKPT-CNTRL.CHK-SAVE-06,                        24777099
245810             :DCLTCHKPT-CNTRL.CHK-SAVE-07,                        24778099
245820             :DCLTCHKPT-CNTRL.CHK-SAVE-08,                        24779099
245830             :DCLTCHKPT-CNTRL.CHK-SAVE-09,                        24780099
245840             :DCLTCHKPT-CNTRL.CHK-SAVE-10,                        24781099
245850             :DCLTCHKPT-CNTRL.CHK-SAVE-11,                        24782099
245860             :DCLTCHKPT-CNTRL.CHK-SAVE-12,                        24783099
245870             :DCLTCHKPT-CNTRL.CHK-SAVE-13,                        24784099
245880             :DCLTCHKPT-CNTRL.CHK-SAVE-14,                        24785099
245890             :DCLTCHKPT-CNTRL.CHK-SAVE-15,                        24786099
245900             :DCLTCHKPT-CNTRL.CHK-SAVE-16                         24787099
245910          FROM TCHKPT_CNTRL                                       24788099
245920          WHERE                                                   24789099
245930            CHK_JOB_ID    = :DCLTCHKPT-CNTRL.CHK-JOB-ID AND       24790099
245940            CHK_JOB_STEP  = :DCLTCHKPT-CNTRL.CHK-JOB-STEP AND     24791099
245950            CHK_PROC_STEP = :DCLTCHKPT-CNTRL.CHK-PROC-STEP AND    24792099
245960            CHK_PGM_ID    = :DCLTCHKPT-CNTRL.CHK-PGM-ID AND       24793099
245970            SEQ_NUM       = :DCLTCHKPT-CNTRL.SEQ-NUM              24794099
245980        END-EXEC                                                  24795099
245990*                                                                 24796099
246000        PERFORM 9150-CHECK-SQLCODE THRU                           24797099
246010                9150-EXIT                                         24798099
246020                                                                  24799099
246030        IF SQL-ROW-NOT-FOUND                                      24800099
246040           EXEC SQL                                               24801099
246050              ROLLBACK                                            24802099
246060           END-EXEC                                               24803099
246070           MOVE 'SECOND CHKPT CNTL REC NOT FOUND'                 24804099
246080             TO WS-ABEND-TEXT                                     24805099
246090           PERFORM 9000-ABORT THRU 9000-EXIT                      24806099
246100        END-IF                                                    24807099
246110                                                                  24808099
246120        MOVE CHK-SAVE-01 OF DCLTCHKPT-CNTRL                       24809099
246130          TO WS-CHKPT-SAVE-1                                      24810099
246140        MOVE CHK-SAVE-02 OF DCLTCHKPT-CNTRL                       24811099
246150          TO WS-CHKPT-SAVE-2                                      24812099
246160        MOVE CHK-SAVE-03 OF DCLTCHKPT-CNTRL                       24813099
246170          TO WS-CHKPT-SAVE-3                                      24814099
246180        MOVE CHK-SAVE-04 OF DCLTCHKPT-CNTRL                       24815099
246190          TO WS-CHKPT-SAVE-4                                      24816099
246200        MOVE CHK-SAVE-05 OF DCLTCHKPT-CNTRL                       24817099
246210          TO WS-CHKPT-SAVE-5                                      24818099
246220        MOVE CHK-SAVE-06 OF DCLTCHKPT-CNTRL                       24819099
246230          TO WS-CHKPT-SAVE-6                                      24820099
246240        MOVE CHK-SAVE-07 OF DCLTCHKPT-CNTRL                       24821099
246250          TO WS-CHKPT-SAVE-7                                      24822099
246260        MOVE CHK-SAVE-08 OF DCLTCHKPT-CNTRL                       24823099
246270          TO WS-CHKPT-SAVE-8                                      24824099
246280        MOVE CHK-SAVE-09 OF DCLTCHKPT-CNTRL                       24825099
246290          TO WS-CHKPT-SAVE-9                                      24826099
246300        MOVE CHK-SAVE-10 OF DCLTCHKPT-CNTRL                       24827099
246310          TO WS-CHKPT-SAVE-10                                     24828099
246320        MOVE CHK-SAVE-11 OF DCLTCHKPT-CNTRL                       24829099
246330          TO WS-CHKPT-SAVE-11                                     24830099
246340        MOVE CHK-SAVE-12 OF DCLTCHKPT-CNTRL                       24831099
246350          TO WS-CHKPT-SAVE-12                                     24832099
246360        MOVE CHK-SAVE-13 OF DCLTCHKPT-CNTRL                       24833099
246370          TO WS-CHKPT-SAVE-13                                     24834099
246380        MOVE CHK-SAVE-14 OF DCLTCHKPT-CNTRL                       24835099
246390          TO WS-CHKPT-SAVE-14                                     24836099
246400        MOVE CHK-SAVE-15 OF DCLTCHKPT-CNTRL                       24837099
246410          TO WS-CHKPT-SAVE-15                                     24838099
246420        MOVE CHK-SAVE-16 OF DCLTCHKPT-CNTRL                       24839099
246430          TO WS-CHKPT-SAVE-16                                     24840099
246440        MOVE WS-CHKPT-SAVE-DATA                                   24841099
246450          TO WS-CHKPT-IO-DATA                                     24842099
246460        MOVE ZERO TO WS-CHKPT-SEQ-SUB                             24843099
246470                                                                  24844099
246480        DISPLAY                                                   24845099
246490          CHK-JOB-ID    OF DCLTCHKPT-CNTRL '.'                    24846099
246500          CHK-JOB-STEP  OF DCLTCHKPT-CNTRL '.'                    24847099
246510          CHK-PROC-STEP OF DCLTCHKPT-CNTRL '.'                    24848099
246520          CHK-PGM-ID    OF DCLTCHKPT-CNTRL                        24849099
246530          ' HAS BEEN RESTARTED AT COMMIT POINT '                  24850099
246540          WS-COMMIT-CNT                                           24851099
246550     END-IF                                                       24852099
246560                                                                  24853099
246570     EXEC SQL                                                     24854099
246580        COMMIT                                                    24855099
246590     END-EXEC                                                     24856099
246600                                                                  24857099
246610     IF SQLCODE = ZERO                                            24858099
246620        CONTINUE                                                  24859099
246630     ELSE                                                         24860099
246640        MOVE 'ERROR ON C100- COMMIT'                              24861099
246650          TO WS-ABEND-TEXT                                        24862099
246660        MOVE SQLCODE TO WS-ABEND-CODE                             24863099
246670        PERFORM 9000-ABORT  THRU 9000-EXIT                        24864099
246680     END-IF                                                       24865099
246690     .                                                            24866099
246700 C100-EXIT.                                                       24867099
246710     EXIT.                                                        24868099
246720*                                                                 24869099
246730 C200-CLEANUP-CHKPT-RSTRT.                                        24870099
246740******************************************************************24871099
246750*   PARAGRAPH NAME : C200-CLEANUP-CHKPT-RSTRT                     24872099
246760*                                                                 24873099
246770*   DESCRIPTION:                                                  24874099
246780*           PERFORM TERMINATION FUNCTIONS FOR                     24875099
246790*           PROGRAMS THAT ARE RESTARTABLE.                        24876099
246800*                                                                 24877099
246830*   -  DELETE THE CHECKPOINT RECORD FOR THE JOB.                  24878099
246840*                                                                 24879099
246850******************************************************************24880099
246860     MOVE 'C200-CLEANUP-CHKPT-RSTRT' TO WS-CURR-PARA              24881099
246870                                                                  24882099
246880     EXEC SQL                                                     24883099
246890       DELETE                                                     24884099
246900       FROM TCHKPT_CNTRL                                          24885099
246910       WHERE                                                      24886099
246920         CHK_JOB_ID       = :DCLTCHKPT-CNTRL.CHK-JOB-ID AND       24887099
246930         CHK_JOB_STEP     = :DCLTCHKPT-CNTRL.CHK-JOB-STEP AND     24888099
246940         CHK_PROC_STEP    = :DCLTCHKPT-CNTRL.CHK-PROC-STEP AND    24889099
246950         CHK_PGM_ID       = :DCLTCHKPT-CNTRL.CHK-PGM-ID           24890099
246960     END-EXEC                                                     24891099
246970                                                                  24892099
246980     .                                                            24893099
246990 C200-EXIT.                                                       24894099
247000     EXIT.                                                        24895099
247010                                                                  24896099
247020 C300-CHECKPOINT-DATA.                                            24897099
247030******************************************************************24898099
247040*   PARAGRAPH NAME : C300-CHECKPOINT-DATA                         24899099
247050*                                                                 24900099
247060*   DESCRIPTION:                                                  24901099
247070*           THIS PARAGRAPH SAVES OFF DATA REQUIRED FOR            24902099
247080*           RESTARTING THE PROGRAM.  THIS PARAGRAPH IS            24903099
247090*           EXECUTED WHEN A COMMIT IS TAKEN.                      24904099
247100*                                                                 24905099
247110*   THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS :             24906099
247120*                                                                 24907099
247130*   -  RETRIEVE DATA AND TIME FOR THE CURRENT COMMIT              24908099
247140*   -  FLUSH ALL THE BSAM BUFFERS FOR ANY SEQUENTIAL              24909099
247150*      FILES                                                      24910099
247160*   -  SAVE CONTROL INFO FOR DDNAMES THAT CAN BE                  24911099
247170*      RESTARTED                                                  24912099
247180*   -  SAVE ALL APPLICATION DATA THAT MUST BE RESTORED            24913099
247190*      FOR RESTART                                                24914099
247200*   -  SAVE OFF ALL PREDICATE INFO FOR CURSORS THAT               24915099
247210*      ARE OPEN DURING A COMMIT                                   24916099
247220*   -  EITHER INSERT OR UPDATE THE CHECKPOINT CONTROL             24917099
247230*      RECORD DEPENDING IF IT IS THE FIRST COMMIT OR              24918099
247240*      REPEATED COMMIT.                                           24919099
247250*   -  POST A MESSAGE TO THE CONTROL REPORT INDICATING            24920099
247260*      A COMMIT HAS TRANSPIRED.                                   24921099
247270******************************************************************24922099
247280     MOVE 'C300-CHECKPOINT-DATA' TO WS-CURR-PARA                  24923099
247290                                                                  24924099
247300     ACCEPT WS-RUN-DATE FROM DATE                                 24925099
247310     ACCEPT WS-RUN-TIME FROM TIME                                 24926099
247320                                                                  24927099
247330     MOVE WS-RUN-DATE TO CHK-DATE OF DCLTCHKPT-CNTRL              24928099
247340     MOVE WS-RUN-TIME TO CHK-TIME OF DCLTCHKPT-CNTRL              24929099
247350                                                                  24930099
247360     ADD  +1 TO CHK-CNT OF DCLTCHKPT-CNTRL                        24931099
247370     MOVE WS-RESTART-VARIABLES                                    24932099
247380       TO SAVE-APPL-DATA-1                                        24933099
247390     MOVE WS-CHKPT-SAVE-APPL-DATA                                 24934099
247400       TO WS-CHKPT-SAVE-DATA                                      24935099
247410     MOVE WS-CHKPT-SAVE-1                                         24936099
247420     TO CHK-SAVE-01 OF DCLTCHKPT-CNTRL                            24937099
247430     MOVE WS-CHKPT-SAVE-2                                         24938099
247440     TO CHK-SAVE-02 OF DCLTCHKPT-CNTRL                            24939099
247450     MOVE WS-CHKPT-SAVE-3                                         24940099
247460     TO CHK-SAVE-03 OF DCLTCHKPT-CNTRL                            24941099
247470     MOVE WS-CHKPT-SAVE-4                                         24942099
247480     TO CHK-SAVE-04 OF DCLTCHKPT-CNTRL                            24943099
247490     MOVE WS-CHKPT-SAVE-5                                         24944099
247500     TO CHK-SAVE-05 OF DCLTCHKPT-CNTRL                            24945099
247510     MOVE WS-CHKPT-SAVE-6                                         24946099
247520     TO CHK-SAVE-06 OF DCLTCHKPT-CNTRL                            24947099
247530     MOVE WS-CHKPT-SAVE-7                                         24948099
247540     TO CHK-SAVE-07 OF DCLTCHKPT-CNTRL                            24949099
247550     MOVE WS-CHKPT-SAVE-8                                         24950099
247560     TO CHK-SAVE-08 OF DCLTCHKPT-CNTRL                            24951099
247570     MOVE WS-CHKPT-SAVE-9                                         24952099
247580     TO CHK-SAVE-09 OF DCLTCHKPT-CNTRL                            24953099
247590     MOVE WS-CHKPT-SAVE-10                                        24954099
247600     TO CHK-SAVE-10 OF DCLTCHKPT-CNTRL                            24955099
247610     MOVE WS-CHKPT-SAVE-11                                        24956099
247620     TO CHK-SAVE-11 OF DCLTCHKPT-CNTRL                            24957099
247630     MOVE WS-CHKPT-SAVE-12                                        24958099
247640     TO CHK-SAVE-12 OF DCLTCHKPT-CNTRL                            24959099
247650     MOVE WS-CHKPT-SAVE-13                                        24960099
247660     TO CHK-SAVE-13 OF DCLTCHKPT-CNTRL                            24961099
247670     MOVE WS-CHKPT-SAVE-14                                        24962099
247680     TO CHK-SAVE-14 OF DCLTCHKPT-CNTRL                            24963099
247690     MOVE WS-CHKPT-SAVE-15                                        24964099
247700     TO CHK-SAVE-15 OF DCLTCHKPT-CNTRL                            24965099
247710     MOVE WS-CHKPT-SAVE-16                                        24966099
247720     TO CHK-SAVE-16 OF DCLTCHKPT-CNTRL                            24967099
247730     MOVE '1' TO SEQ-NUM OF DCLTCHKPT-CNTRL                       24968099
247740                                                                  24969099
247750     IF WS-CHKPT-INSERT-IND = YES-VALUE                           24970099
247760           EXEC SQL                                               24971099
247770           INSERT                                                 24972099
247780           INTO TCHKPT_CNTRL                                      24973099
247790              (                                                   24974099
247800               CHK_JOB_ID,                                        24975099
247810               CHK_JOB_STEP,                                      24976099
247820               CHK_PROC_STEP,                                     24977099
247830               CHK_PGM_ID,                                        24978099
247840               SEQ_NUM,                                           24979099
247850               CHK_DATE,                                          24980099
247860               CHK_TIME,                                          24981099
247870               CHK_FREQ,                                          24982099
247880               CHK_CNT,                                           24983099
247890               CHK_SAVE_01,                                       24984099
247900               CHK_SAVE_02,                                       24985099
247910               CHK_SAVE_03,                                       24986099
247920               CHK_SAVE_04,                                       24987099
247930               CHK_SAVE_05,                                       24988099
247940               CHK_SAVE_06,                                       24989099
247950               CHK_SAVE_07,                                       24990099
247960               CHK_SAVE_08,                                       24991099
247970               CHK_SAVE_09,                                       24992099
247980               CHK_SAVE_10,                                       24993099
247990               CHK_SAVE_11,                                       24994099
248000               CHK_SAVE_12,                                       24995099
248010               CHK_SAVE_13,                                       24996099
248020               CHK_SAVE_14,                                       24997099
248030               CHK_SAVE_15,                                       24998099
248040               CHK_SAVE_16                                        24999099
248050              )                                                   25000099
248060           VALUES                                                 25001099
248070              (                                                   25002099
248080               :DCLTCHKPT-CNTRL.CHK-JOB-ID,                       25003099
248090               :DCLTCHKPT-CNTRL.CHK-JOB-STEP,                     25004099
248100               :DCLTCHKPT-CNTRL.CHK-PROC-STEP,                    25005099
248110               :DCLTCHKPT-CNTRL.CHK-PGM-ID,                       25006099
248120               :DCLTCHKPT-CNTRL.SEQ-NUM,                          25007099
248130               :DCLTCHKPT-CNTRL.CHK-DATE,                         25008099
248140               :DCLTCHKPT-CNTRL.CHK-TIME,                         25009099
248150               :DCLTCHKPT-CNTRL.CHK-FREQ,                         25010099
248160               :DCLTCHKPT-CNTRL.CHK-CNT,                          25011099
248170               :DCLTCHKPT-CNTRL.CHK-SAVE-01,                      25012099
248180               :DCLTCHKPT-CNTRL.CHK-SAVE-02,                      25013099
248190               :DCLTCHKPT-CNTRL.CHK-SAVE-03,                      25014099
248200               :DCLTCHKPT-CNTRL.CHK-SAVE-04,                      25015099
248210               :DCLTCHKPT-CNTRL.CHK-SAVE-05,                      25016099
248220               :DCLTCHKPT-CNTRL.CHK-SAVE-06,                      25017099
248230               :DCLTCHKPT-CNTRL.CHK-SAVE-07,                      25018099
248240               :DCLTCHKPT-CNTRL.CHK-SAVE-08,                      25019099
248250               :DCLTCHKPT-CNTRL.CHK-SAVE-09,                      25020099
248260               :DCLTCHKPT-CNTRL.CHK-SAVE-10,                      25021099
248270               :DCLTCHKPT-CNTRL.CHK-SAVE-11,                      25022099
248280               :DCLTCHKPT-CNTRL.CHK-SAVE-12,                      25023099
248290               :DCLTCHKPT-CNTRL.CHK-SAVE-13,                      25024099
248300               :DCLTCHKPT-CNTRL.CHK-SAVE-14,                      25025099
248310               :DCLTCHKPT-CNTRL.CHK-SAVE-15,                      25026099
248320               :DCLTCHKPT-CNTRL.CHK-SAVE-16                       25027099
248330              )                                                   25028099
248340        END-EXEC                                                  25029099
248350        PERFORM 9150-CHECK-SQLCODE THRU                           25030099
248360                9150-EXIT                                         25031099
248370     ELSE                                                         25032099
248380        EXEC SQL                                                  25033099
248390          UPDATE TCHKPT_CNTRL                                     25034099
248400          SET                                                     25035099
248410            CHK_DATE      = :DCLTCHKPT-CNTRL.CHK-DATE,            25036099
248420            CHK_CNT       = :DCLTCHKPT-CNTRL.CHK-CNT,             25037099
248430            CHK_SAVE_01 =                                         25038099
248440                            :DCLTCHKPT-CNTRL.CHK-SAVE-01,         25039099
248450            CHK_SAVE_02 =                                         25040099
248460                            :DCLTCHKPT-CNTRL.CHK-SAVE-02,         25041099
248470            CHK_SAVE_03 =                                         25042099
248480                            :DCLTCHKPT-CNTRL.CHK-SAVE-03,         25043099
248490            CHK_SAVE_04 =                                         25044099
248500                            :DCLTCHKPT-CNTRL.CHK-SAVE-04,         25045099
248510            CHK_SAVE_05 =                                         25046099
248520                            :DCLTCHKPT-CNTRL.CHK-SAVE-05,         25047099
248530            CHK_SAVE_06 =                                         25048099
248540                            :DCLTCHKPT-CNTRL.CHK-SAVE-06,         25049099
248550            CHK_SAVE_07 =                                         25050099
248560                            :DCLTCHKPT-CNTRL.CHK-SAVE-07,         25051099
248570            CHK_SAVE_08 =                                         25052099
248580                            :DCLTCHKPT-CNTRL.CHK-SAVE-08,         25053099
248590            CHK_SAVE_09 =                                         25054099
248600                            :DCLTCHKPT-CNTRL.CHK-SAVE-09,         25055099
248610            CHK_SAVE_10 =                                         25056099
248620                            :DCLTCHKPT-CNTRL.CHK-SAVE-10,         25057099
248630            CHK_SAVE_11 =                                         25058099
248640                            :DCLTCHKPT-CNTRL.CHK-SAVE-11,         25059099
248650            CHK_SAVE_12 =                                         25060099
248660                            :DCLTCHKPT-CNTRL.CHK-SAVE-12,         25061099
248670            CHK_SAVE_13 =                                         25062099
248680                            :DCLTCHKPT-CNTRL.CHK-SAVE-13,         25063099
248690            CHK_SAVE_14 =                                         25064099
248700                            :DCLTCHKPT-CNTRL.CHK-SAVE-14,         25065099
248710            CHK_SAVE_15 =                                         25066099
248720                            :DCLTCHKPT-CNTRL.CHK-SAVE-15,         25067099
248730            CHK_SAVE_16 =                                         25068099
248740                            :DCLTCHKPT-CNTRL.CHK-SAVE-16          25069099
248750        WHERE                                                     25070099
248760            CHK_JOB_ID    = :DCLTCHKPT-CNTRL.CHK-JOB-ID AND       25071099
248770            CHK_JOB_STEP  = :DCLTCHKPT-CNTRL.CHK-JOB-STEP AND     25072099
248780            CHK_PROC_STEP = :DCLTCHKPT-CNTRL.CHK-PROC-STEP AND    25073099
248790            CHK_PGM_ID    = :DCLTCHKPT-CNTRL.CHK-PGM-ID AND       25074099
248800            SEQ_NUM       = :DCLTCHKPT-CNTRL.SEQ-NUM              25075099
248810        END-EXEC                                                  25076099
248820*                                                                 25077099
248830        PERFORM 9150-CHECK-SQLCODE THRU                           25078099
248840                9150-EXIT                                         25079099
248850     END-IF                                                       25080099
248860                                                                  25081099
248870     IF SQL-SUCCESS                                               25082099
248880        ADD +1 TO WS-TOTL-UPDATES-INSERTS-CHKPT                   25083099
248890        CONTINUE                                                  25084099
248900     ELSE                                                         25085099
248910        MOVE 'INSERT/UPDATE TO TCHKPT_CNTRL TABLE FAILED.'        25086099
248920          TO WS-ABEND-TEXT                                        25087099
248930        PERFORM 9000-ABORT THRU 9000-EXIT                         25088099
248940     END-IF                                                       25089099
248950                                                                  25090099
248960     MOVE SEQCHKPT TO SEQ-FUNCTION                                25091099
248970     MOVE 'ICOSA01' TO SYS-CALL-PGM-ID                            25092099
248980     CALL SYS-CALL-PGM-ID  USING                                  25093099
248990         DFHCOMMAREA                                              25094099
249000         SEQ-RETURN-CODE-DATA                                     25095099
249010                                                                  25096099
249020     IF SEQ-ERROR                                                 25097099
249030        MOVE SEQ-RET-CODE TO                                      25098099
249040           SEQ-RET-CODE-DISPLAY                                   25099099
249050        STRING                                                    25100099
249060           'SEQUENTIAL I/O OPEN ERROR, RC: '                      25101099
249070            SEQ-RET-CODE-DISPLAY                                  25102099
249080             DELIMITED BY SIZE                                    25103099
249090          INTO WS-ABEND-TEXT                                      25104099
249100        END-STRING                                                25105099
249110        PERFORM 9000-ABORT THRU                                   25106099
249120                9000-EXIT                                         25107099
249130     END-IF                                                       25108099
249140                                                                  25109099
249150     MOVE +1 TO SEQ-CNTL-ARRAY-SUB                                25110099
249160     MOVE +1 TO WS-CHKPT-SEQ-SUB                                  25111099
249170     PERFORM UNTIL SEQ-CNTL-ARRAY-SUB >                           25112099
249180                   SEQ-CNTL-ARRAY-ALLOCATED                       25113099
249190        IF SEQ-RESTART-IND (SEQ-CNTL-ARRAY-SUB) = YES-VALUE       25114099
249200           MOVE SEQ-INFO-AREA (SEQ-CNTL-ARRAY-SUB)                25115099
249210             TO SAVE-SEQ-DATA (WS-CHKPT-SEQ-SUB)                  25116099
249220           ADD +1 TO WS-CHKPT-SEQ-SUB                             25117099
249230        END-IF                                                    25118099
249240        ADD +1 TO SEQ-CNTL-ARRAY-SUB                              25119099
249250     END-PERFORM                                                  25120099
249260                                                                  25121099
249270     MOVE WS-CHKPT-IO-DATA                                        25122099
249280       TO WS-CHKPT-SAVE-DATA                                      25123099
249290     MOVE WS-CHKPT-SAVE-1                                         25124099
249300     TO CHK-SAVE-01 OF DCLTCHKPT-CNTRL                            25125099
249310     MOVE WS-CHKPT-SAVE-2                                         25126099
249320     TO CHK-SAVE-02 OF DCLTCHKPT-CNTRL                            25127099
249330     MOVE WS-CHKPT-SAVE-3                                         25128099
249340     TO CHK-SAVE-03 OF DCLTCHKPT-CNTRL                            25129099
249350     MOVE WS-CHKPT-SAVE-4                                         25130099
249360     TO CHK-SAVE-04 OF DCLTCHKPT-CNTRL                            25131099
249370     MOVE WS-CHKPT-SAVE-5                                         25132099
249380     TO CHK-SAVE-05 OF DCLTCHKPT-CNTRL                            25133099
249390     MOVE WS-CHKPT-SAVE-6                                         25134099
249400     TO CHK-SAVE-06 OF DCLTCHKPT-CNTRL                            25135099
249410     MOVE WS-CHKPT-SAVE-7                                         25136099
249420     TO CHK-SAVE-07 OF DCLTCHKPT-CNTRL                            25137099
249430     MOVE WS-CHKPT-SAVE-8                                         25138099
249440     TO CHK-SAVE-08 OF DCLTCHKPT-CNTRL                            25139099
249450     MOVE WS-CHKPT-SAVE-9                                         25140099
249460     TO CHK-SAVE-09 OF DCLTCHKPT-CNTRL                            25141099
249470     MOVE WS-CHKPT-SAVE-10                                        25142099
249480     TO CHK-SAVE-10 OF DCLTCHKPT-CNTRL                            25143099
249490     MOVE WS-CHKPT-SAVE-11                                        25144099
249500     TO CHK-SAVE-11 OF DCLTCHKPT-CNTRL                            25145099
249510     MOVE WS-CHKPT-SAVE-12                                        25146099
249520     TO CHK-SAVE-12 OF DCLTCHKPT-CNTRL                            25147099
249530     MOVE WS-CHKPT-SAVE-13                                        25148099
249540     TO CHK-SAVE-13 OF DCLTCHKPT-CNTRL                            25149099
249550     MOVE WS-CHKPT-SAVE-14                                        25150099
249560     TO CHK-SAVE-14 OF DCLTCHKPT-CNTRL                            25151099
249570     MOVE WS-CHKPT-SAVE-15                                        25152099
249580     TO CHK-SAVE-15 OF DCLTCHKPT-CNTRL                            25153099
249590     MOVE WS-CHKPT-SAVE-16                                        25154099
249600     TO CHK-SAVE-16 OF DCLTCHKPT-CNTRL                            25155099
249610     MOVE '2' TO SEQ-NUM OF DCLTCHKPT-CNTRL                       25156099
249620     MOVE WS-COMMIT-FREQ TO CHK-FREQ OF DCLTCHKPT-CNTRL           25157099
249630     MOVE WS-COMMIT-SECS TO CHK-TIME OF DCLTCHKPT-CNTRL           25158099
249640                                                                  25159099
249650     IF WS-CHKPT-INSERT-IND = YES-VALUE                           25160099
249660        EXEC SQL                                                  25161099
249670        INSERT                                                    25162099
249680        INTO TCHKPT_CNTRL                                         25163099
249690           (                                                      25164099
249700            CHK_JOB_ID,                                           25165099
249710            CHK_JOB_STEP,                                         25166099
249720            CHK_PROC_STEP,                                        25167099
249730            CHK_PGM_ID,                                           25168099
249740            SEQ_NUM,                                              25169099
249750            CHK_DATE,                                             25170099
249760            CHK_TIME,                                             25171099
249770            CHK_FREQ,                                             25172099
249780            CHK_CNT,                                              25173099
249790            CHK_SAVE_01,                                          25174099
249800            CHK_SAVE_02,                                          25175099
249810            CHK_SAVE_03,                                          25176099
249820            CHK_SAVE_04,                                          25177099
249830            CHK_SAVE_05,                                          25178099
249840            CHK_SAVE_06,                                          25179099
249850            CHK_SAVE_07,                                          25180099
249860            CHK_SAVE_08,                                          25181099
249870            CHK_SAVE_09,                                          25182099
249880            CHK_SAVE_10,                                          25183099
249890            CHK_SAVE_11,                                          25184099
249900            CHK_SAVE_12,                                          25185099
249910            CHK_SAVE_13,                                          25186099
249920            CHK_SAVE_14,                                          25187099
249930            CHK_SAVE_15,                                          25188099
249940            CHK_SAVE_16                                           25189099
249950           )                                                      25190099
249960        VALUES                                                    25191099
249970           (                                                      25192099
249980            :DCLTCHKPT-CNTRL.CHK-JOB-ID,                          25193099
249990            :DCLTCHKPT-CNTRL.CHK-JOB-STEP,                        25194099
250000            :DCLTCHKPT-CNTRL.CHK-PROC-STEP,                       25195099
250010            :DCLTCHKPT-CNTRL.CHK-PGM-ID,                          25196099
250020            :DCLTCHKPT-CNTRL.SEQ-NUM,                             25197099
250030            :DCLTCHKPT-CNTRL.CHK-DATE,                            25198099
250040            :DCLTCHKPT-CNTRL.CHK-TIME,                            25199099
250050            :DCLTCHKPT-CNTRL.CHK-FREQ,                            25200099
250060            :DCLTCHKPT-CNTRL.CHK-CNT,                             25201099
250070            :DCLTCHKPT-CNTRL.CHK-SAVE-01,                         25202099
250080            :DCLTCHKPT-CNTRL.CHK-SAVE-02,                         25203099
250090            :DCLTCHKPT-CNTRL.CHK-SAVE-03,                         25204099
250100            :DCLTCHKPT-CNTRL.CHK-SAVE-04,                         25205099
250110            :DCLTCHKPT-CNTRL.CHK-SAVE-05,                         25206099
250120            :DCLTCHKPT-CNTRL.CHK-SAVE-06,                         25207099
250130            :DCLTCHKPT-CNTRL.CHK-SAVE-07,                         25208099
250140            :DCLTCHKPT-CNTRL.CHK-SAVE-08,                         25209099
250150            :DCLTCHKPT-CNTRL.CHK-SAVE-09,                         25210099
250160            :DCLTCHKPT-CNTRL.CHK-SAVE-10,                         25211099
250170            :DCLTCHKPT-CNTRL.CHK-SAVE-11,                         25212099
250180            :DCLTCHKPT-CNTRL.CHK-SAVE-12,                         25213099
250190            :DCLTCHKPT-CNTRL.CHK-SAVE-13,                         25214099
250200            :DCLTCHKPT-CNTRL.CHK-SAVE-14,                         25215099
250210            :DCLTCHKPT-CNTRL.CHK-SAVE-15,                         25216099
250220            :DCLTCHKPT-CNTRL.CHK-SAVE-16                          25217099
250230           )                                                      25218099
250240        END-EXEC                                                  25219099
250250                                                                  25220099
250260        IF SQLCODE = +0                                           25221099
250270          CONTINUE                                                25222099
250280        ELSE                                                      25223099
250290           MOVE 'ERROR INSERTING INTO TCHKPT-CNTRL TABLE'         25224099
250300             TO WS-ABEND-TEXT                                     25225099
250310           MOVE    SQLCODE    TO   WS-ABEND-CODE                  25226099
250320           PERFORM 9000-ABORT THRU 9000-EXIT                      25227099
250330        END-IF                                                    25228099
250340                                                                  25229099
250350        MOVE NO-VALUE TO WS-CHKPT-INSERT-IND                      25230099
250360                                                                  25231099
250370     ELSE                                                         25232099
250380                                                                  25233099
250390        EXEC SQL                                                  25234099
250400        UPDATE TCHKPT_CNTRL                                       25235099
250410        SET                                                       25236099
250420          CHK_DATE      = :DCLTCHKPT-CNTRL.CHK-DATE,              25237099
250430          CHK_CNT       = :DCLTCHKPT-CNTRL.CHK-CNT,               25238099
250440          CHK_FREQ      = :DCLTCHKPT-CNTRL.CHK-FREQ,              25239099
250450          CHK_TIME        = :DCLTCHKPT-CNTRL.CHK-TIME,            25240099
250460          CHK_SAVE_01 =                                           25241099
250470                          :DCLTCHKPT-CNTRL.CHK-SAVE-01,           25242099
250480          CHK_SAVE_02 =                                           25243099
250490                          :DCLTCHKPT-CNTRL.CHK-SAVE-02,           25244099
250500          CHK_SAVE_03 =                                           25245099
250510                          :DCLTCHKPT-CNTRL.CHK-SAVE-03,           25246099
250520          CHK_SAVE_04 =                                           25247099
250530                          :DCLTCHKPT-CNTRL.CHK-SAVE-04,           25248099
250540          CHK_SAVE_05 =                                           25249099
250550                          :DCLTCHKPT-CNTRL.CHK-SAVE-05,           25250099
250560          CHK_SAVE_06 =                                           25251099
250570                          :DCLTCHKPT-CNTRL.CHK-SAVE-06,           25252099
250580          CHK_SAVE_07 =                                           25253099
250590                          :DCLTCHKPT-CNTRL.CHK-SAVE-07,           25254099
250600          CHK_SAVE_08 =                                           25255099
250610                          :DCLTCHKPT-CNTRL.CHK-SAVE-08,           25256099
250620          CHK_SAVE_09 =                                           25257099
250630                          :DCLTCHKPT-CNTRL.CHK-SAVE-09,           25258099
250640          CHK_SAVE_10 =                                           25259099
250650                          :DCLTCHKPT-CNTRL.CHK-SAVE-10,           25260099
250660          CHK_SAVE_11 =                                           25261099
250670                          :DCLTCHKPT-CNTRL.CHK-SAVE-11,           25262099
250680          CHK_SAVE_12 =                                           25263099
250690                          :DCLTCHKPT-CNTRL.CHK-SAVE-12,           25264099
250700          CHK_SAVE_13 =                                           25265099
250710                          :DCLTCHKPT-CNTRL.CHK-SAVE-13,           25266099
250720          CHK_SAVE_14 =                                           25267099
250730                          :DCLTCHKPT-CNTRL.CHK-SAVE-14,           25268099
250740          CHK_SAVE_15 =                                           25269099
250750                          :DCLTCHKPT-CNTRL.CHK-SAVE-15,           25270099
250760          CHK_SAVE_16 =                                           25271099
250770                          :DCLTCHKPT-CNTRL.CHK-SAVE-16            25272099
250780        WHERE                                                     25273099
250790          CHK_JOB_ID      = :DCLTCHKPT-CNTRL.CHK-JOB-ID AND       25274099
250800          CHK_JOB_STEP    = :DCLTCHKPT-CNTRL.CHK-JOB-STEP AND     25275099
250810          CHK_PROC_STEP   = :DCLTCHKPT-CNTRL.CHK-PROC-STEP AND    25276099
250820          CHK_PGM_ID      = :DCLTCHKPT-CNTRL.CHK-PGM-ID AND       25277099
250830          SEQ_NUM         = :DCLTCHKPT-CNTRL.SEQ-NUM              25278099
250840        END-EXEC                                                  25279099
250850*                                                                 25280099
250860        IF SQLCODE = +0                                           25281099
250870           ADD +1 TO WS-TOTL-UPDATES-INSERTS-CHKPT                25282099
250880           CONTINUE                                               25283099
250890        ELSE                                                      25284099
250900           MOVE 'ERROR ON UPDATE OF CHKPT-CNTRL'                  25285099
250910             TO WS-ABEND-TEXT                                     25286099
250920           MOVE    SQLCODE    TO   WS-ABEND-CODE                  25287099
250930           PERFORM 9000-ABORT THRU 9000-EXIT                      25288099
250940        END-IF                                                    25289099
250950                                                                  25290099
250960     END-IF                                                       25291099
250970                                                                  25292099
250980     EXEC SQL                                                     25293099
250990        COMMIT                                                    25294099
251000     END-EXEC                                                     25295099
251010                                                                  25296099
251020     IF SQLCODE = +0                                              25297099
251030        CONTINUE                                                  25298099
251040     ELSE                                                         25299099
251050        MOVE 'ERROR ON COMMIT'                                    25300099
251060          TO WS-ABEND-TEXT                                        25301099
251070        MOVE    SQLCODE     TO   WS-ABEND-CODE                    25302099
251080        PERFORM 9000-ABORT  THRU 9000-EXIT                        25303099
251090     END-IF                                                       25304099
251100                                                                  25305099
251110     MOVE CHK-CNT   OF DCLTCHKPT-CNTRL TO WS-COMMIT-CNT           25306099
251120     MOVE YES-VALUE TO WS-COMMIT-ON-IND                           25307099
251130                                                                  25308099
251140**  JA0410  -  Start                                              25309099
251150**          -  Modified  MQ Commit to be in Sync w/ DB2  Commit   25310099
251160                                                                  25311099
251170        PERFORM Q1011-CMIT-QUEUE      THRU Q1011-EXIT             25312099
251180     .                                                            25313099
251190 C300-EXIT.                                                       25314099
251200     EXIT.                                                        25315099
251210                                                                  25316099
251220*=================================================================25317099
251230*        M Q   S e r i e s   r o u t i n e s   b e l o w          25318099
251240*             FOR ISSUING DISCONNECT TO GATEWAY                   25319099
251250*=================================================================25320099
251260                                                                  25321099
251270 Q1000-ISSUE-DISCON-TO-GATEWAY.                                   25322099
251280       MOVE 'Q1000-ISSUE-DISCON-TO-GATEWAY' TO WS-CURR-PARA       25323099
251290*-----first, fetch CTN-INV row for CTN read from input file-------25324099
251300       IF USE-CTN-FIELDS-FOR-KEY = 'Y'                            25325099
251310          INITIALIZE USE-CTN-FIELDS-FOR-KEY                       25326099
251320          MOVE WS-CTNIN-CTN-TEXT(1:10) TO WS-MDN                  25327099
251330       ELSE                                                       25328099
251340          MOVE MDNIN-MDN             TO WS-MDN                    25329099
251350          MOVE MDNIN-PRODUCT-TYPE    TO WS-PRODUCT-TYPE           25330099
251360       END-IF                                                     25331099
251370                                                                  25332099
251380       PERFORM 7000-SELECT-CTN-INV THRU 7000-EXIT                 25333099
251390                                                                  25334099
251400       IF SQL-ROW-NOT-FOUND                                       25335099
251410          ADD  1 TO WS-TOTL-ERROR-CTNINV-NOTFND                   25336099
251420          SET  WS-ERROR-FIELDS-FOUND TO TRUE                      25337099
251430          MOVE LIT-CTN-INV-ERROR     TO WS-COMMENT                25338099
251440          MOVE WS-MDN                TO WS-ADDTL-INFO (1:10)      25339099
251450          MOVE WS-PRODUCT-TYPE       TO WS-ADDTL-INFO (12:1)      25340099
251460          GO TO Q1000-EXIT                                        25341099
251470       END-IF                                                     25342099
251480                                                                  25343099
251490*-----Issue  Disconnect----                                       25344099
251500                                                                  25345099
251510       INITIALIZE ACTP-DSCP-MSG                                   25346099
251520       MOVE 'DSCP' TO API-ID OF WS-ACTP-DSCP-MESSAGE              25347099
251530       MOVE CTN-TEXT OF DCLCTN-INV(1:3) TO Q-FORMAT-NPA           25348099
251540       MOVE CTN-TEXT OF DCLCTN-INV(4:3) TO Q-FORMAT-NXX           25349099
251550       MOVE CTN-TEXT OF DCLCTN-INV(7:4) TO Q-FORMAT-LINE          25350099
251560       MOVE Q-FORMAT-CTN TO PORTED-MDN OF WS-ACTP-DSCP-MESSAGE    25351099
251570       MOVE OPERATOR-ID OF DCLCTN-INV TO                          25352099
251580            OPERATOR-ID OF WS-ACTP-DSCP-MESSAGE                   25353099
251590       MOVE WS-TIMESTAMP TO                                       25354099
251600            ORIGINATION-DT-TM OF WS-ACTP-DSCP-MESSAGE             25355099
251610       MOVE LAST-TRX-DATE OF DCLCTN-INV(6:2) TO                   25356099
251620            WS-ORIG-TRX-MM                                        25357099
251630       MOVE LAST-TRX-DATE OF DCLCTN-INV(9:2) TO                   25358099
251640            WS-ORIG-TRX-DD                                        25359099
251650       MOVE LAST-TRX-DATE OF DCLCTN-INV(1:4) TO                   25360099
251660            WS-ORIG-TRX-YYYY                                      25361099
251670       MOVE WS-ORIG-TRX-DATE TO                                   25362099
251680            DISCONNECT-DT-TM OF WS-ACTP-DSCP-MESSAGE              25363099
251690*-----move current date/time to Release date/time-----------------25364099
251700       INITIALIZE WS-RELEASE-DT-TM                                25365099
251710       MOVE WS-CURR-DATE-TIME-MM TO WS-RELEASE-MM                 25366099
251720       MOVE WS-CURR-DATE-TIME-DD TO WS-RELEASE-DD                 25367099
251730       MOVE WS-CURR-DATE-TIME-CCYY TO WS-RELEASE-YYYY             25368099
251740       MOVE WS-CURR-DATE-TIME-HH TO WS-RELEASE-HH                 25369099
251750       MOVE WS-CURR-DATE-TIME-MI TO WS-RELEASE-MI                 25370099
251760       MOVE WS-RELEASE-DT-TM TO                                   25371099
251770            RELEASE-DT-TM OF WS-ACTP-DSCP-MESSAGE.                25372099
251780 Q1000-EXIT.                                                      25373099
251790       EXIT.                                                      25374099
251810                                                                  25375099
251820 Q1010-PUT-DISCON-MESSAGE-TO-MQ.                                  25376099
251830       MOVE 'Q1010-PUT-DISCON-MESSAGE-TO-MQ' TO WS-CURR-PARA      25377099
251840       MOVE WS-GATEWAY-QUE-LNKG TO LS-Q-LNKG                      25378099
251850*AXY042706 - BEG                                                  25379099
251860***    MOVE 97 TO LS-Q-BUFFER-LENGTH                              25380099
251870       MOVE LENGTH OF WS-ACTP-DSCP-MESSAGE                        25381099
251880         TO LS-Q-BUFFER-LENGTH                                    25382099
251890*AXY042706 - END                                                  25383099
251900       SET Q-PUT TO TRUE                                          25384099
251910       MOVE MQPMO-NONE TO LS-Q-OPTIONS                            25385099
251920       MOVE WS-GATEWAY-QUEUENAME TO LS-Q-NAME                     25386099
251930       MOVE WS-ACTP-DSCP-MESSAGE TO WS-COMMAREA                   25387099
251940       CALL WS-MQ-SUB USING LS-Q-LNKG,                            25388099
251950                            WS-COMMAREA                           25389099
251960       IF Q-SUCCESS                                               25390099
251970          ADD 1 TO WS-POOLR-MSGQU-CTR                             25391099
251980*AXY042706 - BEG                                                  25392099
251990          SET COMMIT-DSCP TO TRUE                                 25393099
252000*  JA0511  -  Log  MQ  Update                                     25394099
252010          ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                        25395099
252020          INITIALIZE WS-ACTP-DSCP-MESSAGE                         25396099
252030*AXY042706 - END                                                  25397099
252040       ELSE                                                       25398099
252050*AXY042706 - BEG                                                  25399099
252060***       MOVE '4400'        TO WS-ERR-LOCATION                   25400099
252070          MOVE 'Q1010'       TO WS-ERR-LOCATION                   25401099
252080*AXY042706 - END                                                  25402099
252090          MOVE 'MQ TRANSACTION QUEUE MQPUT FAILURE'               25403099
252100                             TO WS-ERR-REASON WS-ABEND-TEXT       25404099
252110          MOVE 'A'           TO WS-ERR-ACTION                     25405099
252120          DISPLAY 'COMPLETION  CODE = ' LS-Q-COMP-CD              25406099
252130          DISPLAY 'REASON      CODE = ' LS-Q-REAS-CD              25407099
252140          DISPLAY 'FUNCTION    CODE = ' LS-Q-FUNCTION             25408099
252150          DISPLAY 'Q MANAGER ID     = ' LS-Q-MGR-ID               25409099
252160          PERFORM 9000-ABORT THRU 9000-EXIT                       25410099
252170       END-IF.                                                    25411099
252180 Q1010-EXIT.                                                      25412099
252190       EXIT.                                                      25413099
252200                                                                  25414099
252210*AXY042706 - BEG                                                  25415099
252220 Q1011-CMIT-QUEUE.                                                25416099
252230       MOVE 'Q1011-CMIT-QUEUE' TO WS-CURR-PARA                    25417099
252240                                                                  25418099
252250       MOVE WS-GATEWAY-QUE-LNKG TO LS-Q-LNKG                      25419099
252260                                                                  25420099
252270       MOVE WS-GATEWAY-QUEUENAME TO LS-Q-NAME                     25421099
252280                                                                  25422099
252290       SET Q-CMIT TO TRUE                                         25423099
252300                                                                  25424099
252310       CALL WS-MQ-SUB USING LS-Q-LNKG,                            25425099
252320                            WS-COMMAREA                           25426099
252330       IF Q-SUCCESS                                               25427099
252340          SET NO-COMMIT-DSCP TO TRUE                              25428099
252350*         CONTINUE                                                25429099
252360       ELSE                                                       25430099
252370          MOVE 'Q1011'       TO WS-ERR-LOCATION                   25431099
252380          MOVE 'MQ COMMIT QUEUE FAILURE'                          25432099
252390                             TO WS-ERR-REASON WS-ABEND-TEXT       25433099
252400          MOVE 'A'           TO WS-ERR-ACTION                     25434099
252410          DISPLAY 'COMPLETION  CODE = ' LS-Q-COMP-CD              25435099
252420          DISPLAY 'REASON      CODE = ' LS-Q-REAS-CD              25436099
252430          DISPLAY 'FUNCTION    CODE = ' LS-Q-FUNCTION             25437099
252440          DISPLAY 'Q MANAGER ID     = ' LS-Q-MGR-ID               25438099
252450          PERFORM 9000-ABORT THRU 9000-EXIT                       25439099
252460       END-IF                                                     25440099
252470                                                                  25441099
252480      .                                                           25442099
252490 Q1011-EXIT.                                                      25443099
252500       EXIT.                                                      25444099
252510*AXY042706 - END                                                  25445099
252520                                                                  25446099
252530 Q1020-SELECT-Q-NAME-GATEWAY.                                     25447099
252540*      SELECT * FROM EUP.TNI_CLIENT_NAMES                         25448099
252550*      WHERE BILLER_ID = 'G' AND                                  25449099
252560*            API_ID = 'VZWG'                                      25450099
252570*                                                                 25451099
252580*                                                                 25452099
252590*    BILLER  API   CLIENT                           APP  PGM      25453099
252600*      ID    ID     NAME                            ID   ID       25454099
252610*    ------  ----  -------------------------------  ---  ---------25455099
252620*    G       VZWG  GEP.TEP.LNP.RECV.QA              Q    VZWGWAY  25456099
252630                                                                  25457099
252640                                                                  25458099
252650       MOVE 'Q1020-SELECT-Q-NAME-GATEWAY' TO WS-CURR-PARA         25459099
252660       INITIALIZE SQLCODE                                         25460099
252670       INITIALIZE CLIENT-NAME OF DCLTNI-CLIENT-NAMES              25461099
252680       MOVE 'G'                  TO   WS-GATEWAY-BILLER-ID        25462099
252690       MOVE 'VZWGWAY'            TO   WS-GATEWAY-PGM-ID           25463099
252700       MOVE 'RCON'               TO   WS-GATEWAY-API-ID           25464099
252710*      MOVE 'VZWG'               TO   WS-GATEWAY-API-ID           25465099
252720       EXEC SQL                                                   25466099
252730            SELECT                                                25467099
252740            CLIENT_NAME                                           25468099
252750         INTO                                                     25469099
252760           :DCLTNI-CLIENT-NAMES.CLIENT-NAME                       25470099
252770         FROM TNI_CLIENT_NAMES                                    25471099
252780         WHERE                                                    25472099
252790            BILLER_ID  = :WS-GATEWAY-BILLER-ID AND                25473099
252800            PGM_ID     = :WS-GATEWAY-PGM-ID AND                   25474099
252810            API_ID     = :WS-GATEWAY-API-ID                       25475099
252820         END-EXEC                                                 25476099
252830                                                                  25477099
252840      IF SQLCODE = 0                                              25478099
252850         MOVE CLIENT-NAME OF DCLTNI-CLIENT-NAMES TO               25479099
252860                             WS-GATEWAY-QUEUENAME                 25480099
252870      ELSE                                                        25481099
252880         DISPLAY 'QUEUE NAME NOT FOUND      '                     25482099
252890         DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE             25483099
252900         MOVE SQLCODE TO WS-SQLCODE                               25484099
252910         SET APPL-ERROR TO TRUE                                   25485099
252920         MOVE 'Q1020' TO WS-ERR-LOCATION                          25486099
252930         MOVE 'ROW NOT FOUND QUEUE NAME INVALID' TO WS-ERR-REASON 25487099
252940                                                    WS-ABEND-TEXT 25488099
252950         MOVE SQLCODE TO WS-ERR-CODE                              25489099
252960         PERFORM 9000-ABORT THRU 9000-EXIT                        25490099
252970      END-IF                                                      25491099
252980     .                                                            25492099
252990 Q1020-EXIT.                                                      25493099
253000     EXIT.                                                        25494099
253010                                                                  25495099
253190*--and use it as a search argument in the "PARAM-CODE" column.----25496099
253200*--The PRM-VALUE returned will be the correct MQ Manager. Simple.-25497099
253210                                                                  25498099
253220 Q1030-SELECT-Q-MANAGER.                                          25499099
253230       MOVE 'Q1030-SELECT-Q-MANAGER' TO WS-CURR-PARA              25500099
253240       INITIALIZE SQLCODE, DCLPARAM-VALUES                        25501099
253250       MOVE LPAR-NAME(1:4) TO PARAM-CODE OF DCLPARAM-VALUES       25502099
253260                                                                  25503099
253270       EXEC SQL                                                   25504099
253280         SELECT                                                   25505099
253290            PRM_VALUE                                             25506099
253300         INTO                                                     25507099
253310           :DCLPARAM-VALUES.PRM-VALUE                             25508099
253320         FROM PARAM_VALUES                                        25509099
253330         WHERE                                                    25510099
253340            PARAM_CODE = :DCLPARAM-VALUES.PARAM-CODE              25511099
253350         END-EXEC                                                 25512099
253360                                                                  25513099
253370       IF SQLCODE = 0                                             25514099
253380          MOVE PRM-VALUE-TEXT OF DCLPARAM-VALUES TO WS-Q-MGR-ID   25515099
253390       ELSE                                                       25516099
253400          DISPLAY '-------------------------------------------'   25517099
253410          DISPLAY 'QUEUE MGR NOT FOUND      '                     25518099
253420          DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE            25519099
253430          MOVE SQLCODE TO WS-SQLCODE                              25520099
253440          SET APPL-ERROR TO TRUE                                  25521099
253450          MOVE 'Q1030' TO WS-ERR-LOCATION                         25522099
253460          MOVE 'ROW NOT FOUND QUEUE MGR INVALID' TO WS-ERR-REASON 25523099
253470                                                    WS-ABEND-TEXT 25524099
253480          MOVE SQLCODE TO WS-ERR-CODE                             25525099
253490          PERFORM 9000-ABORT THRU 9000-EXIT                       25526099
253500      END-IF                                                      25527099
253510     .                                                            25528099
253520 Q1030-EXIT.                                                      25529099
253530      EXIT.                                                       25530099
253540                                                                  25531099
253550 Q1040-CONNECT-TO-Q-MGR.                                          25532099
253560       MOVE 'Q1040-CONNECT-TO-Q-MGR' TO WS-CURR-PARA              25533099
253570       INITIALIZE LS-Q-LNKG                                       25534099
253580       MOVE SPACES       TO LS-Q-MGR-ID                           25535099
253590       SET Q-CONN TO TRUE                                         25536099
253600                                                                  25537099
253610**  JA0507  - Below  Comments                                     25538099
253620**     MOVE WS-Q-MGR-ID TO LS-Q-MGR-ID                            25539099
253630       MOVE WS-GATEWAY-QUEUENAME TO LS-Q-NAME                     25540099
253640                                 WS-QUEUE-NAME OF WS-QUEUE-INFO   25541099
253650       CALL WS-MQ-SUB USING LS-Q-LNKG,                            25542099
253660                            WS-COMMAREA                           25543099
253670       DISPLAY 'CONNECT QUEUE MGR  = ' LS-Q-MGR-ID                25544099
253680       DISPLAY 'CONNECT QUEUE NAME = ' WS-QUEUE-NAME              25545099
253690       IF NOT Q-SUCCESS                                           25546099
253700          MOVE 'Q1040'       TO WS-ERR-LOCATION                   25547099
253710          MOVE 'MQ TRANSACTION QUEUE CONNECTION FAILURE'          25548099
253720                             TO WS-ERR-REASON                     25549099
253730                                WS-ABEND-TEXT                     25550099
253740          MOVE 'A'           TO WS-ERR-ACTION                     25551099
253750          DISPLAY '-------------------------------------------'   25552099
253760          DISPLAY 'COMPLETION  CODE = ' LS-Q-COMP-CD              25553099
253770          DISPLAY 'REASON      CODE = ' LS-Q-REAS-CD              25554099
253780          DISPLAY 'FUNCTION    CODE = ' LS-Q-FUNCTION             25555099
253790          DISPLAY 'Q MANAGER ID     = ' LS-Q-MGR-ID               25556099
253800          PERFORM 9000-ABORT       THRU                           25557099
253810                  9000-EXIT                                       25558099
253820       END-IF                                                     25559099
253830          .                                                       25560099
253840 Q1040-EXIT.                                                      25561099
253850       EXIT.                                                      25562099
253860                                                                  25563099
253870 Q1050-OPEN-GATEWAY-QUE.                                          25564099
253880       MOVE 'Q1050-OPEN-GATEWAY-QUE' TO WS-CURR-PARA              25565099
253890       SET Q-OPEN TO TRUE                                         25566099
253900       ADD MQOO-OUTPUT MQOO-FAIL-IF-QUIESCING                     25567099
253910           GIVING LS-Q-OPTIONS                                    25568099
253920       MOVE WS-GATEWAY-QUEUENAME TO LS-Q-NAME                     25569099
253930       CALL WS-MQ-SUB USING LS-Q-LNKG,                            25570099
253940                            WS-COMMAREA                           25571099
253950       IF NOT Q-SUCCESS                                           25572099
253960          MOVE 'Q1050'       TO WS-ERR-LOCATION                   25573099
253970          MOVE 'MQ GATEWAY QUEUE OPEN FAILURE'                    25574099
253980                             TO WS-ERR-REASON                     25575099
253990                                WS-ABEND-TEXT                     25576099
254000          MOVE 'A'           TO WS-ERR-ACTION                     25577099
254010          DISPLAY '-------------------------------------------'   25578099
254020          DISPLAY 'COMPLETION  CODE = ' LS-Q-COMP-CD              25579099
254030          DISPLAY 'REASON      CODE = ' LS-Q-REAS-CD              25580099
254040          DISPLAY 'FUNCTION    CODE = ' LS-Q-FUNCTION             25581099
254050          DISPLAY 'Q MANAGER ID     = ' LS-Q-MGR-ID               25582099
254060          PERFORM 9000-ABORT       THRU                           25583099
254070                  9000-EXIT                                       25584099
254080       END-IF                                                     25585099
254090       MOVE LS-Q-LNKG TO WS-GATEWAY-QUE-LNKG                      25586099
254100          .                                                       25587099
254110 Q1050-EXIT.                                                      25588099
254120       EXIT.                                                      25589099
254130                                                                  25590099
254140 Q1060-CLOSE-GATEWAY-QUEUE.                                       25591099
254150       MOVE 'Q1060-CLOSE-GATEWAY-QUEUE' TO WS-CURR-PARA           25592099
254160       MOVE WS-GATEWAY-QUE-LNKG TO LS-Q-LNKG                      25593099
254170       MOVE MQCO-NONE TO LS-Q-OPTIONS                             25594099
254180       MOVE WS-GATEWAY-QUEUENAME TO LS-Q-NAME                     25595099
254190       SET Q-CLOSE TO TRUE                                        25596099
254200       CALL WS-MQ-SUB USING LS-Q-LNKG,                            25597099
254210                            WS-COMMAREA                           25598099
254220       IF NOT Q-SUCCESS                                           25599099
254230          MOVE 'Q1060'       TO WS-ERR-LOCATION                   25600099
254240          MOVE 'MQ GATEWAY QUEUE CLOSE FAILURE'                   25601099
254250                             TO WS-ERR-REASON                     25602099
254260                                WS-ABEND-TEXT                     25603099
254270          MOVE 'A'           TO WS-ERR-ACTION                     25604099
254280          DISPLAY '-------------------------------------------'   25605099
254290          DISPLAY 'COMPLETION  CODE = ' LS-Q-COMP-CD              25606099
254300          DISPLAY 'REASON      CODE = ' LS-Q-REAS-CD              25607099
254310          DISPLAY 'FUNCTION    CODE = ' LS-Q-FUNCTION             25608099
254320          DISPLAY 'Q MANAGER ID     = ' LS-Q-MGR-ID               25609099
254330          PERFORM 9000-ABORT       THRU                           25610099
254340                  9000-EXIT                                       25611099
254350       END-IF                                                     25612099
254360       .                                                          25613099
254370 Q1060-EXIT.                                                      25614099
254380       EXIT.                                                      25615099
254390                                                                  25616099
254400 Q1061-CLOSE-NOTIF-QUEUE.                                         25617099
254410       MOVE 'Q1061-CLOSE-NOTIF-QUEUE' TO WS-CURR-PARA             25618099
254420       MOVE WS-NOTI-QUE-LNKG TO LS-Q-LNKG                         25619099
254430       MOVE MQCO-NONE TO LS-Q-OPTIONS                             25620099
254440       MOVE WS-NOTI-QUE-NAME TO LS-Q-NAME                         25621099
254450       SET Q-CLOSE TO TRUE                                        25622099
254460       CALL WS-MQ-SUB USING LS-Q-LNKG,                            25623099
254470                            WS-COMMAREA                           25624099
254480       IF NOT Q-SUCCESS                                           25625099
254490          MOVE 'Q1061'       TO WS-ERR-LOCATION                   25626099
254500          MOVE 'MQ NOTIF QUEUE CLOSE FAILURE'                     25627099
254510                             TO WS-ERR-REASON                     25628099
254520                                WS-ABEND-TEXT                     25629099
254530          MOVE 'A'           TO WS-ERR-ACTION                     25630099
254540          DISPLAY '-------------------------------------------'   25631099
254550          DISPLAY 'COMPLETION  CODE = ' LS-Q-COMP-CD              25632099
254560          DISPLAY 'REASON      CODE = ' LS-Q-REAS-CD              25633099
254570          DISPLAY 'FUNCTION    CODE = ' LS-Q-FUNCTION             25634099
254580          DISPLAY 'Q MANAGER ID     = ' LS-Q-MGR-ID               25635099
254590          PERFORM 9000-ABORT       THRU                           25636099
254600                  9000-EXIT                                       25637099
254610       END-IF                                                     25638099
254620       .                                                          25639099
254630 Q1061-EXIT.                                                      25640099
254640       EXIT.                                                      25641099
254650                                                                  25642099
254660 Q1062-CLOSE-TRIGGER-QUEUE.                                       25643099
254670       MOVE 'Q1062-CLOSE-TRIGGER-QUEUE' TO WS-CURR-PARA           25644099
254680       MOVE WS-TRIG-QUE-LNKG TO LS-Q-LNKG                         25645099
254690       MOVE MQCO-NONE TO LS-Q-OPTIONS                             25646099
254700       MOVE WS-TRIG-QUE-NAME TO LS-Q-NAME                         25647099
254710       SET Q-CLOSE TO TRUE                                        25648099
254720       CALL WS-MQ-SUB USING LS-Q-LNKG,                            25649099
254730                            WS-COMMAREA                           25650099
254740       IF NOT Q-SUCCESS                                           25651099
254750          MOVE 'Q1062'       TO WS-ERR-LOCATION                   25652099
254760          MOVE 'MQ TRIGGER QUEUE CLOSE FAILURE'                   25653099
254770                             TO WS-ERR-REASON                     25654099
254780                                WS-ABEND-TEXT                     25655099
254790          MOVE 'A'           TO WS-ERR-ACTION                     25656099
254800          DISPLAY '-------------------------------------------'   25657099
254810          DISPLAY 'COMPLETION  CODE = ' LS-Q-COMP-CD              25658099
254820          DISPLAY 'REASON      CODE = ' LS-Q-REAS-CD              25659099
254830          DISPLAY 'FUNCTION    CODE = ' LS-Q-FUNCTION             25660099
254840          DISPLAY 'Q MANAGER ID     = ' LS-Q-MGR-ID               25661099
254850          PERFORM 9000-ABORT       THRU                           25662099
254860                  9000-EXIT                                       25663099
254870       END-IF                                                     25664099
254880       .                                                          25665099
254890 Q1062-EXIT.                                                      25666099
254900       EXIT.                                                      25667099
254910                                                                  25668099
254920 Q1063-CLOSE-CDVC-QUEUE.                                          25669099
254930       MOVE 'Q1063-CLOSE-CDVC-QUEUE' TO WS-CURR-PARA              25670099
254940       MOVE WS-CDVC-QUE-LNKG TO LS-Q-LNKG                         25671099
254950       MOVE MQCO-NONE TO LS-Q-OPTIONS                             25672099
254960       MOVE WS-TRIG-QUE-NAME TO LS-Q-NAME                         25673099
254970       SET Q-CLOSE TO TRUE                                        25674099
254980       CALL WS-MQ-SUB USING LS-Q-LNKG,                            25675099
254990                            WS-COMMAREA                           25676099
255000       IF NOT Q-SUCCESS                                           25677099
255010          MOVE 'Q1063'       TO WS-ERR-LOCATION                   25678099
255020          MOVE 'MQ CDVC    QUEUE CLOSE FAILURE'                   25679099
255030                             TO WS-ERR-REASON                     25680099
255040                                WS-ABEND-TEXT                     25681099
255050          MOVE 'A'           TO WS-ERR-ACTION                     25682099
255060          DISPLAY '-------------------------------------------'   25683099
255070          DISPLAY 'COMPLETION  CODE = ' LS-Q-COMP-CD              25684099
255080          DISPLAY 'REASON      CODE = ' LS-Q-REAS-CD              25685099
255090          DISPLAY 'FUNCTION    CODE = ' LS-Q-FUNCTION             25686099
255100          DISPLAY 'Q MANAGER ID     = ' LS-Q-MGR-ID               25687099
255110          PERFORM 9000-ABORT       THRU                           25688099
255120                  9000-EXIT                                       25689099
255130       END-IF                                                     25690099
255140       .                                                          25691099
255150 Q1063-EXIT.                                                      25692099
255160       EXIT.                                                      25693099
255170                                                                  25694099
255180 Q1072-DISCON-FROM-MQ-MGR.                                        25695099
255190       MOVE 'Q1072-DISCON-FROM-MQ-MGR' TO WS-CURR-PARA            25696099
255200       MOVE WS-TRIG-QUE-LNKG TO LS-Q-LNKG                         25697099
255210       MOVE WS-TRIG-QUE-NAME TO LS-Q-NAME                         25698099
255220       SET Q-DISC TO TRUE                                         25699099
255230       CALL WS-MQ-SUB USING LS-Q-LNKG,                            25700099
255240                            WS-COMMAREA                           25701099
255250       IF NOT Q-SUCCESS                                           25702099
255260          MOVE 'Q1072'       TO WS-ERR-LOCATION                   25703099
255270          MOVE 'MQ MANAGER DISCONNCT FAILURE'                     25704099
255280                             TO WS-ERR-REASON                     25705099
255290                                WS-ABEND-TEXT                     25706099
255300          MOVE 'A'           TO WS-ERR-ACTION                     25707099
255310          DISPLAY '-------------------------------------------'   25708099
255320          DISPLAY 'COMPLETION  CODE = ' LS-Q-COMP-CD              25709099
255330          DISPLAY 'REASON      CODE = ' LS-Q-REAS-CD              25710099
255340          DISPLAY 'FUNCTION    CODE = ' LS-Q-FUNCTION             25711099
255350          DISPLAY 'Q MANAGER ID     = ' LS-Q-MGR-ID               25712099
255360          PERFORM 9000-ABORT       THRU                           25713099
255370                  9000-EXIT                                       25714099
255380       END-IF                                                     25715099
255390          .                                                       25716099
255400 Q1072-EXIT.                                                      25717099
255410       EXIT.                                                      25718099
255420                                                                  25719099
255430*=================================================================25720099
255440*        M Q   S e r i e s   r o u t i n e s   b e l o w          25721099
255450*             FOR ISSUING "ASGN" TO BILLER                        25722099
255460*=================================================================25723099
255470                                                                  25724099
255480 Q1021-SELECT-Q-NAMES-ASGN.                                       25725099
255490       MOVE 'Q1021-SELECT-Q-NAMES-ASGN' TO WS-CURR-PARA           25726099
255500                                                                  25727099
255510*      get Notify Que name                                        25728099
255520       INITIALIZE SQLCODE  DCLPARAM-VALUES                        25729099
255530       MOVE 'NOTIFY_QUEUE_NAME' TO PARAM-CODE OF DCLPARAM-VALUES  25730099
255540                                                                  25731099
255550       MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES       25732099
255560                                                                  25733099
255570       EXEC SQL                                                   25734099
255580          SELECT                                                  25735099
255590            PRM_VALUE                                             25736099
255600          INTO                                                    25737099
255610            :DCLPARAM-VALUES.PRM-VALUE                            25738099
255620          FROM PARAM_VALUES                                       25739099
255630          WHERE                                                   25740099
255640           PARAM_CODE = :DCLPARAM-VALUES.PARAM-CODE               25741099
255650       END-EXEC                                                   25742099
255660                                                                  25743099
255670       IF SQLCODE = 0                                             25744099
255680          MOVE PRM-VALUE-TEXT OF DCLPARAM-VALUES TO               25745099
255690               WS-NOTI-QUE-NAME                                   25746099
255700       ELSE                                                       25747099
255710          DISPLAY 'NOTIFY QUEUE NAME NOT FOUND      '             25748099
255720          DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE            25749099
255730          MOVE SQLCODE TO WS-SQLCODE                              25750099
255740          SET APPL-ERROR TO TRUE                                  25751099
255750          MOVE 'Q1021' TO WS-ERR-LOCATION                         25752099
255760          MOVE 'ROW NOT FOUND QUEUE NAME INVALID' TO WS-ERR-REASON25753099
255770                                                     WS-ABEND-TEXT25754099
255780          MOVE SQLCODE TO WS-ERR-CODE                             25755099
255790          PERFORM 9000-ABORT THRU 9000-EXIT                       25756099
255800       END-IF                                                     25757099
255810                                                                  25758099
255820*      get Trigger Que name                                       25759099
255830       INITIALIZE SQLCODE  DCLPARAM-VALUES                        25760099
255840       MOVE 'TRIG_QUEUE_NAME' TO PARAM-CODE OF DCLPARAM-VALUES    25761099
255850                                                                  25762099
255860       MOVE  SPACES  TO  PRM-VALUE-TEXT  OF DCLPARAM-VALUES       25763099
255870                                                                  25764099
255880       EXEC SQL                                                   25765099
255890          SELECT                                                  25766099
255900            PRM_VALUE                                             25767099
255910          INTO                                                    25768099
255920            :DCLPARAM-VALUES.PRM-VALUE                            25769099
255930          FROM PARAM_VALUES                                       25770099
255940          WHERE                                                   25771099
255950           PARAM_CODE = :DCLPARAM-VALUES.PARAM-CODE               25772099
255960       END-EXEC                                                   25773099
255970                                                                  25774099
255980       IF SQLCODE = 0                                             25775099
255990          MOVE PRM-VALUE-TEXT OF DCLPARAM-VALUES TO               25776099
256000                                WS-TRIG-QUE-NAME                  25777099
256010       ELSE                                                       25778099
256020          DISPLAY 'TRIGGER QUEUE NAME NOT FOUND      '            25779099
256030          DISPLAY 'SQL SELECT NOT SUCCESSFUL ' SQLCODE            25780099
256040          MOVE SQLCODE TO WS-SQLCODE                              25781099
256050          SET APPL-ERROR TO TRUE                                  25782099
256060          MOVE 'Q1021' TO WS-ERR-LOCATION                         25783099
256070          MOVE 'ROW NOT FOUND QUEUE NAME INVALID' TO WS-ERR-REASON25784099
256080                                                     WS-ABEND-TEXT25785099
256090          MOVE SQLCODE TO WS-ERR-CODE                             25786099
256100          PERFORM 9000-ABORT THRU 9000-EXIT                       25787099
256110       END-IF.                                                    25788099
256120 Q1021-EXIT.                                                      25789099
256130       EXIT.                                                      25790099
256140                                                                  25791099
256150 Q1051-OPEN-ASGN-QUES.                                            25792099
256160*------open ASGN RAPI's Notification que--------------------------25793099
256170       MOVE 'Q1051-OPEN-ASGN-QUES' TO WS-CURR-PARA                25794099
256180       SET Q-OPEN TO TRUE                                         25795099
256190       ADD MQOO-OUTPUT MQOO-FAIL-IF-QUIESCING                     25796099
256200           GIVING LS-Q-OPTIONS                                    25797099
256210       MOVE WS-NOTI-QUE-NAME TO LS-Q-NAME                         25798099
256220       CALL WS-MQ-SUB USING LS-Q-LNKG,                            25799099
256230                            WS-COMMAREA                           25800099
256240       IF NOT Q-SUCCESS                                           25801099
256250          MOVE 'Q1051'       TO WS-ERR-LOCATION                   25802099
256260          MOVE 'MQ NOTIFICATION QUE OPEN FAILURE'                 25803099
256270                             TO WS-ERR-REASON                     25804099
256280                                WS-ABEND-TEXT                     25805099
256290          MOVE 'A'           TO WS-ERR-ACTION                     25806099
256300          DISPLAY '-------------------------------------------'   25807099
256310          DISPLAY 'COMPLETION  CODE = ' LS-Q-COMP-CD              25808099
256320          DISPLAY 'REASON      CODE = ' LS-Q-REAS-CD              25809099
256330          DISPLAY 'FUNCTION    CODE = ' LS-Q-FUNCTION             25810099
256340          DISPLAY 'Q MANAGER ID     = ' LS-Q-MGR-ID               25811099
256350          PERFORM 9000-ABORT       THRU                           25812099
256360                  9000-EXIT                                       25813099
256370       END-IF                                                     25814099
256380       MOVE LS-Q-LNKG TO WS-NOTI-QUE-LNKG                         25815099
256390                                                                  25816099
256400*------open ASGN RAPI's Trigger que-------------------------------25817099
256410       SET Q-OPEN TO TRUE                                         25818099
256420       ADD MQOO-OUTPUT MQOO-FAIL-IF-QUIESCING                     25819099
256430           GIVING LS-Q-OPTIONS                                    25820099
256440       MOVE WS-TRIG-QUE-NAME TO LS-Q-NAME                         25821099
256450       CALL WS-MQ-SUB USING LS-Q-LNKG,                            25822099
256460                            WS-COMMAREA                           25823099
256470       IF NOT Q-SUCCESS                                           25824099
256480          MOVE 'Q1051'       TO WS-ERR-LOCATION                   25825099
256490          MOVE 'MQ TRIGGER QUE OPEN FAILURE'                      25826099
256500                             TO WS-ERR-REASON                     25827099
256510                                WS-ABEND-TEXT                     25828099
256520          MOVE 'A'           TO WS-ERR-ACTION                     25829099
256530          DISPLAY 'COMPLETION  CODE = ' LS-Q-COMP-CD              25830099
256540          DISPLAY 'REASON      CODE = ' LS-Q-REAS-CD              25831099
256550          DISPLAY 'FUNCTION    CODE = ' LS-Q-FUNCTION             25832099
256560          DISPLAY 'Q MANAGER ID     = ' LS-Q-MGR-ID               25833099
256570          PERFORM 9000-ABORT       THRU                           25834099
256580                  9000-EXIT                                       25835099
256590       END-IF                                                     25836099
256600       MOVE LS-Q-LNKG TO WS-TRIG-QUE-LNKG                         25837099
256610          .                                                       25838099
256620 Q1051-EXIT.                                                      25839099
256630       EXIT.                                                      25840099
256640                                                                  25841099
256650 Q1052-OPEN-CDVC-QUE.                                             25842099
256660*----open CDVC                                                    25843099
256670     MOVE 'Q1052-OPEN-CDVC-QUE' TO WS-CURR-PARA                   25844099
256680     SET Q-OPEN TO TRUE                                           25845099
256690     ADD MQOO-OUTPUT MQOO-FAIL-IF-QUIESCING                       25846099
256700         GIVING LS-Q-OPTIONS                                      25847099
256710     MOVE WS-CDVC-QUEUENAME  TO LS-Q-NAME                         25848099
256720     CALL WS-MQ-SUB USING LS-Q-LNKG,                              25849099
256730                            WS-COMMAREA                           25850099
256740     IF NOT Q-SUCCESS                                             25851099
256750        MOVE 'Q1052'       TO WS-ERR-LOCATION                     25852099
256760        MOVE 'CDVC QUEUE OPEN FAILURE'                            25853099
256770                             TO WS-ERR-REASON                     25854099
256780                                WS-ABEND-TEXT                     25855099
256790          MOVE 'A'           TO WS-ERR-ACTION                     25856099
256800          DISPLAY '-------------------------------------------'   25857099
256810          DISPLAY 'COMPLETION  CODE = ' LS-Q-COMP-CD              25858099
256820          DISPLAY 'REASON      CODE = ' LS-Q-REAS-CD              25859099
256830          DISPLAY 'FUNCTION    CODE = ' LS-Q-FUNCTION             25860099
256840          DISPLAY 'Q MANAGER ID     = ' LS-Q-MGR-ID               25861099
256850          DISPLAY 'Target Queue     = ' LS-Q-NAME                 25862099
256860          PERFORM 9000-ABORT       THRU                           25863099
256870                  9000-EXIT                                       25864099
256880     END-IF                                                       25865099
256890                                                                  25866099
256900     MOVE LS-Q-LNKG TO WS-CDVC-QUE-LNKG                           25867099
256910                                                                  25868099
256920       DISPLAY 'CDVC    QUEUE NAME = ' LS-Q-NAME                  25869099
256930          .                                                       25870099
256940 Q1052-EXIT.                                                      25871099
256950       EXIT.                                                      25872099
256960                                                                  25873099
256970 P100-PRE-READ-OF-FILES.                                          25874099
256980      DISPLAY ' ' DISPLAY ' '                                     25875099
256990      DISPLAY                                                     25876099
257000     '==========================================================='25877099
257010      DISPLAY                                                     25878099
257020     'Now entering into pre-check of input Biller & eTNI files...'25879099
257030      DISPLAY ' ' DISPLAY ' '                                     25880099
257040                                                                  25881099
257050      OPEN INPUT NMMDNINP-FILE                                    25882099
257060      OPEN INPUT NMCTNINP-FILE                                    25883099
257070      INITIALIZE MDNIN-RECORD WS-CTNIN-RECORD                     25884099
257080      INITIALIZE EOF-BILL EOF-ETNI                                25885099
257090                                                                  25886099
257100*-----read Biller file up to first detail record------------------25887099
257110      PERFORM P110-READ-NEXT-BILL-RECORD THRU P110-EXIT           25888099
257120              UNTIL MDNIN-RECORD(1:1) = '5'                       25889099
257130                                                                  25890099
257140*-----read eTNI file first record---------------------------------25891099
257150      PERFORM P120-READ-NEXT-ETNI-RECORD THRU P120-EXIT           25892099
257160                                                                  25893099
257170      PERFORM P105-COMPARE-KEYS-OF-FILES THRU P105-EXIT           25894099
257180              UNTIL EOF-BILL = 'Y' AND EOF-ETNI = 'Y'             25895099
257190                                                                  25896099
257200      CLOSE NMMDNINP-FILE                                         25897099
257210      CLOSE NMCTNINP-FILE                                         25898099
257220      INITIALIZE MDNIN-RECORD WS-CTNIN-RECORD                     25899099
257230      INITIALIZE WS-MATCH-KEY-BILL-MDN WS-MATCH-KEY-ETNI-MDN.     25900099
257240 P100-EXIT.                                                       25901099
257250      EXIT.                                                       25902099
257260                                                                  25903099
257270 P105-COMPARE-KEYS-OF-FILES.                                      25904099
257280      IF EOF-BILL = 'Y' AND EOF-ETNI = 'Y'                        25905099
257290         GO TO P105-EXIT                                          25906099
257300      END-IF                                                      25907099
257310                                                                  25908099
257320*-----take keys from both files and put them into compare fields--25909099
257330      MOVE MDNIN-MDN TO WS-MATCH-KEY-BILL-MDN                     25910099
257340      MOVE WS-CTNIN-CTN-TEXT (1:WS-CTNIN-CTN-LEN) TO              25911099
257350                        WS-MATCH-KEY-ETNI-MDN                     25912099
257360                                                                  25913099
257370**********************************************                    25914099
257380* ANDY: TEST ONLY! BYPASS ALL RECS UNTIL TEST CASE.....           25915099
257390*                                                                 25916099
257400*       IF WS-MATCH-KEY-BILL-MDN(1:10) NOT = '8142337737'         25917099
257410*          PERFORM P110-READ-NEXT-BILL-RECORD THRU P110-EXIT      25918099
257420*          PERFORM P120-READ-NEXT-ETNI-RECORD THRU P120-EXIT      25919099
257430*          GO TO P105-EXIT                                        25920099
257440*          END-IF                                                 25921099
257450**********************************************                    25922099
257460                                                                  25923099
257470*-----CASE 1: Biller's MDN matches eTNI's CTN---------------------25924099
257480      IF WS-MATCH-KEY-BILL-MDN = WS-MATCH-KEY-ETNI-MDN            25925099
257490         ADD 1 TO WS-BILLER-ETNI-MATCH                            25926099
257500         PERFORM P110-READ-NEXT-BILL-RECORD THRU P110-EXIT        25927099
257510         PERFORM P120-READ-NEXT-ETNI-RECORD THRU P120-EXIT        25928099
257520         GO TO P105-EXIT                                          25929099
257530      END-IF                                                      25930099
257540                                                                  25931099
257550*-----CASE 2: Biller's MDN not on eTNI's file---------------------25932099
257560      IF WS-MATCH-KEY-BILL-MDN < WS-MATCH-KEY-ETNI-MDN            25933099
257570         ADD 1 TO WS-BILLER-NOT-IN-ETNI                           25934099
257580         PERFORM P110-READ-NEXT-BILL-RECORD THRU P110-EXIT        25935099
257590         GO TO P105-EXIT                                          25936099
257600      END-IF                                                      25937099
257610                                                                  25938099
257620*-----CASE 3: eTNI's CTN not on Biller's file---------------------25939099
257630      IF WS-MATCH-KEY-BILL-MDN > WS-MATCH-KEY-ETNI-MDN            25940099
257640         ADD 1 TO WS-ETNI-NOT-IN-BILLER                           25941099
257650         PERFORM P120-READ-NEXT-ETNI-RECORD THRU P120-EXIT        25942099
257660      END-IF.                                                     25943099
257670 P105-EXIT.                                                       25944099
257680      EXIT.                                                       25945099
257690                                                                  25946099
257700 P110-READ-NEXT-BILL-RECORD.                                      25947099
257710      IF EOF-BILL = 'Y' AND EOF-ETNI NOT = 'Y'                    25948099
257720         PERFORM P120-READ-NEXT-ETNI-RECORD THRU P120-EXIT        25949099
257730         GO TO P110-EXIT                                          25950099
257740      END-IF                                                      25951099
257750                                                                  25952099
257760      INITIALIZE MDNIN-RECORD                                     25953099
257770      READ NMMDNINP-FILE INTO MDNIN-RECORD                        25954099
257780           AT END MOVE 'Y' TO EOF-BILL.                           25955099
257790*-----from Biller Header, get Biller-ID and calc HDR date - 1 day-25956099
257800      IF MDNIN-RECORD(1:1) = '1'                                  25957099
257810         MOVE MDNIN-BILLER-ID OF MDNIN-HEADER-FIELDS TO           25958099
257820              WS-SAVE-HDR-BILLER-ID                               25959099
257830         MOVE 'N' TO WS-DISPLAY-HDR-DATE                          25960099
257840         PERFORM 2040-PROCESS-HDR-DATE THRU 2040-EXIT             25961099
257850      END-IF                                                      25962099
257860*-----if its the Trailer record, close up shop--------------------25963099
257870      IF MDNIN-RECORD(1:1) = '9'                                  25964099
257880         ADD  +1  TO  WS-TRAILER-COUNTER                          25965099
257890         INITIALIZE MDNIN-RECORD                                  25966099
257900         MOVE 'Y' TO EOF-BILL                                     25967099
257910      END-IF.                                                     25968099
257920 P110-EXIT.                                                       25969099
257930      EXIT.                                                       25970099
257940                                                                  25971099
257950 P120-READ-NEXT-ETNI-RECORD.                                      25972099
257960      IF EOF-ETNI = 'Y' AND EOF-BILL NOT = 'Y'                    25973099
257970         PERFORM P110-READ-NEXT-BILL-RECORD THRU P110-EXIT        25974099
257980         GO TO P120-EXIT                                          25975099
257990      END-IF.                                                     25976099
258000                                                                  25977099
258010 P120-ETNI-READ-LOOP.                                             25978099
258020      INITIALIZE WS-CTNIN-RECORD                                  25979099
258030      READ NMCTNINP-FILE INTO WS-CTNIN-RECORD                     25980099
258040           AT END MOVE 'Y' TO EOF-ETNI                            25981099
258050              MOVE HIGH-VALUES TO WS-CTNIN-RECORD                 25982099
258060              GO TO P120-EXIT.                                    25983099
258070      PERFORM P130-KEEP-ETNI-OR-BYPASS THRU P130-EXIT             25984099
258080      IF WS-KEEP-THIS-RECORD = 'N'                                25985099
258090           GO TO P120-ETNI-READ-LOOP                              25986099
258100      END-IF.                                                     25987099
258110 P120-EXIT.                                                       25988099
258120      EXIT.                                                       25989099
258130                                                                  25990099
258140 P130-KEEP-ETNI-OR-BYPASS.                                        25991099
258150*-----Before doing any REAL processing, first weed out those------25992099
258160*-----cases that need to be bypassed. Set flag and exit routine---25993099
258170*-----These are the same tests used in 2300-MDN-NOT-IN-BILL when--25994099
258180*-----actually processing the reconciliation----------------------25995099
258190      MOVE 'Y' TO WS-KEEP-THIS-RECORD                             25996099
258200                                                                  25997099
258210      IF WS-CTNIN-CTN-STATUS = 'AG' AND                           25998099
258220         WS-CTNIN-PORT-IND = 'SB' AND                             25999099
258230        (WS-CTNIN-NL = SPACES OR WS-CTNIN-NL = LOW-VALUES)        26000099
258240         MOVE 'N' TO WS-KEEP-THIS-RECORD                          26001099
258250         GO TO P130-EXIT                                          26002099
258260      END-IF                                                      26003099
258270                                                                  26004099
258280*----Bypass NEW transactions < 24 hours old-----------------------26005099
258290     MOVE WS-CTNIN-LAST-TRX-DATE (01:4) TO WS-TEMP-DATE-CCYY      26006099
258300     MOVE WS-CTNIN-LAST-TRX-DATE (06:2) TO WS-TEMP-DATE-MM        26007099
258310     MOVE WS-CTNIN-LAST-TRX-DATE (09:2) TO WS-TEMP-DATE-DD        26008099
258320     MOVE WS-CTNIN-LAST-TRX-DATE (12:2) TO WS-TEMP-DATE-HH        26009099
258330     MOVE WS-CTNIN-LAST-TRX-DATE (15:2) TO WS-TEMP-DATE-MI        26010099
258340     MOVE WS-CTNIN-LAST-TRX-DATE (18:2) TO WS-TEMP-DATE-SS        26011099
258350     IF WS-TEMP-DATE-NUM > WS-HDR-DATE-TIME-MINUS-1DAY            26012099
258360        MOVE 'N' TO WS-KEEP-THIS-RECORD                           26013099
258370        GO TO P130-EXIT                                           26014099
258380     END-IF                                                       26015099
258390                                                                  26016099
258400*----Since this CTN is in eTNI and not in Biller and is ported-out26017099
258410*----in eTNI, do not perform any updates or reporting on it-------26018099
258420     IF WS-CTNIN-CTN-STATUS = 'PO' AND                            26019099
258430        WS-CTNIN-PORT-IND = 'PO'                                  26020099
258440        MOVE 'N' TO WS-KEEP-THIS-RECORD                           26021099
258450        GO TO P130-EXIT                                           26022099
258460     END-IF                                                       26023099
258470                                                                  26024099
258480*----Biller id validation. If bad: out!---------------------------26025099
258490     IF WS-CTNIN-BILLER-ID NOT = WS-SAVE-HDR-BILLER-ID            26026099
258500        MOVE 'N' TO WS-KEEP-THIS-RECORD                           26027099
258510        GO TO P130-EXIT                                           26028099
258520     END-IF                                                       26029099
258530                                                                  26030099
258540*----Bypass Prepaid numbers on HOLD-------------------------------26031099
258550     IF WS-CTNIN-NL(2:1) = 'H'                                    26032099
258560        MOVE 'N' TO WS-KEEP-THIS-RECORD                           26033099
258570        GO TO P130-EXIT                                           26034099
258580     END-IF                                                       26035099
258590                                                                  26036099
258600*----Bypass CTNs in "NA" and "NH" status--------------------------26037099
258610     IF WS-CTNIN-CTN-STATUS = 'NA' OR 'NH'                        26038099
258620        MOVE 'N' TO WS-KEEP-THIS-RECORD                           26039099
258630        GO TO P130-EXIT                                           26040099
258640     END-IF                                                       26041099
258650                                                                  26042099
258660*----CTNs with 'SPL' Last Trx Code should not be deleted----------26043099
258670*--- These are special holding pools. Bypass them.----------------26044099
258680     IF WS-CTNIN-LAST-TRX-CODE = 'SPL'                            26045099
258690        MOVE 'N' TO WS-KEEP-THIS-RECORD                           26046099
258700        GO TO P130-EXIT                                           26047099
258710     END-IF                                                       26048099
258720                                                                  26049099
258730     IF WS-PARM-UPDATE OR WS-PARM-UPDDEL OR WS-PARM-UPDDNA        26050099
258740*-------port-outs have spaces in NL, so only compare NLs 1st byte-26051099
258750*-------to Biller from Header if the NL is populated!-------------26052099
258760          IF WS-CTNIN-NL(1:1) NOT = SPACE AND                     26053099
258770             WS-CTNIN-NL(1:1) NOT = LOW-VALUES AND                26054099
258780             WS-CTNIN-NL(1:1) NOT = WS-SAVE-HDR-BILLER-ID         26055099
258790             MOVE 'N' TO WS-KEEP-THIS-RECORD                      26056099
258800             GO TO P130-EXIT                                      26057099
258810         END-IF                                                   26058099
258820     END-IF                                                       26059099
258830                                                                  26060099
258840*----it's OK for MDN to be missing in Biller if PO'd in eTNI------26061099
258850     IF WS-PARM-UPDATE AND                                        26062099
258860       (WS-CTNIN-CTN-STATUS NOT = 'PO' OR                         26063099
258870        WS-CTNIN-PORT-IND NOT = 'PO')                             26064099
258880           MOVE 'N' TO WS-KEEP-THIS-RECORD                        26065099
258890           GO TO P130-EXIT                                        26066099
258900     END-IF.                                                      26067099
258910 P130-EXIT.                                                       26068099
258920      EXIT.                                                       26069099
258930*                                                                 26070099
258940*----------------------------------------------------------------*26071099
258950 4G-PROCESS.                                                      26072099
258960*----------------------------------------------------------------*26073099
258970*                                                                 26074099
258980*  Determine  Source  of  Data,  Based  Upon  Billing / eTNI      26075099
258990*    relationships  - Found,  No Billing or No eTNI  Match        26076099
259000                                                                  26077099
259010*  JA0111 - below                                                 26078099
259020     INITIALIZE  WS-4G-ERROR-SW                                   26079099
259030*                                                                 26080099
259040*    Take  Data  From  Billing                                    26081099
259050*                                                                 26082099
259060     IF  MDN-MATCH-FLAG  =  'Y'                                   26083099
259070         OR                                                       26084099
259080         MDN-NOT-IN-ETNI-FLAG  =  'Y'                             26085099
259090         MOVE  MDNIN-ICC-ID-4G                                    26086099
259100               TO ICC-ID-4G  OF  LTE-INPUT-AREA                   26087099
259110         MOVE  MDNIN-IMSI                                         26088099
259120               TO VORA-IMSI  OF  LTE-INPUT-AREA                   26089099
259130         MOVE  MDNIN-MDN  TO  WS-CTNIN-4TH-G                      26090099
259140     END-IF                                                       26091099
259150                                                                  26092099
259160*                                                                 26093099
259170*    Do  A  Preliminary  Edit                                     26094099
259180*    Confirm  ICC-ID-4G  or  VORA-IMSI  Matches                   26095099
259190*                                                                 26096099
259200     IF  MDN-MATCH-FLAG  =  'Y'                                   26097099
259210        IF  MDNIN-ICC-ID-4G  >  ' '                               26098099
259220         IF  WS-CTNIN-IMSI  =  SPACES                             26099099
259230           IF  MDNIN-ICC-ID-4G  NOT  =  WS-CTNIN-ICC-ID-4G        26100099
259240               SET   WS-4G-ERROR-YES  TO  TRUE                    26101099
259250               MOVE  2  TO  WS-RETURN-CODE                        26102099
259260               MOVE  LIT-UNKNOWN-SIM-MISMATCH  TO WS-COMMENT      26103099
259270               ADD  +1  TO  WS-T-BILL-ETNI-SIM-MISMATCH           26104099
259280               INITIALIZE  DETAIL-LINE-1                          26105099
259290               MOVE  'SIM '   TO  DETAIL-1-SYSTEM                 26106099
259300               MOVE  WS-CTNIN-4TH-G  TO  DETAIL-1-MDN             26107099
259310               GO  TO  4G-PROCESS-EXIT                            26108099
259320           END-IF                                                 26109099
259330         END-IF                                                   26110099
259340        END-IF                                                    26111099
259350     END-IF                                                       26112099
259360                                                                  26113099
259370     IF  MDN-MATCH-FLAG  =  'Y'                                   26114099
259380        IF  MDNIN-IMSI       >  ' '                               26115099
259390         IF  WS-CTNIN-ICC-ID-4G  =  SPACES                        26116099
259400           IF  MDNIN-IMSI  NOT  =  WS-CTNIN-IMSI                  26117099
259410               SET   WS-4G-ERROR-YES  TO  TRUE                    26118099
259420               MOVE  2  TO  WS-RETURN-CODE                        26119099
259430               MOVE  LIT-BILL-ETNI-IMSI-MISMATCH  TO WS-COMMENT   26120099
259440               ADD  +1  TO  WS-T-BILL-ETNI-IMSI-MISMATCH          26121099
259450               INITIALIZE  DETAIL-LINE-1                          26122099
259460               MOVE  'VORA'   TO  DETAIL-1-SYSTEM                 26123099
259470               MOVE  WS-CTNIN-4TH-G  TO  DETAIL-1-MDN             26124099
259480               GO  TO  4G-PROCESS-EXIT                            26125099
259490           END-IF                                                 26126099
259500         END-IF                                                   26127099
259510        END-IF                                                    26128099
259520     END-IF                                                       26129099
259530                                                                  26130099
259540*                                                                 26131099
259550*    Take  Data  From  eTNI                                       26132099
259560*                                                                 26133099
259570     IF  MDN-NOT-IN-BILL-FLAG  =  'Y'                             26134099
259580         MOVE  WS-CTNIN-ICC-ID-4G                                 26135099
259590               TO ICC-ID-4G  OF  LTE-INPUT-AREA                   26136099
259600         MOVE  WS-CTNIN-IMSI                                      26137099
259610               TO VORA-IMSI  OF  LTE-INPUT-AREA                   26138099
259620         MOVE  WS-CTNIN-CTN-TEXT  TO  WS-CTNIN-4TH-G              26139099
259630     END-IF                                                       26140099
259640                                                                  26141099
259650*                                                                 26142099
259660*  Process  SIM  / VORA  Select                                   26143099
259670*    Determine  IF  processing  required                          26144099
259680*                                                                 26145099
259690     IF  ICC-ID-4G  IN   LTE-INPUT-AREA  >  ' '  OR               26146099
259700         VORA-IMSI  IN   LTE-INPUT-AREA  >  ' '                   26147099
259710         CONTINUE                                                 26148099
259720         ELSE                                                     26149099
259730         GO  TO  4G-PROCESS-EXIT                                  26150099
259740     END-IF                                                       26151099
259750*                                                                 26152099
259760*  Process  SIM  Select                                           26153099
259770*                                                                 26154099
259780     IF  ICC-ID-4G  IN   LTE-INPUT-AREA  >  ' '  AND              26155099
259790         WS-SELECT-SIM-VORA  =  SPACES                            26156099
259800         SET  SEL-SIM   OF WS-LTE-DATA-LAYER  TO TRUE             26157099
259810                                                                  26158099
259820         CALL WS-SIM-INV-ETLSC10                                  26159099
259830              USING                                               26160099
259840                   WS-LTE-DATA-LAYER                              26161099
259850              ON EXCEPTION                                        26162099
259860              DISPLAY '*4G-EXCEPTION2  - Calling  ETLSC10'        26163099
259870         END-CALL                                                 26164099
259880     END-IF                                                       26165099
259890*                                                                 26166099
259900*  Process  VORA  Select                                          26167099
259910*                                                                 26168099
259920     IF  VORA-IMSI    IN  LTE-INPUT-AREA  >  ' '  AND             26169099
259930         WS-SELECT-SIM-VORA  =  SPACES                            26170099
259940         SET  SEL-VORA  OF WS-LTE-DATA-LAYER  TO TRUE             26171099
259950                                                                  26172099
259960         CALL WS-VORA-INV-ETLSC11                                 26173099
259970              USING                                               26174099
259980                   WS-LTE-DATA-LAYER                              26175099
259990              ON EXCEPTION                                        26176099
260000              DISPLAY '*4G-EXCEPTION5  - Calling  ETLSC11'        26177099
260010         END-CALL                                                 26178099
260020     END-IF                                                       26179099
260030                                                                  26180099
260040*  Check  Return  Code                                            26181099
260050*                                                                 26182099
260060                                                                  26183099
260070     IF  LTE-STATUS-CD  IN  LTE-OUTPUT-AREA  >  '00000'           26184099
260080         DISPLAY  '* MDN / ICC-ID-4G / IMSI *  '                  26185099
260090                 WS-CTNIN-4TH-G  ' / '                            26186099
260100                 ICC-ID-4G  IN  LTE-INPUT-AREA  ' / '             26187099
260110                 VORA-IMSI  IN  LTE-INPUT-AREA                    26188099
260120         DISPLAY  'LTE-STATUS-CD / DESCR '                        26189099
260130            LTE-STATUS-CD  IN  LTE-OUTPUT-AREA   ' / '            26190099
260140            LTE-STATUS-DESCR  IN  LTE-OUTPUT-AREA                 26191099
260150         SET   WS-4G-ERROR-YES  TO  TRUE                          26192099
260160         MOVE  2  TO  WS-RETURN-CODE                              26193099
260170     END-IF                                                       26194099
260180*                                                                 26195099
260190*  Process  SIM  Failed  Access -                                 26196099
260200*                                                                 26197099
260210     IF  LTE-STATUS-CD  IN  LTE-OUTPUT-AREA  >  '00000'           26198099
260220       IF  ICC-ID-4G  IN   LTE-INPUT-AREA  >  ' '                 26199099
260230         SET   WS-4G-ERROR-YES  TO  TRUE                          26200099
260240         MOVE  LIT-SIM-VORA-ERROR    TO   WS-COMMENT              26201099
260250         ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                        26202099
260260         INITIALIZE  DETAIL-LINE-1                                26203099
260270         MOVE  'SIM '   TO  DETAIL-1-SYSTEM                       26204099
260280         MOVE  WS-CTNIN-4TH-G  TO  DETAIL-1-MDN                   26205099
260290         MOVE  DETAIL-LINE-1  TO   WS-4G-DETAIL-LINE              26206099
260300         GO  TO  4G-PROCESS-EXIT                                  26207099
260310       END-IF                                                     26208099
260320     END-IF                                                       26209099
260330*                                                                 26210099
260340*  Process  VORA  Failed  Access                                  26211099
260350*                                                                 26212099
260360     IF  LTE-STATUS-CD  IN  LTE-OUTPUT-AREA  >  '00000'           26213099
260370       IF  VORA-IMSI    IN  LTE-INPUT-AREA  >  ' '                26214099
260380         SET   WS-4G-ERROR-YES  TO  TRUE                          26215099
260390         MOVE  LIT-SIM-VORA-ERROR    TO   WS-COMMENT              26216099
260400         ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                        26217099
260410         INITIALIZE  DETAIL-LINE-1                                26218099
260420         MOVE  'VORA'   TO  DETAIL-1-SYSTEM                       26219099
260430         MOVE  WS-CTNIN-4TH-G  TO  DETAIL-1-MDN                   26220099
260440         MOVE  DETAIL-LINE-1  TO   WS-4G-DETAIL-LINE              26221099
260450         GO  TO  4G-PROCESS-EXIT                                  26222099
260460       END-IF                                                     26223099
260470     END-IF                                                       26224099
                                                                        26225099
260490     MOVE  SPACES  TO  WS-SELECT-SIM-VORA                         26226099
260500                                                                  26227099
260510     .                                                            26228099
260520 4G-PROCESS-EXIT.  EXIT.                                          26229099
260530                                                                  26230099
260540*----------------------------------------------------------------*26231099
260550 4G-REPORT-BUILD.                                                 26232099
260560*----------------------------------------------------------------*26233099
260570*  Process  SIM  Report  Data                                     26234099
260580                                                                  26235099
260590     INITIALIZE  DETAIL-LINE-1                                    26236099
260600                                                                  26237099
260610     IF  MDN-MATCH-FLAG        =  'Y'  OR                         26238099
260620         MDN-NOT-IN-ETNI-FLAG  =  'Y'                             26239099
260630       IF  MDNIN-ICC-ID-4G     >  ' '                             26240099
260640           MOVE  'SIM '   TO  DETAIL-1-SYSTEM                     26241099
260650           MOVE  MDNIN-MDN  TO  DETAIL-1-MDN                      26242099
260660           MOVE  MDNIN-ICC-ID-4G  TO  DETAIL-1-ICC-IMSI           26243099
260670           PERFORM  4G-9000-SELECT-SIM  THRU  4G-9000-EXIT        26244099
260680           IF  SQLCODE  =  +0                                     26245099
260690               MOVE  SIM-STATUS    IN LTE-OUTPUT-AREA  TO         26246099
260700                                         DETAIL-1-4G-STATUS       26247099
260710               MOVE  SYS-UPDATE-DATE  IN   DCLSIM-INV(1:4)  TO    26248099
260720                                         DETAIL-1-LAST-TRX-DT(1:4)26249099
260730               MOVE  SYS-UPDATE-DATE  IN   DCLSIM-INV(6:2)  TO    26250099
260740                                         DETAIL-1-LAST-TRX-DT(5:2)26251099
260750               MOVE  SYS-UPDATE-DATE  IN   DCLSIM-INV(9:2)  TO    26252099
260760                                         DETAIL-1-LAST-TRX-DT(7:2)26253099
260770           END-IF                                                 26254099
260780       END-IF                                                     26255099
260790     END-IF                                                       26256099
260800                                                                  26257099
260810*  SIM  /   ICC  Report  Line                                     26258099
260810     IF  MDN-NOT-IN-BILL-FLAG  =  'Y'                             26259099
260820       IF  WS-CTNIN-ICC-ID-4G  >  ' '                             26260099
260830           MOVE  'SIM '   TO  DETAIL-1-SYSTEM                     26261099
260840           MOVE  WS-CTNIN-CTN-TEXT  TO  DETAIL-1-MDN              26262099
260850           MOVE  WS-CTNIN-ICC-ID-4G    TO  DETAIL-1-ICC-IMSI      26263099
260860           PERFORM  4G-9000-SELECT-SIM  THRU  4G-9000-EXIT        26264099
260870           IF  SQLCODE  =  +0                                     26265099
260880               MOVE  SIM-STATUS    IN LTE-OUTPUT-AREA  TO         26266099
260890                                      DETAIL-1-4G-STATUS          26267099
260900               MOVE  SYS-UPDATE-DATE  IN   DCLSIM-INV(1:4)  TO    26268099
260910                                         DETAIL-1-LAST-TRX-DT(1:4)26269099
260920               MOVE  SYS-UPDATE-DATE  IN   DCLSIM-INV(6:2)  TO    26270099
260930                                         DETAIL-1-LAST-TRX-DT(5:2)26271099
260940               MOVE  SYS-UPDATE-DATE  IN   DCLSIM-INV(9:2)  TO    26272099
260950                                         DETAIL-1-LAST-TRX-DT(7:2)26273099
260960           END-IF                                                 26274099
260970       END-IF                                                     26275099
260980     END-IF                                                       26276099
260990                                                                  26277099
261000*  Process VORA  Report  Data                                     26278099
261010                                                                  26279099
261020     IF  MDN-MATCH-FLAG        =  'Y'  OR                         26280099
261030         MDN-NOT-IN-ETNI-FLAG  =  'Y'                             26281099
261040       IF  MDNIN-IMSI          >  ' '                             26282099
261050           INITIALIZE  DETAIL-LINE-1                              26283099
261060           MOVE  'VORA'   TO  DETAIL-1-SYSTEM                     26284099
261070           MOVE  MDNIN-MDN    TO  DETAIL-1-MDN                    26285099
261080           MOVE  MDNIN-IMSI   TO  DETAIL-1-ICC-IMSI               26286099
261090           PERFORM  4G-9100-SELECT-VORA  THRU  4G-9100-EXIT       26287099
261100                                                                  26288099
261110         IF  SQLCODE  =  +0                                       26289099
261120             MOVE  IMSI-STATUS  IN LTE-OUTPUT-AREA  TO            26290099
261130                                             DETAIL-1-4G-STATUS   26291099
261140             MOVE  NL  IN LTE-OUTPUT-AREA  TO    DETAIL-1-NL      26292099
261150             MOVE  SYS-UPDATE-DATE  IN   DCLVORA-IMSI-INV(1:4) TO 26293099
261160                                        DETAIL-1-LAST-TRX-DT(1:4) 26294099
261170             MOVE  SYS-UPDATE-DATE  IN   DCLVORA-IMSI-INV(6:2) TO 26295099
261180                                        DETAIL-1-LAST-TRX-DT(5:2) 26296099
261190             MOVE  SYS-UPDATE-DATE  IN   DCLVORA-IMSI-INV(9:2) TO 26297099
261200                                        DETAIL-1-LAST-TRX-DT(7:2) 26298099
261210         END-IF                                                   26299099
261220       END-IF                                                     26300099
261230     END-IF                                                       26301099
261240                                                                  26302099
261260     IF  MDN-NOT-IN-BILL-FLAG  =  'Y'                             26303099
261270       IF  WS-CTNIN-IMSI       >  ' '                             26304099
261280           MOVE  'VORA'   TO  DETAIL-1-SYSTEM                     26305099
261290           MOVE  WS-CTNIN-CTN-TEXT  TO  DETAIL-1-MDN              26306099
261300           MOVE  WS-CTNIN-IMSI      TO  DETAIL-1-ICC-IMSI         26307099
261310           PERFORM  4G-9100-SELECT-VORA  THRU  4G-9100-EXIT       26308099
261320         IF  SQLCODE  =  +0                                       26309099
261330             MOVE  IMSI-STATUS   IN LTE-OUTPUT-AREA  TO           26310099
261340                                      DETAIL-1-4G-STATUS          26311099
261350             MOVE  SYS-UPDATE-DATE  IN   DCLVORA-IMSI-INV(1:4) TO 26312099
261360                                        DETAIL-1-LAST-TRX-DT(1:4) 26313099
261370             MOVE  SYS-UPDATE-DATE  IN   DCLVORA-IMSI-INV(6:2) TO 26314099
261380                                        DETAIL-1-LAST-TRX-DT(5:2) 26315099
261390             MOVE  SYS-UPDATE-DATE  IN   DCLVORA-IMSI-INV(9:2) TO 26316099
261400                                        DETAIL-1-LAST-TRX-DT(7:2) 26317099
261410         END-IF                                                   26318099
261420       END-IF                                                     26319099
261430     END-IF                                                       26320099
261440                                                                  26321099
261450     IF  WS-4G-CDVC-YES                                           26322099
261460         MOVE  LIT-CDVC-GENERATED  TO  DETAIL-1-COMMENT           26323099
261470     END-IF                                                       26324099
261480                                                                  26325099
261490*  JA0111  - Else  Below                                          26326099
261500                                                                  26327099
261510     IF  NOT  WS-4G-ERROR-YES                                     26328099
261520         MOVE  DETAIL-LINE-1  TO   WS-4G-DETAIL-LINE              26329099
261530         PERFORM 6400-WRITE-RECON-RPT          THRU 6400-EXIT     26330099
261540     END-IF                                                       26331099
261550                                                                  26332099
261560*  JA0111 - Below  Cond                                           26333099
261570                                                                  26334099
261580     IF  WS-4G-ERROR-YES                                          26335099
261590         MOVE  DETAIL-LINE-1  TO   WS-4G-DETAIL-LINE              26336099
261600         PERFORM 6500-WRITE-ERROR-RPT          THRU 6500-EXIT     26337099
261610     END-IF                                                       26338099
261620                                                                  26339099
261630     .                                                            26340099
261640 4G-REPORT-BUILD-EXIT. EXIT.                                      26341099
261650                                                                  26342099
261660*  JA0310  -   4G Update                                          26343099
261670                                                                  26344099
261680*----------------------------------------------------------------*26345099
261690 4G-UPDATE.                                                       26346099
261700*----------------------------------------------------------------*26347099
261710*  JA0612  -  Special  Process  for  'AA' OR 'NA'                 26348099
261720*          -  Note - IMSI  Ignored  * *  Vestigial  * *           26349099
261730*  JA0912  -  NA  Last                                            26350099
261730                                                                  26351099
261740     IF  WS-CTNIN-CTN-STATUS  =  'AA'  OR  'NA'  OR               26352099
261750         WS-CTN-STATUS-TO-AA  OR                                  26353099
261760         WS-NEW-STATUS  =  'AA'  OR  'NA'  OR                     26354099
134990         CTN-STATUS OF DCLCTN-INV  =  'AA' OR  'NA'  OR           26355099
261761         MODIFIED-MIN-STATUS  =  'AP'                             26356099
261762         IF  WS-CTNIN-ICC-ID-4G  >  ' '                           26357099
261763           PERFORM  4G-9000-SELECT-SIM-10 THRU  4G-9000-EXIT      26358099
261764           PERFORM  2051-CONVERT-SIM-DATE  THRU  2051-EXIT        26359099
261765**  Check Date                                                    26360099
261766           IF  WS-SIM-SYS-UPDATE-DATE2                            26361099
261767                                   >  WS-HDR-DATE-TIME-MINUS-1DAY 26362099
261768               GO  TO   4G-UPDATE-EXIT                            26363099
261769           END-IF                                                 26364099
261770                                                                  26365099
261780           PERFORM  4G-48000-CALL-ETLSC08   THRU  4G-48000-EXIT   26366099
261790           PERFORM  4G-50100-SIM-HIST       THRU  4G-50100-EXIT   26367099
261791           PERFORM  4G-50200-SIM-CTN-UPDATE THRU  4G-50200-EXIT   26368099
261792           PERFORM  4G-REPORT-BUILD   THRU  4G-REPORT-BUILD-EXIT  26369099
261793           GO  TO   4G-UPDATE-EXIT                                26370099
261794        END-IF                                                    26371099
261795     END-IF                                                       26372099
261796                                                                  26373099
261797*  JA0310  -   4G  - Version  II                                  26374099
261798                                                                  26375099
261799*  JA0910  -  Changed  Below  From New-Status & Old-Status        26376099
261800                                                                  26377099
261801     PERFORM  VARYING  WS-CTN-STATUS-D-A-IDX  FROM  1  BY  1      26378099
261802              UNTIL    WS-CTN-STATUS-D-A-IDX  >                   26379099
261803                       WS-CTN-STATUS-D-A-IDX-MAX                  26380099
261804              OR                                                  26381099
261805         (WS-ETNBC16-4G-PROCESS-ARAY-L(WS-CTN-STATUS-D-A-IDX)(3:2)26382099
261806              =  MDNIN-MDN-STATUS                                 26383099
261807             AND                                                  26384099
261808          WS-ETNBC16-4G-PROCESS-ARAY-L(WS-CTN-STATUS-D-A-IDX)(1:2)26385099
261809              =  WS-CTNIN-CTN-STATUS)                             26386099
261810     END-PERFORM                                                  26387099
261820                                                                  26388099
261830**  At  this  point - We  either  have a From To match or  - NOT- 26389099
261840**  IF  NO  Match per below, then  Exit                           26390099
261850                                                                  26391099
261860     IF  WS-CTN-STATUS-D-A-IDX  >   WS-CTN-STATUS-D-A-IDX-MAX     26392099
261870         GO  TO  4G-UPDATE-EXIT-50                                26393099
261880     END-IF                                                       26394099
261890                                                                  26395099
261900     IF  MDNIN-IMSI  >  ' '                                       26396099
261910*  JA1210   -  Date  Conversion / If                              26397099
261920         PERFORM  4G-9100-SELECT-VORA-10 THRU  4G-9100-EXIT       26398099
261930         PERFORM  2041-CONVERT-VORA-DATE  THRU  2041-EXIT         26399099
261940**  Check Date                                                    26400099
261950         IF  WS-VORA-SYS-UPDATE-DATE2                             26401099
261960                                   >  WS-HDR-DATE-TIME-MINUS-1DAY 26402099
261970             GO  TO   4G-UPDATE-EXIT-50                           26403099
261980         END-IF                                                   26404099
261990                                                                  26405099
262000         PERFORM  4G-49000-CALL-ETLSC09  THRU  4G-49000-EXIT      26406099
262010         PERFORM  4G-51000-VORA-UPDATE   THRU  4G-51000-EXIT      26407099
262020         PERFORM  4G-REPORT-BUILD      THRU  4G-REPORT-BUILD-EXIT 26408099
262030         GO  TO   4G-UPDATE-EXIT-50                               26409099
262040     END-IF                                                       26410099
262050                                                                  26411099
262060     IF  MDNIN-ICC-ID-4G  >  ' '                                  26412099
262070*  JA1210   -  Date  Conversion / If                              26413099
262080         PERFORM  4G-9000-SELECT-SIM-10 THRU  4G-9000-EXIT        26414099
262090         PERFORM  2051-CONVERT-SIM-DATE  THRU  2051-EXIT          26415099
262100**  Check Date                                                    26416099
262110         IF  WS-SIM-SYS-UPDATE-DATE2                              26417099
262120                                   >  WS-HDR-DATE-TIME-MINUS-1DAY 26418099
262130             GO  TO   4G-UPDATE-EXIT-50                           26419099
262140         END-IF                                                   26420099
262150                                                                  26421099
262160         PERFORM  4G-48000-CALL-ETLSC08  THRU  4G-48000-EXIT      26422099
262170         PERFORM  4G-50000-SIM-UPDATE    THRU  4G-50000-EXIT      26423099
262180         PERFORM  4G-REPORT-BUILD      THRU  4G-REPORT-BUILD-EXIT 26424099
262190         GO  TO   4G-UPDATE-EXIT-50                               26425099
262200     END-IF                                                       26426099
262210                                                                  26427099
262220     .                                                            26428099
262230 4G-UPDATE-EXIT-50.                                               26429099
262210                                                                  26430099
      *  JA0912  -  Audit  CTN  Status  &  SIM-Status                   26431099
262210                                                                  26432099
           IF  SIM-STATUS  IN  LTE-INPUT-AREA  =  'AD'  OR              26433099
                                   'PC'  OR  'GF'  OR  'RT'  OR  'GF'   26434099
260520         GO  TO  4G-UPDATE-EXIT                                   26435099
260520     END-IF                                                       26436099
260480                                                                  26437099
262220     .                                                            26438099
262230 4G-UPDATE-EXIT.     EXIT.                                        26439099
262240                                                                  26440099
262250*  JA0310  -   4G Update - CDVC                                   26441099
262260                                                                  26442099
262270 4G-1000-DETERMINE-CDVC.                                          26443099
262280*----------------------------------------------------------------*26444099
262290**              Determine  If  a  CDVC  is  Needed             ** 26445099
262300**                Called  Via  2100-MDN-MATCH  - Only          ** 26446099
262310*----------------------------------------------------------------*26447099
262320                                                                  26448099
262330     MOVE  SPACES  TO  WS-SELECT-SIM-VORA                         26449099
262340                       WS-VORA-STATUS                             26450099
262350                       WS-SIM-STATUS                              26451099
262360                                                                  26452099
262370**  CDVC  Require  Both  MDN  &  CTN  Data                        26453099
262380                                                                  26454099
262390     IF  MDN-MATCH-FLAG   NOT  =  'Y'                             26455099
262400         GO  TO  4G-1000-EXIT                                     26456099
262410     END-IF                                                       26457099
262420                                                                  26458099
262430     IF  WS-CTNIN-ICC-ID-4G  >  SPACES                            26459099
262440        MOVE  WS-CTNIN-ICC-ID-4G TO ICC-ID-4G  OF  LTE-INPUT-AREA 26460099
262450     END-IF                                                       26461099
262460                                                                  26462099
262470**  Does  Billing  Have  An  IMSI  or  ICC-ID  ?                  26463099
262480     IF  MDNIN-ICC-ID-4G  >  ' '  OR                              26464099
262490         MDNIN-IMSI       >  ' '                                  26465099
262500         CONTINUE                                                 26466099
262510        ELSE                                                      26467099
262520         GO  TO  4G-1000-EXIT                                     26468099
262530     END-IF                                                       26469099
262540                                                                  26470099
262550**  Does  Billing  Have  An  ICC-ID  & Match w/ eTNI ?            26471099
262560     IF  MDNIN-ICC-ID-4G  >  ' '                                  26472099
262570         IF  MDNIN-ICC-ID-4G   =   WS-CTNIN-ICC-ID-4G             26473099
262580             GO  TO  4G-1000-EXIT                                 26474099
262590         END-IF                                                   26475099
262600     END-IF                                                       26476099
262610                                                                  26477099
262620**  Does  Billing  Have  An  IMSI  & Match w/ eTNI ?              26478099
262630     IF  MDNIN-IMSI  >  ' '                                       26479099
262640         IF  MDNIN-IMSI  =  WS-CTNIN-IMSI                         26480099
262650             GO  TO  4G-1000-EXIT                                 26481099
262660        END-IF                                                    26482099
262670     END-IF                                                       26483099
262680                                                                  26484099
262690**  Edit  Error  ?                                                26485099
262700     IF  MDNIN-ICC-ID-4G  >  ' '                                  26486099
262710         IF  WS-CTNIN-ICC-ID-4G  >  ' '                           26487099
262720         IF  MDNIN-ICC-ID-4G  NOT  =   WS-CTNIN-ICC-ID-4G         26488099
262730             GO  TO  4G-1000-EXIT                                 26489099
262740         END-IF                                                   26490099
262750       END-IF                                                     26491099
262760     END-IF                                                       26492099
262770                                                                  26493099
262780**  Edit  Error  ?                                                26494099
262790     IF  MDNIN-IMSI  >  ' '                                       26495099
262800       IF  WS-CTNIN-IMSI  >  ' '                                  26496099
262810         IF  MDNIN-IMSI  NOT  =  WS-CTNIN-IMSI                    26497099
262820             GO  TO  4G-1000-EXIT                                 26498099
262830         END-IF                                                   26499099
262840       END-IF                                                     26500099
262850     END-IF                                                       26501099
262860                                                                  26502099
262870     .                                                            26503099
262880 4G-1000-CONTINUE-10.                                             26504099
262890**  Use  MDNIN  to  Access  SIM  or  VORA                         26505099
262900                                                                  26506099
262910     IF  MDNIN-ICC-ID-4G  >  ' '                                  26507099
262920         MOVE  MDNIN-ICC-ID-4G  TO ICC-ID-4G  OF  LTE-INPUT-AREA  26508099
262930     END-IF                                                       26509099
262940                                                                  26510099
262950     IF  MDNIN-IMSI  >  ' '                                       26511099
262960         MOVE  MDNIN-IMSI TO VORA-IMSI  OF  LTE-INPUT-AREA        26512099
262970     END-IF                                                       26513099
262980                                                                  26514099
262990*  Access  4G  Objects  Per  Billing  Data                        26515099
263000                                                                  26516099
263010     IF  ICC-ID-4G  IN   LTE-INPUT-AREA  >  ' '                   26517099
263020         PERFORM  4G-9000-SELECT-SIM  THRU  4G-9000-EXIT          26518099
263030         MOVE  'Y' TO  WS-SELECT-SIM-VORA                         26519099
263040*        GO  TO  4G-1000-CONTINUE-20                              26520099
263050     END-IF                                                       26521099
263060                                                                  26522099
263070     IF  VORA-IMSI  IN  LTE-INPUT-AREA   >  ' '                   26523099
263080         PERFORM  4G-9100-SELECT-VORA  THRU  4G-9100-EXIT         26524099
263090         MOVE  'Y' TO  WS-SELECT-SIM-VORA                         26525099
263100     END-IF                                                       26526099
263110                                                                  26527099
263120*  Access  4G  Objects  Per  eTNI  Data                           26528099
263130                                                                  26529099
263140     IF  WS-CTNIN-IMSI  >  SPACES                                 26530099
263150         MOVE  WS-CTNIN-IMSI  TO VORA-IMSI  OF  LTE-INPUT-AREA    26531099
263160     END-IF                                                       26532099
263170                                                                  26533099
263180     IF  WS-CTNIN-ICC-ID-4G  >  SPACES                            26534099
263190        MOVE  WS-CTNIN-ICC-ID-4G TO ICC-ID-4G  OF  LTE-INPUT-AREA 26535099
263200     END-IF                                                       26536099
263210                                                                  26537099
263220     IF  MDNIN-ICC-ID-4G  >  ' '  OR                              26538099
263230         WS-CTNIN-ICC-ID-4G  >  ' '                               26539099
263240         IF  MDNIN-ICC-ID-4G  =  WS-CTNIN-ICC-ID-4G               26540099
263250             CONTINUE                                             26541099
263260            ELSE                                                  26542099
263270            IF  WS-CTNIN-ICC-ID-4G  >  SPACES                     26543099
263280                PERFORM  4G-9000-SELECT-SIM  THRU  4G-9000-EXIT   26544099
263290               MOVE  'Y' TO  WS-SELECT-SIM-VORA                   26545099
263300            END-IF                                                26546099
263310         END-IF                                                   26547099
263320     END-IF                                                       26548099
263330                                                                  26549099
263340     IF  MDNIN-IMSI       >  ' '  OR                              26550099
263350           WS-CTNIN-IMSI  >  ' '                                  26551099
263360          IF  MDNIN-IMSI  =  WS-CTNIN-IMSI                        26552099
263370              CONTINUE                                            26553099
263380             ELSE                                                 26554099
263390              IF  WS-CTNIN-IMSI  >  SPACES                        26555099
263400                 PERFORM  4G-9100-SELECT-VORA  THRU  4G-9100-EXIT 26556099
263410                 MOVE  'Y' TO  WS-SELECT-SIM-VORA                 26557099
263420              END-IF                                              26558099
263430          END-IF                                                  26559099
263440     END-IF                                                       26560099
263450                                                                  26561099
263460     .                                                            26562099
263470 4G-1000-CONTINUE-20.                                             26563099
263480                                                                  26564099
263490*  Determine  If  Upgrade of  "TO"  Device...via  Billing         26565099
263500                                                                  26566099
263510     IF  MDNIN-ICC-ID-4G  >  ' '                                  26567099
263520       IF  WS-SIM-STATUS  =  'PC'                                 26568099
263530           PERFORM  4G-8000-CDVC  THRU  4G-8000-EXIT              26569099
263540       END-IF                                                     26570099
263550     END-IF                                                       26571099
263560                                                                  26572099
263570     IF  MDNIN-IMSI  >  ' '                                       26573099
263580       IF  WS-VORA-STATUS  =  'PC'                                26574099
263590           PERFORM  4G-8000-CDVC  THRU  4G-8000-EXIT              26575099
263600       END-IF                                                     26576099
263610     END-IF                                                       26577099
263620                                                                  26578099
263630     .                                                            26579099
263640 4G-1000-EXIT.  EXIT.                                             26580099
263650 4G-8000-CDVC.                                                    26581099
263660*----------------------------------------------------------------*26582099
263670*  Format  CDVC                                                   26583099
263680*----------------------------------------------------------------*26584099
263690                                                                  26585099
263700     INITIALIZE  WS-API-COMMAREA                                  26586099
263710                                                                  26587099
263720     MOVE  'CDVC'     TO  API-ID  IN  CA-INPUT-AREA  IN           26588099
263730                                                  WS-API-COMMAREA 26589099
263740     MOVE  MDNIN-MDN  TO  MDN  IN  CA-INPUT-AREA  IN              26590099
263750                                                  WS-API-COMMAREA 26591099
263760     MOVE  LIT-PGM-ID TO  OPERATOR-ID  IN  CA-INPUT-AREA  IN      26592099
263770                                                  WS-API-COMMAREA 26593099
263780     MOVE  LIT-RECON-ID  TO APPLICATION-ID IN  CA-INPUT-AREA  IN  26594099
263790                                                  WS-API-COMMAREA 26595099
263780*  JA0912 -  Ws-Biller-Id  Below                                  26596099
263780     MOVE  WS-BILLER-ID  TO APPLICATION-ID IN  CA-INPUT-AREA  IN  26597099
263790                                             WS-API-COMMAREA(1:1) 26598099
263800     MOVE  WS-TIMESTAMP  TO ORIGINATION-DT-TM IN CA-INPUT-AREA IN 26599099
263810                                                  WS-API-COMMAREA 26600099
263820**  Determine  Device-Ind  (OLD)                                  26601099
263830                                                                  26602099
263840     IF  WS-CTNIN-ICC-ID-4G  =  SPACES                            26603099
263850         IF  WS-CTNIN-IMSI   =  SPACES                            26604099
263860         MOVE  ' '   TO  DEVICE-IND  IN  CA-INPUT-AREA  IN        26605099
263870                                         WS-API-COMMAREA          26606099
263880         END-IF                                                   26607099
263890     END-IF                                                       26608099
263900                                                                  26609099
263910     IF  WS-CTNIN-ICC-ID-4G  >  SPACES                            26610099
263920         MOVE  'L'   TO  DEVICE-IND  IN  CA-INPUT-AREA  IN        26611099
263930                                         WS-API-COMMAREA          26612099
263940         MOVE  WS-CTNIN-ICC-ID-4G  TO  ICC-ID-4G                  26613099
263950                  IN  CA-INPUT-AREA  IN  WS-API-COMMAREA          26614099
263960     END-IF                                                       26615099
263970                                                                  26616099
263980     IF  WS-CTNIN-IMSI       >  SPACES                            26617099
263990         MOVE  'V'   TO  DEVICE-IND  IN  CA-INPUT-AREA  IN        26618099
264000                                         WS-API-COMMAREA          26619099
264010         MOVE  WS-CTNIN-IMSI       TO  VORA-IMSI                  26620099
264020                  IN  CA-INPUT-AREA  IN  WS-API-COMMAREA          26621099
264030     END-IF                                                       26622099
264040                                                                  26623099
264050**  Determine  New-Device-Ind  (NEW)                              26624099
264060                                                                  26625099
264070     IF  MDNIN-ICC-ID-4G     =  ' '                               26626099
264080         IF  MDNIN-IMSI      =  ' '                               26627099
264090         MOVE  ' '   TO  NEW-DEVICE-IND  IN  CA-INPUT-AREA  IN    26628099
264100                                         WS-API-COMMAREA          26629099
264110         END-IF                                                   26630099
264120     END-IF                                                       26631099
264130                                                                  26632099
264140     IF  MDNIN-ICC-ID-4G     >  ' '                               26633099
264150         MOVE  'L'   TO  NEW-DEVICE-IND  IN  CA-INPUT-AREA  IN    26634099
264160                                         WS-API-COMMAREA          26635099
264170         MOVE  MDNIN-ICC-ID-4G     TO  ICC-ID-4G                  26636099
264180                  IN  CA-INPUT-AREA  IN  WS-API-COMMAREA          26637099
264190     END-IF                                                       26638099
264200                                                                  26639099
264210     IF  MDNIN-IMSI          >  ' '                               26640099
264220         MOVE  'V'   TO  NEW-DEVICE-IND  IN  CA-INPUT-AREA  IN    26641099
264230                                         WS-API-COMMAREA          26642099
264240         MOVE  MDNIN-IMSI          TO  VORA-IMSI                  26643099
264250                  IN  CA-INPUT-AREA  IN  WS-API-COMMAREA          26644099
264260     END-IF                                                       26645099
264280                                                                  26646099
264290     MOVE  WS-CDVC-QUE-LNKG  TO  LS-Q-LNKG                        26647099
264300     MOVE LS-Q-LNKG TO WS-CDVC-QUE-LNKG                           26648099
264310     MOVE LENGTH  OF  CA-INPUT-AREA  IN  WS-API-COMMAREA          26649099
264320                      TO LS-Q-BUFFER-LENGTH                       26650099
264330     SET  Q-PUT   TO  TRUE                                        26651099
264340     MOVE WS-CDVC-QUEUENAME  TO LS-Q-NAME                         26652099
264350     MOVE MQPMO-NONE TO LS-Q-OPTIONS                              26653099
264360     MOVE MQMI-NONE  TO LS-Q-CORRELID                             26654099
264370                                                                  26655099
264380     CALL WS-MQ-SUB USING LS-Q-LNKG,                              26656099
264390                          CA-INPUT-AREA  IN  WS-API-COMMAREA      26657099
264400     IF NOT Q-SUCCESS                                             26658099
264410        MOVE LS-Q-REAS-CD                                         26659099
264420              TO WS-REASON                                        26660099
264430                                                                  26661099
264440        MOVE SPACES                                               26662099
264450              TO SD-MESSAGE OF STATUS-DESCR-AREA                  26663099
264460                 SIM-STATUS-DESCR OF SIM-OUTPUT-AREA              26664099
264470                                                                  26665099
264480**  JA1012   -  Remove  CCE3                                      26666099
264480**      MOVE SC-MQ-SERIES-PUT1-ERROR                              26667099
264490**            TO SIM-STATUS-CD OF SIM-OUTPUT-AREA                 26668099
264500        MOVE 'ERROR WITH MQ-SERIES  MQPUT1'                       26669099
264510              TO SD-MSG-TXT                                       26670099
264520        STRING                                                    26671099
264530             'MQPUT  FAILURE IN 4G-8000-CDVC'                     26672099
264540             ' REASON CODE :<'                                    26673099
264550             WS-REASON                                            26674099
264560             '>'                                                  26675099
264570             DELIMITED BY SIZE                                    26676099
264580             INTO SD-DYNAMIC-TXT                                  26677099
264590        END-STRING                                                26678099
264600        MOVE STATUS-DESCR-AREA                                    26679099
264610          TO SIM-STATUS-DESCR OF SIM-OUTPUT-AREA                  26680099
264620        GO  TO  4G-8000-EXIT                                      26681099
264630     END-IF                                                       26682099
264640                                                                  26683099
264650     SET  WS-4G-CDVC-YES  TO  TRUE                                26684099
264660     ADD  +1  TO  WS-TOTL-CDVC-GENERATED                          26685099
264670                                                                  26686099
264680*  JA0511  -  Log  MQ  Update                                     26687099
264690     ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                             26688099
264700                                                                  26689099
264710     .                                                            26690099
264720 4G-8000-EXIT.  EXIT.                                             26691099
264730                                                                  26692099
264740 4G-9000-SELECT-SIM.                                              26693099
264750*----------------------------------------------------------------*26694099
264760*  Process  SIM  Select                                           26695099
264770*----------------------------------------------------------------*26696099
264780     SET  SEL-SIM   OF WS-LTE-DATA-LAYER  TO TRUE                 26697099
264790                                                                  26698099
264800     CALL WS-SIM-INV-ETLSC10                                      26699099
264810          USING  WS-LTE-DATA-LAYER                                26700099
264820              ON EXCEPTION                                        26701099
264830                DISPLAY '*4G-EXCEPTION2  - Calling  ETLSC10'      26702099
264840                SET   WS-4G-ERROR-YES  TO  TRUE                   26703099
264850     END-CALL                                                     26704099
264860*                                                                 26705099
264870*  Process  SIM  Failed  Access -                                 26706099
264880*                                                                 26707099
264890     IF  LTE-STATUS-CD  IN  LTE-OUTPUT-AREA  >  '00000'           26708099
264900         SET   WS-4G-ERROR-YES  TO  TRUE                          26709099
264910         MOVE  LIT-SIM-VORA-ERROR    TO   WS-COMMENT              26710099
264920         ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                        26711099
264930         INITIALIZE  DETAIL-LINE-1                                26712099
264940         MOVE  'SIM '   TO  DETAIL-1-SYSTEM                       26713099
264950         MOVE  WS-CTNIN-4TH-G  TO  DETAIL-1-MDN                   26714099
264960     END-IF                                                       26715099
264970                                                                  26716099
264980     IF  LTE-STATUS-CD  IN  LTE-OUTPUT-AREA  =  '00000'           26717099
264990         MOVE  SIM-STATUS IN LTE-OUTPUT-AREA  TO  WS-SIM-STATUS   26718099
265000     END-IF                                                       26719099
265010     .                                                            26720099
265020 4G-9000-SELECT-SIM-10.                                           26721099
265030                                                                  26722099
265040     INITIALIZE SQLCODE                                           26723099
265050                SYS-UPDATE-DATE  IN  DCLSIM-INV                   26724099
265060                                                                  26725099
265070     MOVE  ICC-ID-4G  IN  LTE-INPUT-AREA  TO                      26726099
265080           ICC-ID-4G  IN  DCLSIM-INV                              26727099
265090                                                                  26728099
265100     EXEC SQL                                                     26729099
265110                                                                  26730099
265120        SELECT                                                    26731099
265130             SYS_UPDATE_DATE,                                     26732099
265140             SIM_STATUS                                           26733099
265150          INTO                                                    26734099
265160             :DCLSIM-INV.SYS-UPDATE-DATE,                         26735099
265170             :DCLSIM-INV.SIM-STATUS                               26736099
265180          FROM SIM_INV                                            26737099
265190                 WHERE ICC_ID_4G = :DCLSIM-INV.ICC-ID-4G          26738099
265200          WITH UR                                                 26739099
265210                                                                  26740099
265220     END-EXEC                                                     26741099
265230                                                                  26742099
265250     .                                                            26743099
265260 4G-9000-EXIT.  EXIT.                                             26744099
265270                                                                  26745099
265280 4G-9100-SELECT-VORA.                                             26746099
265290*----------------------------------------------------------------*26747099
265300*  Process  VORA  Select                                          26748099
265310*----------------------------------------------------------------*26749099
265320     SET  SEL-VORA  OF WS-LTE-DATA-LAYER  TO TRUE                 26750099
265330                                                                  26751099
265340     CALL WS-VORA-INV-ETLSC11                                     26752099
265350          USING   WS-LTE-DATA-LAYER                               26753099
265360              ON EXCEPTION                                        26754099
265370              DISPLAY '*4G-EXCEPTION5  - Calling  ETLSC11'        26755099
265380          SET   WS-4G-ERROR-YES  TO  TRUE                         26756099
265390     END-CALL                                                     26757099
265400                                                                  26758099
265410*  Check  Return  Code                                            26759099
265420*                                                                 26760099
265430     IF  LTE-STATUS-CD  IN  LTE-OUTPUT-AREA  >  '00000'           26761099
265440         DISPLAY  '* MDN / ICC-ID-4G / IMSI *  '                  26762099
265450                 WS-CTNIN-4TH-G  ' / '                            26763099
265460                 ICC-ID-4G  IN  LTE-INPUT-AREA  ' / '             26764099
265470                 VORA-IMSI  IN  LTE-INPUT-AREA                    26765099
265480         DISPLAY  'LTE-STATUS-CD / DESCR '                        26766099
265490            LTE-STATUS-CD  IN  LTE-OUTPUT-AREA   ' / '            26767099
265500            LTE-STATUS-DESCR  IN  LTE-OUTPUT-AREA                 26768099
265510         SET   WS-4G-ERROR-YES  TO  TRUE                          26769099
265520         MOVE  2  TO  WS-RETURN-CODE                              26770099
265530     END-IF                                                       26771099
265540*                                                                 26772099
265550*  Process  VORA  Failed  Access                                  26773099
265560*                                                                 26774099
265570     IF  LTE-STATUS-CD  IN  LTE-OUTPUT-AREA  >  '00000'           26775099
265580         SET   WS-4G-ERROR-YES  TO  TRUE                          26776099
265590         MOVE  LIT-SIM-VORA-ERROR    TO   WS-COMMENT              26777099
265600         ADD  +1  TO  WS-TOTL-SIM-VORA-ERR                        26778099
265610         INITIALIZE  DETAIL-LINE-1                                26779099
265620         MOVE  'VORA'   TO  DETAIL-1-SYSTEM                       26780099
265630         MOVE  WS-CTNIN-4TH-G  TO  DETAIL-1-MDN                   26781099
265640     END-IF                                                       26782099
265650                                                                  26783099
265660     IF  LTE-STATUS-CD  IN  LTE-OUTPUT-AREA  =  '00000'           26784099
265670         MOVE  IMSI-STATUS IN LTE-OUTPUT-AREA  TO  WS-VORA-STATUS 26785099
265680     END-IF                                                       26786099
265690     .                                                            26787099
265700 4G-9100-SELECT-VORA-10.                                          26788099
265710                                                                  26789099
265720     INITIALIZE SQLCODE                                           26790099
265730                SYS-UPDATE-DATE  IN  DCLVORA-IMSI-INV             26791099
265740                                                                  26792099
265750     MOVE  VORA-IMSI  IN  LTE-INPUT-AREA  TO                      26793099
265760           VORA-IMSI  IN  DCLVORA-IMSI-INV                        26794099
265770                                                                  26795099
265780     EXEC SQL                                                     26796099
265790                                                                  26797099
265800        SELECT                                                    26798099
265810             SYS_UPDATE_DATE,                                     26799099
265820             IMSI_STATUS                                          26800099
265830          INTO                                                    26801099
265840             :DCLVORA-IMSI-INV.SYS-UPDATE-DATE,                   26802099
265850             :DCLVORA-IMSI-INV.IMSI-STATUS                        26803099
265860          FROM VORA_IMSI_INV                                      26804099
265870          WHERE VORA_IMSI        = :DCLVORA-IMSI-INV.VORA-IMSI    26805099
265880          WITH UR                                                 26806099
265890                                                                  26807099
265900     END-EXEC                                                     26808099
265910                                                                  26809099
265920     .                                                            26810099
265930 4G-9100-EXIT.  EXIT.                                             26811099
265940                                                                  26812099
265950 4G-48000-CALL-ETLSC08.                                           26813099
265960*----------------------------------------------------------------*26814099
265970*    PARAGRAPH NAME:      4G-48000-CALL-ETLSC08                   26815099
265980*                         Insert  into  SIM-INV-HISTORY           26816099
265990*----------------------------------------------------------------*26817099
266000     MOVE '4G-48000-CALL-ETLSC08 '                                26818099
266010       TO WS-CURR-PARA                                            26819099
266020                                                                  26820099
266030**  Insert  Into  SIM-INV-HISTORY                                 26821099
266040                                                                  26822099
266050     INITIALIZE  LTE-INPUT-AREA                                   26823099
266060                                                                  26824099
266070*  JA0612                                                         26825099
266080     IF  MDN-MATCH-FLAG  =  'Y'  OR                               26826099
266090         MDN-NOT-IN-ETNI-FLAG  =  'Y'                             26827099
266100         MOVE MDNIN-ICC-ID-4G  TO ICC-ID-4G OF  LTE-INPUT-AREA    26828099
266110     END-IF                                                       26829099
266120                                                                  26830099
266130     IF  MDN-NOT-IN-BILL-FLAG  =  'Y'                             26831099
266140         MOVE WS-CTNIN-ICC-ID-4G  TO ICC-ID-4G OF  LTE-INPUT-AREA 26832099
266150     END-IF                                                       26833099
266160                                                                  26834099
266170     SET  LTE-INSERT   OF WS-LTE-DATA-LAYER  TO TRUE              26835099
266180                                                                  26836099
266190     CALL WS-SIM-INV-HIST-ETLSC08  USING                          26837099
266200                                   WS-LTE-DATA-LAYER              26838099
266210          ON EXCEPTION                                            26839099
266220              MOVE SPACES                                         26840099
266230                TO SD-MESSAGE                                     26841099
266240                   API-STATUS-DESCR                               26842099
266250              MOVE '90010'                                        26843099
266260                TO API-STATUS-CD                                  26844099
266270                   STRING                                         26845099
266280                      'CALL FAIL TO ETNSC08 FROM ETNBC16'         26846099
266290                      DELIMITED BY SIZE                           26847099
266300                      INTO API-STATUS-DESCR                       26848099
266310                   END-STRING                                     26849099
266320                 GO  TO  4G-48000-EXIT                            26850099
266330     END-CALL                                                     26851099
266340                                                                  26852099
266350     MOVE  LTE-SQLCODE  TO  WS-SQLCODE                            26853099
266360                            WS-SQLCODE-DS                         26854099
266370                                                                  26855099
266380     IF  LTE-SQLCODE  =  ZERO                                     26856099
266390         MOVE '00000' TO API-STATUS-CD OF CA-OUTPUT-AREA          26857099
266400          ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                        26858099
266410                                                                  26859099
266420         ELSE                                                     26860099
266430                                                                  26861099
264480**  JA1012   -  Remove  CCE3                                      26862099
266440**        MOVE  SC-INSERT-FAIL-SIM-INV-HISTORY                    26863099
266450**                     TO  API-STATUS-CD OF CA-OUTPUT-AREA        26864099
266460**        STRING                                                  26865099
266470**                     'SQLCODE='              DELIMITED BY SIZE  26866099
266480**                      WS-SQLCODE-DS          DELIMITED BY SIZE  26867099
266490**                      ',ICC='                DELIMITED BY SIZE  26868099
266500**             ICC-ID-4G OF CA-INPUT-AREA DELIMITED BY SIZE       26869099
266510**                 INTO  SX-INSERT-FAIL-SIM-INV-HISTORY           26870099
266520**           END-STRING                                           26871099
266530                                                                  26872099
266540          STRING                                                  26873099
266550                 'Insert to SIM Inv-Hist  failed '                26874099
266470                       'SQLCODE= '             DELIMITED BY SIZE  26875099
266480                        WS-SQLCODE-DS          DELIMITED BY SIZE  26876099
266490                        ',ICC= '               DELIMITED BY SIZE  26877099
266500               ICC-ID-4G OF CA-INPUT-AREA DELIMITED BY SIZE       26878099
266570                   INTO  SD-MESSAGE                               26879099
266580          END-STRING                                              26880099
266590          MOVE  SD-MESSAGE                                        26881099
266600                     TO  API-STATUS-DESCR OF CA-OUTPUT-AREA       26882099
266610          GO TO 4G-48000-EXIT                                     26883099
266620     END-IF                                                       26884099
266630      .                                                           26885099
266640 4G-48000-EXIT.                                                   26886099
266650      EXIT.                                                       26887099
266660                                                                  26888099
266670 4G-48500-CALL-ETLSC08.                                           26889099
266680*----------------------------------------------------------------*26890099
266690*    PARAGRAPH NAME:      4G-48500-CALL-ETLSC08                   26891099
266700*                         Insert  into  SIM-INV-HISTORY           26892099
266710*                         Per  CTN                                26893099
266720*----------------------------------------------------------------*26894099
266730     MOVE '4G-48500-CALL-ETLSC08 '                                26895099
266740       TO WS-CURR-PARA                                            26896099
266750                                                                  26897099
266760**  Insert  Into  SIM-INV-HISTORY                                 26898099
266770                                                                  26899099
266780     INITIALIZE  LTE-INPUT-AREA                                   26900099
266790                                                                  26901099
266800     MOVE WS-CTNIN-ICC-ID-4G                                      26902099
266810       TO ICC-ID-4G OF  LTE-INPUT-AREA                            26903099
266820                                                                  26904099
266830     SET  LTE-INSERT   OF WS-LTE-DATA-LAYER  TO TRUE              26905099
266840                                                                  26906099
266850     CALL WS-SIM-INV-HIST-ETLSC08  USING                          26907099
266860                                   WS-LTE-DATA-LAYER              26908099
266870          ON EXCEPTION                                            26909099
266880              MOVE SPACES                                         26910099
266890                TO SD-MESSAGE                                     26911099
266900                   API-STATUS-DESCR                               26912099
266910              MOVE '90010'                                        26913099
266920                TO API-STATUS-CD                                  26914099
266930                   STRING                                         26915099
266940                      'CALL FAIL TO ETNSC08 FROM ETNBC16'         26916099
266950                      DELIMITED BY SIZE                           26917099
266960                      INTO API-STATUS-DESCR                       26918099
266970                   END-STRING                                     26919099
266980                 GO  TO  4G-48500-EXIT                            26920099
266990     END-CALL                                                     26921099
267000                                                                  26922099
267010     MOVE  LTE-SQLCODE  TO  WS-SQLCODE                            26923099
267020                            WS-SQLCODE-DS                         26924099
267030                                                                  26925099
267040     IF  LTE-SQLCODE  =  ZERO                                     26926099
267050         MOVE '00000' TO API-STATUS-CD OF CA-OUTPUT-AREA          26927099
267060          ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                        26928099
267070                                                                  26929099
267080         ELSE                                                     26930099
267090                                                                  26931099
267100**  JA1012  -  Remove  CCE3  -     bye                            26932099
267090                                                                  26933099
267100**        MOVE  SC-INSERT-FAIL-SIM-INV-HISTORY                    26934099
267110**                     TO  API-STATUS-CD OF CA-OUTPUT-AREA        26935099
267120          STRING  'Insert to SIM Inv-Hist  failed '               26936099
267130                       'SQLCODE= '              DELIMITED BY SIZE 26937099
267140                        WS-SQLCODE-DS           DELIMITED BY SIZE 26938099
267150                        ',ICC= '                DELIMITED BY SIZE 26939099
267160               ICC-ID-4G OF CA-INPUT-AREA DELIMITED BY SIZE       26940099
267170                   INTO  SD-MESSAGE                               26941099
267180          END-STRING                                              26942099
267190                                                                  26943099
267250          MOVE  SD-MESSAGE                                        26944099
267260                     TO  API-STATUS-DESCR OF CA-OUTPUT-AREA       26945099
267270          GO TO 4G-48500-EXIT                                     26946099
267280     END-IF                                                       26947099
267290      .                                                           26948099
267300 4G-48500-EXIT.                                                   26949099
267310      EXIT.                                                       26950099
267320                                                                  26951099
267330 4G-49000-CALL-ETLSC09.                                           26952099
267340*----------------------------------------------------------------*26953099
267350*    PARAGRAPH NAME:      4G-49000-CALL-ETLSC09                   26954099
267360*----------------------------------------------------------------*26955099
267370     MOVE '4G-49000-CALL-ETLSC09 '                                26956099
267380       TO WS-CURR-PARA                                            26957099
267390                                                                  26958099
267400**  Insert  Into  VORA-IMSI-INV-HISTORY                           26959099
267410                                                                  26960099
267420     INITIALIZE  LTE-INPUT-AREA                                   26961099
267430                                                                  26962099
267440     MOVE  MDNIN-IMSI   TO  IMSI       OF  DCLCTN-INV             26963099
267450                            VORA-IMSI OF  LTE-INPUT-AREA          26964099
267460                                                                  26965099
267470     SET  LTE-INSERT   OF WS-LTE-DATA-LAYER  TO TRUE              26966099
267480                                                                  26967099
267490     CALL  WS-VORA-INV-HIST-ETLSC09  USING                        26968099
267500                                 WS-LTE-DATA-LAYER                26969099
267510           ON EXCEPTION                                           26970099
267520              MOVE SPACES                                         26971099
267530                TO SD-MESSAGE                                     26972099
267540                   API-STATUS-DESCR                               26973099
267550              MOVE '90010'                                        26974099
267560                TO API-STATUS-CD                                  26975099
267570                   STRING                                         26976099
267580                      'CALL FAIL TO ETNSC09 FROM ETNBC16'         26977099
267590                      DELIMITED BY SIZE                           26978099
267600                      INTO API-STATUS-DESCR                       26979099
267610                   END-STRING                                     26980099
267620                 GO  TO  4G-49000-EXIT                            26981099
267630     END-CALL                                                     26982099
267640                                                                  26983099
267650     MOVE  LTE-SQLCODE  TO  WS-SQLCODE                            26984099
267660                            WS-SQLCODE-DS                         26985099
267670                                                                  26986099
267680     IF  LTE-SQLCODE  =  ZERO                                     26987099
267690             MOVE '00000' TO API-STATUS-CD OF CA-OUTPUT-AREA      26988099
267700          ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                        26989099
267710                                                                  26990099
267720         ELSE                                                     26991099
267730                                                                  26992099
267740**   JA1012 - Remove  CCE3                                        26993099
267730                                                                  26994099
267740**           MOVE  SC-INSERT-FAIL-VORA-HISTORY                    26995099
267750**                     TO  API-STATUS-CD OF CA-OUTPUT-AREA        26996099
267760             STRING  'Insert to VORA Hist  failed '               26997099
267770                       'SQLCODE= '             DELIMITED BY SIZE  26998099
267780                        WS-SQLCODE-DS          DELIMITED BY SIZE  26999099
267790                        ',VORA= '              DELIMITED BY SIZE  27000099
267800               VORA-IMSI  OF CA-INPUT-AREA DELIMITED BY SIZE      27001099
267860                   INTO  SD-MESSAGE                               27002099
267870             END-STRING                                           27003099
267880             MOVE  SD-MESSAGE                                     27004099
267890                     TO  API-STATUS-DESCR OF CA-OUTPUT-AREA       27005099
267900             GO TO 4G-49000-EXIT                                  27006099
267910     END-IF                                                       27007099
267920      .                                                           27008099
267930 4G-49000-EXIT.                                                   27009099
267940      EXIT.                                                       27010099
267960                                                                  27011099
267970 4G-49500-CALL-ETLSC09.                                           27012099
267980*----------------------------------------------------------------*27013099
267990*    PARAGRAPH NAME:      4G-49500-CALL-ETLSC09                   27014099
268000*                         based  upon  CTN                        27015099
268010*----------------------------------------------------------------*27016099
268020     MOVE '4G-49500-CALL-ETLSC09 '                                27017099
268030       TO WS-CURR-PARA                                            27018099
268040                                                                  27019099
268050**  Insert  Into  VORA-IMSI-INV-HISTORY                           27020099
268060                                                                  27021099
268070     INITIALIZE  LTE-INPUT-AREA                                   27022099
268080                                                                  27023099
268090     MOVE  WS-CTNIN-IMSI  TO  IMSI       OF  DCLCTN-INV           27024099
268100                            VORA-IMSI OF  LTE-INPUT-AREA          27025099
268110                                                                  27026099
268120     SET  LTE-INSERT   OF WS-LTE-DATA-LAYER  TO TRUE              27027099
268130                                                                  27028099
268140     CALL  WS-VORA-INV-HIST-ETLSC09  USING                        27029099
268150                                 WS-LTE-DATA-LAYER                27030099
268160           ON EXCEPTION                                           27031099
268170              MOVE SPACES                                         27032099
268180                TO SD-MESSAGE                                     27033099
268190                   API-STATUS-DESCR                               27034099
268200              MOVE '90010'                                        27035099
268210                TO API-STATUS-CD                                  27036099
268220                   STRING                                         27037099
268230                      'CALL FAIL TO ETNSC09 FROM ETNBC16'         27038099
268240                      DELIMITED BY SIZE                           27039099
268250                      INTO API-STATUS-DESCR                       27040099
268260                   END-STRING                                     27041099
268270                 GO  TO  4G-49500-EXIT                            27042099
268280     END-CALL                                                     27043099
268290                                                                  27044099
268300     MOVE  LTE-SQLCODE  TO  WS-SQLCODE                            27045099
268310                            WS-SQLCODE-DS                         27046099
268320                                                                  27047099
268330     IF  LTE-SQLCODE  =  ZERO                                     27048099
268340             MOVE '00000' TO API-STATUS-CD OF CA-OUTPUT-AREA      27049099
268350          ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                        27050099
268360                                                                  27051099
268370         ELSE                                                     27052099
268380                                                                  27053099
267740**   JA1012 - Remove  CCE3                                        27054099
267730                                                                  27055099
267740**           MOVE  SC-INSERT-FAIL-VORA-HISTORY                    27056099
267750**                     TO  API-STATUS-CD OF CA-OUTPUT-AREA        27057099
267760             STRING  'Insert to VORA Hist  failed '               27058099
267770                       'SQLCODE= '             DELIMITED BY SIZE  27059099
267780                        WS-SQLCODE-DS          DELIMITED BY SIZE  27060099
267790                        ',VORA= '              DELIMITED BY SIZE  27061099
267800               VORA-IMSI  OF CA-INPUT-AREA DELIMITED BY SIZE      27062099
267860                   INTO  SD-MESSAGE                               27063099
267870             END-STRING                                           27064099
267880             MOVE  SD-MESSAGE                                     27065099
267890                     TO  API-STATUS-DESCR OF CA-OUTPUT-AREA       27066099
268550             GO TO 4G-49500-EXIT                                  27067099
268560     END-IF                                                       27068099
268570      .                                                           27069099
268580 4G-49500-EXIT.                                                   27070099
268590      EXIT.                                                       27071099
268600                                                                  27072099
268610 4G-50000-SIM-UPDATE.                                             27073099
268620*----------------------------------------------------------------*27074099
268630*    PARAGRAPH NAME:      4G-50000-SIM-UPDATE                     27075099
268640*                         Update  SIM-INV                         27076099
268650*----------------------------------------------------------------*27077099
268660     MOVE '4G-50000-SIM-UPDATE  '                                 27078099
268670       TO WS-CURR-PARA                                            27079099
268680                                                                  27080099
268690     MOVE  SPACES  TO  WS-SIM-UPD-SW                              27081099
268700                                                                  27082099
268710**  Establish  Specific  Type  of  SIM-INV  Update                27083099
268720                                                                  27084099
268730     MOVE MDNIN-ICC-ID-4G                                         27085099
268740       TO ICC-ID-4G      OF DCLSIM-INV                            27086099
268750                                                                  27087099
268760     MOVE MDNIN-MDN                                               27088099
268770       TO MDN            OF DCLSIM-INV                            27089099
268780                                                                  27090099
268790     MOVE LIT-PGM-ID                                              27091099
268800       TO OPERATOR-ID    OF DCLSIM-INV                            27092099
268810                                                                  27093099
268820     MOVE  LIT-RECON-ID                                           27094099
268830       TO APPLICATION-ID OF DCLSIM-INV                            27095099
268840                                                                  27096099
268850     INITIALIZE SQLCODE                                           27097099
268860                                                                  27098099
268870     EXEC SQL                                                     27099099
268880          SET :DCLSIM-INV.SYS-UPDATE-DATE  =  CURRENT TIMESTAMP + 27100099
268890                                             :WS-HRS HOURS        27101099
268900     END-EXEC                                                     27102099
268910                                                                  27103099
268920     EXEC SQL                                                     27104099
268930                                                                  27105099
268940        UPDATE SIM_INV                                            27106099
268950                                                                  27107099
268960           SET  SYS_UPDATE_DATE  = :DCLSIM-INV.SYS-UPDATE-DATE,   27108099
268970                SIM_STATUS       = :MDNIN-MDN-STATUS,             27109099
268980                OPERATOR_ID      = :DCLSIM-INV.OPERATOR-ID,       27110099
268990                APPLICATION_ID   = :DCLSIM-INV.APPLICATION-ID     27111099
269000                                                                  27112099
269010          WHERE ICC_ID_4G        = :DCLSIM-INV.ICC-ID-4G          27113099
269020            AND  SIM_STATUS      = :WS-CTNIN-CTN-STATUS           27114099
269030            AND MDN              = :DCLSIM-INV.MDN                27115099
269040                                                                  27116099
269050     END-EXEC                                                     27117099
269060                                                                  27118099
269070     MOVE SQLCODE TO WS-SQLCODE                                   27119099
269080     MOVE WS-SQLCODE TO WS-SQLCODE-DS                             27120099
269090                                                                  27121099
269100     IF  WS-SQLCODE  NOT  =  +0                                   27122099
269110                                                                  27123099
269120**   JA1012 -  Remove  CCE3                                       27124099
269120             STRING    ' UPDATE FAILED SIM-INV '                  27125099
269150                       'SQLCODE= '             DELIMITED BY SIZE  27126099
269160                        WS-SQLCODE-DS          DELIMITED BY SIZE  27127099
269170                        ',SIM= '               DELIMITED BY SIZE  27128099
269180                ICC-ID-4G  IN  CA-INPUT-AREA  OF  WS-API-COMMAREA 27129099
269190                                               DELIMITED BY SIZE  27130099
269260                   INTO  SD-MESSAGE                               27131099
269270             END-STRING                                           27132099
269280             MOVE  SD-MESSAGE                                     27133099
269290                     TO  API-STATUS-DESCR OF CA-OUTPUT-AREA       27134099
269300             SET   WS-4G-ERROR-YES  TO  TRUE                      27135099
269310                                                                  27136099
269320         GO TO 4G-50000-EXIT                                      27137099
269330     END-IF                                                       27138099
269340                                                                  27139099
           SET  WS-4G-SIM-YES  TO  TRUE                                 27140099
269360     ADD +1 TO WS-TOTL-SIM-UPD                                    27141099
269370      .                                                           27142099
269380 4G-50000-EXIT.                                                   27143099
269390      EXIT.                                                       27144099
269400                                                                  27145099
269410 4G-50100-SIM-HIST.                                               27146099
269420*----------------------------------------------------------------*27147099
269421*    PARAGRAPH NAME:      4G-50100-SIM-HIST                       27148099
269422*                         Select  SIM-INV-HIST  for 'AD'          27149099
269423*----------------------------------------------------------------*27150099
269424     MOVE '4G-50100-SIM-HIST    '                                 27151099
269425       TO WS-CURR-PARA                                            27152099
269426                                                                  27153099
269427     MOVE  ZEROES             TO   WS-SIM-HIST-COUNT              27154099
269428                                                                  27155099
269429     EXEC SQL                                                     27156099
269430      SELECT COUNT(*)                                             27157099
269431        INTO                                                      27158099
269432        :WS-SIM-HIST-COUNT                                        27159099
269433        FROM   SIM_INV_HISTORY                                    27160099
269434        WHERE ICC_ID_4G        = :DCLSIM-INV.ICC-ID-4G            27161099
269435         AND  SIM_STATUS       = 'AD'                             27162099
269436        WITH  UR                                                  27163099
269437                                                                  27164099
269438     END-EXEC.                                                    27165099
269439                                                                  27166099
269440     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    27167099
269441                                                                  27168099
269442      .                                                           27169099
269443 4G-50100-EXIT.                                                   27170099
269444      EXIT.                                                       27171099
269445                                                                  27172099
       4G-50200-SIM-CTN-UPDATE.                                         27173099
269447*----------------------------------------------------------------*27174099
269448*    PARAGRAPH NAME:      4G-50200-SIM-CTN-UPDATE                 27175099
269449*                         Update  SIM-INV                         27176099
269450*----------------------------------------------------------------*27177099
269449*>>  Note:  This  is  a "Forced  Update",  without  Regard  to    27178099
269449*>>                     "ETNBC16-4G-MATCH"  Param                 27179099
269450*----------------------------------------------------------------*27180099
269451     MOVE '4G-50200-SIM-CTN-UPDATE  '                             27181099
269452       TO WS-CURR-PARA                                            27182099
269453                                                                  27183099
269454     MOVE  SPACES  TO  WS-SIM-UPD-SW                              27184099
269455                                                                  27185099
269456**  Establish  Specific  Type  of  SIM-INV  Update                27186099
269457                                                                  27187099
269458     MOVE WS-CTNIN-ICC-ID-4G                                      27188099
269459       TO ICC-ID-4G      OF DCLSIM-INV                            27189099
269460                                                                  27190099
269461**  JA0912  -  Cond,  In case of Future Use                       27191099
269461     IF   MDN-MATCH-FLAG  =  'Y'                                  27192099
269461          MOVE MDNIN-MDN                                          27193099
269462               TO MDN            OF DCLSIM-INV                    27194099
269463                                 WS-MDN-10                        27195099
269463         ELSE                                                     27196099
269461          MOVE WS-CTNIN-CTN-TEXT                                  27197099
269462               TO MDN            OF DCLSIM-INV                    27198099
269463                                 WS-MDN-10                        27199099
269463     END-IF                                                       27200099
269464                                                                  27201099
269465     MOVE LIT-PGM-ID                                              27202099
269466       TO OPERATOR-ID    OF DCLSIM-INV                            27203099
269467                                                                  27204099
269468     MOVE  LIT-RECON-ID                                           27205099
269469       TO APPLICATION-ID OF DCLSIM-INV                            27206099
269470                                                                  27207099
269471     INITIALIZE SQLCODE                                           27208099
269472                                                                  27209099
269473     EXEC SQL                                                     27210099
269474          SET :DCLSIM-INV.SYS-UPDATE-DATE  =  CURRENT TIMESTAMP + 27211099
269475                                             :WS-HRS HOURS        27212099
269476     END-EXEC                                                     27213099
269477                                                                  27214099
269478     IF WS-SIM-HIST-COUNT  >  0                                   27215099
269481        MOVE  'AD'  TO  WS-SIM-INV-STATUS                         27216099
269480       ELSE                                                       27217099
269481        MOVE  'AA'  TO  WS-SIM-INV-STATUS                         27218099
269482     END-IF                                                       27219099
269483                                                                  27220099
269484     EXEC SQL                                                     27221099
269485                                                                  27222099
269486        UPDATE SIM_INV                                            27223099
269487                                                                  27224099
269488           SET  SYS_UPDATE_DATE  = :DCLSIM-INV.SYS-UPDATE-DATE,   27225099
269489                SIM_STATUS       = :WS-SIM-INV-STATUS,            27226099
269490                OPERATOR_ID      = :DCLSIM-INV.OPERATOR-ID,       27227099
269491                MDN              = :WS-SPACES-10,                 27228099
269492                APPLICATION_ID   = :DCLSIM-INV.APPLICATION-ID     27229099
269493                                                                  27230099
269498          WHERE ICC_ID_4G        = :DCLSIM-INV.ICC-ID-4G          27231099
269499            AND  SIM_STATUS      = 'AA'                           27232099
269500            AND MDN              = :WS-MDN-10                     27233099
269497*  JA0912                                                         27234099
269497          OR                                                      27235099
269498                ICC_ID_4G        = :DCLSIM-INV.ICC-ID-4G          27236099
269499            AND  SIM_STATUS      = 'AG'                           27237099
269500            AND MDN              = :WS-MDN-10                     27238099
269497*  JA0912                                                         27239099
269497          OR                                                      27240099
269498                ICC_ID_4G        = :DCLSIM-INV.ICC-ID-4G          27241099
269499            AND  SIM_STATUS      = 'AR'                           27242099
269500            AND MDN              = :WS-MDN-10                     27243099
269497*  JA0912                                                         27244099
269497          OR                                                      27245099
269498                ICC_ID_4G        = :DCLSIM-INV.ICC-ID-4G          27246099
269499            AND  SIM_STATUS      = 'PA'                           27247099
269500            AND MDN              = :WS-MDN-10                     27248099
269497*  JA0912                                                         27249099
269497          OR                                                      27250099
269498                ICC_ID_4G        = :DCLSIM-INV.ICC-ID-4G          27251099
269499            AND  SIM_STATUS      = 'PC'                           27252099
269500            AND MDN              = :WS-MDN-10                     27253099
269501                                                                  27254099
269502     END-EXEC                                                     27255099
269503                                                                  27256099
269504     MOVE SQLCODE TO WS-SQLCODE                                   27257099
269505     MOVE WS-SQLCODE TO WS-SQLCODE-DS                             27258099
269506                                                                  27259099
269507     IF  WS-SQLCODE  NOT  =  +0                                   27260099
269508                                                                  27261099
269120**   JA1012 -  Remove  CCE3                                       27262099
269120             STRING    ' UPDATE FAILED SIM-INV '                  27263099
269150                       'SQLCODE= '             DELIMITED BY SIZE  27264099
269160                        WS-SQLCODE-DS          DELIMITED BY SIZE  27265099
269170                        ',SIM= '               DELIMITED BY SIZE  27266099
269180                ICC-ID-4G  IN  CA-INPUT-AREA  OF  WS-API-COMMAREA 27267099
269190                                               DELIMITED BY SIZE  27268099
269260                   INTO  SD-MESSAGE                               27269099
269270             END-STRING                                           27270099
269300             SET   WS-4G-ERROR-YES  TO  TRUE                      27271099
269310                                                                  27272099
269525             MOVE  SD-MESSAGE                                     27273099
269526                     TO  API-STATUS-DESCR OF CA-OUTPUT-AREA       27274099
269528                                                                  27275099
269529         GO TO 4G-50200-EXIT                                      27276099
269530     END-IF                                                       27277099
269531                                                                  27278099
269532     SET  WS-4G-SIM-YES  TO  TRUE                                 27279099
269533     ADD +1 TO  WS-TOTL-SIM-UPD                                   27280099
269531                                                                  27281099
269534**  JA0912  -  Comments  Below                                    27282099
269531                                                                  27283099
269534**   MOVE  SPACES  TO  ICC-ID-4G  IN  DCLCTN-INV                  27284099
269535**                                                                27285099
269536**   IF  MODIFIED-MIN-STATUS  NOT  =  'AP'                        27286099
269537**     EXEC SQL                                                   27287099
269538**          UPDATE CTN_INV                                        27288099
269539**          SET                                                   27289099
269540**          ICC_ID_4G       =  :DCLCTN-INV.ICC-ID-4G              27290099
269550**      WHERE                                                     27291099
269551**          CTN             =  :WS-MDN                            27292099
269552**      END-EXEC                                                  27293099
269553**                                                                27294099
269554**      PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                 27295099
269555**      IF SQL-SUCCESS                                            27296099
269556**         CONTINUE                                               27297099
269557**        ELSE                                                    27298099
269558**        SET WS-ERROR-FIELDS-FOUND TO TRUE                       27299099
269559**        DISPLAY ' '                                             27300099
269560**        DISPLAY '    In 4G-50200-SIM-CTN-UPDATE      '          27301099
269561**        DISPLAY CTN  IN  DCLCTN-INV                             27302099
269562**        DISPLAY ' '                                             27303099
269563**        PERFORM 9160-DISPLAY-SQL-ERR THRU 9160-EXIT             27304099
269564**        MOVE    SQLCODE TO WS-ABEND-CODE                        27305099
269565**        STRING 'FATAL SQL ERROR!!!  SQLCODE: '                  27306099
269566**                WS-ABEND-CODE                                   27307099
269567**                DELIMITED BY SIZE                               27308099
269568**                INTO WS-ABEND-TEXT                              27309099
269569**        END-STRING                                              27310099
269570**        PERFORM 9000-ABORT           THRU 9000-EXIT             27311099
269571**      END-IF                                                    27312099
269572**     END-IF                                                     27313099
269573      .                                                           27314099
269574 4G-50200-EXIT.                                                   27315099
269575      EXIT.                                                       27316099
269577                                                                  27317099
269578 4G-50500-SIM-UPDATE.                                             27318099
269579*----------------------------------------------------------------*27319099
269580*    PARAGRAPH NAME:      4G-50500-SIM-UPDATE                     27320099
269581*                         Update  SIM-INV  Per  CTN  Data         27321099
269582*----------------------------------------------------------------*27322099
269583     MOVE '4G-50500-SIM-UPDATE  '                                 27323099
269584       TO WS-CURR-PARA                                            27324099
269585                                                                  27325099
269586     MOVE  SPACES  TO  WS-SIM-UPD-SW                              27326099
269587                                                                  27327099
269588**  Establish  Specific  Type  of  SIM-INV  Update                27328099
269589                                                                  27329099
269590     MOVE WS-CTNIN-ICC-ID-4G                                      27330099
269591       TO ICC-ID-4G      OF DCLSIM-INV                            27331099
269592                                                                  27332099
269593     MOVE WS-CTNIN-CTN-TEXT(1:10)                                 27333099
269594       TO MDN            OF DCLSIM-INV                            27334099
269595                                                                  27335099
269596     MOVE LIT-PGM-ID                                              27336099
269597       TO OPERATOR-ID    OF DCLSIM-INV                            27337099
269598                                                                  27338099
269599     MOVE  LIT-RECON-ID                                           27339099
269600       TO APPLICATION-ID OF DCLSIM-INV                            27340099
269601                                                                  27341099
269602     INITIALIZE SQLCODE                                           27342099
269603                                                                  27343099
269604     EXEC SQL                                                     27344099
269605          SET :DCLSIM-INV.SYS-UPDATE-DATE  =  CURRENT TIMESTAMP + 27345099
269606                                             :WS-HRS HOURS        27346099
269607     END-EXEC                                                     27347099
269608                                                                  27348099
269609     EXEC SQL                                                     27349099
269610                                                                  27350099
269620        UPDATE SIM_INV                                            27351099
269630                                                                  27352099
269640           SET  SYS_UPDATE_DATE  = :DCLSIM-INV.SYS-UPDATE-DATE,   27353099
269650                SIM_STATUS       = :WS-SIM-STATUS,                27354099
269660                OPERATOR_ID      = :DCLSIM-INV.OPERATOR-ID,       27355099
269670                APPLICATION_ID   = :DCLSIM-INV.APPLICATION-ID,    27356099
269680                MDN              = :WS-MDN-CLEAR                  27357099
269690                                                                  27358099
269700          WHERE ICC_ID_4G        = :DCLSIM-INV.ICC-ID-4G          27359099
269710            AND MDN              = :DCLSIM-INV.MDN                27360099
269720                                                                  27361099
269730     END-EXEC                                                     27362099
269740                                                                  27363099
269750     MOVE SQLCODE TO WS-SQLCODE                                   27364099
269760     MOVE WS-SQLCODE TO WS-SQLCODE-DS                             27365099
269770                                                                  27366099
269780     IF  WS-SQLCODE  NOT  =  +0                                   27367099
269790                                                                  27368099
269120**   JA1012 -  Remove  CCE3                                       27369099
269120             STRING    ' UPDATE FAILED SIM-INV '                  27370099
269150                       'SQLCODE= '             DELIMITED BY SIZE  27371099
269160                        WS-SQLCODE-DS          DELIMITED BY SIZE  27372099
269170                        ',SIM= '               DELIMITED BY SIZE  27373099
269180                ICC-ID-4G  IN  CA-INPUT-AREA  OF  WS-API-COMMAREA 27374099
269190                                               DELIMITED BY SIZE  27375099
269260                   INTO  SD-MESSAGE                               27376099
269270             END-STRING                                           27377099
269300             SET   WS-4G-ERROR-YES  TO  TRUE                      27378099
269310                                                                  27379099
269525             MOVE  SD-MESSAGE                                     27380099
269526                     TO  API-STATUS-DESCR OF CA-OUTPUT-AREA       27381099
269528                                                                  27382099
270000         GO TO 4G-50500-EXIT                                      27383099
270010     END-IF                                                       27384099
270020                                                                  27385099
270030     ADD +1 TO WS-TOTL-SIM-UPD                                    27386099
270040     SET  WS-4G-SIM-YES  TO  TRUE                                 27387099
270050      .                                                           27388099
270060 4G-50500-EXIT.                                                   27389099
270070      EXIT.                                                       27390099
270080                                                                  27391099
270090                                                                  27392099
270100 4G-51000-VORA-UPDATE.                                            27393099
270110*----------------------------------------------------------------*27394099
270120*    PARAGRAPH NAME:      4G-51000-VORA-UPDATE                    27395099
270130*                         Update  VORA-IMSI-INV per Billing       27396099
270140*----------------------------------------------------------------*27397099
270150     MOVE '4G-51000-VORA-UPDATE  '                                27398099
270160       TO WS-CURR-PARA                                            27399099
270170                                                                  27400099
270180     MOVE  SPACES  TO  WS-VORA-UPD-SW                             27401099
270190                                                                  27402099
270200     INITIALIZE DCLVORA-IMSI-INV                                  27403099
270210                SQLCODE                                           27404099
270220                                                                  27405099
270230     MOVE MDNIN-IMSI                                              27406099
270240       TO VORA-IMSI      OF DCLVORA-IMSI-INV                      27407099
270250                                                                  27408099
270260     MOVE LIT-PGM-ID                                              27409099
270270       TO OPERATOR-ID    OF DCLVORA-IMSI-INV                      27410099
270280                                                                  27411099
270290     MOVE  LIT-RECON-ID                                           27412099
270300       TO APPLICATION-ID OF DCLVORA-IMSI-INV                      27413099
270310                                                                  27414099
270320     EXEC SQL                                                     27415099
270330          SET :DCLVORA-IMSI-INV.SYS-UPDATE-DATE =                 27416099
270340                                             CURRENT TIMESTAMP +  27417099
270350                                            :WS-HRS HOURS         27418099
270360     END-EXEC                                                     27419099
270370                                                                  27420099
270380     EXEC SQL                                                     27421099
270390                                                                  27422099
270400        UPDATE VORA_IMSI_INV                                      27423099
270410                                                                  27424099
270420          SET SYS_UPDATE_DATE = :DCLVORA-IMSI-INV.SYS-UPDATE-DATE,27425099
270430              IMSI_STATUS     = :MDNIN-MDN-STATUS,                27426099
270440               OPERATOR_ID     = :DCLVORA-IMSI-INV.OPERATOR-ID,   27427099
270450               APPLICATION_ID  = :DCLVORA-IMSI-INV.APPLICATION-ID 27428099
270460                                                                  27429099
270470          WHERE VORA_IMSI        = :DCLVORA-IMSI-INV.VORA-IMSI    27430099
270480            AND IMSI_STATUS      = :WS-CTNIN-CTN-STATUS           27431099
270490                                                                  27432099
270500     END-EXEC                                                     27433099
270510                                                                  27434099
270520     MOVE SQLCODE TO WS-SQLCODE                                   27435099
270530     MOVE WS-SQLCODE TO WS-SQLCODE-DS                             27436099
270540                                                                  27437099
270550     IF  WS-SQLCODE  NOT  =  +0                                   27438099
270560                                                                  27439099
270570**  JA1012 -  REMOVE  CCE3                                        27440099
270570             STRING  ' UPDATE FAILED VORA-IMSI '                  27441099
270590                                                                  27442099
270600                       'SQLCODE= '             DELIMITED BY SIZE  27443099
270610                        WS-SQLCODE-DS          DELIMITED BY SIZE  27444099
270620                        ',VORA= '              DELIMITED BY SIZE  27445099
270630                VORA-IMSI  IN  CA-INPUT-AREA  OF  WS-API-COMMAREA 27446099
270640                                               DELIMITED BY SIZE  27447099
270730             INTO  SD-MESSAGE                                     27448099
270660                                                                  27449099
270670             END-STRING                                           27450099
270730             MOVE  SD-MESSAGE                                     27451099
270740                     TO  API-STATUS-DESCR OF CA-OUTPUT-AREA       27452099
270750             SET   WS-4G-ERROR-YES  TO  TRUE                      27453099
270760                                                                  27454099
270770         GO TO 4G-51000-EXIT                                      27455099
270780     END-IF                                                       27456099
270790                                                                  27457099
270800     ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                             27458099
270810     SET  WS-4G-VORA-YES  TO  TRUE                                27459099
270820      .                                                           27460099
270830 4G-51000-EXIT.                                                   27461099
270840      EXIT.                                                       27462099
270850                                                                  27463099
270860 4G-51500-VORA-UPDATE.                                            27464099
270870*----------------------------------------------------------------*27465099
270880*    PARAGRAPH NAME:      4G-51500-VORA-UPDATE                    27466099
270890*                         Update  VORA-IMSI-INV                   27467099
270900*----------------------------------------------------------------*27468099
270910     MOVE '4G-51500-VORA-UPDATE  '                                27469099
270920       TO WS-CURR-PARA                                            27470099
270930                                                                  27471099
270940     MOVE  SPACES  TO  WS-VORA-UPD-SW                             27472099
270950                                                                  27473099
270960     INITIALIZE DCLVORA-IMSI-INV                                  27474099
270970                SQLCODE                                           27475099
270980                                                                  27476099
270990     MOVE WS-CTNIN-IMSI                                           27477099
271000       TO VORA-IMSI      OF DCLVORA-IMSI-INV                      27478099
271010                                                                  27479099
271020     MOVE LIT-PGM-ID                                              27480099
271030       TO OPERATOR-ID    OF DCLVORA-IMSI-INV                      27481099
271040                                                                  27482099
271050     MOVE  LIT-RECON-ID                                           27483099
271060       TO APPLICATION-ID OF DCLVORA-IMSI-INV                      27484099
271070                                                                  27485099
271080     EXEC SQL                                                     27486099
271090          SET :DCLVORA-IMSI-INV.SYS-UPDATE-DATE =                 27487099
271100                                             CURRENT TIMESTAMP +  27488099
271110                                            :WS-HRS HOURS         27489099
271120     END-EXEC                                                     27490099
271130                                                                  27491099
271140     EXEC SQL                                                     27492099
271150                                                                  27493099
271160        UPDATE VORA_IMSI_INV                                      27494099
271170                                                                  27495099
271180          SET SYS_UPDATE_DATE = :DCLVORA-IMSI-INV.SYS-UPDATE-DATE,27496099
271190              IMSI_STATUS     = :WS-VORA-STATUS,                  27497099
271200               OPERATOR_ID     = :DCLVORA-IMSI-INV.OPERATOR-ID,   27498099
271210               APPLICATION_ID  = :DCLVORA-IMSI-INV.APPLICATION-ID 27499099
271220                                                                  27500099
271230          WHERE VORA_IMSI        = :DCLVORA-IMSI-INV.VORA-IMSI    27501099
271240                                                                  27502099
271250     END-EXEC                                                     27503099
271260                                                                  27504099
271270     MOVE SQLCODE TO WS-SQLCODE                                   27505099
271280     MOVE WS-SQLCODE TO WS-SQLCODE-DS                             27506099
271290                                                                  27507099
271300     IF  WS-SQLCODE  NOT  =  +0                                   27508099
271310                                                                  27509099
270570**  JA1012 -  REMOVE  CCE3                                        27510099
270570             STRING  ' UPDATE FAILED VORA-IMSI '                  27511099
270590                                                                  27512099
270600                       'SQLCODE= '             DELIMITED BY SIZE  27513099
270610                        WS-SQLCODE-DS          DELIMITED BY SIZE  27514099
270620                        ',VORA= '              DELIMITED BY SIZE  27515099
270630                VORA-IMSI  IN  CA-INPUT-AREA  OF  WS-API-COMMAREA 27516099
270640                                               DELIMITED BY SIZE  27517099
270730             INTO  SD-MESSAGE                                     27518099
270660                                                                  27519099
270670             END-STRING                                           27520099
271480             MOVE  SD-MESSAGE                                     27521099
271490                     TO  API-STATUS-DESCR OF CA-OUTPUT-AREA       27522099
271500             SET   WS-4G-ERROR-YES  TO  TRUE                      27523099
271510                                                                  27524099
271520         GO TO 4G-51500-EXIT                                      27525099
271530     END-IF                                                       27526099
271540                                                                  27527099
271550     SET  WS-4G-VORA-YES  TO  TRUE                                27528099
271560     ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                             27529099
271570      .                                                           27530099
271580 4G-51500-EXIT.                                                   27531099
271590      EXIT.                                                       27532099
                                                                        27533099
067590 4G-CHECK-SIM-STATUS.                                             27534099
260060                                                                  27535099
067590*  JA1112                                                         27536099
259770*                                                                 27537099
259760*  Process  SIM  Select                                           27538099
259770*                                                                 27539099
067590     MOVE  SPACES  TO  WS-SIM-STATUS                              27540099
067590     MOVE  MDNIN-ICC-ID-4G  TO  ICC-ID-4G  IN   LTE-INPUT-AREA    27541099
259770                                                                  27542099
259800     SET  SEL-SIM   OF WS-LTE-DATA-LAYER  TO TRUE                 27543099
259810                                                                  27544099
259820     CALL WS-SIM-INV-ETLSC10                                      27545099
259830          USING                                                   27546099
259840          WS-LTE-DATA-LAYER                                       27547099
259850          ON EXCEPTION                                            27548099
259860          DISPLAY '*4G-EXCEPTION3  - Calling  ETLSC10'            27549099
259870     END-CALL                                                     27550099
260060                                                                  27551099
260040*  Check  Return  Code                                            27552099
260050*                                                                 27553099
260060                                                                  27554099
264980     IF  LTE-STATUS-CD  IN  LTE-OUTPUT-AREA  =  '00000'           27555099
264990         MOVE  SIM-STATUS IN LTE-OUTPUT-AREA  TO  WS-SIM-STATUS   27556099
264990         GO  TO  4G-CHECK-SIM-STATUS-EXIT                         27557099
265000     END-IF                                                       27558099
260060                                                                  27559099
260080     DISPLAY  '4G-CHECK-SIM - Para'                               27560099
260060                                                                  27561099
260080     DISPLAY  '* MDN / ICC-ID-4G / IMSI *  '                      27562099
260090               WS-CTNIN-4TH-G  ' / '                              27563099
260100               ICC-ID-4G  IN  LTE-INPUT-AREA  ' / '               27564099
260110               VORA-IMSI  IN  LTE-INPUT-AREA                      27565099
260120     DISPLAY  'LTE-STATUS-CD / DESCR '                            27566099
260130               LTE-STATUS-CD  IN  LTE-OUTPUT-AREA   ' / '         27567099
260140               LTE-STATUS-DESCR  IN  LTE-OUTPUT-AREA              27568099
260150     SET   WS-4G-ERROR-YES  TO  TRUE                              27569099
260160     MOVE  2  TO  WS-RETURN-CODE                                  27570099
260060     .                                                            27571099
260060                                                                  27572099
264990 4G-CHECK-SIM-STATUS-EXIT.    EXIT.                               27573099
260060                                                                  27574099
067590 4G-HYBRID-CDVC-TRANS.                                            27575099
260060                                                                  27576099
067590*  JA1112                                                         27577099
260060                                                                  27578099
067590*  Update  CTN-HIST, CTN, SIM-HIST, SIM  &  Generate  Reports     27579099
067590*  OMITTED  Are  Biller  Swaps,  MIN  Changes,  Prepaid-Ind       27580099
260060                                                                  27581099
076880     MOVE  MDNIN-MDN  TO  WS-MDN                                  27582099
076880                          SEARCH-MDN                              27583099
260060                                                                  27584099
198540     PERFORM  7000-SELECT-CTN-INV  THRU  7000-EXIT                27585099
198550                                                                  27586099
198580     EXEC SQL                                                     27589099
198590     INSERT INTO CTN_INV_HISTORY                                  27590099
198600             ( CTN ,                                              27591099
198610               SYS_CREATION_DATE ,                                27592099
198620               SYS_UPDATE_DATE ,                                  27593099
198630               OPERATOR_ID ,                                      27594099
198640               APPLICATION_ID ,                                   27595099
198650               DL_SERVICE_CODE ,                                  27596099
198660               DL_UPDATE_STAMP,                                   27597099
198670               LAST_TRX_DATE ,                                    27598099
198680               LAST_TRX_CODE ,                                    27599099
198690               CTN_STATUS ,                                       27600099
198700               LAST_TRX_UID ,                                     27601099
198710               NL,                                                27602099
198720               NGP ,                                              27603099
198730               CONV_RUN_NO ,                                      27604099
198740               SPECIAL_TRX_DATE ,                                 27605099
198750               RUN_ID ,                                           27606099
198760               HOLD_REASON ,                                      27607099
198770               PRODUCT_TYPE,                                      27608099
198780               ICC_ID ,                                           27609099
198790               PORT_IND ,                                         27610099
198800               MIN_NUM ,                                          27611099
198810               BILLER_ID ,                                        27612099
198820               STATUS_REASON_CD,                                  27613099
198830               PREPAID_IND,                                       27614099
198840               IMSI,                                              27615099
198850               ICC_ID_4G)                                         27616099
198860       SELECT CTN ,                                               27617099
198870              SYS_CREATION_DATE ,                                 27618099
198880              SYS_UPDATE_DATE ,                                   27619099
198890              OPERATOR_ID ,                                       27620099
198900              APPLICATION_ID ,                                    27621099
198910              DL_SERVICE_CODE ,                                   27622099
198920              DL_UPDATE_STAMP,                                    27623099
198930              LAST_TRX_DATE ,                                     27624099
198940              LAST_TRX_CODE ,                                     27625099
198950              CTN_STATUS ,                                        27626099
198960              LAST_TRX_UID ,                                      27627099
198970              NL,                                                 27628099
198980              NGP ,                                               27629099
198990              CONV_RUN_NO ,                                       27630099
199000              SPECIAL_TRX_DATE ,                                  27631099
199010              RUN_ID ,                                            27632099
199020              HOLD_REASON ,                                       27633099
199030              PRODUCT_TYPE,                                       27634099
199040              ICC_ID ,                                            27635099
199050              PORT_IND ,                                          27636099
199060              MIN_NUM ,                                           27637099
199070              BILLER_ID ,                                         27638099
199080              STATUS_REASON_CD ,                                  27639099
199090              PREPAID_IND,                                        27640099
199100              IMSI,                                               27641099
199110              ICC_ID_4G                                           27642099
199120      FROM CTN_INV                                                27643099
199130     WHERE CTN         = :SEARCH-MDN                              27644099
199140     END-EXEC                                                     27645099
199150                                                                  27646099
199160     MOVE SQLCODE TO WS-SQLCODE                                   27647099
199170                     WS-SQLCODE-DS                                27648099
199180                     SQL-STATUS-CODE                              27649099
199190                                                                  27650099
199200     EVALUATE TRUE                                                27651099
199210       WHEN SQL-SUCCESS                                           27652099
199220          ADD  +1  TO  WS-TOTL-ETNI-CTNHIST-INS-CNT               27653099
199230          ADD  +1  TO  WS-TOTL-UPD-INS-DEL-MQ                     27654099
199240          CONTINUE                                                27655099
199250       WHEN SQL-DUP-INSERT                                        27656099
199260          PERFORM 7052-CREATE-HISTORY-DUP                         27657099
199270             THRU 7052-EXIT                                       27658099
199280       WHEN OTHER                                                 27659099
199290         MOVE  SQLCODE  TO  WS-SQLCODE-DS                         27660099
199300         DISPLAY '*********************************************'  27661099
199310         DISPLAY '**                  ERROR                  **'  27662099
199320         DISPLAY '**                                         **'  27663099
199330         DISPLAY '** 4G-HYBRID-CDVC-TRANS         '               27664099
199340         DISPLAY '**                                         **'  27665099
199350         DISPLAY 'INSERT CTN-INV-HISTORY FAILED'                  27666099
199360         DISPLAY 'SQLCODE CODE = ' WS-SQLCODE-DS                  27667099
199370         DISPLAY '**                                         **'  27668099
199380         DISPLAY '**                                         **'  27669099
199390         DISPLAY 'CURRENT MDN RECORD = ' SEARCH-MDN               27670099
199400         DISPLAY '**                                         **'  27671099
199410         DISPLAY  ALL '-'                                         27672099
199420         DISPLAY '*********************************************'  27673099
199430         DISPLAY  ALL '-'                                         27674099
199440         DIVIDE  ZERO1  BY  ZERO2  GIVING  CORE-DUMP              27675099
199450     END-EVALUATE                                                 27676099
199610                                                                  27677099
199630     MOVE  'AI'  TO  SEARCH-CTN-STATUS                            27678099
190000     MOVE  MDNIN-ICC-ID-4G  TO  ICC-ID-4G  IN  DCLCTN-INV         27679099
199670                                                                  27680099
199680     EXEC SQL  UPDATE                                             27681099
199690               CTN_INV                                            27682099
199700      SET                                                         27683099
199710                                                                  27684099
199750        CTN_STATUS      =  :SEARCH-CTN-STATUS,                    27685099
199760        SYS_UPDATE_DATE =  CURRENT TIMESTAMP + :WS-HRS HOURS,     27686099
199770        OPERATOR_ID     =  :LIT-PGM-ID                            27687099
199780                           :DCLCTN-INV-NULL-INDS.OPERATOR-ID-NI,  27688099
190000        ICC_ID_4G       =  :DCLCTN-INV.ICC-ID-4G                  27689099
199790          WHERE                                                   27690099
199800               CTN      =  :SEARCH-MDN                            27691099
199810     END-EXEC                                                     27692099
                                                                        27693099
199830     PERFORM 9150-CHECK-SQLCODE THRU 9150-EXIT                    27694099
199840                                                                  27695099
199850     IF  SQLCODE  NOT  =  ZERO                                    27696099
199860         MOVE  'CTN Up.Err 4G-HYBRID '  TO  WS-COMMENT            27697099
063000         PERFORM 6010-MOVE-ETNI-TO-RPT THRU 6010-EXIT             27698099
063080         PERFORM 6500-WRITE-ERROR-RPT  THRU 6500-EXIT             27699099
199860         GO  TO  4G-HYBRID-CDVC-TRANS-EXIT                        27700099
199870     END-IF                                                       27701099
199880                                                                  27702099
199900     ADD  +1  TO  WS-TOTL-ETNI-CTNINV-UPD-ST-CNT                  27703099
199910     ADD  +1  TO  WS-TOTL-UPD-INS-DEL-MQ                          27704099
199920                                                                  27705099
266760**  Insert  Into  SIM-INV-HISTORY                                 27707099
266770                                                                  27708099
266780     INITIALIZE  LTE-INPUT-AREA                                   27709099
266790                                                                  27710099
266800     MOVE  MDNIN-ICC-ID-4G                                        27711099
266810       TO ICC-ID-4G OF  LTE-INPUT-AREA                            27712099
266820                                                                  27713099
266830     SET  LTE-INSERT   OF WS-LTE-DATA-LAYER  TO TRUE              27714099
266840                                                                  27715099
266850     CALL WS-SIM-INV-HIST-ETLSC08  USING                          27716099
266860                                   WS-LTE-DATA-LAYER              27717099
266870          ON EXCEPTION                                            27718099
266880              MOVE SPACES                                         27719099
266890                TO SD-MESSAGE                                     27720099
266900                   API-STATUS-DESCR                               27721099
266910              MOVE '90010'                                        27722099
266920                TO API-STATUS-CD                                  27723099
266930                   STRING                                         27724099
266940                      'CALL FAIL TO ETNSC08 FROM ETNBC16'         27725099
266950                      DELIMITED BY SIZE                           27726099
266960                      INTO API-STATUS-DESCR                       27727099
266970                   END-STRING                                     27728099
269280              MOVE  SD-MESSAGE                                    27729099
269290                     TO  API-STATUS-DESCR OF CA-OUTPUT-AREA       27730099
269300               SET   WS-4G-ERROR-YES  TO  TRUE                    27731099
267270              GO TO 4G-HYBRID-CDVC-TRANS-EXIT                     27732099
266990     END-CALL                                                     27733099
267000                                                                  27734099
267010     MOVE  LTE-SQLCODE  TO  WS-SQLCODE                            27735099
267020                            WS-SQLCODE-DS                         27736099
267030                                                                  27737099
267040     IF  LTE-SQLCODE  =  ZERO                                     27738099
267050         MOVE '00000' TO API-STATUS-CD OF CA-OUTPUT-AREA          27739099
267060          ADD +1 TO WS-TOTL-UPD-INS-DEL-MQ                        27740099
267070                                                                  27741099
267080         ELSE                                                     27742099
267090                                                                  27743099
267120          STRING  'Insert to SIM Inv-Hist  failed - 4G-HYBRID '   27744099
267130                       'SQLCODE= '                                27745099
267140                        WS-SQLCODE-DS                             27746099
267150                        ',ICC= '                                  27747099
267160               ICC-ID-4G OF CA-INPUT-AREA DELIMITED BY SIZE       27748099
269260                   INTO  SD-MESSAGE                               27749099
269270             END-STRING                                           27750099
269280             MOVE  SD-MESSAGE                                     27751099
269290                     TO  API-STATUS-DESCR OF CA-OUTPUT-AREA       27752099
269300             SET   WS-4G-ERROR-YES  TO  TRUE                      27753099
267270          GO TO 4G-HYBRID-CDVC-TRANS-EXIT                         27754099
267280     END-IF                                                       27755099
268720                                                                  27756099
268730     MOVE MDNIN-ICC-ID-4G                                         27757099
268740       TO ICC-ID-4G      OF DCLSIM-INV                            27758099
268750                                                                  27759099
268760     MOVE MDNIN-MDN                                               27760099
268770       TO MDN            OF DCLSIM-INV                            27761099
268780                                                                  27762099
268790     MOVE LIT-PGM-ID                                              27763099
268800       TO OPERATOR-ID    OF DCLSIM-INV                            27764099
268810                                                                  27765099
268820     MOVE  LIT-RECON-ID                                           27766099
268830       TO APPLICATION-ID OF DCLSIM-INV                            27767099
268840                                                                  27768099
268850     INITIALIZE SQLCODE                                           27769099
268860                                                                  27770099
268870     EXEC SQL                                                     27771099
268880          SET :DCLSIM-INV.SYS-UPDATE-DATE  =  CURRENT TIMESTAMP + 27772099
268890                                             :WS-HRS HOURS        27773099
268900     END-EXEC                                                     27774099
268910                                                                  27775099
268920     EXEC SQL                                                     27776099
268930                                                                  27777099
268940        UPDATE SIM_INV                                            27778099
268950                                                                  27779099
268960           SET  SYS_UPDATE_DATE  = :DCLSIM-INV.SYS-UPDATE-DATE,   27780099
268970                SIM_STATUS       = :MDNIN-MDN-STATUS,             27781099
268980                OPERATOR_ID      = :DCLSIM-INV.OPERATOR-ID,       27782099
269030                MDN              = :DCLSIM-INV.MDN,               27782199
268990                APPLICATION_ID   = :DCLSIM-INV.APPLICATION-ID     27783099
269000                                                                  27784099
269010          WHERE ICC_ID_4G        = :DCLSIM-INV.ICC-ID-4G          27785099
269020            AND  SIM_STATUS      = 'AD'                           27786099
269030            AND MDN              = :WS-MDN-CLEAR                  27787099
269040                                                                  27788099
269050     END-EXEC                                                     27789099
269060                                                                  27790099
269070     MOVE SQLCODE TO WS-SQLCODE                                   27791099
269080     MOVE WS-SQLCODE TO WS-SQLCODE-DS                             27792099
269090                                                                  27793099
269100     IF  WS-SQLCODE  NOT  =  +0                                   27794099
269120         STRING    ' UPDATE FAILED SIM-INV - 4G-HYBRID '          27795099
269150                   'SQLCODE= '             DELIMITED BY SIZE      27796099
269160                    WS-SQLCODE-DS          DELIMITED BY SIZE      27797099
269170                   ',SIM= '               DELIMITED BY SIZE       27798099
269180              ICC-ID-4G  IN  CA-INPUT-AREA  OF  WS-API-COMMAREA   27799099
269190                                          DELIMITED BY SIZE       27800099
269260              INTO  SD-MESSAGE                                    27801099
269270          END-STRING                                              27802099
269280          MOVE  SD-MESSAGE                                        27803099
269290                TO  API-STATUS-DESCR OF CA-OUTPUT-AREA            27804099
269300          SET   WS-4G-ERROR-YES  TO  TRUE                         27805099
269310                                                                  27806099
269320          GO TO 4G-HYBRID-CDVC-TRANS-EXIT                         27807099
269330     END-IF                                                       27808099
269340                                                                  27809099
           SET  WS-4G-SIM-YES  TO  TRUE                                 27810099
269360     ADD +1 TO WS-TOTL-SIM-UPD                                    27811099
260060     .                                                            27813099
067590 4G-HYBRID-CDVC-TRANS-EXIT.  EXIT.                                27814099
